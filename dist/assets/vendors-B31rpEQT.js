var gU=Object.defineProperty;var yU=(e,t,r)=>t in e?gU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Us=(e,t,r)=>yU(e,typeof t!="symbol"?t+"":t,r);function yz(e,t){for(var r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&!Array.isArray(i)){for(const u in i)if(u!=="default"&&!(u in e)){const h=Object.getOwnPropertyDescriptor(i,u);h&&Object.defineProperty(e,u,h.get?h:{enumerable:!0,get:()=>i[u]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var Bm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _z={exports:{}},_x={},vz={exports:{}},Pr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oy=Symbol.for("react.element"),_U=Symbol.for("react.portal"),vU=Symbol.for("react.fragment"),xU=Symbol.for("react.strict_mode"),bU=Symbol.for("react.profiler"),wU=Symbol.for("react.provider"),TU=Symbol.for("react.context"),SU=Symbol.for("react.forward_ref"),EU=Symbol.for("react.suspense"),AU=Symbol.for("react.memo"),PU=Symbol.for("react.lazy"),MO=Symbol.iterator;function MU(e){return e===null||typeof e!="object"?null:(e=MO&&e[MO]||e["@@iterator"],typeof e=="function"?e:null)}var xz={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bz=Object.assign,wz={};function yd(e,t,r){this.props=e,this.context=t,this.refs=wz,this.updater=r||xz}yd.prototype.isReactComponent={};yd.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};yd.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Tz(){}Tz.prototype=yd.prototype;function UE(e,t,r){this.props=e,this.context=t,this.refs=wz,this.updater=r||xz}var VE=UE.prototype=new Tz;VE.constructor=UE;bz(VE,yd.prototype);VE.isPureReactComponent=!0;var CO=Array.isArray,Sz=Object.prototype.hasOwnProperty,GE={current:null},Ez={key:!0,ref:!0,__self:!0,__source:!0};function Az(e,t,r){var i,u={},h=null,p=null;if(t!=null)for(i in t.ref!==void 0&&(p=t.ref),t.key!==void 0&&(h=""+t.key),t)Sz.call(t,i)&&!Ez.hasOwnProperty(i)&&(u[i]=t[i]);var _=arguments.length-2;if(_===1)u.children=r;else if(1<_){for(var o=Array(_),x=0;x<_;x++)o[x]=arguments[x+2];u.children=o}if(e&&e.defaultProps)for(i in _=e.defaultProps,_)u[i]===void 0&&(u[i]=_[i]);return{$$typeof:oy,type:e,key:h,ref:p,props:u,_owner:GE.current}}function CU(e,t){return{$$typeof:oy,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function WE(e){return typeof e=="object"&&e!==null&&e.$$typeof===oy}function OU(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var OO=/\/+/g;function aw(e,t){return typeof e=="object"&&e!==null&&e.key!=null?OU(""+e.key):t.toString(36)}function Mv(e,t,r,i,u){var h=typeof e;(h==="undefined"||h==="boolean")&&(e=null);var p=!1;if(e===null)p=!0;else switch(h){case"string":case"number":p=!0;break;case"object":switch(e.$$typeof){case oy:case _U:p=!0}}if(p)return p=e,u=u(p),e=i===""?"."+aw(p,0):i,CO(u)?(r="",e!=null&&(r=e.replace(OO,"$&/")+"/"),Mv(u,t,r,"",function(x){return x})):u!=null&&(WE(u)&&(u=CU(u,r+(!u.key||p&&p.key===u.key?"":(""+u.key).replace(OO,"$&/")+"/")+e)),t.push(u)),1;if(p=0,i=i===""?".":i+":",CO(e))for(var _=0;_<e.length;_++){h=e[_];var o=i+aw(h,_);p+=Mv(h,t,r,o,u)}else if(o=MU(e),typeof o=="function")for(e=o.call(e),_=0;!(h=e.next()).done;)h=h.value,o=i+aw(h,_++),p+=Mv(h,t,r,o,u);else if(h==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return p}function q_(e,t,r){if(e==null)return e;var i=[],u=0;return Mv(e,i,"","",function(h){return t.call(r,h,u++)}),i}function IU(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var eo={current:null},Cv={transition:null},kU={ReactCurrentDispatcher:eo,ReactCurrentBatchConfig:Cv,ReactCurrentOwner:GE};Pr.Children={map:q_,forEach:function(e,t,r){q_(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return q_(e,function(){t++}),t},toArray:function(e){return q_(e,function(t){return t})||[]},only:function(e){if(!WE(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Pr.Component=yd;Pr.Fragment=vU;Pr.Profiler=bU;Pr.PureComponent=UE;Pr.StrictMode=xU;Pr.Suspense=EU;Pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kU;Pr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=bz({},e.props),u=e.key,h=e.ref,p=e._owner;if(t!=null){if(t.ref!==void 0&&(h=t.ref,p=GE.current),t.key!==void 0&&(u=""+t.key),e.type&&e.type.defaultProps)var _=e.type.defaultProps;for(o in t)Sz.call(t,o)&&!Ez.hasOwnProperty(o)&&(i[o]=t[o]===void 0&&_!==void 0?_[o]:t[o])}var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){_=Array(o);for(var x=0;x<o;x++)_[x]=arguments[x+2];i.children=_}return{$$typeof:oy,type:e.type,key:u,ref:h,props:i,_owner:p}};Pr.createContext=function(e){return e={$$typeof:TU,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:wU,_context:e},e.Consumer=e};Pr.createElement=Az;Pr.createFactory=function(e){var t=Az.bind(null,e);return t.type=e,t};Pr.createRef=function(){return{current:null}};Pr.forwardRef=function(e){return{$$typeof:SU,render:e}};Pr.isValidElement=WE;Pr.lazy=function(e){return{$$typeof:PU,_payload:{_status:-1,_result:e},_init:IU}};Pr.memo=function(e,t){return{$$typeof:AU,type:e,compare:t===void 0?null:t}};Pr.startTransition=function(e){var t=Cv.transition;Cv.transition={};try{e()}finally{Cv.transition=t}};Pr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Pr.useCallback=function(e,t){return eo.current.useCallback(e,t)};Pr.useContext=function(e){return eo.current.useContext(e)};Pr.useDebugValue=function(){};Pr.useDeferredValue=function(e){return eo.current.useDeferredValue(e)};Pr.useEffect=function(e,t){return eo.current.useEffect(e,t)};Pr.useId=function(){return eo.current.useId()};Pr.useImperativeHandle=function(e,t,r){return eo.current.useImperativeHandle(e,t,r)};Pr.useInsertionEffect=function(e,t){return eo.current.useInsertionEffect(e,t)};Pr.useLayoutEffect=function(e,t){return eo.current.useLayoutEffect(e,t)};Pr.useMemo=function(e,t){return eo.current.useMemo(e,t)};Pr.useReducer=function(e,t,r){return eo.current.useReducer(e,t,r)};Pr.useRef=function(e){return eo.current.useRef(e)};Pr.useState=function(e){return eo.current.useState(e)};Pr.useSyncExternalStore=function(e,t,r){return eo.current.useSyncExternalStore(e,t,r)};Pr.useTransition=function(){return eo.current.useTransition()};Pr.version="18.2.0";vz.exports=Pr;var De=vz.exports;const Fe=Xr(De),DU=yz({__proto__:null,default:Fe},[De]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LU=De,zU=Symbol.for("react.element"),RU=Symbol.for("react.fragment"),BU=Object.prototype.hasOwnProperty,jU=LU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,FU={key:!0,ref:!0,__self:!0,__source:!0};function Pz(e,t,r){var i,u={},h=null,p=null;r!==void 0&&(h=""+r),t.key!==void 0&&(h=""+t.key),t.ref!==void 0&&(p=t.ref);for(i in t)BU.call(t,i)&&!FU.hasOwnProperty(i)&&(u[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)u[i]===void 0&&(u[i]=t[i]);return{$$typeof:zU,type:e,key:h,ref:p,props:u,_owner:jU.current}}_x.Fragment=RU;_x.jsx=Pz;_x.jsxs=Pz;_z.exports=_x;var kge=_z.exports,IO={},Mz={exports:{}},Ro={},Cz={exports:{}},Oz={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Ce,Oe){var at=Ce.length;Ce.push(Oe);e:for(;0<at;){var ft=at-1>>>1,st=Ce[ft];if(0<u(st,Oe))Ce[ft]=Oe,Ce[at]=st,at=ft;else break e}}function r(Ce){return Ce.length===0?null:Ce[0]}function i(Ce){if(Ce.length===0)return null;var Oe=Ce[0],at=Ce.pop();if(at!==Oe){Ce[0]=at;e:for(var ft=0,st=Ce.length,Ot=st>>>1;ft<Ot;){var St=2*(ft+1)-1,pr=Ce[St],Tr=St+1,Kr=Ce[Tr];if(0>u(pr,at))Tr<st&&0>u(Kr,pr)?(Ce[ft]=Kr,Ce[Tr]=at,ft=Tr):(Ce[ft]=pr,Ce[St]=at,ft=St);else if(Tr<st&&0>u(Kr,at))Ce[ft]=Kr,Ce[Tr]=at,ft=Tr;else break e}}return Oe}function u(Ce,Oe){var at=Ce.sortIndex-Oe.sortIndex;return at!==0?at:Ce.id-Oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var p=Date,_=p.now();e.unstable_now=function(){return p.now()-_}}var o=[],x=[],E=1,A=null,O=3,L=!1,j=!1,F=!1,Z=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Ce){for(var Oe=r(x);Oe!==null;){if(Oe.callback===null)i(x);else if(Oe.startTime<=Ce)i(x),Oe.sortIndex=Oe.expirationTime,t(o,Oe);else break;Oe=r(x)}}function G(Ce){if(F=!1,U(Ce),!j)if(r(o)!==null)j=!0,Me(q);else{var Oe=r(x);Oe!==null&&ke(G,Oe.startTime-Ce)}}function q(Ce,Oe){j=!1,F&&(F=!1,$(pe),pe=-1),L=!0;var at=O;try{for(U(Oe),A=r(o);A!==null&&(!(A.expirationTime>Oe)||Ce&&!Be());){var ft=A.callback;if(typeof ft=="function"){A.callback=null,O=A.priorityLevel;var st=ft(A.expirationTime<=Oe);Oe=e.unstable_now(),typeof st=="function"?A.callback=st:A===r(o)&&i(o),U(Oe)}else i(o);A=r(o)}if(A!==null)var Ot=!0;else{var St=r(x);St!==null&&ke(G,St.startTime-Oe),Ot=!1}return Ot}finally{A=null,O=at,L=!1}}var K=!1,re=null,pe=-1,xe=5,ge=-1;function Be(){return!(e.unstable_now()-ge<xe)}function $e(){if(re!==null){var Ce=e.unstable_now();ge=Ce;var Oe=!0;try{Oe=re(!0,Ce)}finally{Oe?Ve():(K=!1,re=null)}}else K=!1}var Ve;if(typeof V=="function")Ve=function(){V($e)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,_e=be.port2;be.port1.onmessage=$e,Ve=function(){_e.postMessage(null)}}else Ve=function(){Z($e,0)};function Me(Ce){re=Ce,K||(K=!0,Ve())}function ke(Ce,Oe){pe=Z(function(){Ce(e.unstable_now())},Oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ce){Ce.callback=null},e.unstable_continueExecution=function(){j||L||(j=!0,Me(q))},e.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xe=0<Ce?Math.floor(1e3/Ce):5},e.unstable_getCurrentPriorityLevel=function(){return O},e.unstable_getFirstCallbackNode=function(){return r(o)},e.unstable_next=function(Ce){switch(O){case 1:case 2:case 3:var Oe=3;break;default:Oe=O}var at=O;O=Oe;try{return Ce()}finally{O=at}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ce,Oe){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var at=O;O=Ce;try{return Oe()}finally{O=at}},e.unstable_scheduleCallback=function(Ce,Oe,at){var ft=e.unstable_now();switch(typeof at=="object"&&at!==null?(at=at.delay,at=typeof at=="number"&&0<at?ft+at:ft):at=ft,Ce){case 1:var st=-1;break;case 2:st=250;break;case 5:st=1073741823;break;case 4:st=1e4;break;default:st=5e3}return st=at+st,Ce={id:E++,callback:Oe,priorityLevel:Ce,startTime:at,expirationTime:st,sortIndex:-1},at>ft?(Ce.sortIndex=at,t(x,Ce),r(o)===null&&Ce===r(x)&&(F?($(pe),pe=-1):F=!0,ke(G,at-ft))):(Ce.sortIndex=st,t(o,Ce),j||L||(j=!0,Me(q))),Ce},e.unstable_shouldYield=Be,e.unstable_wrapCallback=function(Ce){var Oe=O;return function(){var at=O;O=Oe;try{return Ce.apply(this,arguments)}finally{O=at}}}})(Oz);Cz.exports=Oz;var $U=Cz.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iz=De,zo=$U;function Tt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kz=new Set,ig={};function Nc(e,t){jf(e,t),jf(e+"Capture",t)}function jf(e,t){for(ig[e]=t,e=0;e<t.length;e++)kz.add(t[e])}var nl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pT=Object.prototype.hasOwnProperty,NU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,kO={},DO={};function UU(e){return pT.call(DO,e)?!0:pT.call(kO,e)?!1:NU.test(e)?DO[e]=!0:(kO[e]=!0,!1)}function VU(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function GU(e,t,r,i){if(t===null||typeof t>"u"||VU(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function to(e,t,r,i,u,h,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=u,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=h,this.removeEmptyString=p}var Mi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Mi[e]=new to(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Mi[t]=new to(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Mi[e]=new to(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Mi[e]=new to(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Mi[e]=new to(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Mi[e]=new to(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Mi[e]=new to(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Mi[e]=new to(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Mi[e]=new to(e,5,!1,e.toLowerCase(),null,!1,!1)});var qE=/[\-:]([a-z])/g;function ZE(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(qE,ZE);Mi[t]=new to(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(qE,ZE);Mi[t]=new to(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(qE,ZE);Mi[t]=new to(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Mi[e]=new to(e,1,!1,e.toLowerCase(),null,!1,!1)});Mi.xlinkHref=new to("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Mi[e]=new to(e,1,!1,e.toLowerCase(),null,!0,!0)});function HE(e,t,r,i){var u=Mi.hasOwnProperty(t)?Mi[t]:null;(u!==null?u.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(GU(t,r,u,i)&&(r=null),i||u===null?UU(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):u.mustUseProperty?e[u.propertyName]=r===null?u.type===3?!1:"":r:(t=u.attributeName,i=u.attributeNamespace,r===null?e.removeAttribute(t):(u=u.type,r=u===3||u===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var cl=Iz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Z_=Symbol.for("react.element"),of=Symbol.for("react.portal"),af=Symbol.for("react.fragment"),XE=Symbol.for("react.strict_mode"),mT=Symbol.for("react.profiler"),Dz=Symbol.for("react.provider"),Lz=Symbol.for("react.context"),KE=Symbol.for("react.forward_ref"),gT=Symbol.for("react.suspense"),yT=Symbol.for("react.suspense_list"),YE=Symbol.for("react.memo"),ql=Symbol.for("react.lazy"),zz=Symbol.for("react.offscreen"),LO=Symbol.iterator;function dm(e){return e===null||typeof e!="object"?null:(e=LO&&e[LO]||e["@@iterator"],typeof e=="function"?e:null)}var Fn=Object.assign,sw;function jm(e){if(sw===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);sw=t&&t[1]||""}return`
`+sw+e}var lw=!1;function uw(e,t){if(!e||lw)return"";lw=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(x){var i=x}Reflect.construct(e,[],t)}else{try{t.call()}catch(x){i=x}e.call(t.prototype)}else{try{throw Error()}catch(x){i=x}e()}}catch(x){if(x&&i&&typeof x.stack=="string"){for(var u=x.stack.split(`
`),h=i.stack.split(`
`),p=u.length-1,_=h.length-1;1<=p&&0<=_&&u[p]!==h[_];)_--;for(;1<=p&&0<=_;p--,_--)if(u[p]!==h[_]){if(p!==1||_!==1)do if(p--,_--,0>_||u[p]!==h[_]){var o=`
`+u[p].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}while(1<=p&&0<=_);break}}}finally{lw=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?jm(e):""}function WU(e){switch(e.tag){case 5:return jm(e.type);case 16:return jm("Lazy");case 13:return jm("Suspense");case 19:return jm("SuspenseList");case 0:case 2:case 15:return e=uw(e.type,!1),e;case 11:return e=uw(e.type.render,!1),e;case 1:return e=uw(e.type,!0),e;default:return""}}function _T(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case af:return"Fragment";case of:return"Portal";case mT:return"Profiler";case XE:return"StrictMode";case gT:return"Suspense";case yT:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Lz:return(e.displayName||"Context")+".Consumer";case Dz:return(e._context.displayName||"Context")+".Provider";case KE:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case YE:return t=e.displayName||null,t!==null?t:_T(e.type)||"Memo";case ql:t=e._payload,e=e._init;try{return _T(e(t))}catch{}}return null}function qU(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _T(t);case 8:return t===XE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function hu(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Rz(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ZU(e){var t=Rz(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var u=r.get,h=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return u.call(this)},set:function(p){i=""+p,h.call(this,p)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(p){i=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function H_(e){e._valueTracker||(e._valueTracker=ZU(e))}function Bz(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=Rz(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function Vv(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function vT(e,t){var r=t.checked;return Fn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function zO(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=hu(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jz(e,t){t=t.checked,t!=null&&HE(e,"checked",t,!1)}function xT(e,t){jz(e,t);var r=hu(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?bT(e,t.type,r):t.hasOwnProperty("defaultValue")&&bT(e,t.type,hu(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function RO(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function bT(e,t,r){(t!=="number"||Vv(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Fm=Array.isArray;function Tf(e,t,r,i){if(e=e.options,t){t={};for(var u=0;u<r.length;u++)t["$"+r[u]]=!0;for(r=0;r<e.length;r++)u=t.hasOwnProperty("$"+e[r].value),e[r].selected!==u&&(e[r].selected=u),u&&i&&(e[r].defaultSelected=!0)}else{for(r=""+hu(r),t=null,u=0;u<e.length;u++){if(e[u].value===r){e[u].selected=!0,i&&(e[u].defaultSelected=!0);return}t!==null||e[u].disabled||(t=e[u])}t!==null&&(t.selected=!0)}}function wT(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Tt(91));return Fn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function BO(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Tt(92));if(Fm(r)){if(1<r.length)throw Error(Tt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:hu(r)}}function Fz(e,t){var r=hu(t.value),i=hu(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function jO(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function $z(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function TT(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?$z(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var X_,Nz=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,i,u){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,u)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(X_=X_||document.createElement("div"),X_.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=X_.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function og(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Vm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HU=["Webkit","ms","Moz","O"];Object.keys(Vm).forEach(function(e){HU.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Vm[t]=Vm[e]})});function Uz(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Vm.hasOwnProperty(e)&&Vm[e]?(""+t).trim():t+"px"}function Vz(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,u=Uz(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,u):e[r]=u}}var XU=Fn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ST(e,t){if(t){if(XU[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Tt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Tt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Tt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Tt(62))}}function ET(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var AT=null;function JE(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var PT=null,Sf=null,Ef=null;function FO(e){if(e=ly(e)){if(typeof PT!="function")throw Error(Tt(280));var t=e.stateNode;t&&(t=Tx(t),PT(e.stateNode,e.type,t))}}function Gz(e){Sf?Ef?Ef.push(e):Ef=[e]:Sf=e}function Wz(){if(Sf){var e=Sf,t=Ef;if(Ef=Sf=null,FO(e),t)for(e=0;e<t.length;e++)FO(t[e])}}function qz(e,t){return e(t)}function Zz(){}var cw=!1;function Hz(e,t,r){if(cw)return e(t,r);cw=!0;try{return qz(e,t,r)}finally{cw=!1,(Sf!==null||Ef!==null)&&(Zz(),Wz())}}function ag(e,t){var r=e.stateNode;if(r===null)return null;var i=Tx(r);if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Tt(231,t,typeof r));return r}var MT=!1;if(nl)try{var pm={};Object.defineProperty(pm,"passive",{get:function(){MT=!0}}),window.addEventListener("test",pm,pm),window.removeEventListener("test",pm,pm)}catch{MT=!1}function KU(e,t,r,i,u,h,p,_,o){var x=Array.prototype.slice.call(arguments,3);try{t.apply(r,x)}catch(E){this.onError(E)}}var Gm=!1,Gv=null,Wv=!1,CT=null,YU={onError:function(e){Gm=!0,Gv=e}};function JU(e,t,r,i,u,h,p,_,o){Gm=!1,Gv=null,KU.apply(YU,arguments)}function QU(e,t,r,i,u,h,p,_,o){if(JU.apply(this,arguments),Gm){if(Gm){var x=Gv;Gm=!1,Gv=null}else throw Error(Tt(198));Wv||(Wv=!0,CT=x)}}function Uc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Xz(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function $O(e){if(Uc(e)!==e)throw Error(Tt(188))}function e6(e){var t=e.alternate;if(!t){if(t=Uc(e),t===null)throw Error(Tt(188));return t!==e?null:e}for(var r=e,i=t;;){var u=r.return;if(u===null)break;var h=u.alternate;if(h===null){if(i=u.return,i!==null){r=i;continue}break}if(u.child===h.child){for(h=u.child;h;){if(h===r)return $O(u),e;if(h===i)return $O(u),t;h=h.sibling}throw Error(Tt(188))}if(r.return!==i.return)r=u,i=h;else{for(var p=!1,_=u.child;_;){if(_===r){p=!0,r=u,i=h;break}if(_===i){p=!0,i=u,r=h;break}_=_.sibling}if(!p){for(_=h.child;_;){if(_===r){p=!0,r=h,i=u;break}if(_===i){p=!0,i=h,r=u;break}_=_.sibling}if(!p)throw Error(Tt(189))}}if(r.alternate!==i)throw Error(Tt(190))}if(r.tag!==3)throw Error(Tt(188));return r.stateNode.current===r?e:t}function Kz(e){return e=e6(e),e!==null?Yz(e):null}function Yz(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Yz(e);if(t!==null)return t;e=e.sibling}return null}var Jz=zo.unstable_scheduleCallback,NO=zo.unstable_cancelCallback,t6=zo.unstable_shouldYield,r6=zo.unstable_requestPaint,Wn=zo.unstable_now,n6=zo.unstable_getCurrentPriorityLevel,QE=zo.unstable_ImmediatePriority,Qz=zo.unstable_UserBlockingPriority,qv=zo.unstable_NormalPriority,i6=zo.unstable_LowPriority,eR=zo.unstable_IdlePriority,vx=null,ps=null;function o6(e){if(ps&&typeof ps.onCommitFiberRoot=="function")try{ps.onCommitFiberRoot(vx,e,void 0,(e.current.flags&128)===128)}catch{}}var qa=Math.clz32?Math.clz32:l6,a6=Math.log,s6=Math.LN2;function l6(e){return e>>>=0,e===0?32:31-(a6(e)/s6|0)|0}var K_=64,Y_=4194304;function $m(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zv(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,u=e.suspendedLanes,h=e.pingedLanes,p=r&268435455;if(p!==0){var _=p&~u;_!==0?i=$m(_):(h&=p,h!==0&&(i=$m(h)))}else p=r&~u,p!==0?i=$m(p):h!==0&&(i=$m(h));if(i===0)return 0;if(t!==0&&t!==i&&!(t&u)&&(u=i&-i,h=t&-t,u>=h||u===16&&(h&4194240)!==0))return t;if(i&4&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-qa(t),u=1<<r,i|=e[r],t&=~u;return i}function u6(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function c6(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,u=e.expirationTimes,h=e.pendingLanes;0<h;){var p=31-qa(h),_=1<<p,o=u[p];o===-1?(!(_&r)||_&i)&&(u[p]=u6(_,t)):o<=t&&(e.expiredLanes|=_),h&=~_}}function OT(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function tR(){var e=K_;return K_<<=1,!(K_&4194240)&&(K_=64),e}function hw(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ay(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-qa(t),e[t]=r}function h6(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var u=31-qa(r),h=1<<u;t[u]=0,i[u]=-1,e[u]=-1,r&=~h}}function eA(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-qa(r),u=1<<i;u&t|e[i]&t&&(e[i]|=t),r&=~u}}var nn=0;function rR(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var nR,tA,iR,oR,aR,IT=!1,J_=[],tu=null,ru=null,nu=null,sg=new Map,lg=new Map,Xl=[],f6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function UO(e,t){switch(e){case"focusin":case"focusout":tu=null;break;case"dragenter":case"dragleave":ru=null;break;case"mouseover":case"mouseout":nu=null;break;case"pointerover":case"pointerout":sg.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":lg.delete(t.pointerId)}}function mm(e,t,r,i,u,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:h,targetContainers:[u]},t!==null&&(t=ly(t),t!==null&&tA(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,u!==null&&t.indexOf(u)===-1&&t.push(u),e)}function d6(e,t,r,i,u){switch(t){case"focusin":return tu=mm(tu,e,t,r,i,u),!0;case"dragenter":return ru=mm(ru,e,t,r,i,u),!0;case"mouseover":return nu=mm(nu,e,t,r,i,u),!0;case"pointerover":var h=u.pointerId;return sg.set(h,mm(sg.get(h)||null,e,t,r,i,u)),!0;case"gotpointercapture":return h=u.pointerId,lg.set(h,mm(lg.get(h)||null,e,t,r,i,u)),!0}return!1}function sR(e){var t=yc(e.target);if(t!==null){var r=Uc(t);if(r!==null){if(t=r.tag,t===13){if(t=Xz(r),t!==null){e.blockedOn=t,aR(e.priority,function(){iR(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ov(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=kT(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);AT=i,r.target.dispatchEvent(i),AT=null}else return t=ly(r),t!==null&&tA(t),e.blockedOn=r,!1;t.shift()}return!0}function VO(e,t,r){Ov(e)&&r.delete(t)}function p6(){IT=!1,tu!==null&&Ov(tu)&&(tu=null),ru!==null&&Ov(ru)&&(ru=null),nu!==null&&Ov(nu)&&(nu=null),sg.forEach(VO),lg.forEach(VO)}function gm(e,t){e.blockedOn===t&&(e.blockedOn=null,IT||(IT=!0,zo.unstable_scheduleCallback(zo.unstable_NormalPriority,p6)))}function ug(e){function t(u){return gm(u,e)}if(0<J_.length){gm(J_[0],e);for(var r=1;r<J_.length;r++){var i=J_[r];i.blockedOn===e&&(i.blockedOn=null)}}for(tu!==null&&gm(tu,e),ru!==null&&gm(ru,e),nu!==null&&gm(nu,e),sg.forEach(t),lg.forEach(t),r=0;r<Xl.length;r++)i=Xl[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<Xl.length&&(r=Xl[0],r.blockedOn===null);)sR(r),r.blockedOn===null&&Xl.shift()}var Af=cl.ReactCurrentBatchConfig,Hv=!0;function m6(e,t,r,i){var u=nn,h=Af.transition;Af.transition=null;try{nn=1,rA(e,t,r,i)}finally{nn=u,Af.transition=h}}function g6(e,t,r,i){var u=nn,h=Af.transition;Af.transition=null;try{nn=4,rA(e,t,r,i)}finally{nn=u,Af.transition=h}}function rA(e,t,r,i){if(Hv){var u=kT(e,t,r,i);if(u===null)bw(e,t,i,Xv,r),UO(e,i);else if(d6(u,e,t,r,i))i.stopPropagation();else if(UO(e,i),t&4&&-1<f6.indexOf(e)){for(;u!==null;){var h=ly(u);if(h!==null&&nR(h),h=kT(e,t,r,i),h===null&&bw(e,t,i,Xv,r),h===u)break;u=h}u!==null&&i.stopPropagation()}else bw(e,t,i,null,r)}}var Xv=null;function kT(e,t,r,i){if(Xv=null,e=JE(i),e=yc(e),e!==null)if(t=Uc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Xz(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xv=e,null}function lR(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(n6()){case QE:return 1;case Qz:return 4;case qv:case i6:return 16;case eR:return 536870912;default:return 16}default:return 16}}var Jl=null,nA=null,Iv=null;function uR(){if(Iv)return Iv;var e,t=nA,r=t.length,i,u="value"in Jl?Jl.value:Jl.textContent,h=u.length;for(e=0;e<r&&t[e]===u[e];e++);var p=r-e;for(i=1;i<=p&&t[r-i]===u[h-i];i++);return Iv=u.slice(e,1<i?1-i:void 0)}function kv(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Q_(){return!0}function GO(){return!1}function Bo(e){function t(r,i,u,h,p){this._reactName=r,this._targetInst=u,this.type=i,this.nativeEvent=h,this.target=p,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(r=e[_],this[_]=r?r(h):h[_]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?Q_:GO,this.isPropagationStopped=GO,this}return Fn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Q_)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Q_)},persist:function(){},isPersistent:Q_}),t}var _d={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},iA=Bo(_d),sy=Fn({},_d,{view:0,detail:0}),y6=Bo(sy),fw,dw,ym,xx=Fn({},sy,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oA,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ym&&(ym&&e.type==="mousemove"?(fw=e.screenX-ym.screenX,dw=e.screenY-ym.screenY):dw=fw=0,ym=e),fw)},movementY:function(e){return"movementY"in e?e.movementY:dw}}),WO=Bo(xx),_6=Fn({},xx,{dataTransfer:0}),v6=Bo(_6),x6=Fn({},sy,{relatedTarget:0}),pw=Bo(x6),b6=Fn({},_d,{animationName:0,elapsedTime:0,pseudoElement:0}),w6=Bo(b6),T6=Fn({},_d,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),S6=Bo(T6),E6=Fn({},_d,{data:0}),qO=Bo(E6),A6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},P6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},M6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function C6(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=M6[e])?!!t[e]:!1}function oA(){return C6}var O6=Fn({},sy,{key:function(e){if(e.key){var t=A6[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=kv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?P6[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oA,charCode:function(e){return e.type==="keypress"?kv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?kv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),I6=Bo(O6),k6=Fn({},xx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ZO=Bo(k6),D6=Fn({},sy,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oA}),L6=Bo(D6),z6=Fn({},_d,{propertyName:0,elapsedTime:0,pseudoElement:0}),R6=Bo(z6),B6=Fn({},xx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),j6=Bo(B6),F6=[9,13,27,32],aA=nl&&"CompositionEvent"in window,Wm=null;nl&&"documentMode"in document&&(Wm=document.documentMode);var $6=nl&&"TextEvent"in window&&!Wm,cR=nl&&(!aA||Wm&&8<Wm&&11>=Wm),HO=" ",XO=!1;function hR(e,t){switch(e){case"keyup":return F6.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fR(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var sf=!1;function N6(e,t){switch(e){case"compositionend":return fR(t);case"keypress":return t.which!==32?null:(XO=!0,HO);case"textInput":return e=t.data,e===HO&&XO?null:e;default:return null}}function U6(e,t){if(sf)return e==="compositionend"||!aA&&hR(e,t)?(e=uR(),Iv=nA=Jl=null,sf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return cR&&t.locale!=="ko"?null:t.data;default:return null}}var V6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KO(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!V6[e.type]:t==="textarea"}function dR(e,t,r,i){Gz(i),t=Kv(t,"onChange"),0<t.length&&(r=new iA("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var qm=null,cg=null;function G6(e){SR(e,0)}function bx(e){var t=cf(e);if(Bz(t))return e}function W6(e,t){if(e==="change")return t}var pR=!1;if(nl){var mw;if(nl){var gw="oninput"in document;if(!gw){var YO=document.createElement("div");YO.setAttribute("oninput","return;"),gw=typeof YO.oninput=="function"}mw=gw}else mw=!1;pR=mw&&(!document.documentMode||9<document.documentMode)}function JO(){qm&&(qm.detachEvent("onpropertychange",mR),cg=qm=null)}function mR(e){if(e.propertyName==="value"&&bx(cg)){var t=[];dR(t,cg,e,JE(e)),Hz(G6,t)}}function q6(e,t,r){e==="focusin"?(JO(),qm=t,cg=r,qm.attachEvent("onpropertychange",mR)):e==="focusout"&&JO()}function Z6(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return bx(cg)}function H6(e,t){if(e==="click")return bx(t)}function X6(e,t){if(e==="input"||e==="change")return bx(t)}function K6(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xa=typeof Object.is=="function"?Object.is:K6;function hg(e,t){if(Xa(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var u=r[i];if(!pT.call(t,u)||!Xa(e[u],t[u]))return!1}return!0}function QO(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function eI(e,t){var r=QO(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=QO(r)}}function gR(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?gR(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function yR(){for(var e=window,t=Vv();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Vv(e.document)}return t}function sA(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Y6(e){var t=yR(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&gR(r.ownerDocument.documentElement,r)){if(i!==null&&sA(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var u=r.textContent.length,h=Math.min(i.start,u);i=i.end===void 0?h:Math.min(i.end,u),!e.extend&&h>i&&(u=i,i=h,h=u),u=eI(r,h);var p=eI(r,i);u&&p&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(t=t.createRange(),t.setStart(u.node,u.offset),e.removeAllRanges(),h>i?(e.addRange(t),e.extend(p.node,p.offset)):(t.setEnd(p.node,p.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var J6=nl&&"documentMode"in document&&11>=document.documentMode,lf=null,DT=null,Zm=null,LT=!1;function tI(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;LT||lf==null||lf!==Vv(i)||(i=lf,"selectionStart"in i&&sA(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Zm&&hg(Zm,i)||(Zm=i,i=Kv(DT,"onSelect"),0<i.length&&(t=new iA("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=lf)))}function ev(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var uf={animationend:ev("Animation","AnimationEnd"),animationiteration:ev("Animation","AnimationIteration"),animationstart:ev("Animation","AnimationStart"),transitionend:ev("Transition","TransitionEnd")},yw={},_R={};nl&&(_R=document.createElement("div").style,"AnimationEvent"in window||(delete uf.animationend.animation,delete uf.animationiteration.animation,delete uf.animationstart.animation),"TransitionEvent"in window||delete uf.transitionend.transition);function wx(e){if(yw[e])return yw[e];if(!uf[e])return e;var t=uf[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in _R)return yw[e]=t[r];return e}var vR=wx("animationend"),xR=wx("animationiteration"),bR=wx("animationstart"),wR=wx("transitionend"),TR=new Map,rI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mu(e,t){TR.set(e,t),Nc(t,[e])}for(var _w=0;_w<rI.length;_w++){var vw=rI[_w],Q6=vw.toLowerCase(),e8=vw[0].toUpperCase()+vw.slice(1);mu(Q6,"on"+e8)}mu(vR,"onAnimationEnd");mu(xR,"onAnimationIteration");mu(bR,"onAnimationStart");mu("dblclick","onDoubleClick");mu("focusin","onFocus");mu("focusout","onBlur");mu(wR,"onTransitionEnd");jf("onMouseEnter",["mouseout","mouseover"]);jf("onMouseLeave",["mouseout","mouseover"]);jf("onPointerEnter",["pointerout","pointerover"]);jf("onPointerLeave",["pointerout","pointerover"]);Nc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Nc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Nc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Nc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Nc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Nc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),t8=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nm));function nI(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,QU(i,t,void 0,e),e.currentTarget=null}function SR(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],u=i.event;i=i.listeners;e:{var h=void 0;if(t)for(var p=i.length-1;0<=p;p--){var _=i[p],o=_.instance,x=_.currentTarget;if(_=_.listener,o!==h&&u.isPropagationStopped())break e;nI(u,_,x),h=o}else for(p=0;p<i.length;p++){if(_=i[p],o=_.instance,x=_.currentTarget,_=_.listener,o!==h&&u.isPropagationStopped())break e;nI(u,_,x),h=o}}}if(Wv)throw e=CT,Wv=!1,CT=null,e}function vn(e,t){var r=t[FT];r===void 0&&(r=t[FT]=new Set);var i=e+"__bubble";r.has(i)||(ER(t,e,2,!1),r.add(i))}function xw(e,t,r){var i=0;t&&(i|=4),ER(r,e,i,t)}var tv="_reactListening"+Math.random().toString(36).slice(2);function fg(e){if(!e[tv]){e[tv]=!0,kz.forEach(function(r){r!=="selectionchange"&&(t8.has(r)||xw(r,!1,e),xw(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[tv]||(t[tv]=!0,xw("selectionchange",!1,t))}}function ER(e,t,r,i){switch(lR(t)){case 1:var u=m6;break;case 4:u=g6;break;default:u=rA}r=u.bind(null,t,r,e),u=void 0,!MT||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(u=!0),i?u!==void 0?e.addEventListener(t,r,{capture:!0,passive:u}):e.addEventListener(t,r,!0):u!==void 0?e.addEventListener(t,r,{passive:u}):e.addEventListener(t,r,!1)}function bw(e,t,r,i,u){var h=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var p=i.tag;if(p===3||p===4){var _=i.stateNode.containerInfo;if(_===u||_.nodeType===8&&_.parentNode===u)break;if(p===4)for(p=i.return;p!==null;){var o=p.tag;if((o===3||o===4)&&(o=p.stateNode.containerInfo,o===u||o.nodeType===8&&o.parentNode===u))return;p=p.return}for(;_!==null;){if(p=yc(_),p===null)return;if(o=p.tag,o===5||o===6){i=h=p;continue e}_=_.parentNode}}i=i.return}Hz(function(){var x=h,E=JE(r),A=[];e:{var O=TR.get(e);if(O!==void 0){var L=iA,j=e;switch(e){case"keypress":if(kv(r)===0)break e;case"keydown":case"keyup":L=I6;break;case"focusin":j="focus",L=pw;break;case"focusout":j="blur",L=pw;break;case"beforeblur":case"afterblur":L=pw;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":L=WO;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":L=v6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":L=L6;break;case vR:case xR:case bR:L=w6;break;case wR:L=R6;break;case"scroll":L=y6;break;case"wheel":L=j6;break;case"copy":case"cut":case"paste":L=S6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":L=ZO}var F=(t&4)!==0,Z=!F&&e==="scroll",$=F?O!==null?O+"Capture":null:O;F=[];for(var V=x,U;V!==null;){U=V;var G=U.stateNode;if(U.tag===5&&G!==null&&(U=G,$!==null&&(G=ag(V,$),G!=null&&F.push(dg(V,G,U)))),Z)break;V=V.return}0<F.length&&(O=new L(O,j,null,r,E),A.push({event:O,listeners:F}))}}if(!(t&7)){e:{if(O=e==="mouseover"||e==="pointerover",L=e==="mouseout"||e==="pointerout",O&&r!==AT&&(j=r.relatedTarget||r.fromElement)&&(yc(j)||j[il]))break e;if((L||O)&&(O=E.window===E?E:(O=E.ownerDocument)?O.defaultView||O.parentWindow:window,L?(j=r.relatedTarget||r.toElement,L=x,j=j?yc(j):null,j!==null&&(Z=Uc(j),j!==Z||j.tag!==5&&j.tag!==6)&&(j=null)):(L=null,j=x),L!==j)){if(F=WO,G="onMouseLeave",$="onMouseEnter",V="mouse",(e==="pointerout"||e==="pointerover")&&(F=ZO,G="onPointerLeave",$="onPointerEnter",V="pointer"),Z=L==null?O:cf(L),U=j==null?O:cf(j),O=new F(G,V+"leave",L,r,E),O.target=Z,O.relatedTarget=U,G=null,yc(E)===x&&(F=new F($,V+"enter",j,r,E),F.target=U,F.relatedTarget=Z,G=F),Z=G,L&&j)t:{for(F=L,$=j,V=0,U=F;U;U=qh(U))V++;for(U=0,G=$;G;G=qh(G))U++;for(;0<V-U;)F=qh(F),V--;for(;0<U-V;)$=qh($),U--;for(;V--;){if(F===$||$!==null&&F===$.alternate)break t;F=qh(F),$=qh($)}F=null}else F=null;L!==null&&iI(A,O,L,F,!1),j!==null&&Z!==null&&iI(A,Z,j,F,!0)}}e:{if(O=x?cf(x):window,L=O.nodeName&&O.nodeName.toLowerCase(),L==="select"||L==="input"&&O.type==="file")var q=W6;else if(KO(O))if(pR)q=X6;else{q=Z6;var K=q6}else(L=O.nodeName)&&L.toLowerCase()==="input"&&(O.type==="checkbox"||O.type==="radio")&&(q=H6);if(q&&(q=q(e,x))){dR(A,q,r,E);break e}K&&K(e,O,x),e==="focusout"&&(K=O._wrapperState)&&K.controlled&&O.type==="number"&&bT(O,"number",O.value)}switch(K=x?cf(x):window,e){case"focusin":(KO(K)||K.contentEditable==="true")&&(lf=K,DT=x,Zm=null);break;case"focusout":Zm=DT=lf=null;break;case"mousedown":LT=!0;break;case"contextmenu":case"mouseup":case"dragend":LT=!1,tI(A,r,E);break;case"selectionchange":if(J6)break;case"keydown":case"keyup":tI(A,r,E)}var re;if(aA)e:{switch(e){case"compositionstart":var pe="onCompositionStart";break e;case"compositionend":pe="onCompositionEnd";break e;case"compositionupdate":pe="onCompositionUpdate";break e}pe=void 0}else sf?hR(e,r)&&(pe="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(pe="onCompositionStart");pe&&(cR&&r.locale!=="ko"&&(sf||pe!=="onCompositionStart"?pe==="onCompositionEnd"&&sf&&(re=uR()):(Jl=E,nA="value"in Jl?Jl.value:Jl.textContent,sf=!0)),K=Kv(x,pe),0<K.length&&(pe=new qO(pe,e,null,r,E),A.push({event:pe,listeners:K}),re?pe.data=re:(re=fR(r),re!==null&&(pe.data=re)))),(re=$6?N6(e,r):U6(e,r))&&(x=Kv(x,"onBeforeInput"),0<x.length&&(E=new qO("onBeforeInput","beforeinput",null,r,E),A.push({event:E,listeners:x}),E.data=re))}SR(A,t)})}function dg(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Kv(e,t){for(var r=t+"Capture",i=[];e!==null;){var u=e,h=u.stateNode;u.tag===5&&h!==null&&(u=h,h=ag(e,r),h!=null&&i.unshift(dg(e,h,u)),h=ag(e,t),h!=null&&i.push(dg(e,h,u))),e=e.return}return i}function qh(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function iI(e,t,r,i,u){for(var h=t._reactName,p=[];r!==null&&r!==i;){var _=r,o=_.alternate,x=_.stateNode;if(o!==null&&o===i)break;_.tag===5&&x!==null&&(_=x,u?(o=ag(r,h),o!=null&&p.unshift(dg(r,o,_))):u||(o=ag(r,h),o!=null&&p.push(dg(r,o,_)))),r=r.return}p.length!==0&&e.push({event:t,listeners:p})}var r8=/\r\n?/g,n8=/\u0000|\uFFFD/g;function oI(e){return(typeof e=="string"?e:""+e).replace(r8,`
`).replace(n8,"")}function rv(e,t,r){if(t=oI(t),oI(e)!==t&&r)throw Error(Tt(425))}function Yv(){}var zT=null,RT=null;function BT(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var jT=typeof setTimeout=="function"?setTimeout:void 0,i8=typeof clearTimeout=="function"?clearTimeout:void 0,aI=typeof Promise=="function"?Promise:void 0,o8=typeof queueMicrotask=="function"?queueMicrotask:typeof aI<"u"?function(e){return aI.resolve(null).then(e).catch(a8)}:jT;function a8(e){setTimeout(function(){throw e})}function ww(e,t){var r=t,i=0;do{var u=r.nextSibling;if(e.removeChild(r),u&&u.nodeType===8)if(r=u.data,r==="/$"){if(i===0){e.removeChild(u),ug(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=u}while(r);ug(t)}function iu(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function sI(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var vd=Math.random().toString(36).slice(2),fs="__reactFiber$"+vd,pg="__reactProps$"+vd,il="__reactContainer$"+vd,FT="__reactEvents$"+vd,s8="__reactListeners$"+vd,l8="__reactHandles$"+vd;function yc(e){var t=e[fs];if(t)return t;for(var r=e.parentNode;r;){if(t=r[il]||r[fs]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=sI(e);e!==null;){if(r=e[fs])return r;e=sI(e)}return t}e=r,r=e.parentNode}return null}function ly(e){return e=e[fs]||e[il],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function cf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Tt(33))}function Tx(e){return e[pg]||null}var $T=[],hf=-1;function gu(e){return{current:e}}function wn(e){0>hf||(e.current=$T[hf],$T[hf]=null,hf--)}function gn(e,t){hf++,$T[hf]=e.current,e.current=t}var fu={},Gi=gu(fu),yo=gu(!1),Ic=fu;function Ff(e,t){var r=e.type.contextTypes;if(!r)return fu;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var u={},h;for(h in r)u[h]=t[h];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=u),u}function _o(e){return e=e.childContextTypes,e!=null}function Jv(){wn(yo),wn(Gi)}function lI(e,t,r){if(Gi.current!==fu)throw Error(Tt(168));gn(Gi,t),gn(yo,r)}function AR(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var u in i)if(!(u in t))throw Error(Tt(108,qU(e)||"Unknown",u));return Fn({},r,i)}function Qv(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fu,Ic=Gi.current,gn(Gi,e),gn(yo,yo.current),!0}function uI(e,t,r){var i=e.stateNode;if(!i)throw Error(Tt(169));r?(e=AR(e,t,Ic),i.__reactInternalMemoizedMergedChildContext=e,wn(yo),wn(Gi),gn(Gi,e)):wn(yo),gn(yo,r)}var qs=null,Sx=!1,Tw=!1;function PR(e){qs===null?qs=[e]:qs.push(e)}function u8(e){Sx=!0,PR(e)}function yu(){if(!Tw&&qs!==null){Tw=!0;var e=0,t=nn;try{var r=qs;for(nn=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}qs=null,Sx=!1}catch(u){throw qs!==null&&(qs=qs.slice(e+1)),Jz(QE,yu),u}finally{nn=t,Tw=!1}}return null}var ff=[],df=0,e0=null,t0=0,ea=[],ta=0,kc=null,Zs=1,Hs="";function fc(e,t){ff[df++]=t0,ff[df++]=e0,e0=e,t0=t}function MR(e,t,r){ea[ta++]=Zs,ea[ta++]=Hs,ea[ta++]=kc,kc=e;var i=Zs;e=Hs;var u=32-qa(i)-1;i&=~(1<<u),r+=1;var h=32-qa(t)+u;if(30<h){var p=u-u%5;h=(i&(1<<p)-1).toString(32),i>>=p,u-=p,Zs=1<<32-qa(t)+u|r<<u|i,Hs=h+e}else Zs=1<<h|r<<u|i,Hs=e}function lA(e){e.return!==null&&(fc(e,1),MR(e,1,0))}function uA(e){for(;e===e0;)e0=ff[--df],ff[df]=null,t0=ff[--df],ff[df]=null;for(;e===kc;)kc=ea[--ta],ea[ta]=null,Hs=ea[--ta],ea[ta]=null,Zs=ea[--ta],ea[ta]=null}var Lo=null,Do=null,An=!1,Na=null;function CR(e,t){var r=ra(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function cI(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Lo=e,Do=iu(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Lo=e,Do=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=kc!==null?{id:Zs,overflow:Hs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ra(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Lo=e,Do=null,!0):!1;default:return!1}}function NT(e){return(e.mode&1)!==0&&(e.flags&128)===0}function UT(e){if(An){var t=Do;if(t){var r=t;if(!cI(e,t)){if(NT(e))throw Error(Tt(418));t=iu(r.nextSibling);var i=Lo;t&&cI(e,t)?CR(i,r):(e.flags=e.flags&-4097|2,An=!1,Lo=e)}}else{if(NT(e))throw Error(Tt(418));e.flags=e.flags&-4097|2,An=!1,Lo=e}}}function hI(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Lo=e}function nv(e){if(e!==Lo)return!1;if(!An)return hI(e),An=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!BT(e.type,e.memoizedProps)),t&&(t=Do)){if(NT(e))throw OR(),Error(Tt(418));for(;t;)CR(e,t),t=iu(t.nextSibling)}if(hI(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Tt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Do=iu(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Do=null}}else Do=Lo?iu(e.stateNode.nextSibling):null;return!0}function OR(){for(var e=Do;e;)e=iu(e.nextSibling)}function $f(){Do=Lo=null,An=!1}function cA(e){Na===null?Na=[e]:Na.push(e)}var c8=cl.ReactCurrentBatchConfig;function Ba(e,t){if(e&&e.defaultProps){t=Fn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var r0=gu(null),n0=null,pf=null,hA=null;function fA(){hA=pf=n0=null}function dA(e){var t=r0.current;wn(r0),e._currentValue=t}function VT(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function Pf(e,t){n0=e,hA=pf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(mo=!0),e.firstContext=null)}function sa(e){var t=e._currentValue;if(hA!==e)if(e={context:e,memoizedValue:t,next:null},pf===null){if(n0===null)throw Error(Tt(308));pf=e,n0.dependencies={lanes:0,firstContext:e}}else pf=pf.next=e;return t}var _c=null;function pA(e){_c===null?_c=[e]:_c.push(e)}function IR(e,t,r,i){var u=t.interleaved;return u===null?(r.next=r,pA(t)):(r.next=u.next,u.next=r),t.interleaved=r,ol(e,i)}function ol(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Zl=!1;function mA(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kR(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Js(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ou(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Dr&2){var u=i.pending;return u===null?t.next=t:(t.next=u.next,u.next=t),i.pending=t,ol(e,r)}return u=i.interleaved,u===null?(t.next=t,pA(i)):(t.next=u.next,u.next=t),i.interleaved=t,ol(e,r)}function Dv(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,eA(e,r)}}function fI(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var u=null,h=null;if(r=r.firstBaseUpdate,r!==null){do{var p={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};h===null?u=h=p:h=h.next=p,r=r.next}while(r!==null);h===null?u=h=t:h=h.next=t}else u=h=t;r={baseState:i.baseState,firstBaseUpdate:u,lastBaseUpdate:h,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function i0(e,t,r,i){var u=e.updateQueue;Zl=!1;var h=u.firstBaseUpdate,p=u.lastBaseUpdate,_=u.shared.pending;if(_!==null){u.shared.pending=null;var o=_,x=o.next;o.next=null,p===null?h=x:p.next=x,p=o;var E=e.alternate;E!==null&&(E=E.updateQueue,_=E.lastBaseUpdate,_!==p&&(_===null?E.firstBaseUpdate=x:_.next=x,E.lastBaseUpdate=o))}if(h!==null){var A=u.baseState;p=0,E=x=o=null,_=h;do{var O=_.lane,L=_.eventTime;if((i&O)===O){E!==null&&(E=E.next={eventTime:L,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var j=e,F=_;switch(O=t,L=r,F.tag){case 1:if(j=F.payload,typeof j=="function"){A=j.call(L,A,O);break e}A=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=F.payload,O=typeof j=="function"?j.call(L,A,O):j,O==null)break e;A=Fn({},A,O);break e;case 2:Zl=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,O=u.effects,O===null?u.effects=[_]:O.push(_))}else L={eventTime:L,lane:O,tag:_.tag,payload:_.payload,callback:_.callback,next:null},E===null?(x=E=L,o=A):E=E.next=L,p|=O;if(_=_.next,_===null){if(_=u.shared.pending,_===null)break;O=_,_=O.next,O.next=null,u.lastBaseUpdate=O,u.shared.pending=null}}while(!0);if(E===null&&(o=A),u.baseState=o,u.firstBaseUpdate=x,u.lastBaseUpdate=E,t=u.shared.interleaved,t!==null){u=t;do p|=u.lane,u=u.next;while(u!==t)}else h===null&&(u.shared.lanes=0);Lc|=p,e.lanes=p,e.memoizedState=A}}function dI(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],u=i.callback;if(u!==null){if(i.callback=null,i=r,typeof u!="function")throw Error(Tt(191,u));u.call(i)}}}var DR=new Iz.Component().refs;function GT(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:Fn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ex={isMounted:function(e){return(e=e._reactInternals)?Uc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=Qi(),u=su(e),h=Js(i,u);h.payload=t,r!=null&&(h.callback=r),t=ou(e,h,u),t!==null&&(Za(t,e,u,i),Dv(t,e,u))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=Qi(),u=su(e),h=Js(i,u);h.tag=1,h.payload=t,r!=null&&(h.callback=r),t=ou(e,h,u),t!==null&&(Za(t,e,u,i),Dv(t,e,u))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Qi(),i=su(e),u=Js(r,i);u.tag=2,t!=null&&(u.callback=t),t=ou(e,u,i),t!==null&&(Za(t,e,i,r),Dv(t,e,i))}};function pI(e,t,r,i,u,h,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,h,p):t.prototype&&t.prototype.isPureReactComponent?!hg(r,i)||!hg(u,h):!0}function LR(e,t,r){var i=!1,u=fu,h=t.contextType;return typeof h=="object"&&h!==null?h=sa(h):(u=_o(t)?Ic:Gi.current,i=t.contextTypes,h=(i=i!=null)?Ff(e,u):fu),t=new t(r,h),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ex,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=h),t}function mI(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&Ex.enqueueReplaceState(t,t.state,null)}function WT(e,t,r,i){var u=e.stateNode;u.props=r,u.state=e.memoizedState,u.refs=DR,mA(e);var h=t.contextType;typeof h=="object"&&h!==null?u.context=sa(h):(h=_o(t)?Ic:Gi.current,u.context=Ff(e,h)),u.state=e.memoizedState,h=t.getDerivedStateFromProps,typeof h=="function"&&(GT(e,t,h,r),u.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(t=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),t!==u.state&&Ex.enqueueReplaceState(u,u.state,null),i0(e,r,u,i),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}function _m(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Tt(309));var i=r.stateNode}if(!i)throw Error(Tt(147,e));var u=i,h=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===h?t.ref:(t=function(p){var _=u.refs;_===DR&&(_=u.refs={}),p===null?delete _[h]:_[h]=p},t._stringRef=h,t)}if(typeof e!="string")throw Error(Tt(284));if(!r._owner)throw Error(Tt(290,e))}return e}function iv(e,t){throw e=Object.prototype.toString.call(t),Error(Tt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gI(e){var t=e._init;return t(e._payload)}function zR(e){function t($,V){if(e){var U=$.deletions;U===null?($.deletions=[V],$.flags|=16):U.push(V)}}function r($,V){if(!e)return null;for(;V!==null;)t($,V),V=V.sibling;return null}function i($,V){for($=new Map;V!==null;)V.key!==null?$.set(V.key,V):$.set(V.index,V),V=V.sibling;return $}function u($,V){return $=lu($,V),$.index=0,$.sibling=null,$}function h($,V,U){return $.index=U,e?(U=$.alternate,U!==null?(U=U.index,U<V?($.flags|=2,V):U):($.flags|=2,V)):($.flags|=1048576,V)}function p($){return e&&$.alternate===null&&($.flags|=2),$}function _($,V,U,G){return V===null||V.tag!==6?(V=Ow(U,$.mode,G),V.return=$,V):(V=u(V,U),V.return=$,V)}function o($,V,U,G){var q=U.type;return q===af?E($,V,U.props.children,G,U.key):V!==null&&(V.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===ql&&gI(q)===V.type)?(G=u(V,U.props),G.ref=_m($,V,U),G.return=$,G):(G=Fv(U.type,U.key,U.props,null,$.mode,G),G.ref=_m($,V,U),G.return=$,G)}function x($,V,U,G){return V===null||V.tag!==4||V.stateNode.containerInfo!==U.containerInfo||V.stateNode.implementation!==U.implementation?(V=Iw(U,$.mode,G),V.return=$,V):(V=u(V,U.children||[]),V.return=$,V)}function E($,V,U,G,q){return V===null||V.tag!==7?(V=Pc(U,$.mode,G,q),V.return=$,V):(V=u(V,U),V.return=$,V)}function A($,V,U){if(typeof V=="string"&&V!==""||typeof V=="number")return V=Ow(""+V,$.mode,U),V.return=$,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Z_:return U=Fv(V.type,V.key,V.props,null,$.mode,U),U.ref=_m($,null,V),U.return=$,U;case of:return V=Iw(V,$.mode,U),V.return=$,V;case ql:var G=V._init;return A($,G(V._payload),U)}if(Fm(V)||dm(V))return V=Pc(V,$.mode,U,null),V.return=$,V;iv($,V)}return null}function O($,V,U,G){var q=V!==null?V.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return q!==null?null:_($,V,""+U,G);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Z_:return U.key===q?o($,V,U,G):null;case of:return U.key===q?x($,V,U,G):null;case ql:return q=U._init,O($,V,q(U._payload),G)}if(Fm(U)||dm(U))return q!==null?null:E($,V,U,G,null);iv($,U)}return null}function L($,V,U,G,q){if(typeof G=="string"&&G!==""||typeof G=="number")return $=$.get(U)||null,_(V,$,""+G,q);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case Z_:return $=$.get(G.key===null?U:G.key)||null,o(V,$,G,q);case of:return $=$.get(G.key===null?U:G.key)||null,x(V,$,G,q);case ql:var K=G._init;return L($,V,U,K(G._payload),q)}if(Fm(G)||dm(G))return $=$.get(U)||null,E(V,$,G,q,null);iv(V,G)}return null}function j($,V,U,G){for(var q=null,K=null,re=V,pe=V=0,xe=null;re!==null&&pe<U.length;pe++){re.index>pe?(xe=re,re=null):xe=re.sibling;var ge=O($,re,U[pe],G);if(ge===null){re===null&&(re=xe);break}e&&re&&ge.alternate===null&&t($,re),V=h(ge,V,pe),K===null?q=ge:K.sibling=ge,K=ge,re=xe}if(pe===U.length)return r($,re),An&&fc($,pe),q;if(re===null){for(;pe<U.length;pe++)re=A($,U[pe],G),re!==null&&(V=h(re,V,pe),K===null?q=re:K.sibling=re,K=re);return An&&fc($,pe),q}for(re=i($,re);pe<U.length;pe++)xe=L(re,$,pe,U[pe],G),xe!==null&&(e&&xe.alternate!==null&&re.delete(xe.key===null?pe:xe.key),V=h(xe,V,pe),K===null?q=xe:K.sibling=xe,K=xe);return e&&re.forEach(function(Be){return t($,Be)}),An&&fc($,pe),q}function F($,V,U,G){var q=dm(U);if(typeof q!="function")throw Error(Tt(150));if(U=q.call(U),U==null)throw Error(Tt(151));for(var K=q=null,re=V,pe=V=0,xe=null,ge=U.next();re!==null&&!ge.done;pe++,ge=U.next()){re.index>pe?(xe=re,re=null):xe=re.sibling;var Be=O($,re,ge.value,G);if(Be===null){re===null&&(re=xe);break}e&&re&&Be.alternate===null&&t($,re),V=h(Be,V,pe),K===null?q=Be:K.sibling=Be,K=Be,re=xe}if(ge.done)return r($,re),An&&fc($,pe),q;if(re===null){for(;!ge.done;pe++,ge=U.next())ge=A($,ge.value,G),ge!==null&&(V=h(ge,V,pe),K===null?q=ge:K.sibling=ge,K=ge);return An&&fc($,pe),q}for(re=i($,re);!ge.done;pe++,ge=U.next())ge=L(re,$,pe,ge.value,G),ge!==null&&(e&&ge.alternate!==null&&re.delete(ge.key===null?pe:ge.key),V=h(ge,V,pe),K===null?q=ge:K.sibling=ge,K=ge);return e&&re.forEach(function($e){return t($,$e)}),An&&fc($,pe),q}function Z($,V,U,G){if(typeof U=="object"&&U!==null&&U.type===af&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case Z_:e:{for(var q=U.key,K=V;K!==null;){if(K.key===q){if(q=U.type,q===af){if(K.tag===7){r($,K.sibling),V=u(K,U.props.children),V.return=$,$=V;break e}}else if(K.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===ql&&gI(q)===K.type){r($,K.sibling),V=u(K,U.props),V.ref=_m($,K,U),V.return=$,$=V;break e}r($,K);break}else t($,K);K=K.sibling}U.type===af?(V=Pc(U.props.children,$.mode,G,U.key),V.return=$,$=V):(G=Fv(U.type,U.key,U.props,null,$.mode,G),G.ref=_m($,V,U),G.return=$,$=G)}return p($);case of:e:{for(K=U.key;V!==null;){if(V.key===K)if(V.tag===4&&V.stateNode.containerInfo===U.containerInfo&&V.stateNode.implementation===U.implementation){r($,V.sibling),V=u(V,U.children||[]),V.return=$,$=V;break e}else{r($,V);break}else t($,V);V=V.sibling}V=Iw(U,$.mode,G),V.return=$,$=V}return p($);case ql:return K=U._init,Z($,V,K(U._payload),G)}if(Fm(U))return j($,V,U,G);if(dm(U))return F($,V,U,G);iv($,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,V!==null&&V.tag===6?(r($,V.sibling),V=u(V,U),V.return=$,$=V):(r($,V),V=Ow(U,$.mode,G),V.return=$,$=V),p($)):r($,V)}return Z}var Nf=zR(!0),RR=zR(!1),uy={},ms=gu(uy),mg=gu(uy),gg=gu(uy);function vc(e){if(e===uy)throw Error(Tt(174));return e}function gA(e,t){switch(gn(gg,t),gn(mg,e),gn(ms,uy),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:TT(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=TT(t,e)}wn(ms),gn(ms,t)}function Uf(){wn(ms),wn(mg),wn(gg)}function BR(e){vc(gg.current);var t=vc(ms.current),r=TT(t,e.type);t!==r&&(gn(mg,e),gn(ms,r))}function yA(e){mg.current===e&&(wn(ms),wn(mg))}var Bn=gu(0);function o0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Sw=[];function _A(){for(var e=0;e<Sw.length;e++)Sw[e]._workInProgressVersionPrimary=null;Sw.length=0}var Lv=cl.ReactCurrentDispatcher,Ew=cl.ReactCurrentBatchConfig,Dc=0,jn=null,li=null,vi=null,a0=!1,Hm=!1,yg=0,h8=0;function Bi(){throw Error(Tt(321))}function vA(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Xa(e[r],t[r]))return!1;return!0}function xA(e,t,r,i,u,h){if(Dc=h,jn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Lv.current=e===null||e.memoizedState===null?m8:g8,e=r(i,u),Hm){h=0;do{if(Hm=!1,yg=0,25<=h)throw Error(Tt(301));h+=1,vi=li=null,t.updateQueue=null,Lv.current=y8,e=r(i,u)}while(Hm)}if(Lv.current=s0,t=li!==null&&li.next!==null,Dc=0,vi=li=jn=null,a0=!1,t)throw Error(Tt(300));return e}function bA(){var e=yg!==0;return yg=0,e}function hs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vi===null?jn.memoizedState=vi=e:vi=vi.next=e,vi}function la(){if(li===null){var e=jn.alternate;e=e!==null?e.memoizedState:null}else e=li.next;var t=vi===null?jn.memoizedState:vi.next;if(t!==null)vi=t,li=e;else{if(e===null)throw Error(Tt(310));li=e,e={memoizedState:li.memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},vi===null?jn.memoizedState=vi=e:vi=vi.next=e}return vi}function _g(e,t){return typeof t=="function"?t(e):t}function Aw(e){var t=la(),r=t.queue;if(r===null)throw Error(Tt(311));r.lastRenderedReducer=e;var i=li,u=i.baseQueue,h=r.pending;if(h!==null){if(u!==null){var p=u.next;u.next=h.next,h.next=p}i.baseQueue=u=h,r.pending=null}if(u!==null){h=u.next,i=i.baseState;var _=p=null,o=null,x=h;do{var E=x.lane;if((Dc&E)===E)o!==null&&(o=o.next={lane:0,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null}),i=x.hasEagerState?x.eagerState:e(i,x.action);else{var A={lane:E,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null};o===null?(_=o=A,p=i):o=o.next=A,jn.lanes|=E,Lc|=E}x=x.next}while(x!==null&&x!==h);o===null?p=i:o.next=_,Xa(i,t.memoizedState)||(mo=!0),t.memoizedState=i,t.baseState=p,t.baseQueue=o,r.lastRenderedState=i}if(e=r.interleaved,e!==null){u=e;do h=u.lane,jn.lanes|=h,Lc|=h,u=u.next;while(u!==e)}else u===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Pw(e){var t=la(),r=t.queue;if(r===null)throw Error(Tt(311));r.lastRenderedReducer=e;var i=r.dispatch,u=r.pending,h=t.memoizedState;if(u!==null){r.pending=null;var p=u=u.next;do h=e(h,p.action),p=p.next;while(p!==u);Xa(h,t.memoizedState)||(mo=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),r.lastRenderedState=h}return[h,i]}function jR(){}function FR(e,t){var r=jn,i=la(),u=t(),h=!Xa(i.memoizedState,u);if(h&&(i.memoizedState=u,mo=!0),i=i.queue,wA(UR.bind(null,r,i,e),[e]),i.getSnapshot!==t||h||vi!==null&&vi.memoizedState.tag&1){if(r.flags|=2048,vg(9,NR.bind(null,r,i,u,t),void 0,null),bi===null)throw Error(Tt(349));Dc&30||$R(r,t,u)}return u}function $R(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=jn.updateQueue,t===null?(t={lastEffect:null,stores:null},jn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function NR(e,t,r,i){t.value=r,t.getSnapshot=i,VR(t)&&GR(e)}function UR(e,t,r){return r(function(){VR(t)&&GR(e)})}function VR(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Xa(e,r)}catch{return!0}}function GR(e){var t=ol(e,1);t!==null&&Za(t,e,1,-1)}function yI(e){var t=hs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_g,lastRenderedState:e},t.queue=e,e=e.dispatch=p8.bind(null,jn,e),[t.memoizedState,e]}function vg(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=jn.updateQueue,t===null?(t={lastEffect:null,stores:null},jn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function WR(){return la().memoizedState}function zv(e,t,r,i){var u=hs();jn.flags|=e,u.memoizedState=vg(1|t,r,void 0,i===void 0?null:i)}function Ax(e,t,r,i){var u=la();i=i===void 0?null:i;var h=void 0;if(li!==null){var p=li.memoizedState;if(h=p.destroy,i!==null&&vA(i,p.deps)){u.memoizedState=vg(t,r,h,i);return}}jn.flags|=e,u.memoizedState=vg(1|t,r,h,i)}function _I(e,t){return zv(8390656,8,e,t)}function wA(e,t){return Ax(2048,8,e,t)}function qR(e,t){return Ax(4,2,e,t)}function ZR(e,t){return Ax(4,4,e,t)}function HR(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function XR(e,t,r){return r=r!=null?r.concat([e]):null,Ax(4,4,HR.bind(null,t,e),r)}function TA(){}function KR(e,t){var r=la();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&vA(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function YR(e,t){var r=la();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&vA(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function JR(e,t,r){return Dc&21?(Xa(r,t)||(r=tR(),jn.lanes|=r,Lc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,mo=!0),e.memoizedState=r)}function f8(e,t){var r=nn;nn=r!==0&&4>r?r:4,e(!0);var i=Ew.transition;Ew.transition={};try{e(!1),t()}finally{nn=r,Ew.transition=i}}function QR(){return la().memoizedState}function d8(e,t,r){var i=su(e);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},eB(e))tB(t,r);else if(r=IR(e,t,r,i),r!==null){var u=Qi();Za(r,e,i,u),rB(r,t,i)}}function p8(e,t,r){var i=su(e),u={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(eB(e))tB(t,u);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var p=t.lastRenderedState,_=h(p,r);if(u.hasEagerState=!0,u.eagerState=_,Xa(_,p)){var o=t.interleaved;o===null?(u.next=u,pA(t)):(u.next=o.next,o.next=u),t.interleaved=u;return}}catch{}finally{}r=IR(e,t,u,i),r!==null&&(u=Qi(),Za(r,e,i,u),rB(r,t,i))}}function eB(e){var t=e.alternate;return e===jn||t!==null&&t===jn}function tB(e,t){Hm=a0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function rB(e,t,r){if(r&4194240){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,eA(e,r)}}var s0={readContext:sa,useCallback:Bi,useContext:Bi,useEffect:Bi,useImperativeHandle:Bi,useInsertionEffect:Bi,useLayoutEffect:Bi,useMemo:Bi,useReducer:Bi,useRef:Bi,useState:Bi,useDebugValue:Bi,useDeferredValue:Bi,useTransition:Bi,useMutableSource:Bi,useSyncExternalStore:Bi,useId:Bi,unstable_isNewReconciler:!1},m8={readContext:sa,useCallback:function(e,t){return hs().memoizedState=[e,t===void 0?null:t],e},useContext:sa,useEffect:_I,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,zv(4194308,4,HR.bind(null,t,e),r)},useLayoutEffect:function(e,t){return zv(4194308,4,e,t)},useInsertionEffect:function(e,t){return zv(4,2,e,t)},useMemo:function(e,t){var r=hs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=hs();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=d8.bind(null,jn,e),[i.memoizedState,e]},useRef:function(e){var t=hs();return e={current:e},t.memoizedState=e},useState:yI,useDebugValue:TA,useDeferredValue:function(e){return hs().memoizedState=e},useTransition:function(){var e=yI(!1),t=e[0];return e=f8.bind(null,e[1]),hs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=jn,u=hs();if(An){if(r===void 0)throw Error(Tt(407));r=r()}else{if(r=t(),bi===null)throw Error(Tt(349));Dc&30||$R(i,t,r)}u.memoizedState=r;var h={value:r,getSnapshot:t};return u.queue=h,_I(UR.bind(null,i,h,e),[e]),i.flags|=2048,vg(9,NR.bind(null,i,h,r,t),void 0,null),r},useId:function(){var e=hs(),t=bi.identifierPrefix;if(An){var r=Hs,i=Zs;r=(i&~(1<<32-qa(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=yg++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=h8++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},g8={readContext:sa,useCallback:KR,useContext:sa,useEffect:wA,useImperativeHandle:XR,useInsertionEffect:qR,useLayoutEffect:ZR,useMemo:YR,useReducer:Aw,useRef:WR,useState:function(){return Aw(_g)},useDebugValue:TA,useDeferredValue:function(e){var t=la();return JR(t,li.memoizedState,e)},useTransition:function(){var e=Aw(_g)[0],t=la().memoizedState;return[e,t]},useMutableSource:jR,useSyncExternalStore:FR,useId:QR,unstable_isNewReconciler:!1},y8={readContext:sa,useCallback:KR,useContext:sa,useEffect:wA,useImperativeHandle:XR,useInsertionEffect:qR,useLayoutEffect:ZR,useMemo:YR,useReducer:Pw,useRef:WR,useState:function(){return Pw(_g)},useDebugValue:TA,useDeferredValue:function(e){var t=la();return li===null?t.memoizedState=e:JR(t,li.memoizedState,e)},useTransition:function(){var e=Pw(_g)[0],t=la().memoizedState;return[e,t]},useMutableSource:jR,useSyncExternalStore:FR,useId:QR,unstable_isNewReconciler:!1};function Vf(e,t){try{var r="",i=t;do r+=WU(i),i=i.return;while(i);var u=r}catch(h){u=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:t,stack:u,digest:null}}function Mw(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function qT(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var _8=typeof WeakMap=="function"?WeakMap:Map;function nB(e,t,r){r=Js(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){u0||(u0=!0,rS=i),qT(e,t)},r}function iB(e,t,r){r=Js(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var u=t.value;r.payload=function(){return i(u)},r.callback=function(){qT(e,t)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(r.callback=function(){qT(e,t),typeof i!="function"&&(au===null?au=new Set([this]):au.add(this));var p=t.stack;this.componentDidCatch(t.value,{componentStack:p!==null?p:""})}),r}function vI(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new _8;var u=new Set;i.set(t,u)}else u=i.get(t),u===void 0&&(u=new Set,i.set(t,u));u.has(r)||(u.add(r),e=k8.bind(null,e,t,r),t.then(e,e))}function xI(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function bI(e,t,r,i,u){return e.mode&1?(e.flags|=65536,e.lanes=u,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Js(-1,1),t.tag=2,ou(r,t,1))),r.lanes|=1),e)}var v8=cl.ReactCurrentOwner,mo=!1;function Ki(e,t,r,i){t.child=e===null?RR(t,null,r,i):Nf(t,e.child,r,i)}function wI(e,t,r,i,u){r=r.render;var h=t.ref;return Pf(t,u),i=xA(e,t,r,i,h,u),r=bA(),e!==null&&!mo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~u,al(e,t,u)):(An&&r&&lA(t),t.flags|=1,Ki(e,t,i,u),t.child)}function TI(e,t,r,i,u){if(e===null){var h=r.type;return typeof h=="function"&&!IA(h)&&h.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=h,oB(e,t,h,i,u)):(e=Fv(r.type,null,i,t,t.mode,u),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!(e.lanes&u)){var p=h.memoizedProps;if(r=r.compare,r=r!==null?r:hg,r(p,i)&&e.ref===t.ref)return al(e,t,u)}return t.flags|=1,e=lu(h,i),e.ref=t.ref,e.return=t,t.child=e}function oB(e,t,r,i,u){if(e!==null){var h=e.memoizedProps;if(hg(h,i)&&e.ref===t.ref)if(mo=!1,t.pendingProps=i=h,(e.lanes&u)!==0)e.flags&131072&&(mo=!0);else return t.lanes=e.lanes,al(e,t,u)}return ZT(e,t,r,i,u)}function aB(e,t,r){var i=t.pendingProps,u=i.children,h=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gn(gf,Mo),Mo|=r;else{if(!(r&1073741824))return e=h!==null?h.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gn(gf,Mo),Mo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=h!==null?h.baseLanes:r,gn(gf,Mo),Mo|=i}else h!==null?(i=h.baseLanes|r,t.memoizedState=null):i=r,gn(gf,Mo),Mo|=i;return Ki(e,t,u,r),t.child}function sB(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ZT(e,t,r,i,u){var h=_o(r)?Ic:Gi.current;return h=Ff(t,h),Pf(t,u),r=xA(e,t,r,i,h,u),i=bA(),e!==null&&!mo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~u,al(e,t,u)):(An&&i&&lA(t),t.flags|=1,Ki(e,t,r,u),t.child)}function SI(e,t,r,i,u){if(_o(r)){var h=!0;Qv(t)}else h=!1;if(Pf(t,u),t.stateNode===null)Rv(e,t),LR(t,r,i),WT(t,r,i,u),i=!0;else if(e===null){var p=t.stateNode,_=t.memoizedProps;p.props=_;var o=p.context,x=r.contextType;typeof x=="object"&&x!==null?x=sa(x):(x=_o(r)?Ic:Gi.current,x=Ff(t,x));var E=r.getDerivedStateFromProps,A=typeof E=="function"||typeof p.getSnapshotBeforeUpdate=="function";A||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(_!==i||o!==x)&&mI(t,p,i,x),Zl=!1;var O=t.memoizedState;p.state=O,i0(t,i,p,u),o=t.memoizedState,_!==i||O!==o||yo.current||Zl?(typeof E=="function"&&(GT(t,r,E,i),o=t.memoizedState),(_=Zl||pI(t,r,_,i,O,o,x))?(A||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(t.flags|=4194308)):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=o),p.props=i,p.state=o,p.context=x,i=_):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{p=t.stateNode,kR(e,t),_=t.memoizedProps,x=t.type===t.elementType?_:Ba(t.type,_),p.props=x,A=t.pendingProps,O=p.context,o=r.contextType,typeof o=="object"&&o!==null?o=sa(o):(o=_o(r)?Ic:Gi.current,o=Ff(t,o));var L=r.getDerivedStateFromProps;(E=typeof L=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(_!==A||O!==o)&&mI(t,p,i,o),Zl=!1,O=t.memoizedState,p.state=O,i0(t,i,p,u);var j=t.memoizedState;_!==A||O!==j||yo.current||Zl?(typeof L=="function"&&(GT(t,r,L,i),j=t.memoizedState),(x=Zl||pI(t,r,x,i,O,j,o)||!1)?(E||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(i,j,o),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(i,j,o)),typeof p.componentDidUpdate=="function"&&(t.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof p.componentDidUpdate!="function"||_===e.memoizedProps&&O===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&O===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=j),p.props=i,p.state=j,p.context=o,i=x):(typeof p.componentDidUpdate!="function"||_===e.memoizedProps&&O===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&O===e.memoizedState||(t.flags|=1024),i=!1)}return HT(e,t,r,i,h,u)}function HT(e,t,r,i,u,h){sB(e,t);var p=(t.flags&128)!==0;if(!i&&!p)return u&&uI(t,r,!1),al(e,t,h);i=t.stateNode,v8.current=t;var _=p&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&p?(t.child=Nf(t,e.child,null,h),t.child=Nf(t,null,_,h)):Ki(e,t,_,h),t.memoizedState=i.state,u&&uI(t,r,!0),t.child}function lB(e){var t=e.stateNode;t.pendingContext?lI(e,t.pendingContext,t.pendingContext!==t.context):t.context&&lI(e,t.context,!1),gA(e,t.containerInfo)}function EI(e,t,r,i,u){return $f(),cA(u),t.flags|=256,Ki(e,t,r,i),t.child}var XT={dehydrated:null,treeContext:null,retryLane:0};function KT(e){return{baseLanes:e,cachePool:null,transitions:null}}function uB(e,t,r){var i=t.pendingProps,u=Bn.current,h=!1,p=(t.flags&128)!==0,_;if((_=p)||(_=e!==null&&e.memoizedState===null?!1:(u&2)!==0),_?(h=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),gn(Bn,u&1),e===null)return UT(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(p=i.children,e=i.fallback,h?(i=t.mode,h=t.child,p={mode:"hidden",children:p},!(i&1)&&h!==null?(h.childLanes=0,h.pendingProps=p):h=Cx(p,i,0,null),e=Pc(e,i,r,null),h.return=t,e.return=t,h.sibling=e,t.child=h,t.child.memoizedState=KT(r),t.memoizedState=XT,e):SA(t,p));if(u=e.memoizedState,u!==null&&(_=u.dehydrated,_!==null))return x8(e,t,p,i,_,u,r);if(h){h=i.fallback,p=t.mode,u=e.child,_=u.sibling;var o={mode:"hidden",children:i.children};return!(p&1)&&t.child!==u?(i=t.child,i.childLanes=0,i.pendingProps=o,t.deletions=null):(i=lu(u,o),i.subtreeFlags=u.subtreeFlags&14680064),_!==null?h=lu(_,h):(h=Pc(h,p,r,null),h.flags|=2),h.return=t,i.return=t,i.sibling=h,t.child=i,i=h,h=t.child,p=e.child.memoizedState,p=p===null?KT(r):{baseLanes:p.baseLanes|r,cachePool:null,transitions:p.transitions},h.memoizedState=p,h.childLanes=e.childLanes&~r,t.memoizedState=XT,i}return h=e.child,e=h.sibling,i=lu(h,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=r),i.return=t,i.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function SA(e,t){return t=Cx({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ov(e,t,r,i){return i!==null&&cA(i),Nf(t,e.child,null,r),e=SA(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function x8(e,t,r,i,u,h,p){if(r)return t.flags&256?(t.flags&=-257,i=Mw(Error(Tt(422))),ov(e,t,p,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(h=i.fallback,u=t.mode,i=Cx({mode:"visible",children:i.children},u,0,null),h=Pc(h,u,p,null),h.flags|=2,i.return=t,h.return=t,i.sibling=h,t.child=i,t.mode&1&&Nf(t,e.child,null,p),t.child.memoizedState=KT(p),t.memoizedState=XT,h);if(!(t.mode&1))return ov(e,t,p,null);if(u.data==="$!"){if(i=u.nextSibling&&u.nextSibling.dataset,i)var _=i.dgst;return i=_,h=Error(Tt(419)),i=Mw(h,i,void 0),ov(e,t,p,i)}if(_=(p&e.childLanes)!==0,mo||_){if(i=bi,i!==null){switch(p&-p){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=u&(i.suspendedLanes|p)?0:u,u!==0&&u!==h.retryLane&&(h.retryLane=u,ol(e,u),Za(i,e,u,-1))}return OA(),i=Mw(Error(Tt(421))),ov(e,t,p,i)}return u.data==="$?"?(t.flags|=128,t.child=e.child,t=D8.bind(null,e),u._reactRetry=t,null):(e=h.treeContext,Do=iu(u.nextSibling),Lo=t,An=!0,Na=null,e!==null&&(ea[ta++]=Zs,ea[ta++]=Hs,ea[ta++]=kc,Zs=e.id,Hs=e.overflow,kc=t),t=SA(t,i.children),t.flags|=4096,t)}function AI(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),VT(e.return,t,r)}function Cw(e,t,r,i,u){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:u}:(h.isBackwards=t,h.rendering=null,h.renderingStartTime=0,h.last=i,h.tail=r,h.tailMode=u)}function cB(e,t,r){var i=t.pendingProps,u=i.revealOrder,h=i.tail;if(Ki(e,t,i.children,r),i=Bn.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&AI(e,r,t);else if(e.tag===19)AI(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(gn(Bn,i),!(t.mode&1))t.memoizedState=null;else switch(u){case"forwards":for(r=t.child,u=null;r!==null;)e=r.alternate,e!==null&&o0(e)===null&&(u=r),r=r.sibling;r=u,r===null?(u=t.child,t.child=null):(u=r.sibling,r.sibling=null),Cw(t,!1,u,r,h);break;case"backwards":for(r=null,u=t.child,t.child=null;u!==null;){if(e=u.alternate,e!==null&&o0(e)===null){t.child=u;break}e=u.sibling,u.sibling=r,r=u,u=e}Cw(t,!0,r,null,h);break;case"together":Cw(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Rv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function al(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Lc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Tt(153));if(t.child!==null){for(e=t.child,r=lu(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=lu(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function b8(e,t,r){switch(t.tag){case 3:lB(t),$f();break;case 5:BR(t);break;case 1:_o(t.type)&&Qv(t);break;case 4:gA(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,u=t.memoizedProps.value;gn(r0,i._currentValue),i._currentValue=u;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(gn(Bn,Bn.current&1),t.flags|=128,null):r&t.child.childLanes?uB(e,t,r):(gn(Bn,Bn.current&1),e=al(e,t,r),e!==null?e.sibling:null);gn(Bn,Bn.current&1);break;case 19:if(i=(r&t.childLanes)!==0,e.flags&128){if(i)return cB(e,t,r);t.flags|=128}if(u=t.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),gn(Bn,Bn.current),i)break;return null;case 22:case 23:return t.lanes=0,aB(e,t,r)}return al(e,t,r)}var hB,YT,fB,dB;hB=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};YT=function(){};fB=function(e,t,r,i){var u=e.memoizedProps;if(u!==i){e=t.stateNode,vc(ms.current);var h=null;switch(r){case"input":u=vT(e,u),i=vT(e,i),h=[];break;case"select":u=Fn({},u,{value:void 0}),i=Fn({},i,{value:void 0}),h=[];break;case"textarea":u=wT(e,u),i=wT(e,i),h=[];break;default:typeof u.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=Yv)}ST(r,i);var p;r=null;for(x in u)if(!i.hasOwnProperty(x)&&u.hasOwnProperty(x)&&u[x]!=null)if(x==="style"){var _=u[x];for(p in _)_.hasOwnProperty(p)&&(r||(r={}),r[p]="")}else x!=="dangerouslySetInnerHTML"&&x!=="children"&&x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(ig.hasOwnProperty(x)?h||(h=[]):(h=h||[]).push(x,null));for(x in i){var o=i[x];if(_=u!=null?u[x]:void 0,i.hasOwnProperty(x)&&o!==_&&(o!=null||_!=null))if(x==="style")if(_){for(p in _)!_.hasOwnProperty(p)||o&&o.hasOwnProperty(p)||(r||(r={}),r[p]="");for(p in o)o.hasOwnProperty(p)&&_[p]!==o[p]&&(r||(r={}),r[p]=o[p])}else r||(h||(h=[]),h.push(x,r)),r=o;else x==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,_=_?_.__html:void 0,o!=null&&_!==o&&(h=h||[]).push(x,o)):x==="children"?typeof o!="string"&&typeof o!="number"||(h=h||[]).push(x,""+o):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&(ig.hasOwnProperty(x)?(o!=null&&x==="onScroll"&&vn("scroll",e),h||_===o||(h=[])):(h=h||[]).push(x,o))}r&&(h=h||[]).push("style",r);var x=h;(t.updateQueue=x)&&(t.flags|=4)}};dB=function(e,t,r,i){r!==i&&(t.flags|=4)};function vm(e,t){if(!An)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function ji(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var u=e.child;u!==null;)r|=u.lanes|u.childLanes,i|=u.subtreeFlags&14680064,i|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)r|=u.lanes|u.childLanes,i|=u.subtreeFlags,i|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function w8(e,t,r){var i=t.pendingProps;switch(uA(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ji(t),null;case 1:return _o(t.type)&&Jv(),ji(t),null;case 3:return i=t.stateNode,Uf(),wn(yo),wn(Gi),_A(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(nv(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Na!==null&&(oS(Na),Na=null))),YT(e,t),ji(t),null;case 5:yA(t);var u=vc(gg.current);if(r=t.type,e!==null&&t.stateNode!=null)fB(e,t,r,i,u),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(Tt(166));return ji(t),null}if(e=vc(ms.current),nv(t)){i=t.stateNode,r=t.type;var h=t.memoizedProps;switch(i[fs]=t,i[pg]=h,e=(t.mode&1)!==0,r){case"dialog":vn("cancel",i),vn("close",i);break;case"iframe":case"object":case"embed":vn("load",i);break;case"video":case"audio":for(u=0;u<Nm.length;u++)vn(Nm[u],i);break;case"source":vn("error",i);break;case"img":case"image":case"link":vn("error",i),vn("load",i);break;case"details":vn("toggle",i);break;case"input":zO(i,h),vn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!h.multiple},vn("invalid",i);break;case"textarea":BO(i,h),vn("invalid",i)}ST(r,h),u=null;for(var p in h)if(h.hasOwnProperty(p)){var _=h[p];p==="children"?typeof _=="string"?i.textContent!==_&&(h.suppressHydrationWarning!==!0&&rv(i.textContent,_,e),u=["children",_]):typeof _=="number"&&i.textContent!==""+_&&(h.suppressHydrationWarning!==!0&&rv(i.textContent,_,e),u=["children",""+_]):ig.hasOwnProperty(p)&&_!=null&&p==="onScroll"&&vn("scroll",i)}switch(r){case"input":H_(i),RO(i,h,!0);break;case"textarea":H_(i),jO(i);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(i.onclick=Yv)}i=u,t.updateQueue=i,i!==null&&(t.flags|=4)}else{p=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$z(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=p.createElement(r,{is:i.is}):(e=p.createElement(r),r==="select"&&(p=e,i.multiple?p.multiple=!0:i.size&&(p.size=i.size))):e=p.createElementNS(e,r),e[fs]=t,e[pg]=i,hB(e,t,!1,!1),t.stateNode=e;e:{switch(p=ET(r,i),r){case"dialog":vn("cancel",e),vn("close",e),u=i;break;case"iframe":case"object":case"embed":vn("load",e),u=i;break;case"video":case"audio":for(u=0;u<Nm.length;u++)vn(Nm[u],e);u=i;break;case"source":vn("error",e),u=i;break;case"img":case"image":case"link":vn("error",e),vn("load",e),u=i;break;case"details":vn("toggle",e),u=i;break;case"input":zO(e,i),u=vT(e,i),vn("invalid",e);break;case"option":u=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},u=Fn({},i,{value:void 0}),vn("invalid",e);break;case"textarea":BO(e,i),u=wT(e,i),vn("invalid",e);break;default:u=i}ST(r,u),_=u;for(h in _)if(_.hasOwnProperty(h)){var o=_[h];h==="style"?Vz(e,o):h==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&Nz(e,o)):h==="children"?typeof o=="string"?(r!=="textarea"||o!=="")&&og(e,o):typeof o=="number"&&og(e,""+o):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ig.hasOwnProperty(h)?o!=null&&h==="onScroll"&&vn("scroll",e):o!=null&&HE(e,h,o,p))}switch(r){case"input":H_(e),RO(e,i,!1);break;case"textarea":H_(e),jO(e);break;case"option":i.value!=null&&e.setAttribute("value",""+hu(i.value));break;case"select":e.multiple=!!i.multiple,h=i.value,h!=null?Tf(e,!!i.multiple,h,!1):i.defaultValue!=null&&Tf(e,!!i.multiple,i.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=Yv)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ji(t),null;case 6:if(e&&t.stateNode!=null)dB(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(Tt(166));if(r=vc(gg.current),vc(ms.current),nv(t)){if(i=t.stateNode,r=t.memoizedProps,i[fs]=t,(h=i.nodeValue!==r)&&(e=Lo,e!==null))switch(e.tag){case 3:rv(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&rv(i.nodeValue,r,(e.mode&1)!==0)}h&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[fs]=t,t.stateNode=i}return ji(t),null;case 13:if(wn(Bn),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(An&&Do!==null&&t.mode&1&&!(t.flags&128))OR(),$f(),t.flags|=98560,h=!1;else if(h=nv(t),i!==null&&i.dehydrated!==null){if(e===null){if(!h)throw Error(Tt(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(Tt(317));h[fs]=t}else $f(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ji(t),h=!1}else Na!==null&&(oS(Na),Na=null),h=!0;if(!h)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||Bn.current&1?ui===0&&(ui=3):OA())),t.updateQueue!==null&&(t.flags|=4),ji(t),null);case 4:return Uf(),YT(e,t),e===null&&fg(t.stateNode.containerInfo),ji(t),null;case 10:return dA(t.type._context),ji(t),null;case 17:return _o(t.type)&&Jv(),ji(t),null;case 19:if(wn(Bn),h=t.memoizedState,h===null)return ji(t),null;if(i=(t.flags&128)!==0,p=h.rendering,p===null)if(i)vm(h,!1);else{if(ui!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(p=o0(e),p!==null){for(t.flags|=128,vm(h,!1),i=p.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)h=r,e=i,h.flags&=14680066,p=h.alternate,p===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=p.childLanes,h.lanes=p.lanes,h.child=p.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=p.memoizedProps,h.memoizedState=p.memoizedState,h.updateQueue=p.updateQueue,h.type=p.type,e=p.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return gn(Bn,Bn.current&1|2),t.child}e=e.sibling}h.tail!==null&&Wn()>Gf&&(t.flags|=128,i=!0,vm(h,!1),t.lanes=4194304)}else{if(!i)if(e=o0(p),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),vm(h,!0),h.tail===null&&h.tailMode==="hidden"&&!p.alternate&&!An)return ji(t),null}else 2*Wn()-h.renderingStartTime>Gf&&r!==1073741824&&(t.flags|=128,i=!0,vm(h,!1),t.lanes=4194304);h.isBackwards?(p.sibling=t.child,t.child=p):(r=h.last,r!==null?r.sibling=p:t.child=p,h.last=p)}return h.tail!==null?(t=h.tail,h.rendering=t,h.tail=t.sibling,h.renderingStartTime=Wn(),t.sibling=null,r=Bn.current,gn(Bn,i?r&1|2:r&1),t):(ji(t),null);case 22:case 23:return CA(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?Mo&1073741824&&(ji(t),t.subtreeFlags&6&&(t.flags|=8192)):ji(t),null;case 24:return null;case 25:return null}throw Error(Tt(156,t.tag))}function T8(e,t){switch(uA(t),t.tag){case 1:return _o(t.type)&&Jv(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Uf(),wn(yo),wn(Gi),_A(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return yA(t),null;case 13:if(wn(Bn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Tt(340));$f()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return wn(Bn),null;case 4:return Uf(),null;case 10:return dA(t.type._context),null;case 22:case 23:return CA(),null;case 24:return null;default:return null}}var av=!1,Ni=!1,S8=typeof WeakSet=="function"?WeakSet:Set,$t=null;function mf(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){Un(e,t,i)}else r.current=null}function JT(e,t,r){try{r()}catch(i){Un(e,t,i)}}var PI=!1;function E8(e,t){if(zT=Hv,e=yR(),sA(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var u=i.anchorOffset,h=i.focusNode;i=i.focusOffset;try{r.nodeType,h.nodeType}catch{r=null;break e}var p=0,_=-1,o=-1,x=0,E=0,A=e,O=null;t:for(;;){for(var L;A!==r||u!==0&&A.nodeType!==3||(_=p+u),A!==h||i!==0&&A.nodeType!==3||(o=p+i),A.nodeType===3&&(p+=A.nodeValue.length),(L=A.firstChild)!==null;)O=A,A=L;for(;;){if(A===e)break t;if(O===r&&++x===u&&(_=p),O===h&&++E===i&&(o=p),(L=A.nextSibling)!==null)break;A=O,O=A.parentNode}A=L}r=_===-1||o===-1?null:{start:_,end:o}}else r=null}r=r||{start:0,end:0}}else r=null;for(RT={focusedElem:e,selectionRange:r},Hv=!1,$t=t;$t!==null;)if(t=$t,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,$t=e;else for(;$t!==null;){t=$t;try{var j=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var F=j.memoizedProps,Z=j.memoizedState,$=t.stateNode,V=$.getSnapshotBeforeUpdate(t.elementType===t.type?F:Ba(t.type,F),Z);$.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var U=t.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Tt(163))}}catch(G){Un(t,t.return,G)}if(e=t.sibling,e!==null){e.return=t.return,$t=e;break}$t=t.return}return j=PI,PI=!1,j}function Xm(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var u=i=i.next;do{if((u.tag&e)===e){var h=u.destroy;u.destroy=void 0,h!==void 0&&JT(t,r,h)}u=u.next}while(u!==i)}}function Px(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function QT(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function pB(e){var t=e.alternate;t!==null&&(e.alternate=null,pB(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[fs],delete t[pg],delete t[FT],delete t[s8],delete t[l8])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function mB(e){return e.tag===5||e.tag===3||e.tag===4}function MI(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||mB(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function eS(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Yv));else if(i!==4&&(e=e.child,e!==null))for(eS(e,t,r),e=e.sibling;e!==null;)eS(e,t,r),e=e.sibling}function tS(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(tS(e,t,r),e=e.sibling;e!==null;)tS(e,t,r),e=e.sibling}var Ei=null,ja=!1;function Vl(e,t,r){for(r=r.child;r!==null;)gB(e,t,r),r=r.sibling}function gB(e,t,r){if(ps&&typeof ps.onCommitFiberUnmount=="function")try{ps.onCommitFiberUnmount(vx,r)}catch{}switch(r.tag){case 5:Ni||mf(r,t);case 6:var i=Ei,u=ja;Ei=null,Vl(e,t,r),Ei=i,ja=u,Ei!==null&&(ja?(e=Ei,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ei.removeChild(r.stateNode));break;case 18:Ei!==null&&(ja?(e=Ei,r=r.stateNode,e.nodeType===8?ww(e.parentNode,r):e.nodeType===1&&ww(e,r),ug(e)):ww(Ei,r.stateNode));break;case 4:i=Ei,u=ja,Ei=r.stateNode.containerInfo,ja=!0,Vl(e,t,r),Ei=i,ja=u;break;case 0:case 11:case 14:case 15:if(!Ni&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){u=i=i.next;do{var h=u,p=h.destroy;h=h.tag,p!==void 0&&(h&2||h&4)&&JT(r,t,p),u=u.next}while(u!==i)}Vl(e,t,r);break;case 1:if(!Ni&&(mf(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(_){Un(r,t,_)}Vl(e,t,r);break;case 21:Vl(e,t,r);break;case 22:r.mode&1?(Ni=(i=Ni)||r.memoizedState!==null,Vl(e,t,r),Ni=i):Vl(e,t,r);break;default:Vl(e,t,r)}}function CI(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new S8),t.forEach(function(i){var u=L8.bind(null,e,i);r.has(i)||(r.add(i),i.then(u,u))})}}function za(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var u=r[i];try{var h=e,p=t,_=p;e:for(;_!==null;){switch(_.tag){case 5:Ei=_.stateNode,ja=!1;break e;case 3:Ei=_.stateNode.containerInfo,ja=!0;break e;case 4:Ei=_.stateNode.containerInfo,ja=!0;break e}_=_.return}if(Ei===null)throw Error(Tt(160));gB(h,p,u),Ei=null,ja=!1;var o=u.alternate;o!==null&&(o.return=null),u.return=null}catch(x){Un(u,t,x)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)yB(t,e),t=t.sibling}function yB(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(za(t,e),cs(e),i&4){try{Xm(3,e,e.return),Px(3,e)}catch(F){Un(e,e.return,F)}try{Xm(5,e,e.return)}catch(F){Un(e,e.return,F)}}break;case 1:za(t,e),cs(e),i&512&&r!==null&&mf(r,r.return);break;case 5:if(za(t,e),cs(e),i&512&&r!==null&&mf(r,r.return),e.flags&32){var u=e.stateNode;try{og(u,"")}catch(F){Un(e,e.return,F)}}if(i&4&&(u=e.stateNode,u!=null)){var h=e.memoizedProps,p=r!==null?r.memoizedProps:h,_=e.type,o=e.updateQueue;if(e.updateQueue=null,o!==null)try{_==="input"&&h.type==="radio"&&h.name!=null&&jz(u,h),ET(_,p);var x=ET(_,h);for(p=0;p<o.length;p+=2){var E=o[p],A=o[p+1];E==="style"?Vz(u,A):E==="dangerouslySetInnerHTML"?Nz(u,A):E==="children"?og(u,A):HE(u,E,A,x)}switch(_){case"input":xT(u,h);break;case"textarea":Fz(u,h);break;case"select":var O=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!h.multiple;var L=h.value;L!=null?Tf(u,!!h.multiple,L,!1):O!==!!h.multiple&&(h.defaultValue!=null?Tf(u,!!h.multiple,h.defaultValue,!0):Tf(u,!!h.multiple,h.multiple?[]:"",!1))}u[pg]=h}catch(F){Un(e,e.return,F)}}break;case 6:if(za(t,e),cs(e),i&4){if(e.stateNode===null)throw Error(Tt(162));u=e.stateNode,h=e.memoizedProps;try{u.nodeValue=h}catch(F){Un(e,e.return,F)}}break;case 3:if(za(t,e),cs(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{ug(t.containerInfo)}catch(F){Un(e,e.return,F)}break;case 4:za(t,e),cs(e);break;case 13:za(t,e),cs(e),u=e.child,u.flags&8192&&(h=u.memoizedState!==null,u.stateNode.isHidden=h,!h||u.alternate!==null&&u.alternate.memoizedState!==null||(PA=Wn())),i&4&&CI(e);break;case 22:if(E=r!==null&&r.memoizedState!==null,e.mode&1?(Ni=(x=Ni)||E,za(t,e),Ni=x):za(t,e),cs(e),i&8192){if(x=e.memoizedState!==null,(e.stateNode.isHidden=x)&&!E&&e.mode&1)for($t=e,E=e.child;E!==null;){for(A=$t=E;$t!==null;){switch(O=$t,L=O.child,O.tag){case 0:case 11:case 14:case 15:Xm(4,O,O.return);break;case 1:mf(O,O.return);var j=O.stateNode;if(typeof j.componentWillUnmount=="function"){i=O,r=O.return;try{t=i,j.props=t.memoizedProps,j.state=t.memoizedState,j.componentWillUnmount()}catch(F){Un(i,r,F)}}break;case 5:mf(O,O.return);break;case 22:if(O.memoizedState!==null){II(A);continue}}L!==null?(L.return=O,$t=L):II(A)}E=E.sibling}e:for(E=null,A=e;;){if(A.tag===5){if(E===null){E=A;try{u=A.stateNode,x?(h=u.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(_=A.stateNode,o=A.memoizedProps.style,p=o!=null&&o.hasOwnProperty("display")?o.display:null,_.style.display=Uz("display",p))}catch(F){Un(e,e.return,F)}}}else if(A.tag===6){if(E===null)try{A.stateNode.nodeValue=x?"":A.memoizedProps}catch(F){Un(e,e.return,F)}}else if((A.tag!==22&&A.tag!==23||A.memoizedState===null||A===e)&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===e)break e;for(;A.sibling===null;){if(A.return===null||A.return===e)break e;E===A&&(E=null),A=A.return}E===A&&(E=null),A.sibling.return=A.return,A=A.sibling}}break;case 19:za(t,e),cs(e),i&4&&CI(e);break;case 21:break;default:za(t,e),cs(e)}}function cs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(mB(r)){var i=r;break e}r=r.return}throw Error(Tt(160))}switch(i.tag){case 5:var u=i.stateNode;i.flags&32&&(og(u,""),i.flags&=-33);var h=MI(e);tS(e,h,u);break;case 3:case 4:var p=i.stateNode.containerInfo,_=MI(e);eS(e,_,p);break;default:throw Error(Tt(161))}}catch(o){Un(e,e.return,o)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function A8(e,t,r){$t=e,_B(e)}function _B(e,t,r){for(var i=(e.mode&1)!==0;$t!==null;){var u=$t,h=u.child;if(u.tag===22&&i){var p=u.memoizedState!==null||av;if(!p){var _=u.alternate,o=_!==null&&_.memoizedState!==null||Ni;_=av;var x=Ni;if(av=p,(Ni=o)&&!x)for($t=u;$t!==null;)p=$t,o=p.child,p.tag===22&&p.memoizedState!==null?kI(u):o!==null?(o.return=p,$t=o):kI(u);for(;h!==null;)$t=h,_B(h),h=h.sibling;$t=u,av=_,Ni=x}OI(e)}else u.subtreeFlags&8772&&h!==null?(h.return=u,$t=h):OI(e)}}function OI(e){for(;$t!==null;){var t=$t;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ni||Px(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Ni)if(r===null)i.componentDidMount();else{var u=t.elementType===t.type?r.memoizedProps:Ba(t.type,r.memoizedProps);i.componentDidUpdate(u,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var h=t.updateQueue;h!==null&&dI(t,h,i);break;case 3:var p=t.updateQueue;if(p!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}dI(t,p,r)}break;case 5:var _=t.stateNode;if(r===null&&t.flags&4){r=_;var o=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&r.focus();break;case"img":o.src&&(r.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var x=t.alternate;if(x!==null){var E=x.memoizedState;if(E!==null){var A=E.dehydrated;A!==null&&ug(A)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Tt(163))}Ni||t.flags&512&&QT(t)}catch(O){Un(t,t.return,O)}}if(t===e){$t=null;break}if(r=t.sibling,r!==null){r.return=t.return,$t=r;break}$t=t.return}}function II(e){for(;$t!==null;){var t=$t;if(t===e){$t=null;break}var r=t.sibling;if(r!==null){r.return=t.return,$t=r;break}$t=t.return}}function kI(e){for(;$t!==null;){var t=$t;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Px(4,t)}catch(o){Un(t,r,o)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var u=t.return;try{i.componentDidMount()}catch(o){Un(t,u,o)}}var h=t.return;try{QT(t)}catch(o){Un(t,h,o)}break;case 5:var p=t.return;try{QT(t)}catch(o){Un(t,p,o)}}}catch(o){Un(t,t.return,o)}if(t===e){$t=null;break}var _=t.sibling;if(_!==null){_.return=t.return,$t=_;break}$t=t.return}}var P8=Math.ceil,l0=cl.ReactCurrentDispatcher,EA=cl.ReactCurrentOwner,ia=cl.ReactCurrentBatchConfig,Dr=0,bi=null,ei=null,Pi=0,Mo=0,gf=gu(0),ui=0,xg=null,Lc=0,Mx=0,AA=0,Km=null,po=null,PA=0,Gf=1/0,Gs=null,u0=!1,rS=null,au=null,sv=!1,Ql=null,c0=0,Ym=0,nS=null,Bv=-1,jv=0;function Qi(){return Dr&6?Wn():Bv!==-1?Bv:Bv=Wn()}function su(e){return e.mode&1?Dr&2&&Pi!==0?Pi&-Pi:c8.transition!==null?(jv===0&&(jv=tR()),jv):(e=nn,e!==0||(e=window.event,e=e===void 0?16:lR(e.type)),e):1}function Za(e,t,r,i){if(50<Ym)throw Ym=0,nS=null,Error(Tt(185));ay(e,r,i),(!(Dr&2)||e!==bi)&&(e===bi&&(!(Dr&2)&&(Mx|=r),ui===4&&Kl(e,Pi)),vo(e,i),r===1&&Dr===0&&!(t.mode&1)&&(Gf=Wn()+500,Sx&&yu()))}function vo(e,t){var r=e.callbackNode;c6(e,t);var i=Zv(e,e===bi?Pi:0);if(i===0)r!==null&&NO(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&NO(r),t===1)e.tag===0?u8(DI.bind(null,e)):PR(DI.bind(null,e)),o8(function(){!(Dr&6)&&yu()}),r=null;else{switch(rR(i)){case 1:r=QE;break;case 4:r=Qz;break;case 16:r=qv;break;case 536870912:r=eR;break;default:r=qv}r=AB(r,vB.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function vB(e,t){if(Bv=-1,jv=0,Dr&6)throw Error(Tt(327));var r=e.callbackNode;if(Mf()&&e.callbackNode!==r)return null;var i=Zv(e,e===bi?Pi:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=h0(e,i);else{t=i;var u=Dr;Dr|=2;var h=bB();(bi!==e||Pi!==t)&&(Gs=null,Gf=Wn()+500,Ac(e,t));do try{O8();break}catch(_){xB(e,_)}while(!0);fA(),l0.current=h,Dr=u,ei!==null?t=0:(bi=null,Pi=0,t=ui)}if(t!==0){if(t===2&&(u=OT(e),u!==0&&(i=u,t=iS(e,u))),t===1)throw r=xg,Ac(e,0),Kl(e,i),vo(e,Wn()),r;if(t===6)Kl(e,i);else{if(u=e.current.alternate,!(i&30)&&!M8(u)&&(t=h0(e,i),t===2&&(h=OT(e),h!==0&&(i=h,t=iS(e,h))),t===1))throw r=xg,Ac(e,0),Kl(e,i),vo(e,Wn()),r;switch(e.finishedWork=u,e.finishedLanes=i,t){case 0:case 1:throw Error(Tt(345));case 2:dc(e,po,Gs);break;case 3:if(Kl(e,i),(i&130023424)===i&&(t=PA+500-Wn(),10<t)){if(Zv(e,0)!==0)break;if(u=e.suspendedLanes,(u&i)!==i){Qi(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=jT(dc.bind(null,e,po,Gs),t);break}dc(e,po,Gs);break;case 4:if(Kl(e,i),(i&4194240)===i)break;for(t=e.eventTimes,u=-1;0<i;){var p=31-qa(i);h=1<<p,p=t[p],p>u&&(u=p),i&=~h}if(i=u,i=Wn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*P8(i/1960))-i,10<i){e.timeoutHandle=jT(dc.bind(null,e,po,Gs),i);break}dc(e,po,Gs);break;case 5:dc(e,po,Gs);break;default:throw Error(Tt(329))}}}return vo(e,Wn()),e.callbackNode===r?vB.bind(null,e):null}function iS(e,t){var r=Km;return e.current.memoizedState.isDehydrated&&(Ac(e,t).flags|=256),e=h0(e,t),e!==2&&(t=po,po=r,t!==null&&oS(t)),e}function oS(e){po===null?po=e:po.push.apply(po,e)}function M8(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var u=r[i],h=u.getSnapshot;u=u.value;try{if(!Xa(h(),u))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kl(e,t){for(t&=~AA,t&=~Mx,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-qa(t),i=1<<r;e[r]=-1,t&=~i}}function DI(e){if(Dr&6)throw Error(Tt(327));Mf();var t=Zv(e,0);if(!(t&1))return vo(e,Wn()),null;var r=h0(e,t);if(e.tag!==0&&r===2){var i=OT(e);i!==0&&(t=i,r=iS(e,i))}if(r===1)throw r=xg,Ac(e,0),Kl(e,t),vo(e,Wn()),r;if(r===6)throw Error(Tt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,dc(e,po,Gs),vo(e,Wn()),null}function MA(e,t){var r=Dr;Dr|=1;try{return e(t)}finally{Dr=r,Dr===0&&(Gf=Wn()+500,Sx&&yu())}}function zc(e){Ql!==null&&Ql.tag===0&&!(Dr&6)&&Mf();var t=Dr;Dr|=1;var r=ia.transition,i=nn;try{if(ia.transition=null,nn=1,e)return e()}finally{nn=i,ia.transition=r,Dr=t,!(Dr&6)&&yu()}}function CA(){Mo=gf.current,wn(gf)}function Ac(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,i8(r)),ei!==null)for(r=ei.return;r!==null;){var i=r;switch(uA(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Jv();break;case 3:Uf(),wn(yo),wn(Gi),_A();break;case 5:yA(i);break;case 4:Uf();break;case 13:wn(Bn);break;case 19:wn(Bn);break;case 10:dA(i.type._context);break;case 22:case 23:CA()}r=r.return}if(bi=e,ei=e=lu(e.current,null),Pi=Mo=t,ui=0,xg=null,AA=Mx=Lc=0,po=Km=null,_c!==null){for(t=0;t<_c.length;t++)if(r=_c[t],i=r.interleaved,i!==null){r.interleaved=null;var u=i.next,h=r.pending;if(h!==null){var p=h.next;h.next=u,i.next=p}r.pending=i}_c=null}return e}function xB(e,t){do{var r=ei;try{if(fA(),Lv.current=s0,a0){for(var i=jn.memoizedState;i!==null;){var u=i.queue;u!==null&&(u.pending=null),i=i.next}a0=!1}if(Dc=0,vi=li=jn=null,Hm=!1,yg=0,EA.current=null,r===null||r.return===null){ui=1,xg=t,ei=null;break}e:{var h=e,p=r.return,_=r,o=t;if(t=Pi,_.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var x=o,E=_,A=E.tag;if(!(E.mode&1)&&(A===0||A===11||A===15)){var O=E.alternate;O?(E.updateQueue=O.updateQueue,E.memoizedState=O.memoizedState,E.lanes=O.lanes):(E.updateQueue=null,E.memoizedState=null)}var L=xI(p);if(L!==null){L.flags&=-257,bI(L,p,_,h,t),L.mode&1&&vI(h,x,t),t=L,o=x;var j=t.updateQueue;if(j===null){var F=new Set;F.add(o),t.updateQueue=F}else j.add(o);break e}else{if(!(t&1)){vI(h,x,t),OA();break e}o=Error(Tt(426))}}else if(An&&_.mode&1){var Z=xI(p);if(Z!==null){!(Z.flags&65536)&&(Z.flags|=256),bI(Z,p,_,h,t),cA(Vf(o,_));break e}}h=o=Vf(o,_),ui!==4&&(ui=2),Km===null?Km=[h]:Km.push(h),h=p;do{switch(h.tag){case 3:h.flags|=65536,t&=-t,h.lanes|=t;var $=nB(h,o,t);fI(h,$);break e;case 1:_=o;var V=h.type,U=h.stateNode;if(!(h.flags&128)&&(typeof V.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(au===null||!au.has(U)))){h.flags|=65536,t&=-t,h.lanes|=t;var G=iB(h,_,t);fI(h,G);break e}}h=h.return}while(h!==null)}TB(r)}catch(q){t=q,ei===r&&r!==null&&(ei=r=r.return);continue}break}while(!0)}function bB(){var e=l0.current;return l0.current=s0,e===null?s0:e}function OA(){(ui===0||ui===3||ui===2)&&(ui=4),bi===null||!(Lc&268435455)&&!(Mx&268435455)||Kl(bi,Pi)}function h0(e,t){var r=Dr;Dr|=2;var i=bB();(bi!==e||Pi!==t)&&(Gs=null,Ac(e,t));do try{C8();break}catch(u){xB(e,u)}while(!0);if(fA(),Dr=r,l0.current=i,ei!==null)throw Error(Tt(261));return bi=null,Pi=0,ui}function C8(){for(;ei!==null;)wB(ei)}function O8(){for(;ei!==null&&!t6();)wB(ei)}function wB(e){var t=EB(e.alternate,e,Mo);e.memoizedProps=e.pendingProps,t===null?TB(e):ei=t,EA.current=null}function TB(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=T8(r,t),r!==null){r.flags&=32767,ei=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ui=6,ei=null;return}}else if(r=w8(r,t,Mo),r!==null){ei=r;return}if(t=t.sibling,t!==null){ei=t;return}ei=t=e}while(t!==null);ui===0&&(ui=5)}function dc(e,t,r){var i=nn,u=ia.transition;try{ia.transition=null,nn=1,I8(e,t,r,i)}finally{ia.transition=u,nn=i}return null}function I8(e,t,r,i){do Mf();while(Ql!==null);if(Dr&6)throw Error(Tt(327));r=e.finishedWork;var u=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Tt(177));e.callbackNode=null,e.callbackPriority=0;var h=r.lanes|r.childLanes;if(h6(e,h),e===bi&&(ei=bi=null,Pi=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||sv||(sv=!0,AB(qv,function(){return Mf(),null})),h=(r.flags&15990)!==0,r.subtreeFlags&15990||h){h=ia.transition,ia.transition=null;var p=nn;nn=1;var _=Dr;Dr|=4,EA.current=null,E8(e,r),yB(r,e),Y6(RT),Hv=!!zT,RT=zT=null,e.current=r,A8(r),r6(),Dr=_,nn=p,ia.transition=h}else e.current=r;if(sv&&(sv=!1,Ql=e,c0=u),h=e.pendingLanes,h===0&&(au=null),o6(r.stateNode),vo(e,Wn()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)u=t[r],i(u.value,{componentStack:u.stack,digest:u.digest});if(u0)throw u0=!1,e=rS,rS=null,e;return c0&1&&e.tag!==0&&Mf(),h=e.pendingLanes,h&1?e===nS?Ym++:(Ym=0,nS=e):Ym=0,yu(),null}function Mf(){if(Ql!==null){var e=rR(c0),t=ia.transition,r=nn;try{if(ia.transition=null,nn=16>e?16:e,Ql===null)var i=!1;else{if(e=Ql,Ql=null,c0=0,Dr&6)throw Error(Tt(331));var u=Dr;for(Dr|=4,$t=e.current;$t!==null;){var h=$t,p=h.child;if($t.flags&16){var _=h.deletions;if(_!==null){for(var o=0;o<_.length;o++){var x=_[o];for($t=x;$t!==null;){var E=$t;switch(E.tag){case 0:case 11:case 15:Xm(8,E,h)}var A=E.child;if(A!==null)A.return=E,$t=A;else for(;$t!==null;){E=$t;var O=E.sibling,L=E.return;if(pB(E),E===x){$t=null;break}if(O!==null){O.return=L,$t=O;break}$t=L}}}var j=h.alternate;if(j!==null){var F=j.child;if(F!==null){j.child=null;do{var Z=F.sibling;F.sibling=null,F=Z}while(F!==null)}}$t=h}}if(h.subtreeFlags&2064&&p!==null)p.return=h,$t=p;else e:for(;$t!==null;){if(h=$t,h.flags&2048)switch(h.tag){case 0:case 11:case 15:Xm(9,h,h.return)}var $=h.sibling;if($!==null){$.return=h.return,$t=$;break e}$t=h.return}}var V=e.current;for($t=V;$t!==null;){p=$t;var U=p.child;if(p.subtreeFlags&2064&&U!==null)U.return=p,$t=U;else e:for(p=V;$t!==null;){if(_=$t,_.flags&2048)try{switch(_.tag){case 0:case 11:case 15:Px(9,_)}}catch(q){Un(_,_.return,q)}if(_===p){$t=null;break e}var G=_.sibling;if(G!==null){G.return=_.return,$t=G;break e}$t=_.return}}if(Dr=u,yu(),ps&&typeof ps.onPostCommitFiberRoot=="function")try{ps.onPostCommitFiberRoot(vx,e)}catch{}i=!0}return i}finally{nn=r,ia.transition=t}}return!1}function LI(e,t,r){t=Vf(r,t),t=nB(e,t,1),e=ou(e,t,1),t=Qi(),e!==null&&(ay(e,1,t),vo(e,t))}function Un(e,t,r){if(e.tag===3)LI(e,e,r);else for(;t!==null;){if(t.tag===3){LI(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(au===null||!au.has(i))){e=Vf(r,e),e=iB(t,e,1),t=ou(t,e,1),e=Qi(),t!==null&&(ay(t,1,e),vo(t,e));break}}t=t.return}}function k8(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=Qi(),e.pingedLanes|=e.suspendedLanes&r,bi===e&&(Pi&r)===r&&(ui===4||ui===3&&(Pi&130023424)===Pi&&500>Wn()-PA?Ac(e,0):AA|=r),vo(e,t)}function SB(e,t){t===0&&(e.mode&1?(t=Y_,Y_<<=1,!(Y_&130023424)&&(Y_=4194304)):t=1);var r=Qi();e=ol(e,t),e!==null&&(ay(e,t,r),vo(e,r))}function D8(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),SB(e,r)}function L8(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,u=e.memoizedState;u!==null&&(r=u.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(Tt(314))}i!==null&&i.delete(t),SB(e,r)}var EB;EB=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||yo.current)mo=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return mo=!1,b8(e,t,r);mo=!!(e.flags&131072)}else mo=!1,An&&t.flags&1048576&&MR(t,t0,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Rv(e,t),e=t.pendingProps;var u=Ff(t,Gi.current);Pf(t,r),u=xA(null,t,i,e,u,r);var h=bA();return t.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,_o(i)?(h=!0,Qv(t)):h=!1,t.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,mA(t),u.updater=Ex,t.stateNode=u,u._reactInternals=t,WT(t,i,e,r),t=HT(null,t,i,!0,h,r)):(t.tag=0,An&&h&&lA(t),Ki(null,t,u,r),t=t.child),t;case 16:i=t.elementType;e:{switch(Rv(e,t),e=t.pendingProps,u=i._init,i=u(i._payload),t.type=i,u=t.tag=R8(i),e=Ba(i,e),u){case 0:t=ZT(null,t,i,e,r);break e;case 1:t=SI(null,t,i,e,r);break e;case 11:t=wI(null,t,i,e,r);break e;case 14:t=TI(null,t,i,Ba(i.type,e),r);break e}throw Error(Tt(306,i,""))}return t;case 0:return i=t.type,u=t.pendingProps,u=t.elementType===i?u:Ba(i,u),ZT(e,t,i,u,r);case 1:return i=t.type,u=t.pendingProps,u=t.elementType===i?u:Ba(i,u),SI(e,t,i,u,r);case 3:e:{if(lB(t),e===null)throw Error(Tt(387));i=t.pendingProps,h=t.memoizedState,u=h.element,kR(e,t),i0(t,i,null,r);var p=t.memoizedState;if(i=p.element,h.isDehydrated)if(h={element:i,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){u=Vf(Error(Tt(423)),t),t=EI(e,t,i,r,u);break e}else if(i!==u){u=Vf(Error(Tt(424)),t),t=EI(e,t,i,r,u);break e}else for(Do=iu(t.stateNode.containerInfo.firstChild),Lo=t,An=!0,Na=null,r=RR(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if($f(),i===u){t=al(e,t,r);break e}Ki(e,t,i,r)}t=t.child}return t;case 5:return BR(t),e===null&&UT(t),i=t.type,u=t.pendingProps,h=e!==null?e.memoizedProps:null,p=u.children,BT(i,u)?p=null:h!==null&&BT(i,h)&&(t.flags|=32),sB(e,t),Ki(e,t,p,r),t.child;case 6:return e===null&&UT(t),null;case 13:return uB(e,t,r);case 4:return gA(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Nf(t,null,i,r):Ki(e,t,i,r),t.child;case 11:return i=t.type,u=t.pendingProps,u=t.elementType===i?u:Ba(i,u),wI(e,t,i,u,r);case 7:return Ki(e,t,t.pendingProps,r),t.child;case 8:return Ki(e,t,t.pendingProps.children,r),t.child;case 12:return Ki(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,u=t.pendingProps,h=t.memoizedProps,p=u.value,gn(r0,i._currentValue),i._currentValue=p,h!==null)if(Xa(h.value,p)){if(h.children===u.children&&!yo.current){t=al(e,t,r);break e}}else for(h=t.child,h!==null&&(h.return=t);h!==null;){var _=h.dependencies;if(_!==null){p=h.child;for(var o=_.firstContext;o!==null;){if(o.context===i){if(h.tag===1){o=Js(-1,r&-r),o.tag=2;var x=h.updateQueue;if(x!==null){x=x.shared;var E=x.pending;E===null?o.next=o:(o.next=E.next,E.next=o),x.pending=o}}h.lanes|=r,o=h.alternate,o!==null&&(o.lanes|=r),VT(h.return,r,t),_.lanes|=r;break}o=o.next}}else if(h.tag===10)p=h.type===t.type?null:h.child;else if(h.tag===18){if(p=h.return,p===null)throw Error(Tt(341));p.lanes|=r,_=p.alternate,_!==null&&(_.lanes|=r),VT(p,r,t),p=h.sibling}else p=h.child;if(p!==null)p.return=h;else for(p=h;p!==null;){if(p===t){p=null;break}if(h=p.sibling,h!==null){h.return=p.return,p=h;break}p=p.return}h=p}Ki(e,t,u.children,r),t=t.child}return t;case 9:return u=t.type,i=t.pendingProps.children,Pf(t,r),u=sa(u),i=i(u),t.flags|=1,Ki(e,t,i,r),t.child;case 14:return i=t.type,u=Ba(i,t.pendingProps),u=Ba(i.type,u),TI(e,t,i,u,r);case 15:return oB(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,u=t.pendingProps,u=t.elementType===i?u:Ba(i,u),Rv(e,t),t.tag=1,_o(i)?(e=!0,Qv(t)):e=!1,Pf(t,r),LR(t,i,u),WT(t,i,u,r),HT(null,t,i,!0,e,r);case 19:return cB(e,t,r);case 22:return aB(e,t,r)}throw Error(Tt(156,t.tag))};function AB(e,t){return Jz(e,t)}function z8(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ra(e,t,r,i){return new z8(e,t,r,i)}function IA(e){return e=e.prototype,!(!e||!e.isReactComponent)}function R8(e){if(typeof e=="function")return IA(e)?1:0;if(e!=null){if(e=e.$$typeof,e===KE)return 11;if(e===YE)return 14}return 2}function lu(e,t){var r=e.alternate;return r===null?(r=ra(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Fv(e,t,r,i,u,h){var p=2;if(i=e,typeof e=="function")IA(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case af:return Pc(r.children,u,h,t);case XE:p=8,u|=8;break;case mT:return e=ra(12,r,t,u|2),e.elementType=mT,e.lanes=h,e;case gT:return e=ra(13,r,t,u),e.elementType=gT,e.lanes=h,e;case yT:return e=ra(19,r,t,u),e.elementType=yT,e.lanes=h,e;case zz:return Cx(r,u,h,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Dz:p=10;break e;case Lz:p=9;break e;case KE:p=11;break e;case YE:p=14;break e;case ql:p=16,i=null;break e}throw Error(Tt(130,e==null?e:typeof e,""))}return t=ra(p,r,t,u),t.elementType=e,t.type=i,t.lanes=h,t}function Pc(e,t,r,i){return e=ra(7,e,i,t),e.lanes=r,e}function Cx(e,t,r,i){return e=ra(22,e,i,t),e.elementType=zz,e.lanes=r,e.stateNode={isHidden:!1},e}function Ow(e,t,r){return e=ra(6,e,null,t),e.lanes=r,e}function Iw(e,t,r){return t=ra(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function B8(e,t,r,i,u){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hw(0),this.expirationTimes=hw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hw(0),this.identifierPrefix=i,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function kA(e,t,r,i,u,h,p,_,o){return e=new B8(e,t,r,_,o),t===1?(t=1,h===!0&&(t|=8)):t=0,h=ra(3,null,null,t),e.current=h,h.stateNode=e,h.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},mA(h),e}function j8(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:of,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function PB(e){if(!e)return fu;e=e._reactInternals;e:{if(Uc(e)!==e||e.tag!==1)throw Error(Tt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(_o(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Tt(171))}if(e.tag===1){var r=e.type;if(_o(r))return AR(e,r,t)}return t}function MB(e,t,r,i,u,h,p,_,o){return e=kA(r,i,!0,e,u,h,p,_,o),e.context=PB(null),r=e.current,i=Qi(),u=su(r),h=Js(i,u),h.callback=t??null,ou(r,h,u),e.current.lanes=u,ay(e,u,i),vo(e,i),e}function Ox(e,t,r,i){var u=t.current,h=Qi(),p=su(u);return r=PB(r),t.context===null?t.context=r:t.pendingContext=r,t=Js(h,p),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=ou(u,t,p),e!==null&&(Za(e,u,p,h),Dv(e,u,p)),p}function f0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function zI(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function DA(e,t){zI(e,t),(e=e.alternate)&&zI(e,t)}function F8(){return null}var CB=typeof reportError=="function"?reportError:function(e){console.error(e)};function LA(e){this._internalRoot=e}Ix.prototype.render=LA.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Tt(409));Ox(e,t,null,null)};Ix.prototype.unmount=LA.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;zc(function(){Ox(null,e,null,null)}),t[il]=null}};function Ix(e){this._internalRoot=e}Ix.prototype.unstable_scheduleHydration=function(e){if(e){var t=oR();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Xl.length&&t!==0&&t<Xl[r].priority;r++);Xl.splice(r,0,e),r===0&&sR(e)}};function zA(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function kx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function RI(){}function $8(e,t,r,i,u){if(u){if(typeof i=="function"){var h=i;i=function(){var x=f0(p);h.call(x)}}var p=MB(t,i,e,0,null,!1,!1,"",RI);return e._reactRootContainer=p,e[il]=p.current,fg(e.nodeType===8?e.parentNode:e),zc(),p}for(;u=e.lastChild;)e.removeChild(u);if(typeof i=="function"){var _=i;i=function(){var x=f0(o);_.call(x)}}var o=kA(e,0,!1,null,null,!1,!1,"",RI);return e._reactRootContainer=o,e[il]=o.current,fg(e.nodeType===8?e.parentNode:e),zc(function(){Ox(t,o,r,i)}),o}function Dx(e,t,r,i,u){var h=r._reactRootContainer;if(h){var p=h;if(typeof u=="function"){var _=u;u=function(){var o=f0(p);_.call(o)}}Ox(t,p,e,u)}else p=$8(r,t,e,u,i);return f0(p)}nR=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=$m(t.pendingLanes);r!==0&&(eA(t,r|1),vo(t,Wn()),!(Dr&6)&&(Gf=Wn()+500,yu()))}break;case 13:zc(function(){var i=ol(e,1);if(i!==null){var u=Qi();Za(i,e,1,u)}}),DA(e,1)}};tA=function(e){if(e.tag===13){var t=ol(e,134217728);if(t!==null){var r=Qi();Za(t,e,134217728,r)}DA(e,134217728)}};iR=function(e){if(e.tag===13){var t=su(e),r=ol(e,t);if(r!==null){var i=Qi();Za(r,e,t,i)}DA(e,t)}};oR=function(){return nn};aR=function(e,t){var r=nn;try{return nn=e,t()}finally{nn=r}};PT=function(e,t,r){switch(t){case"input":if(xT(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var u=Tx(i);if(!u)throw Error(Tt(90));Bz(i),xT(i,u)}}}break;case"textarea":Fz(e,r);break;case"select":t=r.value,t!=null&&Tf(e,!!r.multiple,t,!1)}};qz=MA;Zz=zc;var N8={usingClientEntryPoint:!1,Events:[ly,cf,Tx,Gz,Wz,MA]},xm={findFiberByHostInstance:yc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},U8={bundleType:xm.bundleType,version:xm.version,rendererPackageName:xm.rendererPackageName,rendererConfig:xm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Kz(e),e===null?null:e.stateNode},findFiberByHostInstance:xm.findFiberByHostInstance||F8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lv.isDisabled&&lv.supportsFiber)try{vx=lv.inject(U8),ps=lv}catch{}}Ro.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N8;Ro.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zA(t))throw Error(Tt(200));return j8(e,t,null,r)};Ro.createRoot=function(e,t){if(!zA(e))throw Error(Tt(299));var r=!1,i="",u=CB;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(u=t.onRecoverableError)),t=kA(e,1,!1,null,null,r,!1,i,u),e[il]=t.current,fg(e.nodeType===8?e.parentNode:e),new LA(t)};Ro.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Tt(188)):(e=Object.keys(e).join(","),Error(Tt(268,e)));return e=Kz(t),e=e===null?null:e.stateNode,e};Ro.flushSync=function(e){return zc(e)};Ro.hydrate=function(e,t,r){if(!kx(t))throw Error(Tt(200));return Dx(null,e,t,!0,r)};Ro.hydrateRoot=function(e,t,r){if(!zA(e))throw Error(Tt(405));var i=r!=null&&r.hydratedSources||null,u=!1,h="",p=CB;if(r!=null&&(r.unstable_strictMode===!0&&(u=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onRecoverableError!==void 0&&(p=r.onRecoverableError)),t=MB(t,null,e,1,r??null,u,!1,h,p),e[il]=t.current,fg(e),i)for(e=0;e<i.length;e++)r=i[e],u=r._getVersion,u=u(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,u]:t.mutableSourceEagerHydrationData.push(r,u);return new Ix(t)};Ro.render=function(e,t,r){if(!kx(t))throw Error(Tt(200));return Dx(null,e,t,!1,r)};Ro.unmountComponentAtNode=function(e){if(!kx(e))throw Error(Tt(40));return e._reactRootContainer?(zc(function(){Dx(null,null,e,!1,function(){e._reactRootContainer=null,e[il]=null})}),!0):!1};Ro.unstable_batchedUpdates=MA;Ro.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!kx(r))throw Error(Tt(200));if(e==null||e._reactInternals===void 0)throw Error(Tt(38));return Dx(e,t,r,!1,i)};Ro.version="18.2.0-next-9e3b772b8-20220608";function OB(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(OB)}catch(e){console.error(e)}}OB(),Mz.exports=Ro;var RA=Mz.exports,BI=RA;IO.createRoot=BI.createRoot,IO.hydrateRoot=BI.hydrateRoot;/**
 * @remix-run/router v1.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function En(){return En=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},En.apply(this,arguments)}var si;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(si||(si={}));const jI="popstate";function V8(e){e===void 0&&(e={});function t(i,u){let{pathname:h,search:p,hash:_}=i.location;return bg("",{pathname:h,search:p,hash:_},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function r(i,u){return typeof u=="string"?u:Rc(u)}return W8(t,r,null,e)}function Ar(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Wf(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function G8(){return Math.random().toString(36).substr(2,8)}function FI(e,t){return{usr:e.state,key:e.key,idx:t}}function bg(e,t,r,i){return r===void 0&&(r=null),En({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?_u(t):t,{state:r,key:t&&t.key||i||G8()})}function Rc(e){let{pathname:t="/",search:r="",hash:i=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function _u(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function W8(e,t,r,i){i===void 0&&(i={});let{window:u=document.defaultView,v5Compat:h=!1}=i,p=u.history,_=si.Pop,o=null,x=E();x==null&&(x=0,p.replaceState(En({},p.state,{idx:x}),""));function E(){return(p.state||{idx:null}).idx}function A(){_=si.Pop;let Z=E(),$=Z==null?null:Z-x;x=Z,o&&o({action:_,location:F.location,delta:$})}function O(Z,$){_=si.Push;let V=bg(F.location,Z,$);x=E()+1;let U=FI(V,x),G=F.createHref(V);try{p.pushState(U,"",G)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;u.location.assign(G)}h&&o&&o({action:_,location:F.location,delta:1})}function L(Z,$){_=si.Replace;let V=bg(F.location,Z,$);x=E();let U=FI(V,x),G=F.createHref(V);p.replaceState(U,"",G),h&&o&&o({action:_,location:F.location,delta:0})}function j(Z){let $=u.location.origin!=="null"?u.location.origin:u.location.href,V=typeof Z=="string"?Z:Rc(Z);return Ar($,"No window.location.(origin|href) available to create URL for href: "+V),new URL(V,$)}let F={get action(){return _},get location(){return e(u,p)},listen(Z){if(o)throw new Error("A history only accepts one active listener");return u.addEventListener(jI,A),o=Z,()=>{u.removeEventListener(jI,A),o=null}},createHref(Z){return t(u,Z)},createURL:j,encodeLocation(Z){let $=j(Z);return{pathname:$.pathname,search:$.search,hash:$.hash}},push:O,replace:L,go(Z){return p.go(Z)}};return F}var Gn;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Gn||(Gn={}));const q8=new Set(["lazy","caseSensitive","path","id","index","children"]);function Z8(e){return e.index===!0}function aS(e,t,r,i){return r===void 0&&(r=[]),i===void 0&&(i={}),e.map((u,h)=>{let p=[...r,h],_=typeof u.id=="string"?u.id:p.join("-");if(Ar(u.index!==!0||!u.children,"Cannot specify children on an index route"),Ar(!i[_],'Found a route id collision on id "'+_+`".  Route id's must be globally unique within Data Router usages`),Z8(u)){let o=En({},u,t(u),{id:_});return i[_]=o,o}else{let o=En({},u,t(u),{id:_,children:void 0});return i[_]=o,u.children&&(o.children=aS(u.children,t,p,i)),o}})}function yf(e,t,r){r===void 0&&(r="/");let i=typeof t=="string"?_u(t):t,u=xd(i.pathname||"/",r);if(u==null)return null;let h=IB(e);H8(h);let p=null;for(let _=0;p==null&&_<h.length;++_)p=nV(h[_],aV(u));return p}function IB(e,t,r,i){t===void 0&&(t=[]),r===void 0&&(r=[]),i===void 0&&(i="");let u=(h,p,_)=>{let o={relativePath:_===void 0?h.path||"":_,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};o.relativePath.startsWith("/")&&(Ar(o.relativePath.startsWith(i),'Absolute route path "'+o.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),o.relativePath=o.relativePath.slice(i.length));let x=Qs([i,o.relativePath]),E=r.concat(o);h.children&&h.children.length>0&&(Ar(h.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+x+'".')),IB(h.children,t,E,x)),!(h.path==null&&!h.index)&&t.push({path:x,score:tV(x,h.index),routesMeta:E})};return e.forEach((h,p)=>{var _;if(h.path===""||!((_=h.path)!=null&&_.includes("?")))u(h,p);else for(let o of kB(h.path))u(h,p,o)}),t}function kB(e){let t=e.split("/");if(t.length===0)return[];let[r,...i]=t,u=r.endsWith("?"),h=r.replace(/\?$/,"");if(i.length===0)return u?[h,""]:[h];let p=kB(i.join("/")),_=[];return _.push(...p.map(o=>o===""?h:[h,o].join("/"))),u&&_.push(...p),_.map(o=>e.startsWith("/")&&o===""?"/":o)}function H8(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:rV(t.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const X8=/^:\w+$/,K8=3,Y8=2,J8=1,Q8=10,eV=-2,$I=e=>e==="*";function tV(e,t){let r=e.split("/"),i=r.length;return r.some($I)&&(i+=eV),t&&(i+=Y8),r.filter(u=>!$I(u)).reduce((u,h)=>u+(X8.test(h)?K8:h===""?J8:Q8),i)}function rV(e,t){return e.length===t.length&&e.slice(0,-1).every((i,u)=>i===t[u])?e[e.length-1]-t[t.length-1]:0}function nV(e,t){let{routesMeta:r}=e,i={},u="/",h=[];for(let p=0;p<r.length;++p){let _=r[p],o=p===r.length-1,x=u==="/"?t:t.slice(u.length)||"/",E=iV({path:_.relativePath,caseSensitive:_.caseSensitive,end:o},x);if(!E)return null;Object.assign(i,E.params);let A=_.route;h.push({params:i,pathname:Qs([u,E.pathname]),pathnameBase:cV(Qs([u,E.pathnameBase])),route:A}),E.pathnameBase!=="/"&&(u=Qs([u,E.pathnameBase]))}return h}function iV(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,i]=oV(e.path,e.caseSensitive,e.end),u=t.match(r);if(!u)return null;let h=u[0],p=h.replace(/(.)\/+$/,"$1"),_=u.slice(1);return{params:i.reduce((x,E,A)=>{if(E==="*"){let O=_[A]||"";p=h.slice(0,h.length-O.length).replace(/(.)\/+$/,"$1")}return x[E]=sV(_[A]||"",E),x},{}),pathname:h,pathnameBase:p,pattern:e}}function oV(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Wf(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],u="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(p,_)=>(i.push(_),"/([^\\/]+)"));return e.endsWith("*")?(i.push("*"),u+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?u+="\\/*$":e!==""&&e!=="/"&&(u+="(?:(?=\\/|$))"),[new RegExp(u,t?void 0:"i"),i]}function aV(e){try{return decodeURI(e)}catch(t){return Wf(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function sV(e,t){try{return decodeURIComponent(e)}catch(r){return Wf(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function xd(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,i=e.charAt(r);return i&&i!=="/"?null:e.slice(r)||"/"}function lV(e,t){t===void 0&&(t="/");let{pathname:r,search:i="",hash:u=""}=typeof e=="string"?_u(e):e;return{pathname:r?r.startsWith("/")?r:uV(r,t):t,search:hV(i),hash:fV(u)}}function uV(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(u=>{u===".."?r.length>1&&r.pop():u!=="."&&r.push(u)}),r.length>1?r.join("/"):"/"}function kw(e,t,r,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Lx(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function BA(e,t,r,i){i===void 0&&(i=!1);let u;typeof e=="string"?u=_u(e):(u=En({},e),Ar(!u.pathname||!u.pathname.includes("?"),kw("?","pathname","search",u)),Ar(!u.pathname||!u.pathname.includes("#"),kw("#","pathname","hash",u)),Ar(!u.search||!u.search.includes("#"),kw("#","search","hash",u)));let h=e===""||u.pathname==="",p=h?"/":u.pathname,_;if(i||p==null)_=r;else{let A=t.length-1;if(p.startsWith("..")){let O=p.split("/");for(;O[0]==="..";)O.shift(),A-=1;u.pathname=O.join("/")}_=A>=0?t[A]:"/"}let o=lV(u,_),x=p&&p!=="/"&&p.endsWith("/"),E=(h||p===".")&&r.endsWith("/");return!o.pathname.endsWith("/")&&(x||E)&&(o.pathname+="/"),o}const Qs=e=>e.join("/").replace(/\/\/+/g,"/"),cV=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),hV=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,fV=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class jA{constructor(t,r,i,u){u===void 0&&(u=!1),this.status=t,this.statusText=r||"",this.internal=u,i instanceof Error?(this.data=i.toString(),this.error=i):this.data=i}}function DB(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const LB=["post","put","patch","delete"],dV=new Set(LB),pV=["get",...LB],mV=new Set(pV),gV=new Set([301,302,303,307,308]),yV=new Set([307,308]),Dw={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},_V={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},bm={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},zB=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vV=e=>({hasErrorBoundary:!!e.hasErrorBoundary});function xV(e){const t=e.window?e.window:typeof window<"u"?window:void 0,r=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",i=!r;Ar(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let u;if(e.mapRouteProperties)u=e.mapRouteProperties;else if(e.detectErrorBoundary){let Ke=e.detectErrorBoundary;u=tt=>({hasErrorBoundary:Ke(tt)})}else u=vV;let h={},p=aS(e.routes,u,void 0,h),_,o=e.basename||"/",x=En({v7_normalizeFormMethod:!1,v7_prependBasename:!1},e.future),E=null,A=new Set,O=null,L=null,j=null,F=e.hydrationData!=null,Z=yf(p,e.history.location,o),$=null;if(Z==null){let Ke=Qo(404,{pathname:e.history.location.pathname}),{matches:tt,route:xt}=HI(p);Z=tt,$={[xt.id]:Ke}}let V=!Z.some(Ke=>Ke.route.lazy)&&(!Z.some(Ke=>Ke.route.loader)||e.hydrationData!=null),U,G={historyAction:e.history.action,location:e.history.location,matches:Z,initialized:V,navigation:Dw,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||$,fetchers:new Map,blockers:new Map},q=si.Pop,K=!1,re,pe=!1,xe=!1,ge=[],Be=[],$e=new Map,Ve=0,be=-1,_e=new Map,Me=new Set,ke=new Map,Ce=new Map,Oe=new Map,at=!1;function ft(){return E=e.history.listen(Ke=>{let{action:tt,location:xt,delta:Rt}=Ke;if(at){at=!1;return}Wf(Oe.size===0||Rt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Kt=ws({currentLocation:G.location,nextLocation:xt,historyAction:tt});if(Kt&&Rt!=null){at=!0,e.history.go(Rt*-1),fa(Kt,{state:"blocked",location:xt,proceed(){fa(Kt,{state:"proceeding",proceed:void 0,reset:void 0,location:xt}),e.history.go(Rt)},reset(){let Yt=new Map(G.blockers);Yt.set(Kt,bm),St({blockers:Yt})}});return}return yr(tt,xt)}),G.initialized||yr(si.Pop,G.location),U}function st(){E&&E(),A.clear(),re&&re.abort(),G.fetchers.forEach((Ke,tt)=>$n(tt)),G.blockers.forEach((Ke,tt)=>no(tt))}function Ot(Ke){return A.add(Ke),()=>A.delete(Ke)}function St(Ke){G=En({},G,Ke),A.forEach(tt=>tt(G))}function pr(Ke,tt){var xt,Rt;let Kt=G.actionData!=null&&G.navigation.formMethod!=null&&Fa(G.navigation.formMethod)&&G.navigation.state==="loading"&&((xt=Ke.state)==null?void 0:xt._isRedirect)!==!0,Yt;tt.actionData?Object.keys(tt.actionData).length>0?Yt=tt.actionData:Yt=null:Kt?Yt=G.actionData:Yt=null;let ue=tt.loaderData?ZI(G.loaderData,tt.loaderData,tt.matches||[],tt.errors):G.loaderData,Y=G.blockers;Y.size>0&&(Y=new Map(Y),Y.forEach((he,ve)=>Y.set(ve,bm)));let Q=K===!0||G.navigation.formMethod!=null&&Fa(G.navigation.formMethod)&&((Rt=Ke.state)==null?void 0:Rt._isRedirect)!==!0;_&&(p=_,_=void 0),pe||q===si.Pop||(q===si.Push?e.history.push(Ke,Ke.state):q===si.Replace&&e.history.replace(Ke,Ke.state)),St(En({},tt,{actionData:Yt,loaderData:ue,historyAction:q,location:Ke,initialized:!0,navigation:Dw,revalidation:"idle",restoreScrollPosition:pa(Ke,tt.matches||G.matches),preventScrollReset:Q,blockers:Y})),q=si.Pop,K=!1,pe=!1,xe=!1,ge=[],Be=[]}async function Tr(Ke,tt){if(typeof Ke=="number"){e.history.go(Ke);return}let xt=sS(G.location,G.matches,o,x.v7_prependBasename,Ke,tt==null?void 0:tt.fromRouteId,tt==null?void 0:tt.relative),{path:Rt,submission:Kt,error:Yt}=NI(x.v7_normalizeFormMethod,!1,xt,tt),ue=G.location,Y=bg(G.location,Rt,tt&&tt.state);Y=En({},Y,e.history.encodeLocation(Y));let Q=tt&&tt.replace!=null?tt.replace:void 0,he=si.Push;Q===!0?he=si.Replace:Q===!1||Kt!=null&&Fa(Kt.formMethod)&&Kt.formAction===G.location.pathname+G.location.search&&(he=si.Replace);let ve=tt&&"preventScrollReset"in tt?tt.preventScrollReset===!0:void 0,Te=ws({currentLocation:ue,nextLocation:Y,historyAction:he});if(Te){fa(Te,{state:"blocked",location:Y,proceed(){fa(Te,{state:"proceeding",proceed:void 0,reset:void 0,location:Y}),Tr(Ke,tt)},reset(){let Le=new Map(G.blockers);Le.set(Te,bm),St({blockers:Le})}});return}return await yr(he,Y,{submission:Kt,pendingError:Yt,preventScrollReset:ve,replace:tt&&tt.replace})}function Kr(){if(kr(),St({revalidation:"loading"}),G.navigation.state!=="submitting"){if(G.navigation.state==="idle"){yr(G.historyAction,G.location,{startUninterruptedRevalidation:!0});return}yr(q||G.historyAction,G.navigation.location,{overrideNavigation:G.navigation})}}async function yr(Ke,tt,xt){re&&re.abort(),re=null,q=Ke,pe=(xt&&xt.startUninterruptedRevalidation)===!0,da(G.location,G.matches),K=(xt&&xt.preventScrollReset)===!0;let Rt=_||p,Kt=xt&&xt.overrideNavigation,Yt=yf(Rt,tt,o);if(!Yt){let Le=Qo(404,{pathname:tt.pathname}),{matches:Re,route:Ie}=HI(Rt);di(),pr(tt,{matches:Re,loaderData:{},errors:{[Ie.id]:Le}});return}if(G.initialized&&!xe&&EV(G.location,tt)&&!(xt&&xt.submission&&Fa(xt.submission.formMethod))){pr(tt,{matches:Yt});return}re=new AbortController;let ue=Tm(e.history,tt,re.signal,xt&&xt.submission),Y,Q;if(xt&&xt.pendingError)Q={[_f(Yt).route.id]:xt.pendingError};else if(xt&&xt.submission&&Fa(xt.submission.formMethod)){let Le=await kt(ue,tt,xt.submission,Yt,{replace:xt.replace});if(Le.shortCircuited)return;Y=Le.pendingActionData,Q=Le.pendingActionError,Kt=uv(tt,xt.submission),ue=new Request(ue.url,{signal:ue.signal})}let{shortCircuited:he,loaderData:ve,errors:Te}=await Xt(ue,tt,Yt,Kt,xt&&xt.submission,xt&&xt.fetcherSubmission,xt&&xt.replace,Y,Q);he||(re=null,pr(tt,En({matches:Yt},Y?{actionData:Y}:{},{loaderData:ve,errors:Te})))}async function kt(Ke,tt,xt,Rt,Kt){Kt===void 0&&(Kt={}),kr();let Yt=OV(tt,xt);St({navigation:Yt});let ue,Y=uS(Rt,tt);if(!Y.route.action&&!Y.route.lazy)ue={type:Gn.error,error:Qo(405,{method:Ke.method,pathname:tt.pathname,routeId:Y.route.id})};else if(ue=await wm("action",Ke,Y,Rt,h,u,o),Ke.signal.aborted)return{shortCircuited:!0};if(Cf(ue)){let Q;return Kt&&Kt.replace!=null?Q=Kt.replace:Q=ue.location===G.location.pathname+G.location.search,await Ir(G,ue,{submission:xt,replace:Q}),{shortCircuited:!0}}if(Jm(ue)){let Q=_f(Rt,Y.route.id);return(Kt&&Kt.replace)!==!0&&(q=si.Push),{pendingActionData:{},pendingActionError:{[Q.route.id]:ue.error}}}if(xc(ue))throw Qo(400,{type:"defer-action"});return{pendingActionData:{[Y.route.id]:ue.data}}}async function Xt(Ke,tt,xt,Rt,Kt,Yt,ue,Y,Q){let he=Rt||uv(tt,Kt),ve=Kt||Yt||YI(he),Te=_||p,[Le,Re]=UI(e.history,G,xt,ve,tt,xe,ge,Be,ke,Me,Te,o,Y,Q);if(di(qt=>!(xt&&xt.some(Mr=>Mr.route.id===qt))||Le&&Le.some(Mr=>Mr.route.id===qt)),be=++Ve,Le.length===0&&Re.length===0){let qt=ri();return pr(tt,En({matches:xt,loaderData:{},errors:Q||null},Y?{actionData:Y}:{},qt?{fetchers:new Map(G.fetchers)}:{})),{shortCircuited:!0}}if(!pe){Re.forEach(Mr=>{let un=G.fetchers.get(Mr.key),fn=Sm(void 0,un?un.data:void 0);G.fetchers.set(Mr.key,fn)});let qt=Y||G.actionData;St(En({navigation:he},qt?Object.keys(qt).length===0?{actionData:null}:{actionData:qt}:{},Re.length>0?{fetchers:new Map(G.fetchers)}:{}))}Re.forEach(qt=>{$e.has(qt.key)&&tn(qt.key),qt.controller&&$e.set(qt.key,qt.controller)});let Ie=()=>Re.forEach(qt=>tn(qt.key));re&&re.signal.addEventListener("abort",Ie);let{results:qe,loaderResults:yt,fetcherResults:wt}=await ir(G.matches,xt,Le,Re,Ke);if(Ke.signal.aborted)return{shortCircuited:!0};re&&re.signal.removeEventListener("abort",Ie),Re.forEach(qt=>$e.delete(qt.key));let ct=XI(qe);if(ct){if(ct.idx>=Le.length){let qt=Re[ct.idx-Le.length].key;Me.add(qt)}return await Ir(G,ct.result,{replace:ue}),{shortCircuited:!0}}let{loaderData:Wt,errors:er}=qI(G,xt,Le,yt,Q,Re,wt,Ce);Ce.forEach((qt,Mr)=>{qt.subscribe(un=>{(un||qt.done)&&Ce.delete(Mr)})});let Zt=ri(),or=ro(be),ur=Zt||or||Re.length>0;return En({loaderData:Wt,errors:er},ur?{fetchers:new Map(G.fetchers)}:{})}function Jt(Ke){return G.fetchers.get(Ke)||_V}function et(Ke,tt,xt,Rt){if(i)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");$e.has(Ke)&&tn(Ke);let Kt=_||p,Yt=sS(G.location,G.matches,o,x.v7_prependBasename,xt,tt,Rt==null?void 0:Rt.relative),ue=yf(Kt,Yt,o);if(!ue){qn(Ke,tt,Qo(404,{pathname:Yt}));return}let{path:Y,submission:Q,error:he}=NI(x.v7_normalizeFormMethod,!0,Yt,Rt);if(he){qn(Ke,tt,he);return}let ve=uS(ue,Y);if(K=(Rt&&Rt.preventScrollReset)===!0,Q&&Fa(Q.formMethod)){Or(Ke,tt,Y,ve,ue,Q);return}ke.set(Ke,{routeId:tt,path:Y}),Qt(Ke,tt,Y,ve,ue,Q)}async function Or(Ke,tt,xt,Rt,Kt,Yt){if(kr(),ke.delete(Ke),!Rt.route.action&&!Rt.route.lazy){let Lr=Qo(405,{method:Yt.formMethod,pathname:xt,routeId:tt});qn(Ke,tt,Lr);return}let ue=G.fetchers.get(Ke),Y=IV(Yt,ue);G.fetchers.set(Ke,Y),St({fetchers:new Map(G.fetchers)});let Q=new AbortController,he=Tm(e.history,xt,Q.signal,Yt);$e.set(Ke,Q);let ve=Ve,Te=await wm("action",he,Rt,Kt,h,u,o);if(he.signal.aborted){$e.get(Ke)===Q&&$e.delete(Ke);return}if(Cf(Te))if($e.delete(Ke),be>ve){let Lr=nf(void 0);G.fetchers.set(Ke,Lr),St({fetchers:new Map(G.fetchers)});return}else{Me.add(Ke);let Lr=Sm(Yt);return G.fetchers.set(Ke,Lr),St({fetchers:new Map(G.fetchers)}),Ir(G,Te,{submission:Yt,isFetchActionRedirect:!0})}if(Jm(Te)){qn(Ke,tt,Te.error);return}if(xc(Te))throw Qo(400,{type:"defer-action"});let Le=G.navigation.location||G.location,Re=Tm(e.history,Le,Q.signal),Ie=_||p,qe=G.navigation.state!=="idle"?yf(Ie,G.navigation.location,o):G.matches;Ar(qe,"Didn't find any matches after fetcher action");let yt=++Ve;_e.set(Ke,yt);let wt=Sm(Yt,Te.data);G.fetchers.set(Ke,wt);let[ct,Wt]=UI(e.history,G,qe,Yt,Le,xe,ge,Be,ke,Me,Ie,o,{[Rt.route.id]:Te.data},void 0);Wt.filter(Lr=>Lr.key!==Ke).forEach(Lr=>{let dn=Lr.key,Zn=G.fetchers.get(dn),Ja=Sm(void 0,Zn?Zn.data:void 0);G.fetchers.set(dn,Ja),$e.has(dn)&&tn(dn),Lr.controller&&$e.set(dn,Lr.controller)}),St({fetchers:new Map(G.fetchers)});let er=()=>Wt.forEach(Lr=>tn(Lr.key));Q.signal.addEventListener("abort",er);let{results:Zt,loaderResults:or,fetcherResults:ur}=await ir(G.matches,qe,ct,Wt,Re);if(Q.signal.aborted)return;Q.signal.removeEventListener("abort",er),_e.delete(Ke),$e.delete(Ke),Wt.forEach(Lr=>$e.delete(Lr.key));let qt=XI(Zt);if(qt){if(qt.idx>=ct.length){let Lr=Wt[qt.idx-ct.length].key;Me.add(Lr)}return Ir(G,qt.result)}let{loaderData:Mr,errors:un}=qI(G,G.matches,ct,or,void 0,Wt,ur,Ce);if(G.fetchers.has(Ke)){let Lr=nf(Te.data);G.fetchers.set(Ke,Lr)}let fn=ro(yt);G.navigation.state==="loading"&&yt>be?(Ar(q,"Expected pending action"),re&&re.abort(),pr(G.navigation.location,{matches:qe,loaderData:Mr,errors:un,fetchers:new Map(G.fetchers)})):(St(En({errors:un,loaderData:ZI(G.loaderData,Mr,qe,un)},fn||Wt.length>0?{fetchers:new Map(G.fetchers)}:{})),xe=!1)}async function Qt(Ke,tt,xt,Rt,Kt,Yt){let ue=G.fetchers.get(Ke),Y=Sm(Yt,ue?ue.data:void 0);G.fetchers.set(Ke,Y),St({fetchers:new Map(G.fetchers)});let Q=new AbortController,he=Tm(e.history,xt,Q.signal);$e.set(Ke,Q);let ve=Ve,Te=await wm("loader",he,Rt,Kt,h,u,o);if(xc(Te)&&(Te=await jB(Te,he.signal,!0)||Te),$e.get(Ke)===Q&&$e.delete(Ke),he.signal.aborted)return;if(Cf(Te))if(be>ve){let Re=nf(void 0);G.fetchers.set(Ke,Re),St({fetchers:new Map(G.fetchers)});return}else{Me.add(Ke),await Ir(G,Te);return}if(Jm(Te)){let Re=_f(G.matches,tt);G.fetchers.delete(Ke),St({fetchers:new Map(G.fetchers),errors:{[Re.route.id]:Te.error}});return}Ar(!xc(Te),"Unhandled fetcher deferred data");let Le=nf(Te.data);G.fetchers.set(Ke,Le),St({fetchers:new Map(G.fetchers)})}async function Ir(Ke,tt,xt){let{submission:Rt,replace:Kt,isFetchActionRedirect:Yt}=xt===void 0?{}:xt;tt.revalidate&&(xe=!0);let ue=bg(Ke.location,tt.location,En({_isRedirect:!0},Yt?{_isFetchActionRedirect:!0}:{}));if(Ar(ue,"Expected a location on the redirect navigation"),r){let he=!1;if(tt.reloadDocument)he=!0;else if(zB.test(tt.location)){const ve=e.history.createURL(tt.location);he=ve.origin!==t.location.origin||xd(ve.pathname,o)==null}if(he){Kt?t.location.replace(tt.location):t.location.assign(tt.location);return}}re=null;let Y=Kt===!0?si.Replace:si.Push,Q=Rt||YI(Ke.navigation);if(yV.has(tt.status)&&Q&&Fa(Q.formMethod))await yr(Y,ue,{submission:En({},Q,{formAction:tt.location}),preventScrollReset:K});else if(Yt)await yr(Y,ue,{overrideNavigation:uv(ue),fetcherSubmission:Q,preventScrollReset:K});else{let he=uv(ue,Q);await yr(Y,ue,{overrideNavigation:he,preventScrollReset:K})}}async function ir(Ke,tt,xt,Rt,Kt){let Yt=await Promise.all([...xt.map(Q=>wm("loader",Kt,Q,tt,h,u,o)),...Rt.map(Q=>Q.matches&&Q.match&&Q.controller?wm("loader",Tm(e.history,Q.path,Q.controller.signal),Q.match,Q.matches,h,u,o):{type:Gn.error,error:Qo(404,{pathname:Q.path})})]),ue=Yt.slice(0,xt.length),Y=Yt.slice(xt.length);return await Promise.all([KI(Ke,xt,ue,ue.map(()=>Kt.signal),!1,G.loaderData),KI(Ke,Rt.map(Q=>Q.match),Y,Rt.map(Q=>Q.controller?Q.controller.signal:null),!0)]),{results:Yt,loaderResults:ue,fetcherResults:Y}}function kr(){xe=!0,ge.push(...di()),ke.forEach((Ke,tt)=>{$e.has(tt)&&(Be.push(tt),tn(tt))})}function qn(Ke,tt,xt){let Rt=_f(G.matches,tt);$n(Ke),St({errors:{[Rt.route.id]:xt},fetchers:new Map(G.fetchers)})}function $n(Ke){let tt=G.fetchers.get(Ke);$e.has(Ke)&&!(tt&&tt.state==="loading"&&_e.has(Ke))&&tn(Ke),ke.delete(Ke),_e.delete(Ke),Me.delete(Ke),G.fetchers.delete(Ke)}function tn(Ke){let tt=$e.get(Ke);Ar(tt,"Expected fetch controller: "+Ke),tt.abort(),$e.delete(Ke)}function fi(Ke){for(let tt of Ke){let xt=Jt(tt),Rt=nf(xt.data);G.fetchers.set(tt,Rt)}}function ri(){let Ke=[],tt=!1;for(let xt of Me){let Rt=G.fetchers.get(xt);Ar(Rt,"Expected fetcher: "+xt),Rt.state==="loading"&&(Me.delete(xt),Ke.push(xt),tt=!0)}return fi(Ke),tt}function ro(Ke){let tt=[];for(let[xt,Rt]of _e)if(Rt<Ke){let Kt=G.fetchers.get(xt);Ar(Kt,"Expected fetcher: "+xt),Kt.state==="loading"&&(tn(xt),_e.delete(xt),tt.push(xt))}return fi(tt),tt.length>0}function Wi(Ke,tt){let xt=G.blockers.get(Ke)||bm;return Oe.get(Ke)!==tt&&Oe.set(Ke,tt),xt}function no(Ke){G.blockers.delete(Ke),Oe.delete(Ke)}function fa(Ke,tt){let xt=G.blockers.get(Ke)||bm;Ar(xt.state==="unblocked"&&tt.state==="blocked"||xt.state==="blocked"&&tt.state==="blocked"||xt.state==="blocked"&&tt.state==="proceeding"||xt.state==="blocked"&&tt.state==="unblocked"||xt.state==="proceeding"&&tt.state==="unblocked","Invalid blocker state transition: "+xt.state+" -> "+tt.state);let Rt=new Map(G.blockers);Rt.set(Ke,tt),St({blockers:Rt})}function ws(Ke){let{currentLocation:tt,nextLocation:xt,historyAction:Rt}=Ke;if(Oe.size===0)return;Oe.size>1&&Wf(!1,"A router only supports one blocker at a time");let Kt=Array.from(Oe.entries()),[Yt,ue]=Kt[Kt.length-1],Y=G.blockers.get(Yt);if(!(Y&&Y.state==="proceeding")&&ue({currentLocation:tt,nextLocation:xt,historyAction:Rt}))return Yt}function di(Ke){let tt=[];return Ce.forEach((xt,Rt)=>{(!Ke||Ke(Rt))&&(xt.cancel(),tt.push(Rt),Ce.delete(Rt))}),tt}function jo(Ke,tt,xt){if(O=Ke,j=tt,L=xt||null,!F&&G.navigation===Dw){F=!0;let Rt=pa(G.location,G.matches);Rt!=null&&St({restoreScrollPosition:Rt})}return()=>{O=null,j=null,L=null}}function Ya(Ke,tt){return L&&L(Ke,tt.map(Rt=>CV(Rt,G.loaderData)))||Ke.key}function da(Ke,tt){if(O&&j){let xt=Ya(Ke,tt);O[xt]=j()}}function pa(Ke,tt){if(O){let xt=Ya(Ke,tt),Rt=O[xt];if(typeof Rt=="number")return Rt}return null}function Ts(Ke){h={},_=aS(Ke,u,void 0,h)}return U={get basename(){return o},get state(){return G},get routes(){return p},initialize:ft,subscribe:Ot,enableScrollRestoration:jo,navigate:Tr,fetch:et,revalidate:Kr,createHref:Ke=>e.history.createHref(Ke),encodeLocation:Ke=>e.history.encodeLocation(Ke),getFetcher:Jt,deleteFetcher:$n,dispose:st,getBlocker:Wi,deleteBlocker:no,_internalFetchControllers:$e,_internalActiveDeferreds:Ce,_internalSetRoutes:Ts},U}function bV(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function sS(e,t,r,i,u,h,p){let _,o;if(h!=null&&p!=="path"){_=[];for(let E of t)if(_.push(E),E.route.id===h){o=E;break}}else _=t,o=t[t.length-1];let x=BA(u||".",Lx(_).map(E=>E.pathnameBase),xd(e.pathname,r)||e.pathname,p==="path");return u==null&&(x.search=e.search,x.hash=e.hash),(u==null||u===""||u===".")&&o&&o.route.index&&!FA(x.search)&&(x.search=x.search?x.search.replace(/^\?/,"?index&"):"?index"),i&&r!=="/"&&(x.pathname=x.pathname==="/"?r:Qs([r,x.pathname])),Rc(x)}function NI(e,t,r,i){if(!i||!bV(i))return{path:r};if(i.formMethod&&!MV(i.formMethod))return{path:r,error:Qo(405,{method:i.formMethod})};let u=()=>({path:r,error:Qo(400,{type:"invalid-body"})}),h=i.formMethod||"get",p=e?h.toUpperCase():h.toLowerCase(),_=BB(r);if(i.body!==void 0){if(i.formEncType==="text/plain"){if(!Fa(p))return u();let O=typeof i.body=="string"?i.body:i.body instanceof FormData||i.body instanceof URLSearchParams?Array.from(i.body.entries()).reduce((L,j)=>{let[F,Z]=j;return""+L+F+"="+Z+`
`},""):String(i.body);return{path:r,submission:{formMethod:p,formAction:_,formEncType:i.formEncType,formData:void 0,json:void 0,text:O}}}else if(i.formEncType==="application/json"){if(!Fa(p))return u();try{let O=typeof i.body=="string"?JSON.parse(i.body):i.body;return{path:r,submission:{formMethod:p,formAction:_,formEncType:i.formEncType,formData:void 0,json:O,text:void 0}}}catch{return u()}}}Ar(typeof FormData=="function","FormData is not available in this environment");let o,x;if(i.formData)o=lS(i.formData),x=i.formData;else if(i.body instanceof FormData)o=lS(i.body),x=i.body;else if(i.body instanceof URLSearchParams)o=i.body,x=WI(o);else if(i.body==null)o=new URLSearchParams,x=new FormData;else try{o=new URLSearchParams(i.body),x=WI(o)}catch{return u()}let E={formMethod:p,formAction:_,formEncType:i&&i.formEncType||"application/x-www-form-urlencoded",formData:x,json:void 0,text:void 0};if(Fa(E.formMethod))return{path:r,submission:E};let A=_u(r);return t&&A.search&&FA(A.search)&&o.append("index",""),A.search="?"+o,{path:Rc(A),submission:E}}function wV(e,t){let r=e;if(t){let i=e.findIndex(u=>u.route.id===t);i>=0&&(r=e.slice(0,i))}return r}function UI(e,t,r,i,u,h,p,_,o,x,E,A,O,L){let j=L?Object.values(L)[0]:O?Object.values(O)[0]:void 0,F=e.createURL(t.location),Z=e.createURL(u),$=L?Object.keys(L)[0]:void 0,U=wV(r,$).filter((q,K)=>{if(q.route.lazy)return!0;if(q.route.loader==null)return!1;if(TV(t.loaderData,t.matches[K],q)||p.some(xe=>xe===q.route.id))return!0;let re=t.matches[K],pe=q;return VI(q,En({currentUrl:F,currentParams:re.params,nextUrl:Z,nextParams:pe.params},i,{actionResult:j,defaultShouldRevalidate:h||F.pathname+F.search===Z.pathname+Z.search||F.search!==Z.search||RB(re,pe)}))}),G=[];return o.forEach((q,K)=>{if(!r.some(Be=>Be.route.id===q.routeId))return;let re=yf(E,q.path,A);if(!re){G.push({key:K,routeId:q.routeId,path:q.path,matches:null,match:null,controller:null});return}let pe=t.fetchers.get(K),xe=uS(re,q.path),ge=!1;x.has(K)?ge=!1:_.includes(K)?ge=!0:pe&&pe.state!=="idle"&&pe.data===void 0?ge=h:ge=VI(xe,En({currentUrl:F,currentParams:t.matches[t.matches.length-1].params,nextUrl:Z,nextParams:r[r.length-1].params},i,{actionResult:j,defaultShouldRevalidate:h})),ge&&G.push({key:K,routeId:q.routeId,path:q.path,matches:re,match:xe,controller:new AbortController})}),[U,G]}function TV(e,t,r){let i=!t||r.route.id!==t.route.id,u=e[r.route.id]===void 0;return i||u}function RB(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function VI(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}async function GI(e,t,r){if(!e.lazy)return;let i=await e.lazy();if(!e.lazy)return;let u=r[e.id];Ar(u,"No route found in manifest");let h={};for(let p in i){let o=u[p]!==void 0&&p!=="hasErrorBoundary";Wf(!o,'Route "'+u.id+'" has a static property "'+p+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+p+'" will be ignored.')),!o&&!q8.has(p)&&(h[p]=i[p])}Object.assign(u,h),Object.assign(u,En({},t(u),{lazy:void 0}))}async function wm(e,t,r,i,u,h,p,_){_===void 0&&(_={});let o,x,E,A=j=>{let F,Z=new Promise(($,V)=>F=V);return E=()=>F(),t.signal.addEventListener("abort",E),Promise.race([j({request:t,params:r.params,context:_.requestContext}),Z])};try{let j=r.route[e];if(r.route.lazy)if(j)x=(await Promise.all([A(j),GI(r.route,h,u)]))[0];else if(await GI(r.route,h,u),j=r.route[e],j)x=await A(j);else if(e==="action"){let F=new URL(t.url),Z=F.pathname+F.search;throw Qo(405,{method:t.method,pathname:Z,routeId:r.route.id})}else return{type:Gn.data,data:void 0};else if(j)x=await A(j);else{let F=new URL(t.url),Z=F.pathname+F.search;throw Qo(404,{pathname:Z})}Ar(x!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(j){o=Gn.error,x=j}finally{E&&t.signal.removeEventListener("abort",E)}if(PV(x)){let j=x.status;if(gV.has(j)){let $=x.headers.get("Location");if(Ar($,"Redirects returned/thrown from loaders/actions must have a Location header"),!zB.test($))$=sS(new URL(t.url),i.slice(0,i.indexOf(r)+1),p,!0,$);else if(!_.isStaticRequest){let V=new URL(t.url),U=$.startsWith("//")?new URL(V.protocol+$):new URL($),G=xd(U.pathname,p)!=null;U.origin===V.origin&&G&&($=U.pathname+U.search+U.hash)}if(_.isStaticRequest)throw x.headers.set("Location",$),x;return{type:Gn.redirect,status:j,location:$,revalidate:x.headers.get("X-Remix-Revalidate")!==null,reloadDocument:x.headers.get("X-Remix-Reload-Document")!==null}}if(_.isRouteRequest)throw{type:o===Gn.error?Gn.error:Gn.data,response:x};let F,Z=x.headers.get("Content-Type");return Z&&/\bapplication\/json\b/.test(Z)?F=await x.json():F=await x.text(),o===Gn.error?{type:o,error:new jA(j,x.statusText,F),headers:x.headers}:{type:Gn.data,data:F,statusCode:x.status,headers:x.headers}}if(o===Gn.error)return{type:o,error:x};if(AV(x)){var O,L;return{type:Gn.deferred,deferredData:x,statusCode:(O=x.init)==null?void 0:O.status,headers:((L=x.init)==null?void 0:L.headers)&&new Headers(x.init.headers)}}return{type:Gn.data,data:x}}function Tm(e,t,r,i){let u=e.createURL(BB(t)).toString(),h={signal:r};if(i&&Fa(i.formMethod)){let{formMethod:p,formEncType:_}=i;h.method=p.toUpperCase(),_==="application/json"?(h.headers=new Headers({"Content-Type":_}),h.body=JSON.stringify(i.json)):_==="text/plain"?h.body=i.text:_==="application/x-www-form-urlencoded"&&i.formData?h.body=lS(i.formData):h.body=i.formData}return new Request(u,h)}function lS(e){let t=new URLSearchParams;for(let[r,i]of e.entries())t.append(r,typeof i=="string"?i:i.name);return t}function WI(e){let t=new FormData;for(let[r,i]of e.entries())t.append(r,i);return t}function SV(e,t,r,i,u){let h={},p=null,_,o=!1,x={};return r.forEach((E,A)=>{let O=t[A].route.id;if(Ar(!Cf(E),"Cannot handle redirect results in processLoaderData"),Jm(E)){let L=_f(e,O),j=E.error;i&&(j=Object.values(i)[0],i=void 0),p=p||{},p[L.route.id]==null&&(p[L.route.id]=j),h[O]=void 0,o||(o=!0,_=DB(E.error)?E.error.status:500),E.headers&&(x[O]=E.headers)}else xc(E)?(u.set(O,E.deferredData),h[O]=E.deferredData.data):h[O]=E.data,E.statusCode!=null&&E.statusCode!==200&&!o&&(_=E.statusCode),E.headers&&(x[O]=E.headers)}),i&&(p=i,h[Object.keys(i)[0]]=void 0),{loaderData:h,errors:p,statusCode:_||200,loaderHeaders:x}}function qI(e,t,r,i,u,h,p,_){let{loaderData:o,errors:x}=SV(t,r,i,u,_);for(let E=0;E<h.length;E++){let{key:A,match:O,controller:L}=h[E];Ar(p!==void 0&&p[E]!==void 0,"Did not find corresponding fetcher result");let j=p[E];if(!(L&&L.signal.aborted))if(Jm(j)){let F=_f(e.matches,O==null?void 0:O.route.id);x&&x[F.route.id]||(x=En({},x,{[F.route.id]:j.error})),e.fetchers.delete(A)}else if(Cf(j))Ar(!1,"Unhandled fetcher revalidation redirect");else if(xc(j))Ar(!1,"Unhandled fetcher deferred data");else{let F=nf(j.data);e.fetchers.set(A,F)}}return{loaderData:o,errors:x}}function ZI(e,t,r,i){let u=En({},t);for(let h of r){let p=h.route.id;if(t.hasOwnProperty(p)?t[p]!==void 0&&(u[p]=t[p]):e[p]!==void 0&&h.route.loader&&(u[p]=e[p]),i&&i.hasOwnProperty(p))break}return u}function _f(e,t){return(t?e.slice(0,e.findIndex(i=>i.route.id===t)+1):[...e]).reverse().find(i=>i.route.hasErrorBoundary===!0)||e[0]}function HI(e){let t=e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Qo(e,t){let{pathname:r,routeId:i,method:u,type:h}=t===void 0?{}:t,p="Unknown Server Error",_="Unknown @remix-run/router error";return e===400?(p="Bad Request",u&&r&&i?_="You made a "+u+' request to "'+r+'" but '+('did not provide a `loader` for route "'+i+'", ')+"so there is no way to handle the request.":h==="defer-action"?_="defer() is not supported in actions":h==="invalid-body"&&(_="Unable to encode submission body")):e===403?(p="Forbidden",_='Route "'+i+'" does not match URL "'+r+'"'):e===404?(p="Not Found",_='No route matches URL "'+r+'"'):e===405&&(p="Method Not Allowed",u&&r&&i?_="You made a "+u.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+i+'", ')+"so there is no way to handle the request.":u&&(_='Invalid request method "'+u.toUpperCase()+'"')),new jA(e||500,p,new Error(_),!0)}function XI(e){for(let t=e.length-1;t>=0;t--){let r=e[t];if(Cf(r))return{result:r,idx:t}}}function BB(e){let t=typeof e=="string"?_u(e):e;return Rc(En({},t,{hash:""}))}function EV(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function xc(e){return e.type===Gn.deferred}function Jm(e){return e.type===Gn.error}function Cf(e){return(e&&e.type)===Gn.redirect}function AV(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function PV(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function MV(e){return mV.has(e.toLowerCase())}function Fa(e){return dV.has(e.toLowerCase())}async function KI(e,t,r,i,u,h){for(let p=0;p<r.length;p++){let _=r[p],o=t[p];if(!o)continue;let x=e.find(A=>A.route.id===o.route.id),E=x!=null&&!RB(x,o)&&(h&&h[o.route.id])!==void 0;if(xc(_)&&(u||E)){let A=i[p];Ar(A,"Expected an AbortSignal for revalidating fetcher deferred result"),await jB(_,A,u).then(O=>{O&&(r[p]=O||r[p])})}}}async function jB(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:Gn.data,data:e.deferredData.unwrappedData}}catch(u){return{type:Gn.error,error:u}}return{type:Gn.data,data:e.deferredData.data}}}function FA(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function CV(e,t){let{route:r,pathname:i,params:u}=e;return{id:r.id,pathname:i,params:u,data:t[r.id],handle:r.handle}}function uS(e,t){let r=typeof t=="string"?_u(t).search:t.search;if(e[e.length-1].route.index&&FA(r||""))return e[e.length-1];let i=Lx(e);return i[i.length-1]}function YI(e){let{formMethod:t,formAction:r,formEncType:i,text:u,formData:h,json:p}=e;if(!(!t||!r||!i)){if(u!=null)return{formMethod:t,formAction:r,formEncType:i,formData:void 0,json:void 0,text:u};if(h!=null)return{formMethod:t,formAction:r,formEncType:i,formData:h,json:void 0,text:void 0};if(p!==void 0)return{formMethod:t,formAction:r,formEncType:i,formData:void 0,json:p,text:void 0}}}function uv(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function OV(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Sm(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t," _hasFetcherDoneAnything ":!0}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t," _hasFetcherDoneAnything ":!0}}function IV(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0," _hasFetcherDoneAnything ":!0}}function nf(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e," _hasFetcherDoneAnything ":!0}}/**
 * React Router v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cS(){return cS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},cS.apply(this,arguments)}const zx=De.createContext(null),FB=De.createContext(null),bd=De.createContext(null),$A=De.createContext(null),Vc=De.createContext({outlet:null,matches:[],isDataRoute:!1}),$B=De.createContext(null);function kV(e,t){let{relative:r}=t===void 0?{}:t;cy()||Ar(!1);let{basename:i,navigator:u}=De.useContext(bd),{hash:h,pathname:p,search:_}=UB(e,{relative:r}),o=p;return i!=="/"&&(o=p==="/"?i:Qs([i,p])),u.createHref({pathname:o,search:_,hash:h})}function cy(){return De.useContext($A)!=null}function Rx(){return cy()||Ar(!1),De.useContext($A).location}function NB(e){De.useContext(bd).static||De.useLayoutEffect(e)}function DV(){let{isDataRoute:e}=De.useContext(Vc);return e?WV():LV()}function LV(){cy()||Ar(!1);let e=De.useContext(zx),{basename:t,navigator:r}=De.useContext(bd),{matches:i}=De.useContext(Vc),{pathname:u}=Rx(),h=JSON.stringify(Lx(i).map(o=>o.pathnameBase)),p=De.useRef(!1);return NB(()=>{p.current=!0}),De.useCallback(function(o,x){if(x===void 0&&(x={}),!p.current)return;if(typeof o=="number"){r.go(o);return}let E=BA(o,JSON.parse(h),u,x.relative==="path");e==null&&t!=="/"&&(E.pathname=E.pathname==="/"?t:Qs([t,E.pathname])),(x.replace?r.replace:r.push)(E,x.state,x)},[t,r,h,u,e])}function UB(e,t){let{relative:r}=t===void 0?{}:t,{matches:i}=De.useContext(Vc),{pathname:u}=Rx(),h=JSON.stringify(Lx(i).map(p=>p.pathnameBase));return De.useMemo(()=>BA(e,JSON.parse(h),u,r==="path"),[e,h,u,r])}function zV(e,t,r){cy()||Ar(!1);let{navigator:i}=De.useContext(bd),{matches:u}=De.useContext(Vc),h=u[u.length-1],p=h?h.params:{};h&&h.pathname;let _=h?h.pathnameBase:"/";h&&h.route;let o=Rx(),x;x=o;let E=x.pathname||"/",A=_==="/"?E:E.slice(_.length)||"/",O=yf(e,{pathname:A});return $V(O&&O.map(j=>Object.assign({},j,{params:Object.assign({},p,j.params),pathname:Qs([_,i.encodeLocation?i.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?_:Qs([_,i.encodeLocation?i.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),u,r)}function RV(){let e=GV(),t=DB(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,u={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return De.createElement(De.Fragment,null,De.createElement("h2",null,"Unexpected Application Error!"),De.createElement("h3",{style:{fontStyle:"italic"}},t),r?De.createElement("pre",{style:u},r):null,null)}const BV=De.createElement(RV,null);class jV extends De.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?De.createElement(Vc.Provider,{value:this.props.routeContext},De.createElement($B.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function FV(e){let{routeContext:t,match:r,children:i}=e,u=De.useContext(zx);return u&&u.static&&u.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(u.staticContext._deepestRenderedBoundaryId=r.route.id),De.createElement(Vc.Provider,{value:t},i)}function $V(e,t,r){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var u;if((u=r)!=null&&u.errors)e=r.matches;else return null}let h=e,p=(i=r)==null?void 0:i.errors;if(p!=null){let _=h.findIndex(o=>o.route.id&&(p==null?void 0:p[o.route.id]));_>=0||Ar(!1),h=h.slice(0,Math.min(h.length,_+1))}return h.reduceRight((_,o,x)=>{let E=o.route.id?p==null?void 0:p[o.route.id]:null,A=null;r&&(A=o.route.errorElement||BV);let O=t.concat(h.slice(0,x+1)),L=()=>{let j;return E?j=A:o.route.Component?j=De.createElement(o.route.Component,null):o.route.element?j=o.route.element:j=_,De.createElement(FV,{match:o,routeContext:{outlet:_,matches:O,isDataRoute:r!=null},children:j})};return r&&(o.route.ErrorBoundary||o.route.errorElement||x===0)?De.createElement(jV,{location:r.location,revalidation:r.revalidation,component:A,error:E,children:L(),routeContext:{outlet:null,matches:O,isDataRoute:!0}}):L()},null)}var VB=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(VB||{}),GB=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(GB||{});function NV(e){let t=De.useContext(zx);return t||Ar(!1),t}function UV(e){let t=De.useContext(FB);return t||Ar(!1),t}function VV(e){let t=De.useContext(Vc);return t||Ar(!1),t}function WB(e){let t=VV(),r=t.matches[t.matches.length-1];return r.route.id||Ar(!1),r.route.id}function GV(){var e;let t=De.useContext($B),r=UV(GB.UseRouteError),i=WB();return t||((e=r.errors)==null?void 0:e[i])}function WV(){let{router:e}=NV(VB.UseNavigateStable),t=WB(),r=De.useRef(!1);return NB(()=>{r.current=!0}),De.useCallback(function(u,h){h===void 0&&(h={}),r.current&&(typeof u=="number"?e.navigate(u):e.navigate(u,cS({fromRouteId:t},h)))},[e,t])}const qV="startTransition",JI=DU[qV];function Dge(e){let{fallbackElement:t,router:r,future:i}=e,[u,h]=De.useState(r.state),{v7_startTransition:p}=i||{},_=De.useCallback(A=>{p&&JI?JI(()=>h(A)):h(A)},[h,p]);De.useLayoutEffect(()=>r.subscribe(_),[r,_]);let o=De.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:A=>r.navigate(A),push:(A,O,L)=>r.navigate(A,{state:O,preventScrollReset:L==null?void 0:L.preventScrollReset}),replace:(A,O,L)=>r.navigate(A,{replace:!0,state:O,preventScrollReset:L==null?void 0:L.preventScrollReset})}),[r]),x=r.basename||"/",E=De.useMemo(()=>({router:r,navigator:o,static:!1,basename:x}),[r,o,x]);return De.createElement(De.Fragment,null,De.createElement(zx.Provider,{value:E},De.createElement(FB.Provider,{value:u},De.createElement(HV,{basename:x,location:u.location,navigationType:u.historyAction,navigator:o},u.initialized?De.createElement(ZV,{routes:r.routes,state:u}):t))),null)}function ZV(e){let{routes:t,state:r}=e;return zV(t,void 0,r)}function HV(e){let{basename:t="/",children:r=null,location:i,navigationType:u=si.Pop,navigator:h,static:p=!1}=e;cy()&&Ar(!1);let _=t.replace(/^\/*/,"/"),o=De.useMemo(()=>({basename:_,navigator:h,static:p}),[_,h,p]);typeof i=="string"&&(i=_u(i));let{pathname:x="/",search:E="",hash:A="",state:O=null,key:L="default"}=i,j=De.useMemo(()=>{let F=xd(x,_);return F==null?null:{location:{pathname:F,search:E,hash:A,state:O,key:L},navigationType:u}},[_,x,E,A,O,L,u]);return j==null?null:De.createElement(bd.Provider,{value:o},De.createElement($A.Provider,{children:r,value:j}))}new Promise(()=>{});function XV(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:De.createElement(e.Component),Component:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:De.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wg(){return wg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},wg.apply(this,arguments)}function KV(e,t){if(e==null)return{};var r={},i=Object.keys(e),u,h;for(h=0;h<i.length;h++)u=i[h],!(t.indexOf(u)>=0)&&(r[u]=e[u]);return r}function YV(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function JV(e,t){return e.button===0&&(!t||t==="_self")&&!YV(e)}const QV=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function Lge(e,t){return xV({basename:t==null?void 0:t.basename,future:wg({},t==null?void 0:t.future,{v7_prependBasename:!0}),history:V8({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||eG(),routes:e,mapRouteProperties:XV}).initialize()}function eG(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=wg({},t,{errors:tG(t.errors)})),t}function tG(e){if(!e)return null;let t=Object.entries(e),r={};for(let[i,u]of t)if(u&&u.__type==="RouteErrorResponse")r[i]=new jA(u.status,u.statusText,u.data,u.internal===!0);else if(u&&u.__type==="Error"){if(u.__subType){let h=window[u.__subType];if(typeof h=="function")try{let p=new h(u.message);p.stack="",r[i]=p}catch{}}if(r[i]==null){let h=new Error(u.message);h.stack="",r[i]=h}}else r[i]=u;return r}const rG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",nG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zge=De.forwardRef(function(t,r){let{onClick:i,relative:u,reloadDocument:h,replace:p,state:_,target:o,to:x,preventScrollReset:E}=t,A=KV(t,QV),{basename:O}=De.useContext(bd),L,j=!1;if(typeof x=="string"&&nG.test(x)&&(L=x,rG))try{let V=new URL(window.location.href),U=x.startsWith("//")?new URL(V.protocol+x):new URL(x),G=xd(U.pathname,O);U.origin===V.origin&&G!=null?x=G+U.search+U.hash:j=!0}catch{}let F=kV(x,{relative:u}),Z=iG(x,{replace:p,state:_,target:o,preventScrollReset:E,relative:u});function $(V){i&&i(V),V.defaultPrevented||Z(V)}return De.createElement("a",wg({},A,{href:L||F,onClick:j||h?i:$,ref:r,target:o}))});var QI;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(QI||(QI={}));var ek;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(ek||(ek={}));function iG(e,t){let{target:r,replace:i,state:u,preventScrollReset:h,relative:p}=t===void 0?{}:t,_=DV(),o=Rx(),x=UB(e,{relative:p});return De.useCallback(E=>{if(JV(E,r)){E.preventDefault();let A=i!==void 0?i:Rc(o)===Rc(x);_(e,{replace:A,state:u,preventScrollReset:h,relative:p})}},[o,_,x,i,u,r,e,h,p])}var oG=typeof Element<"u",aG=typeof Map=="function",sG=typeof Set=="function",lG=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function $v(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,i,u;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(i=r;i--!==0;)if(!$v(e[i],t[i]))return!1;return!0}var h;if(aG&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(h=e.entries();!(i=h.next()).done;)if(!t.has(i.value[0]))return!1;for(h=e.entries();!(i=h.next()).done;)if(!$v(i.value[1],t.get(i.value[0])))return!1;return!0}if(sG&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(h=e.entries();!(i=h.next()).done;)if(!t.has(i.value[0]))return!1;return!0}if(lG&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(i=r;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(u=Object.keys(e),r=u.length,r!==Object.keys(t).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,u[i]))return!1;if(oG&&e instanceof Element)return!1;for(i=r;i--!==0;)if(!((u[i]==="_owner"||u[i]==="__v"||u[i]==="__o")&&e.$$typeof)&&!$v(e[u[i]],t[u[i]]))return!1;return!0}return e!==e&&t!==t}var uG=function(t,r){try{return $v(t,r)}catch(i){if((i.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw i}};const cG=Xr(uG);var hG=function(e,t,r,i,u,h,p,_){if(!e){var o;if(t===void 0)o=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var x=[r,i,u,h,p,_],E=0;o=new Error(t.replace(/%s/g,function(){return x[E++]})),o.name="Invariant Violation"}throw o.framesToPop=1,o}},fG=hG;const tk=Xr(fG);var dG=function(t,r,i,u){var h=i?i.call(u,t,r):void 0;if(h!==void 0)return!!h;if(t===r)return!0;if(typeof t!="object"||!t||typeof r!="object"||!r)return!1;var p=Object.keys(t),_=Object.keys(r);if(p.length!==_.length)return!1;for(var o=Object.prototype.hasOwnProperty.bind(r),x=0;x<p.length;x++){var E=p[x];if(!o(E))return!1;var A=t[E],O=r[E];if(h=i?i.call(u,A,O,E):void 0,h===!1||h===void 0&&A!==O)return!1}return!0};const pG=Xr(dG);var qB=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))(qB||{}),Lw={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},rk=Object.values(qB),NA={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},mG=Object.entries(NA).reduce((e,[t,r])=>(e[r]=t,e),{}),Va="data-rh",Of={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},If=(e,t)=>{for(let r=e.length-1;r>=0;r-=1){const i=e[r];if(Object.prototype.hasOwnProperty.call(i,t))return i[t]}return null},gG=e=>{let t=If(e,"title");const r=If(e,Of.TITLE_TEMPLATE);if(Array.isArray(t)&&(t=t.join("")),r&&t)return r.replace(/%s/g,()=>t);const i=If(e,Of.DEFAULT_TITLE);return t||i||void 0},yG=e=>If(e,Of.ON_CHANGE_CLIENT_STATE)||(()=>{}),zw=(e,t)=>t.filter(r=>typeof r[e]<"u").map(r=>r[e]).reduce((r,i)=>({...r,...i}),{}),_G=(e,t)=>t.filter(r=>typeof r.base<"u").map(r=>r.base).reverse().reduce((r,i)=>{if(!r.length){const u=Object.keys(i);for(let h=0;h<u.length;h+=1){const _=u[h].toLowerCase();if(e.indexOf(_)!==-1&&i[_])return r.concat(i)}}return r},[]),vG=e=>console&&typeof console.warn=="function"&&console.warn(e),Em=(e,t,r)=>{const i={};return r.filter(u=>Array.isArray(u[e])?!0:(typeof u[e]<"u"&&vG(`Helmet: ${e} should be of type "Array". Instead found type "${typeof u[e]}"`),!1)).map(u=>u[e]).reverse().reduce((u,h)=>{const p={};h.filter(o=>{let x;const E=Object.keys(o);for(let O=0;O<E.length;O+=1){const L=E[O],j=L.toLowerCase();t.indexOf(j)!==-1&&!(x==="rel"&&o[x].toLowerCase()==="canonical")&&!(j==="rel"&&o[j].toLowerCase()==="stylesheet")&&(x=j),t.indexOf(L)!==-1&&(L==="innerHTML"||L==="cssText"||L==="itemprop")&&(x=L)}if(!x||!o[x])return!1;const A=o[x].toLowerCase();return i[x]||(i[x]={}),p[x]||(p[x]={}),i[x][A]?!1:(p[x][A]=!0,!0)}).reverse().forEach(o=>u.push(o));const _=Object.keys(p);for(let o=0;o<_.length;o+=1){const x=_[o],E={...i[x],...p[x]};i[x]=E}return u},[]).reverse()},xG=(e,t)=>{if(Array.isArray(e)&&e.length){for(let r=0;r<e.length;r+=1)if(e[r][t])return!0}return!1},bG=e=>({baseTag:_G(["href"],e),bodyAttributes:zw("bodyAttributes",e),defer:If(e,Of.DEFER),encode:If(e,Of.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:zw("htmlAttributes",e),linkTags:Em("link",["rel","href"],e),metaTags:Em("meta",["name","charset","http-equiv","property","itemprop"],e),noscriptTags:Em("noscript",["innerHTML"],e),onChangeClientState:yG(e),scriptTags:Em("script",["src","innerHTML"],e),styleTags:Em("style",["cssText"],e),title:gG(e),titleAttributes:zw("titleAttributes",e),prioritizeSeoTags:xG(e,Of.PRIORITIZE_SEO_TAGS)}),ZB=e=>Array.isArray(e)?e.join(""):e,wG=(e,t)=>{const r=Object.keys(e);for(let i=0;i<r.length;i+=1)if(t[r[i]]&&t[r[i]].includes(e[r[i]]))return!0;return!1},Rw=(e,t)=>Array.isArray(e)?e.reduce((r,i)=>(wG(i,t)?r.priority.push(i):r.default.push(i),r),{priority:[],default:[]}):{default:e,priority:[]},nk=(e,t)=>({...e,[t]:void 0}),TG=["noscript","script","style"],hS=(e,t=!0)=>t===!1?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),HB=e=>Object.keys(e).reduce((t,r)=>{const i=typeof e[r]<"u"?`${r}="${e[r]}"`:`${r}`;return t?`${t} ${i}`:i},""),SG=(e,t,r,i)=>{const u=HB(r),h=ZB(t);return u?`<${e} ${Va}="true" ${u}>${hS(h,i)}</${e}>`:`<${e} ${Va}="true">${hS(h,i)}</${e}>`},EG=(e,t,r=!0)=>t.reduce((i,u)=>{const h=u,p=Object.keys(h).filter(x=>!(x==="innerHTML"||x==="cssText")).reduce((x,E)=>{const A=typeof h[E]>"u"?E:`${E}="${hS(h[E],r)}"`;return x?`${x} ${A}`:A},""),_=h.innerHTML||h.cssText||"",o=TG.indexOf(e)===-1;return`${i}<${e} ${Va}="true" ${p}${o?"/>":`>${_}</${e}>`}`},""),XB=(e,t={})=>Object.keys(e).reduce((r,i)=>{const u=NA[i];return r[u||i]=e[i],r},t),AG=(e,t,r)=>{const i={key:t,[Va]:!0},u=XB(r,i);return[Fe.createElement("title",u,t)]},Nv=(e,t)=>t.map((r,i)=>{const u={key:i,[Va]:!0};return Object.keys(r).forEach(h=>{const _=NA[h]||h;if(_==="innerHTML"||_==="cssText"){const o=r.innerHTML||r.cssText;u.dangerouslySetInnerHTML={__html:o}}else u[_]=r[h]}),Fe.createElement(e,u)}),Jo=(e,t,r=!0)=>{switch(e){case"title":return{toComponent:()=>AG(e,t.title,t.titleAttributes),toString:()=>SG(e,t.title,t.titleAttributes,r)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>XB(t),toString:()=>HB(t)};default:return{toComponent:()=>Nv(e,t),toString:()=>EG(e,t,r)}}},PG=({metaTags:e,linkTags:t,scriptTags:r,encode:i})=>{const u=Rw(e,Lw.meta),h=Rw(t,Lw.link),p=Rw(r,Lw.script);return{priorityMethods:{toComponent:()=>[...Nv("meta",u.priority),...Nv("link",h.priority),...Nv("script",p.priority)],toString:()=>`${Jo("meta",u.priority,i)} ${Jo("link",h.priority,i)} ${Jo("script",p.priority,i)}`},metaTags:u.default,linkTags:h.default,scriptTags:p.default}},MG=e=>{const{baseTag:t,bodyAttributes:r,encode:i=!0,htmlAttributes:u,noscriptTags:h,styleTags:p,title:_="",titleAttributes:o,prioritizeSeoTags:x}=e;let{linkTags:E,metaTags:A,scriptTags:O}=e,L={toComponent:()=>{},toString:()=>""};return x&&({priorityMethods:L,linkTags:E,metaTags:A,scriptTags:O}=PG(e)),{priority:L,base:Jo("base",t,i),bodyAttributes:Jo("bodyAttributes",r,i),htmlAttributes:Jo("htmlAttributes",u,i),link:Jo("link",E,i),meta:Jo("meta",A,i),noscript:Jo("noscript",h,i),script:Jo("script",O,i),style:Jo("style",p,i),title:Jo("title",{title:_,titleAttributes:o},i)}},fS=MG,cv=[],KB=!!(typeof window<"u"&&window.document&&window.document.createElement),dS=class{constructor(e,t){Us(this,"instances",[]);Us(this,"canUseDOM",KB);Us(this,"context");Us(this,"value",{setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?cv:this.instances,add:e=>{(this.canUseDOM?cv:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?cv:this.instances).indexOf(e);(this.canUseDOM?cv:this.instances).splice(t,1)}}});this.context=e,this.canUseDOM=t||!1,t||(e.helmet=fS({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},CG={},YB=Fe.createContext(CG),Ec,OG=(Ec=class extends De.Component{constructor(r){super(r);Us(this,"helmetData");this.helmetData=new dS(this.props.context||{},Ec.canUseDOM)}render(){return Fe.createElement(YB.Provider,{value:this.helmetData.value},this.props.children)}},Us(Ec,"canUseDOM",KB),Ec),Zh=(e,t)=>{const r=document.head||document.querySelector("head"),i=r.querySelectorAll(`${e}[${Va}]`),u=[].slice.call(i),h=[];let p;return t&&t.length&&t.forEach(_=>{const o=document.createElement(e);for(const x in _)if(Object.prototype.hasOwnProperty.call(_,x))if(x==="innerHTML")o.innerHTML=_.innerHTML;else if(x==="cssText")o.styleSheet?o.styleSheet.cssText=_.cssText:o.appendChild(document.createTextNode(_.cssText));else{const E=x,A=typeof _[E]>"u"?"":_[E];o.setAttribute(x,A)}o.setAttribute(Va,"true"),u.some((x,E)=>(p=E,o.isEqualNode(x)))?u.splice(p,1):h.push(o)}),u.forEach(_=>{var o;return(o=_.parentNode)==null?void 0:o.removeChild(_)}),h.forEach(_=>r.appendChild(_)),{oldTags:u,newTags:h}},pS=(e,t)=>{const r=document.getElementsByTagName(e)[0];if(!r)return;const i=r.getAttribute(Va),u=i?i.split(","):[],h=[...u],p=Object.keys(t);for(const _ of p){const o=t[_]||"";r.getAttribute(_)!==o&&r.setAttribute(_,o),u.indexOf(_)===-1&&u.push(_);const x=h.indexOf(_);x!==-1&&h.splice(x,1)}for(let _=h.length-1;_>=0;_-=1)r.removeAttribute(h[_]);u.length===h.length?r.removeAttribute(Va):r.getAttribute(Va)!==p.join(",")&&r.setAttribute(Va,p.join(","))},IG=(e,t)=>{typeof e<"u"&&document.title!==e&&(document.title=ZB(e)),pS("title",t)},ik=(e,t)=>{const{baseTag:r,bodyAttributes:i,htmlAttributes:u,linkTags:h,metaTags:p,noscriptTags:_,onChangeClientState:o,scriptTags:x,styleTags:E,title:A,titleAttributes:O}=e;pS("body",i),pS("html",u),IG(A,O);const L={baseTag:Zh("base",r),linkTags:Zh("link",h),metaTags:Zh("meta",p),noscriptTags:Zh("noscript",_),scriptTags:Zh("script",x),styleTags:Zh("style",E)},j={},F={};Object.keys(L).forEach(Z=>{const{newTags:$,oldTags:V}=L[Z];$.length&&(j[Z]=$),V.length&&(F[Z]=L[Z].oldTags)}),t&&t(),o(e,j,F)},Am=null,kG=e=>{Am&&cancelAnimationFrame(Am),e.defer?Am=requestAnimationFrame(()=>{ik(e,()=>{Am=null})}):(ik(e),Am=null)},DG=kG,ok=class extends De.Component{constructor(){super(...arguments);Us(this,"rendered",!1)}shouldComponentUpdate(t){return!pG(t,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:t}=this.props.context;t.remove(this),this.emitChange()}emitChange(){const{helmetInstances:t,setHelmet:r}=this.props.context;let i=null;const u=bG(t.get().map(h=>{const p={...h.props};return delete p.context,p}));OG.canUseDOM?DG(u):fS&&(i=fS(u)),r(i)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:t}=this.props.context;t.add(this),this.emitChange()}render(){return this.init(),null}},dT,Rge=(dT=class extends De.Component{shouldComponentUpdate(e){return!cG(nk(this.props,"helmetData"),nk(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,r,i){return{...t,[e.type]:[...t[e.type]||[],{...r,...this.mapNestedChildrenToProps(e,i)}]}}mapObjectTypeChildren(e,t,r,i){switch(e.type){case"title":return{...t,[e.type]:i,titleAttributes:{...r}};case"body":return{...t,bodyAttributes:{...r}};case"html":return{...t,htmlAttributes:{...r}};default:return{...t,[e.type]:{...r}}}}mapArrayTypeChildrenToProps(e,t){let r={...t};return Object.keys(e).forEach(i=>{r={...r,[i]:e[i]}}),r}warnOnInvalidChildren(e,t){return tk(rk.some(r=>e.type===r),typeof e.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${rk.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),tk(!t||typeof t=="string"||Array.isArray(t)&&!t.some(r=>typeof r!="string"),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let r={};return Fe.Children.forEach(e,i=>{if(!i||!i.props)return;const{children:u,...h}=i.props,p=Object.keys(h).reduce((o,x)=>(o[mG[x]||x]=h[x],o),{});let{type:_}=i;switch(typeof _=="symbol"?_=_.toString():this.warnOnInvalidChildren(i,u),_){case"Symbol(react.fragment)":t=this.mapChildrenToProps(u,t);break;case"link":case"meta":case"noscript":case"script":case"style":r=this.flattenArrayTypeChildren(i,r,p,u);break;default:t=this.mapObjectTypeChildren(i,t,p,u);break}}),this.mapArrayTypeChildrenToProps(r,t)}render(){const{children:e,...t}=this.props;let r={...t},{helmetData:i}=t;if(e&&(r=this.mapChildrenToProps(e,r)),i&&!(i instanceof dS)){const u=i;i=new dS(u.context,!0),delete r.helmetData}return i?Fe.createElement(ok,{...r,context:i.value}):Fe.createElement(YB.Consumer,null,u=>Fe.createElement(ok,{...r,context:u}))}},Us(dT,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),dT),JB={exports:{}},LG="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",zG=LG,RG=zG;function QB(){}function e4(){}e4.resetWarningCache=QB;var BG=function(){function e(i,u,h,p,_,o){if(o!==RG){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:e4,resetWarningCache:QB};return r.PropTypes=r,r};JB.exports=BG();var jG=JB.exports;const Jr=Xr(jG),FG="modulepreload",$G=function(e){return"/"+e},ak={},NG=function(t,r,i){let u=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),_=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));u=Promise.allSettled(r.map(o=>{if(o=$G(o),o in ak)return;ak[o]=!0;const x=o.endsWith(".css"),E=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${E}`))return;const A=document.createElement("link");if(A.rel=x?"stylesheet":FG,x||(A.as="script"),A.crossOrigin="",A.href=o,_&&A.setAttribute("nonce",_),document.head.appendChild(A),x)return new Promise((O,L)=>{A.addEventListener("load",O),A.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${o}`)))})}))}function h(p){const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=p,window.dispatchEvent(_),!_.defaultPrevented)throw p}return u.then(p=>{for(const _ of p||[])_.status==="rejected"&&h(_.reason);return t().catch(h)})};var t4={exports:{}};(function(e){var t={};function r(h){return Math.floor(Math.abs(h)+.5)*(h>=0?1:-1)}function i(h,p,_){h=r(h*_),p=r(p*_);var o=(h-p)*2;o<0&&(o=-o-1);for(var x="";o>=32;)x+=String.fromCharCode((32|o&31)+63),o/=32;return x+=String.fromCharCode((o|0)+63),x}t.decode=function(h,p){for(var _=0,o=0,x=0,E=[],A=0,O=0,L=null,j,F,Z=Math.pow(10,Number.isInteger(p)?p:5);_<h.length;){L=null,A=1,O=0;do L=h.charCodeAt(_++)-63,O+=(L&31)*A,A*=32;while(L>=32);j=O&1?(-O-1)/2:O/2,A=1,O=0;do L=h.charCodeAt(_++)-63,O+=(L&31)*A,A*=32;while(L>=32);F=O&1?(-O-1)/2:O/2,o+=j,x+=F,E.push([o/Z,x/Z])}return E},t.encode=function(h,p){if(!h.length)return"";for(var _=Math.pow(10,Number.isInteger(p)?p:5),o=i(h[0][0],0,_)+i(h[0][1],0,_),x=1;x<h.length;x++){var E=h[x],A=h[x-1];o+=i(E[0],A[0],_),o+=i(E[1],A[1],_)}return o};function u(h){for(var p=[],_=0;_<h.length;_++){var o=h[_].slice();p.push([o[1],o[0]])}return p}t.fromGeoJSON=function(h,p){if(h&&h.type==="Feature"&&(h=h.geometry),!h||h.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return t.encode(u(h.coordinates),p)},t.toGeoJSON=function(h,p){var _=t.decode(h,p);return{type:"LineString",coordinates:u(_)}},e.exports&&(e.exports=t)})(t4);var Bge=t4.exports;/* @preserve
 * gcoord 0.3.2, geographic coordinate library
 * Copyright (c) 2021 Jiulong Hu <me@hujiulong.com>
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var d0=function(){return d0=Object.assign||function(t){for(var r,i=1,u=arguments.length;i<u;i++){r=arguments[i];for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(t[h]=r[h])}return t},d0.apply(this,arguments)},Oo=Math.sin,UG=Math.cos,UA=Math.sqrt,p0=Math.abs,Yi=Math.PI,sk=6378245,lk=.006693421622965823;function r4(e,t){return e>=72.004&&e<=137.8347&&t>=.8293&&t<=55.8271}function VG(e,t){var r=-100+2*e+3*t+.2*t*t+.1*e*t+.2*UA(p0(e));return r+=(20*Oo(6*e*Yi)+20*Oo(2*e*Yi))*2/3,r+=(20*Oo(t*Yi)+40*Oo(t/3*Yi))*2/3,r+=(160*Oo(t/12*Yi)+320*Oo(t*Yi/30))*2/3,r}function GG(e,t){var r=300+e+2*t+.1*e*e+.1*e*t+.1*UA(p0(e));return r+=(20*Oo(6*e*Yi)+20*Oo(2*e*Yi))*2/3,r+=(20*Oo(e*Yi)+40*Oo(e/3*Yi))*2/3,r+=(150*Oo(e/12*Yi)+300*Oo(e/30*Yi))*2/3,r}function WG(e,t){var r=GG(e-105,t-35),i=VG(e-105,t-35),u=t/180*Yi,h=Oo(u);h=1-lk*h*h;var p=UA(h);return r=r*180/(sk/p*UG(u)*Yi),i=i*180/(sk*(1-lk)/(h*p)*Yi),[r,i]}function uu(e){var t=e[0],r=e[1];if(!r4(t,r))return[t,r];var i=WG(t,r);return[t+i[0],r+i[1]]}function qf(e){var t=e[0],r=e[1];if(!r4(t,r))return[t,r];for(var i=[t,r],u=i[0],h=i[1],p=uu([u,h]),_=p[0]-t,o=p[1]-r;p0(_)>1e-6||p0(o)>1e-6;)u-=_,h-=o,p=uu([u,h]),_=p[0]-t,o=p[1]-r;return[u,h]}var m0=Math.sin,g0=Math.cos,n4=Math.atan2,i4=Math.sqrt,qG=Math.PI,y0=qG*3e3/180;function kf(e){var t=e[0],r=e[1],i=t-.0065,u=r-.006,h=i4(i*i+u*u)-2e-5*m0(u*y0),p=n4(u,i)-3e-6*g0(i*y0),_=h*g0(p),o=h*m0(p);return[_,o]}function Zf(e){var t=e[0],r=e[1],i=t,u=r,h=i4(i*i+u*u)+2e-5*m0(u*y0),p=n4(u,i)+3e-6*g0(i*y0),_=h*g0(p)+.0065,o=h*m0(p)+.006;return[_,o]}var uk=180/Math.PI,ck=Math.PI/180,_0=6378137,Gl=20037508342789244e-9;function hv(e){return[e[0]*uk/_0,(Math.PI*.5-2*Math.atan(Math.exp(-e[1]/_0)))*uk]}function Bx(e){var t=Math.abs(e[0])<=180?e[0]:e[0]-(e[0]<0?-1:1)*360,r=[_0*t*ck,_0*Math.log(Math.tan(Math.PI*.25+.5*e[1]*ck))];return r[0]>Gl&&(r[0]=Gl),r[0]<-Gl&&(r[0]=-Gl),r[1]>Gl&&(r[1]=Gl),r[1]<-Gl&&(r[1]=-Gl),r}var mS=Math.abs,hk=[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],fk=[75,60,45,30,15,0],ZG=[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],HG=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]];function o4(e,t,r){var i=mS(t)/r[9],u=r[0]+r[1]*mS(e),h=r[2]+r[3]*i+r[4]*Math.pow(i,2)+r[5]*Math.pow(i,3)+r[6]*Math.pow(i,4)+r[7]*Math.pow(i,5)+r[8]*Math.pow(i,6);return u*=e<0?-1:1,h*=t<0?-1:1,[u,h]}function jx(e){for(var t=e[0],r=e[1],i=[],u=0;u<fk.length;u++)if(mS(r)>fk[u]){i=HG[u];break}return o4(t,r,i)}function fv(e){for(var t=e[0],r=e[1],i=[],u=0;u<hk.length;u++)if(r>=hk[u]){i=ZG[u];break}return o4(t,r,i)}function Wl(e,t){if(!e)throw new Error(t)}function a4(e){return!!e&&Object.prototype.toString.call(e)==="[object Array]"}function dk(e){return!isNaN(Number(e))&&e!==null&&!a4(e)}function oa(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.length-1;return function(){for(var i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];for(var h=r,p=e[r].apply(null,i);h--;)p=e[h].call(null,p);return p}}function s4(e,t,r){if(r===void 0&&(r=!1),e!==null)for(var i,u,h,p,_,o,x,E=0,A=0,O,L=e.type,j=L==="FeatureCollection",F=L==="Feature",Z=j?e.features.length:1,$=0;$<Z;$++){x=j?e.features[$].geometry:F?e.geometry:e,O=x?x.type==="GeometryCollection":!1,_=O?x.geometries.length:1;for(var V=0;V<_;V++){var U=0,G=0;if(p=O?x.geometries[V]:x,p!==null){var q=p.type;switch(E=r&&(q==="Polygon"||q==="MultiPolygon")?1:0,q){case null:break;case"Point":if(o=p.coordinates,t(o,A,$,U,G)===!1)return!1;A++,U++;break;case"LineString":case"MultiPoint":for(o=p.coordinates,i=0;i<o.length;i++){if(t(o[i],A,$,U,G)===!1)return!1;A++,q==="MultiPoint"&&U++}q==="LineString"&&U++;break;case"Polygon":case"MultiLineString":for(o=p.coordinates,i=0;i<o.length;i++){for(u=0;u<o[i].length-E;u++){if(t(o[i][u],A,$,U,G)===!1)return!1;A++}q==="MultiLineString"&&U++,q==="Polygon"&&G++}q==="Polygon"&&U++;break;case"MultiPolygon":for(o=p.coordinates,i=0;i<o.length;i++){for(G=0,u=0;u<o[i].length;u++){for(h=0;h<o[i][u].length-E;h++){if(t(o[i][u][h],A,$,U,G)===!1)return!1;A++}G++}U++}break;case"GeometryCollection":for(i=0;i<p.geometries.length;i++)if(s4(p.geometries[i],t,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var Hh,Xh,Kh,Yh,Jh,Pn;(function(e){e.WGS84="WGS84",e.WGS1984="WGS84",e.EPSG4326="WGS84",e.GCJ02="GCJ02",e.AMap="GCJ02",e.BD09="BD09",e.BD09LL="BD09",e.Baidu="BD09",e.BMap="BD09",e.BD09MC="BD09MC",e.BD09Meter="BD09MC",e.EPSG3857="EPSG3857",e.EPSG900913="EPSG3857",e.EPSG102100="EPSG3857",e.WebMercator="EPSG3857",e.WM="EPSG3857"})(Pn||(Pn={}));var XG={to:(Hh={},Hh[Pn.GCJ02]=uu,Hh[Pn.BD09]=oa(Zf,uu),Hh[Pn.BD09MC]=oa(jx,Zf,uu),Hh[Pn.EPSG3857]=Bx,Hh)},KG={to:(Xh={},Xh[Pn.WGS84]=qf,Xh[Pn.BD09]=Zf,Xh[Pn.BD09MC]=oa(jx,Zf),Xh[Pn.EPSG3857]=oa(Bx,qf),Xh)},YG={to:(Kh={},Kh[Pn.WGS84]=oa(qf,kf),Kh[Pn.GCJ02]=kf,Kh[Pn.EPSG3857]=oa(Bx,qf,kf),Kh[Pn.BD09MC]=jx,Kh)},JG={to:(Yh={},Yh[Pn.WGS84]=hv,Yh[Pn.GCJ02]=oa(uu,hv),Yh[Pn.BD09]=oa(Zf,uu,hv),Yh[Pn.BD09MC]=oa(jx,Zf,uu,hv),Yh)},QG={to:(Jh={},Jh[Pn.WGS84]=oa(qf,kf,fv),Jh[Pn.GCJ02]=oa(kf,fv),Jh[Pn.EPSG3857]=oa(Bx,qf,kf,fv),Jh[Pn.BD09]=fv,Jh)},e9={WGS84:XG,GCJ02:KG,BD09:YG,EPSG3857:JG,BD09MC:QG};function t9(e,t,r){if(Wl(!!e,"The args[0] input coordinate is required"),Wl(!!t,"The args[1] original coordinate system is required"),Wl(!!r,"The args[2] target coordinate system is required"),t===r)return e;var i=e9[t];Wl(!!i,"Invalid original coordinate system: "+t);var u=i.to[r];Wl(!!u,"Invalid target coordinate system: "+r);var h=typeof e;if(Wl(h==="string"||h==="object","Invalid input coordinate type: "+h),h==="string")try{e=JSON.parse(e)}catch{throw new Error("Invalid input coordinate: "+e)}var p=!1;a4(e)&&(Wl(e.length>=2,"Invalid input coordinate: "+e),Wl(dk(e[0])&&dk(e[1]),"Invalid input coordinate: "+e),e=e.map(Number),p=!0);var _=u;return p?_(e):(s4(e,function(o){var x;x=_(o),o[0]=x[0],o[1]=x[1]}),e)}var jge=d0(d0({},Pn),{CRSTypes:Pn,transform:t9});const Fi=1e-6;let Hf=typeof Float32Array<"u"?Float32Array:Array;function r9(){const e=new Hf(2);return Hf!=Float32Array&&(e[0]=0,e[1]=0),e}function pk(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function n9(e,t){return e[0]=-t[0],e[1]=-t[1],e}function l4(e,t,r,i){const u=t[0],h=t[1];return e[0]=u+i*(r[0]-u),e[1]=h+i*(r[1]-h),e}(function(){const e=r9();return function(t,r,i,u,h,p){let _,o;for(r||(r=2),i||(i=0),u?o=Math.min(u*r+i,t.length):o=t.length,_=i;_<o;_+=r)e[0]=t[_],e[1]=t[_+1],h(e,e,p),t[_]=e[0],t[_+1]=e[1];return t}})();function i9(){const e=new Hf(3);return Hf!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function o9(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function a9(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function s9(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}const l9=a9;(function(){const e=i9();return function(t,r,i,u,h,p){let _,o;for(r||(r=3),i||(i=0),u?o=Math.min(u*r+i,t.length):o=t.length,_=i;_<o;_+=r)e[0]=t[_],e[1]=t[_+1],e[2]=t[_+2],h(e,e,p),t[_]=e[0],t[_+1]=e[1],t[_+2]=e[2];return t}})();function u9(e,t){const r=t[0],i=t[1],u=t[2],h=t[3],p=t[4],_=t[5],o=t[6],x=t[7],E=t[8],A=t[9],O=t[10],L=t[11],j=t[12],F=t[13],Z=t[14],$=t[15],V=r*_-i*p,U=r*o-u*p,G=r*x-h*p,q=i*o-u*_,K=i*x-h*_,re=u*x-h*o,pe=E*F-A*j,xe=E*Z-O*j,ge=E*$-L*j,Be=A*Z-O*F,$e=A*$-L*F,Ve=O*$-L*Z;let be=V*Ve-U*$e+G*Be+q*ge-K*xe+re*pe;return be?(be=1/be,e[0]=(_*Ve-o*$e+x*Be)*be,e[1]=(u*$e-i*Ve-h*Be)*be,e[2]=(F*re-Z*K+$*q)*be,e[3]=(O*K-A*re-L*q)*be,e[4]=(o*ge-p*Ve-x*xe)*be,e[5]=(r*Ve-u*ge+h*xe)*be,e[6]=(Z*G-j*re-$*U)*be,e[7]=(E*re-O*G+L*U)*be,e[8]=(p*$e-_*ge+x*pe)*be,e[9]=(i*ge-r*$e-h*pe)*be,e[10]=(j*K-F*G+$*V)*be,e[11]=(A*G-E*K-L*V)*be,e[12]=(_*xe-p*Be-o*pe)*be,e[13]=(r*Be-i*xe+u*pe)*be,e[14]=(F*U-j*q-Z*V)*be,e[15]=(E*q-A*U+O*V)*be,e):null}function Bw(e,t,r){const i=t[0],u=t[1],h=t[2],p=t[3],_=t[4],o=t[5],x=t[6],E=t[7],A=t[8],O=t[9],L=t[10],j=t[11],F=t[12],Z=t[13],$=t[14],V=t[15];let U=r[0],G=r[1],q=r[2],K=r[3];return e[0]=U*i+G*_+q*A+K*F,e[1]=U*u+G*o+q*O+K*Z,e[2]=U*h+G*x+q*L+K*$,e[3]=U*p+G*E+q*j+K*V,U=r[4],G=r[5],q=r[6],K=r[7],e[4]=U*i+G*_+q*A+K*F,e[5]=U*u+G*o+q*O+K*Z,e[6]=U*h+G*x+q*L+K*$,e[7]=U*p+G*E+q*j+K*V,U=r[8],G=r[9],q=r[10],K=r[11],e[8]=U*i+G*_+q*A+K*F,e[9]=U*u+G*o+q*O+K*Z,e[10]=U*h+G*x+q*L+K*$,e[11]=U*p+G*E+q*j+K*V,U=r[12],G=r[13],q=r[14],K=r[15],e[12]=U*i+G*_+q*A+K*F,e[13]=U*u+G*o+q*O+K*Z,e[14]=U*h+G*x+q*L+K*$,e[15]=U*p+G*E+q*j+K*V,e}function gS(e,t,r){const i=r[0],u=r[1],h=r[2];let p,_,o,x,E,A,O,L,j,F,Z,$;return t===e?(e[12]=t[0]*i+t[4]*u+t[8]*h+t[12],e[13]=t[1]*i+t[5]*u+t[9]*h+t[13],e[14]=t[2]*i+t[6]*u+t[10]*h+t[14],e[15]=t[3]*i+t[7]*u+t[11]*h+t[15]):(p=t[0],_=t[1],o=t[2],x=t[3],E=t[4],A=t[5],O=t[6],L=t[7],j=t[8],F=t[9],Z=t[10],$=t[11],e[0]=p,e[1]=_,e[2]=o,e[3]=x,e[4]=E,e[5]=A,e[6]=O,e[7]=L,e[8]=j,e[9]=F,e[10]=Z,e[11]=$,e[12]=p*i+E*u+j*h+t[12],e[13]=_*i+A*u+F*h+t[13],e[14]=o*i+O*u+Z*h+t[14],e[15]=x*i+L*u+$*h+t[15]),e}function u4(e,t,r){const i=r[0],u=r[1],h=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*u,e[5]=t[5]*u,e[6]=t[6]*u,e[7]=t[7]*u,e[8]=t[8]*h,e[9]=t[9]*h,e[10]=t[10]*h,e[11]=t[11]*h,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function c9(e,t,r){const i=Math.sin(r),u=Math.cos(r),h=t[4],p=t[5],_=t[6],o=t[7],x=t[8],E=t[9],A=t[10],O=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=h*u+x*i,e[5]=p*u+E*i,e[6]=_*u+A*i,e[7]=o*u+O*i,e[8]=x*u-h*i,e[9]=E*u-p*i,e[10]=A*u-_*i,e[11]=O*u-o*i,e}function h9(e,t,r){const i=Math.sin(r),u=Math.cos(r),h=t[0],p=t[1],_=t[2],o=t[3],x=t[4],E=t[5],A=t[6],O=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=h*u+x*i,e[1]=p*u+E*i,e[2]=_*u+A*i,e[3]=o*u+O*i,e[4]=x*u-h*i,e[5]=E*u-p*i,e[6]=A*u-_*i,e[7]=O*u-o*i,e}function f9(e,t,r,i,u){const h=1/Math.tan(t/2);if(e[0]=h/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,u!=null&&u!==1/0){const p=1/(i-u);e[10]=(u+i)*p,e[14]=2*u*i*p}else e[10]=-1,e[14]=-2*i;return e}const d9=f9;function mk(e,t){const r=e[0],i=e[1],u=e[2],h=e[3],p=e[4],_=e[5],o=e[6],x=e[7],E=e[8],A=e[9],O=e[10],L=e[11],j=e[12],F=e[13],Z=e[14],$=e[15],V=t[0],U=t[1],G=t[2],q=t[3],K=t[4],re=t[5],pe=t[6],xe=t[7],ge=t[8],Be=t[9],$e=t[10],Ve=t[11],be=t[12],_e=t[13],Me=t[14],ke=t[15];return Math.abs(r-V)<=Fi*Math.max(1,Math.abs(r),Math.abs(V))&&Math.abs(i-U)<=Fi*Math.max(1,Math.abs(i),Math.abs(U))&&Math.abs(u-G)<=Fi*Math.max(1,Math.abs(u),Math.abs(G))&&Math.abs(h-q)<=Fi*Math.max(1,Math.abs(h),Math.abs(q))&&Math.abs(p-K)<=Fi*Math.max(1,Math.abs(p),Math.abs(K))&&Math.abs(_-re)<=Fi*Math.max(1,Math.abs(_),Math.abs(re))&&Math.abs(o-pe)<=Fi*Math.max(1,Math.abs(o),Math.abs(pe))&&Math.abs(x-xe)<=Fi*Math.max(1,Math.abs(x),Math.abs(xe))&&Math.abs(E-ge)<=Fi*Math.max(1,Math.abs(E),Math.abs(ge))&&Math.abs(A-Be)<=Fi*Math.max(1,Math.abs(A),Math.abs(Be))&&Math.abs(O-$e)<=Fi*Math.max(1,Math.abs(O),Math.abs($e))&&Math.abs(L-Ve)<=Fi*Math.max(1,Math.abs(L),Math.abs(Ve))&&Math.abs(j-be)<=Fi*Math.max(1,Math.abs(j),Math.abs(be))&&Math.abs(F-_e)<=Fi*Math.max(1,Math.abs(F),Math.abs(_e))&&Math.abs(Z-Me)<=Fi*Math.max(1,Math.abs(Z),Math.abs(Me))&&Math.abs($-ke)<=Fi*Math.max(1,Math.abs($),Math.abs(ke))}function p9(){const e=new Hf(4);return Hf!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function m9(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function g9(e,t,r){const i=t[0],u=t[1],h=t[2],p=t[3];return e[0]=r[0]*i+r[4]*u+r[8]*h+r[12]*p,e[1]=r[1]*i+r[5]*u+r[9]*h+r[13]*p,e[2]=r[2]*i+r[6]*u+r[10]*h+r[14]*p,e[3]=r[3]*i+r[7]*u+r[11]*h+r[15]*p,e}(function(){const e=p9();return function(t,r,i,u,h,p){let _,o;for(r||(r=4),i||(i=0),u?o=Math.min(u*r+i,t.length):o=t.length,_=i;_<o;_+=r)e[0]=t[_],e[1]=t[_+1],e[2]=t[_+2],e[3]=t[_+3],h(e,e,p),t[_]=e[0],t[_+1]=e[1],t[_+2]=e[2],t[_+3]=e[3];return t}})();function Uv(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Df(e,t){const r=g9([],t,e);return m9(r,r,1/r[3]),r}function yS(e,t,r){return e<t?t:e>r?r:e}function y9(e){return Math.log(e)*Math.LOG2E}const _9=Math.log2||y9;function du(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Ga=Math.PI,c4=Ga/4,gs=Ga/180,_S=180/Ga,Tg=512,gk=4003e4,dv=85.051129,h4=1.5;function v9(e){return Math.pow(2,e)}function vf(e){const[t,r]=e;du(Number.isFinite(t)),du(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");const i=t*gs,u=r*gs,h=Tg*(i+Ga)/(2*Ga),p=Tg*(Ga+Math.log(Math.tan(c4+u*.5)))/(2*Ga);return[h,p]}function Qm(e){const[t,r]=e,i=t/Tg*(2*Ga)-Ga,u=2*(Math.atan(Math.exp(r/Tg*(2*Ga)-Ga))-c4);return[i*_S,u*_S]}function x9(e){const{latitude:t,longitude:r,highPrecision:i=!1}=e;du(Number.isFinite(t)&&Number.isFinite(r));const u=Tg,h=Math.cos(t*gs),p=u/360,_=p/h,o=u/gk/h,x={unitsPerMeter:[o,o,o],metersPerUnit:[1/o,1/o,1/o],unitsPerDegree:[p,_,o],degreesPerUnit:[1/p,1/_,1/o]};if(i){const E=gs*Math.tan(t*gs)/h,A=p*E/2,O=u/gk*E,L=O/_*o;x.unitsPerDegree2=[0,A,O],x.unitsPerMeter2=[L,0,L]}return x}function b9(e){const{height:t,pitch:r,bearing:i,altitude:u,scale:h,center:p}=e,_=Uv();gS(_,_,[0,0,-u]),c9(_,_,-r*gs),h9(_,_,i*gs);const o=h/t;return u4(_,_,[o,o,o]),p&&gS(_,_,s9([],p)),_}function w9(e){const{width:t,height:r,altitude:i,pitch:u=0,offset:h,center:p,scale:_,nearZMultiplier:o=1,farZMultiplier:x=1}=e;let{fovy:E=v0(h4)}=e;i!==void 0&&(E=v0(i));const A=E*gs,O=u*gs,L=f4(E);let j=L;p&&(j+=p[2]*_/Math.cos(O)/r);const F=A*(.5+(h?h[1]:0)/r),Z=Math.sin(F)*j/Math.sin(yS(Math.PI/2-O-F,.01,Math.PI-.01)),$=Math.sin(O)*Z+j,V=j*10,U=Math.min($*x,V);return{fov:A,aspect:t/r,focalDistance:L,near:o,far:U}}function T9(e){const{fov:t,aspect:r,near:i,far:u}=w9(e);return d9([],t,r,i,u)}function v0(e){return 2*Math.atan(.5/e)*_S}function f4(e){return .5/Math.tan(.5*e*gs)}function S9(e,t){const[r,i,u=0]=e;return du(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(u)),Df(t,[r,i,u,1])}function yk(e,t,r=0){const[i,u,h]=e;if(du(Number.isFinite(i)&&Number.isFinite(u),"invalid pixel coordinate"),Number.isFinite(h))return Df(t,[i,u,h,1]);const p=Df(t,[i,u,0,1]),_=Df(t,[i,u,1,1]),o=p[2],x=_[2],E=o===x?0:((r||0)-o)/(x-o);return l4([],p,_,E)}function E9(e){const{width:t,height:r,bounds:i,minExtent:u=0,maxZoom:h=24,offset:p=[0,0]}=e,[[_,o],[x,E]]=i,A=A9(e.padding),O=vf([_,yS(E,-dv,dv)]),L=vf([x,yS(o,-dv,dv)]),j=[Math.max(Math.abs(L[0]-O[0]),u),Math.max(Math.abs(L[1]-O[1]),u)],F=[t-A.left-A.right-Math.abs(p[0])*2,r-A.top-A.bottom-Math.abs(p[1])*2];du(F[0]>0&&F[1]>0);const Z=F[0]/j[0],$=F[1]/j[1],V=(A.right-A.left)/2/Z,U=(A.top-A.bottom)/2/$,G=[(L[0]+O[0])/2+V,(L[1]+O[1])/2+U],q=Qm(G),K=Math.min(h,_9(Math.abs(Math.min(Z,$))));return du(Number.isFinite(K)),{longitude:q[0],latitude:q[1],zoom:K}}function A9(e=0){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:(du(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e)}const _k=Math.PI/180;function P9(e,t=0){const{width:r,height:i,unproject:u}=e,h={targetZ:t},p=u([0,i],h),_=u([r,i],h);let o,x;const E=e.fovy?.5*e.fovy*_k:Math.atan(.5/e.altitude),A=(90-e.pitch)*_k;return E>A-.01?(o=vk(e,0,t),x=vk(e,r,t)):(o=u([0,0],h),x=u([r,0],h)),[p,_,x,o]}function vk(e,t,r){const{pixelUnprojectionMatrix:i}=e,u=Df(i,[t,0,1,1]),h=Df(i,[t,e.height,1,1]),_=(r*e.distanceScales.unitsPerMeter[2]-u[2])/(h[2]-u[2]),o=l4([],u,h,_),x=Qm(o);return x.push(r),x}class vS{constructor(t={width:1,height:1}){this.equals=$=>$ instanceof vS?$.width===this.width&&$.height===this.height&&mk($.projectionMatrix,this.projectionMatrix)&&mk($.viewMatrix,this.viewMatrix):!1,this.project=($,V={})=>{const{topLeft:U=!0}=V,G=this.projectPosition($),q=S9(G,this.pixelProjectionMatrix),[K,re]=q,pe=U?re:this.height-re;return $.length===2?[K,pe]:[K,pe,q[2]]},this.unproject=($,V={})=>{const{topLeft:U=!0,targetZ:G=void 0}=V,[q,K,re]=$,pe=U?K:this.height-K,xe=G&&G*this.distanceScales.unitsPerMeter[2],ge=yk([q,pe,re],this.pixelUnprojectionMatrix,xe),[Be,$e,Ve]=this.unprojectPosition(ge);return Number.isFinite(re)?[Be,$e,Ve]:Number.isFinite(G)?[Be,$e,G]:[Be,$e]},this.projectPosition=$=>{const[V,U]=vf($),G=($[2]||0)*this.distanceScales.unitsPerMeter[2];return[V,U,G]},this.unprojectPosition=$=>{const[V,U]=Qm($),G=($[2]||0)*this.distanceScales.metersPerUnit[2];return[V,U,G]};let{width:r,height:i,altitude:u=null,fovy:h=null}=t;const{latitude:p=0,longitude:_=0,zoom:o=0,pitch:x=0,bearing:E=0,position:A=null,nearZMultiplier:O=.02,farZMultiplier:L=1.01}=t;r=r||1,i=i||1,h===null&&u===null?(u=h4,h=v0(u)):h===null?h=v0(u):u===null&&(u=f4(h));const j=v9(o);u=Math.max(.75,u);const F=x9({longitude:_,latitude:p}),Z=vf([_,p]);Z.push(0),A&&o9(Z,Z,l9([],A,F.unitsPerMeter)),this.projectionMatrix=T9({width:r,height:i,scale:j,center:Z,pitch:x,fovy:h,nearZMultiplier:O,farZMultiplier:L}),this.viewMatrix=b9({height:i,scale:j,center:Z,pitch:x,bearing:E,altitude:u}),this.width=r,this.height=i,this.scale=j,this.latitude=p,this.longitude=_,this.zoom=o,this.pitch=x,this.bearing=E,this.altitude=u,this.fovy=h,this.center=Z,this.meterOffset=A||[0,0,0],this.distanceScales=F,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:t,height:r,projectionMatrix:i,viewMatrix:u}=this,h=Uv();Bw(h,h,i),Bw(h,h,u),this.viewProjectionMatrix=h;const p=Uv();u4(p,p,[t/2,-r/2,1]),gS(p,p,[1,-1,0]),Bw(p,p,h);const _=u9(Uv(),p);if(!_)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=p,this.pixelUnprojectionMatrix=_}projectFlat(t){return vf(t)}unprojectFlat(t){return Qm(t)}getMapCenterByLngLatPosition({lngLat:t,pos:r}){const i=yk(r,this.pixelUnprojectionMatrix),u=vf(t),h=pk([],u,n9([],i)),p=pk([],this.center,h);return Qm(p)}fitBounds(t,r={}){const{width:i,height:u}=this,{longitude:h,latitude:p,zoom:_}=E9(Object.assign({width:i,height:u,bounds:t},r));return new vS({width:i,height:u,longitude:h,latitude:p,zoom:_})}getBounds(t){const r=this.getBoundingRegion(t),i=Math.min(...r.map(_=>_[0])),u=Math.max(...r.map(_=>_[0])),h=Math.min(...r.map(_=>_[1])),p=Math.max(...r.map(_=>_[1]));return[[i,h],[u,p]]}getBoundingRegion(t={}){return P9(this,t.z||0)}getLocationAtPoint({lngLat:t,pos:r}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:r})}}var M9={exports:{}};(function(e){function t(x){if(x=Object.assign({},x),!(this instanceof t))throw new Error("MapboxLanguage needs to be called with the new keyword");this.setLanguage=this.setLanguage.bind(this),this._initialStyleUpdate=this._initialStyleUpdate.bind(this),this._defaultLanguage=x.defaultLanguage,this._isLanguageField=x.languageField||/^name_/,this._getLanguageField=x.getLanguageField||function(A){return A==="mul"?"name":`name_${A}`},this._languageSource=x.languageSource||null,this._languageTransform=x.languageTransform,this._excludedLayerIds=x.excludedLayerIds||[],this.supportedLanguages=x.supportedLanguages||["ar","de","en","es","fr","it","ja","ko","mul","pt","ru","vi","zh-Hans","zh-Hant"]}const r=/^\{name/;function i(x,E){const A=Array.isArray(E)&&E[0]==="get";return A&&r.test(E[1])&&console.warn("This plugin no longer supports the use of token syntax (e.g. {name}). Please use a get expression. See https://docs.mapbox.com/mapbox-gl-js/style-spec/expressions/ for more details."),A&&x.test(E[1])}function u(x,E,A){if(Array.isArray(E))for(let O=1;O<E.length;O++)Array.isArray(E[O])&&(i(x,E[O])&&(E[O][1]=A),u(x,E[O],A))}function h(x,E,A){if(i(x,E)&&(E[1]=A),u(x,E,A),E[0]==="get"&&E[1]==="name"){const O=E.slice();E=["coalesce",["get",A],O]}return E}function p(x,E,A,O){return E.layout&&E.layout["text-field"]&&O.indexOf(E.id)===-1?Object.assign({},E,{layout:Object.assign({},E.layout,{"text-field":h(x,E.layout["text-field"],A)})}):E}function _(x){const E=Object.keys(x.sources).filter(A=>{const O=x.sources[A].url;return O&&O.indexOf("mapbox.mapbox-streets-v8")>-1||/mapbox-streets-v[1-9][1-9]/.test(O)});if(!E.length)throw new Error('If using MapboxLanguage with a Mapbox style, the style must be based on vector tile version 8, e.g. "streets-v11"');return E[0]}t.prototype.setLanguage=function(x,E){if(this.supportedLanguages.indexOf(E)<0)throw new Error(`Language ${E} is not supported`);const A=this._languageSource||_(x);if(!A)return x;const O=this._getLanguageField(E),L=this._isLanguageField,j=this._excludedLayerIds,F=x.layers.map($=>$.source===A?p(L,$,O,j):$),Z=Object.assign({},x,{layers:F});return this._languageTransform?this._languageTransform(Z,E):Z},t.prototype._initialStyleUpdate=function(){const x=this._map.getStyle(),E=this._defaultLanguage||o(this.supportedLanguages);this._map.setStyle(this.setLanguage(x,E))};function o(x){const E=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,A=E&&E.split("-");let O=E;return A.length>1&&(O=A[0]),x.indexOf(O)>-1?O:null}t.prototype.onAdd=function(x){return this._map=x,this._map.on("style.load",this._initialStyleUpdate),this._container=document.createElement("div"),this._container},t.prototype.onRemove=function(){this._map.off("style.load",this._initialStyleUpdate),this._map=void 0},e.exports=t})(M9);const C9=De.createContext(null);function O9(e,t){const r=Array.isArray(e)?e[0]:e?e.x:0,i=Array.isArray(e)?e[1]:e?e.y:0,u=Array.isArray(t)?t[0]:t?t.x:0,h=Array.isArray(t)?t[1]:t?t.y:0;return r===u&&i===h}function Io(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Io(e[r],t[r]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const u of r)if(!t.hasOwnProperty(u)||!Io(e[u],t[u]))return!1;return!0}return!1}function I9(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}function xk(e,t){if(!e.getProjection)return;const r=e.getProjection(),i=t.getProjection();Io(r,i)||t.setProjection(r)}function bk(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function wk(e,t){const r=t.viewState||t;let i=!1;if("longitude"in r&&"latitude"in r){const u=e.center;e.center=new u.constructor(r.longitude,r.latitude),i=i||u!==e.center}if("zoom"in r){const u=e.zoom;e.zoom=r.zoom,i=i||u!==e.zoom}if("bearing"in r){const u=e.bearing;e.bearing=r.bearing,i=i||u!==e.bearing}if("pitch"in r){const u=e.pitch;e.pitch=r.pitch,i=i||u!==e.pitch}return r.padding&&!e.isPaddingEqual(r.padding)&&(i=!0,e.padding=r.padding),i}const k9=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Tk(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const i of e.layers)t[i.id]=i;const r=e.layers.map(i=>{let u=null;"interactive"in i&&(u=Object.assign({},i),delete u.interactive);const h=t[i.ref];if(h){u=u||Object.assign({},i),delete u.ref;for(const p of k9)p in h&&(u[p]=h[p])}return u||i});return{...e,layers:r}}var Sk={};const Ek={version:8,sources:{},layers:[]},Ak={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},jw={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Pk={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},D9=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],L9=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Xf{constructor(t,r,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=u=>{const h=this.props[Pk[u.type]];h?h(u):u.type==="error"&&console.error(u.error)},this._onPointerEvent=u=>{(u.type==="mousemove"||u.type==="mouseout")&&this._updateHover(u);const h=this.props[Ak[u.type]];h&&(this.props.interactiveLayerIds&&u.type!=="mouseover"&&u.type!=="mouseout"&&(u.features=this._hoveredFeatures||this._queryRenderedFeatures(u.point)),h(u),delete u.features)},this._onCameraEvent=u=>{if(!this._internalUpdate){const h=this.props[jw[u.type]];h&&h(u)}u.type in this._deferredEvents&&(this._deferredEvents[u.type]=!1)},this._MapClass=t,this.props=r,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const r=this.props;this.props=t;const i=this._updateSettings(t,r);i&&this._createShadowTransform(this._map);const u=this._updateSize(t),h=this._updateViewState(t,!0);this._updateStyle(t,r),this._updateStyleComponents(t,r),this._updateHandlers(t,r),(i||u||h&&!this._map.isMoving())&&this.redraw()}static reuse(t,r){const i=Xf.savedMaps.pop();if(!i)return null;const u=i.map,h=u.getContainer();for(r.className=h.className;h.childNodes.length>0;)r.appendChild(h.childNodes[0]);u._container=r;const p=u._resizeObserver;p&&(p.disconnect(),p.observe(r)),i.setProps({...t,styleDiffing:!1}),u.resize();const{initialViewState:_}=t;return _&&(_.bounds?u.fitBounds(_.bounds,{..._.fitBoundsOptions,duration:0}):i._updateViewState(_,!1)),u.isStyleLoaded()?u.fire("load"):u.once("styledata",()=>u.fire("load")),u._update(),i}_initialize(t){const{props:r}=this,{mapStyle:i=Ek}=r,u={...r,...r.initialViewState,accessToken:r.mapboxAccessToken||z9()||null,container:t,style:Tk(i)},h=u.initialViewState||u.viewState||u;if(Object.assign(u,{center:[h.longitude||0,h.latitude||0],zoom:h.zoom||0,pitch:h.pitch||0,bearing:h.bearing||0}),r.gl){const E=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=E,r.gl)}const p=new this._MapClass(u);h.padding&&p.setPadding(h.padding),r.cursor&&(p.getCanvas().style.cursor=r.cursor),this._createShadowTransform(p);const _=p._render;p._render=E=>{this._inRender=!0,_.call(p,E),this._inRender=!1};const o=p._renderTaskQueue.run;p._renderTaskQueue.run=E=>{o.call(p._renderTaskQueue,E),this._onBeforeRepaint()},p.on("render",()=>this._onAfterRepaint());const x=p.fire;p.fire=this._fireEvent.bind(this,x),p.on("resize",()=>{this._renderTransform.resize(p.transform.width,p.transform.height)}),p.on("styledata",()=>{this._updateStyleComponents(this.props,{}),xk(p.transform,this._renderTransform)}),p.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const E in Ak)p.on(E,this._onPointerEvent);for(const E in jw)p.on(E,this._onCameraEvent);for(const E in Pk)p.on(E,this._onEvent);this._map=p}recycle(){const r=this.map.getContainer().querySelector("[mapboxgl-children]");r==null||r.remove(),Xf.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const r=I9(t.transform);t.painter.transform=r,this._renderTransform=r}_updateSize(t){const{viewState:r}=t;if(r){const i=this._map;if(r.width!==i.transform.width||r.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(t,r){if(this._internalUpdate)return!1;const i=this._map,u=this._renderTransform,{zoom:h,pitch:p,bearing:_}=u,o=i.isMoving();o&&(u.cameraElevationReference="sea");const x=wk(u,{...bk(i.transform),...t});if(o&&(u.cameraElevationReference="ground"),x&&r){const E=this._deferredEvents;E.move=!0,E.zoom||(E.zoom=h!==u.zoom),E.rotate||(E.rotate=_!==u.bearing),E.pitch||(E.pitch=p!==u.pitch)}return o||wk(i.transform,t),x}_updateSettings(t,r){const i=this._map;let u=!1;for(const h of D9)if(h in t&&!Io(t[h],r[h])){u=!0;const p=i[`set${h[0].toUpperCase()}${h.slice(1)}`];p==null||p.call(i,t[h])}return u}_updateStyle(t,r){if(t.cursor!==r.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==r.mapStyle){const{mapStyle:i=Ek,styleDiffing:u=!0}=t,h={diff:u};return"localIdeographFontFamily"in t&&(h.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(Tk(i),h),!0}return!1}_updateStyleComponents(t,r){const i=this._map;let u=!1;return i.isStyleLoaded()&&("light"in t&&i.setLight&&!Io(t.light,r.light)&&(u=!0,i.setLight(t.light)),"fog"in t&&i.setFog&&!Io(t.fog,r.fog)&&(u=!0,i.setFog(t.fog)),"terrain"in t&&i.setTerrain&&!Io(t.terrain,r.terrain)&&(!t.terrain||i.getSource(t.terrain.source))&&(u=!0,i.setTerrain(t.terrain))),u}_updateHandlers(t,r){var i,u;const h=this._map;let p=!1;for(const _ of L9){const o=(i=t[_])!==null&&i!==void 0?i:!0,x=(u=r[_])!==null&&u!==void 0?u:!0;Io(o,x)||(p=!0,o?h[_].enable(o):h[_].disable())}return p}_queryRenderedFeatures(t){const r=this._map,i=r.transform,{interactiveLayerIds:u=[]}=this.props;try{return r.transform=this._renderTransform,r.queryRenderedFeatures(t,{layers:u.filter(r.getLayer.bind(r))})}catch{return[]}finally{r.transform=i}}_updateHover(t){var r;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const h=t.type,p=((r=this._hoveredFeatures)===null||r===void 0?void 0:r.length)>0,_=this._queryRenderedFeatures(t.point),o=_.length>0;!o&&p&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=_,o&&!p&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=h}else this._hoveredFeatures=null}_fireEvent(t,r,i){const u=this._map,h=u.transform,p=typeof r=="string"?r:r.type;return p==="move"&&this._updateViewState(this.props,!1),p in jw&&(typeof r=="object"&&(r.viewState=bk(h)),this._map.isMoving())?(u.transform=this._renderTransform,t.call(u,r,i),u.transform=h,u):(t.call(u,r,i),u)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&t.fire(i);this._internalUpdate=!1;const r=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{xk(this._renderTransform,r),t.transform=r}}}Xf.savedMaps=[];function z9(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||Sk.MapboxAccessToken}catch{}try{e=e||Sk.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const R9=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function B9(e){if(!e)return null;const t=e.map,r={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:i=>{const u=t.transform;t.transform=e.transform;const h=t.project(i);return t.transform=u,h},unproject:i=>{const u=t.transform;t.transform=e.transform;const h=t.unproject(i);return t.transform=u,h},queryTerrainElevation:(i,u)=>{const h=t.transform;t.transform=e.transform;const p=t.queryTerrainElevation(i,u);return t.transform=h,p},queryRenderedFeatures:(i,u)=>{const h=t.transform;t.transform=e.transform;const p=t.queryRenderedFeatures(i,u);return t.transform=h,p}};for(const i of j9(t))!(i in r)&&!R9.includes(i)&&(r[i]=t[i].bind(t));return r}function j9(e){const t=new Set;let r=e;for(;r;){for(const i of Object.getOwnPropertyNames(r))i[0]!=="_"&&typeof e[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&t.add(i);r=Object.getPrototypeOf(r)}return Array.from(t)}const F9=typeof document<"u"?De.useLayoutEffect:De.useEffect,$9=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function N9(e,t){for(const i of $9)i in t&&(e[i]=t[i]);const{RTLTextPlugin:r="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;r&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(r,i=>{i&&console.error(i)},!1)}const wd=De.createContext(null);function U9(e,t,r){const i=De.useContext(C9),[u,h]=De.useState(null),p=De.useRef(),{current:_}=De.useRef({mapLib:null,map:null});De.useEffect(()=>{const E=e.mapLib;let A=!0,O;return Promise.resolve(E||r).then(L=>{if(!A)return;if(!L)throw new Error("Invalid mapLib");const j="Map"in L?L:L.default;if(!j.Map)throw new Error("Invalid mapLib");if(N9(j,e),!j.supported||j.supported(e))e.reuseMaps&&(O=Xf.reuse(e,p.current)),O||(O=new Xf(j.Map,e,p.current)),_.map=B9(O),_.mapLib=j,h(O),i==null||i.onMapMount(_.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(L=>{const{onError:j}=e;j?j({type:"error",target:null,originalEvent:null,error:L}):console.error(L)}),()=>{A=!1,O&&(i==null||i.onMapUnmount(e.id),e.reuseMaps?O.recycle():O.destroy())}},[]),F9(()=>{u&&u.setProps(e)}),De.useImperativeHandle(t,()=>_.map,[u]);const o=De.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),x={height:"100%"};return De.createElement("div",{id:e.id,ref:p,style:o},u&&De.createElement(wd.Provider,{value:_},De.createElement("div",{"mapboxgl-children":"",style:x},e.children)))}const V9=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Gc(e,t){if(!e||!t)return;const r=e.style;for(const i in t){const u=t[i];Number.isFinite(u)&&!V9.test(i)?r[i]=`${u}px`:r[i]=u}}function G9(e,t){const{map:r,mapLib:i}=De.useContext(wd),u=De.useRef({props:e});u.current.props=e;const h=De.useMemo(()=>{let F=!1;De.Children.forEach(e.children,V=>{V&&(F=!0)});const Z={...e,element:F?document.createElement("div"):null},$=new i.Marker(Z);return $.setLngLat([e.longitude,e.latitude]),$.getElement().addEventListener("click",V=>{var U,G;(G=(U=u.current.props).onClick)===null||G===void 0||G.call(U,{type:"click",target:$,originalEvent:V})}),$.on("dragstart",V=>{var U,G;const q=V;q.lngLat=h.getLngLat(),(G=(U=u.current.props).onDragStart)===null||G===void 0||G.call(U,q)}),$.on("drag",V=>{var U,G;const q=V;q.lngLat=h.getLngLat(),(G=(U=u.current.props).onDrag)===null||G===void 0||G.call(U,q)}),$.on("dragend",V=>{var U,G;const q=V;q.lngLat=h.getLngLat(),(G=(U=u.current.props).onDragEnd)===null||G===void 0||G.call(U,q)}),$},[]);De.useEffect(()=>(h.addTo(r.getMap()),()=>{h.remove()}),[]);const{longitude:p,latitude:_,offset:o,style:x,draggable:E=!1,popup:A=null,rotation:O=0,rotationAlignment:L="auto",pitchAlignment:j="auto"}=e;return De.useEffect(()=>{Gc(h.getElement(),x)},[x]),De.useImperativeHandle(t,()=>h,[]),(h.getLngLat().lng!==p||h.getLngLat().lat!==_)&&h.setLngLat([p,_]),o&&!O9(h.getOffset(),o)&&h.setOffset(o),h.isDraggable()!==E&&h.setDraggable(E),h.getRotation()!==O&&h.setRotation(O),h.getRotationAlignment()!==L&&h.setRotationAlignment(L),h.getPitchAlignment()!==j&&h.setPitchAlignment(j),h.getPopup()!==A&&h.setPopup(A),RA.createPortal(e.children,h.getElement())}const W9=De.memo(De.forwardRef(G9));function Mk(e){return new Set(e?e.trim().split(/\s+/):[])}function q9(e,t){const{map:r,mapLib:i}=De.useContext(wd),u=De.useMemo(()=>document.createElement("div"),[]),h=De.useRef({props:e});h.current.props=e;const p=De.useMemo(()=>{const _={...e},o=new i.Popup(_);return o.setLngLat([e.longitude,e.latitude]),o.once("open",x=>{var E,A;(A=(E=h.current.props).onOpen)===null||A===void 0||A.call(E,x)}),o},[]);if(De.useEffect(()=>{const _=o=>{var x,E;(E=(x=h.current.props).onClose)===null||E===void 0||E.call(x,o)};return p.on("close",_),p.setDOMContent(u).addTo(r.getMap()),()=>{p.off("close",_),p.isOpen()&&p.remove()}},[]),De.useEffect(()=>{Gc(p.getElement(),e.style)},[e.style]),De.useImperativeHandle(t,()=>p,[]),p.isOpen()&&((p.getLngLat().lng!==e.longitude||p.getLngLat().lat!==e.latitude)&&p.setLngLat([e.longitude,e.latitude]),e.offset&&!Io(p.options.offset,e.offset)&&p.setOffset(e.offset),(p.options.anchor!==e.anchor||p.options.maxWidth!==e.maxWidth)&&(p.options.anchor=e.anchor,p.setMaxWidth(e.maxWidth)),p.options.className!==e.className)){const _=Mk(p.options.className),o=Mk(e.className);for(const x of _)o.has(x)||p.removeClassName(x);for(const x of o)_.has(x)||p.addClassName(x);p.options.className=e.className}return RA.createPortal(e.children,u)}De.memo(De.forwardRef(q9));function hy(e,t,r,i){const u=De.useContext(wd),h=De.useMemo(()=>e(u),[]);return De.useEffect(()=>{const p=t,_=null,o=typeof t=="function"?t:null,{map:x}=u;return x.hasControl(h)||(x.addControl(h,p==null?void 0:p.position),_&&_(u)),()=>{o&&o(u),x.hasControl(h)&&x.removeControl(h)}},[]),h}function Z9(e){const t=hy(({mapLib:r})=>new r.AttributionControl(e),{position:e.position});return De.useEffect(()=>{Gc(t._container,e.style)},[e.style]),null}De.memo(Z9);function H9(e){const t=hy(({mapLib:r})=>new r.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return De.useEffect(()=>{Gc(t._controlContainer,e.style)},[e.style]),null}const X9=De.memo(H9);function K9(e,t){const r=De.useRef({props:e}),i=hy(({mapLib:u})=>{const h=new u.GeolocateControl(e),p=h._setupUI;return h._setupUI=_=>{h._container.hasChildNodes()||p(_)},h.on("geolocate",_=>{var o,x;(x=(o=r.current.props).onGeolocate)===null||x===void 0||x.call(o,_)}),h.on("error",_=>{var o,x;(x=(o=r.current.props).onError)===null||x===void 0||x.call(o,_)}),h.on("outofmaxbounds",_=>{var o,x;(x=(o=r.current.props).onOutOfMaxBounds)===null||x===void 0||x.call(o,_)}),h.on("trackuserlocationstart",_=>{var o,x;(x=(o=r.current.props).onTrackUserLocationStart)===null||x===void 0||x.call(o,_)}),h.on("trackuserlocationend",_=>{var o,x;(x=(o=r.current.props).onTrackUserLocationEnd)===null||x===void 0||x.call(o,_)}),h},{position:e.position});return r.current.props=e,De.useImperativeHandle(t,()=>i,[]),De.useEffect(()=>{Gc(i._container,e.style)},[e.style]),null}De.memo(De.forwardRef(K9));function Y9(e){const t=hy(({mapLib:r})=>new r.NavigationControl(e),{position:e.position});return De.useEffect(()=>{Gc(t._container,e.style)},[e.style]),null}const J9=De.memo(Y9);function Q9(e){const t=hy(({mapLib:h})=>new h.ScaleControl(e),{position:e.position}),r=De.useRef(e),i=r.current;r.current=e;const{style:u}=e;return e.maxWidth!==void 0&&e.maxWidth!==i.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==i.unit&&t.setUnit(e.unit),De.useEffect(()=>{Gc(t._container,u)},[u]),null}De.memo(Q9);function x0(e,t){if(!e)throw new Error(t)}function e7(e,t,r,i){if(x0(r.id===i.id,"layer id changed"),x0(r.type===i.type,"layer type changed"),r.type==="custom"||i.type==="custom")return;const{layout:u={},paint:h={},filter:p,minzoom:_,maxzoom:o,beforeId:x}=r;if(x!==i.beforeId&&e.moveLayer(t,x),u!==i.layout){const E=i.layout||{};for(const A in u)Io(u[A],E[A])||e.setLayoutProperty(t,A,u[A]);for(const A in E)u.hasOwnProperty(A)||e.setLayoutProperty(t,A,void 0)}if(h!==i.paint){const E=i.paint||{};for(const A in h)Io(h[A],E[A])||e.setPaintProperty(t,A,h[A]);for(const A in E)h.hasOwnProperty(A)||e.setPaintProperty(t,A,void 0)}Io(p,i.filter)||e.setFilter(t,p),(_!==i.minzoom||o!==i.maxzoom)&&e.setLayerZoomRange(t,_,o)}function t7(e,t,r){if(e.style&&e.style._loaded&&(!("source"in r)||e.getSource(r.source))){const i={...r,id:t};delete i.beforeId,e.addLayer(i,r.beforeId)}}let r7=0;function n7(e){const t=De.useContext(wd).map.getMap(),r=De.useRef(e),[,i]=De.useState(0),u=De.useMemo(()=>e.id||`jsx-layer-${r7++}`,[]);if(De.useEffect(()=>{if(t){const p=()=>i(_=>_+1);return t.on("styledata",p),p(),()=>{t.off("styledata",p),t.style&&t.style._loaded&&t.getLayer(u)&&t.removeLayer(u)}}},[t]),t&&t.style&&t.getLayer(u))try{e7(t,u,e,r.current)}catch(p){console.warn(p)}else t7(t,u,e);return r.current=e,null}let i7=0;function o7(e,t,r){if(e.style&&e.style._loaded){const i={...r};return delete i.id,delete i.children,e.addSource(t,i),e.getSource(t)}return null}function a7(e,t,r){x0(t.id===r.id,"source id changed"),x0(t.type===r.type,"source type changed");let i="",u=0;for(const p in t)p!=="children"&&p!=="id"&&!Io(r[p],t[p])&&(i=p,u++);if(!u)return;const h=t.type;if(h==="geojson")e.setData(t.data);else if(h==="image")e.updateImage({url:t.url,coordinates:t.coordinates});else if("setCoordinates"in e&&u===1&&i==="coordinates")e.setCoordinates(t.coordinates);else if("setUrl"in e)switch(i){case"url":e.setUrl(t.url);break;case"tiles":e.setTiles(t.tiles);break}else console.warn(`Unable to update <Source> prop: ${i}`)}function s7(e){const t=De.useContext(wd).map.getMap(),r=De.useRef(e),[,i]=De.useState(0),u=De.useMemo(()=>e.id||`jsx-source-${i7++}`,[]);De.useEffect(()=>{if(t){const p=()=>setTimeout(()=>i(_=>_+1),0);return t.on("styledata",p),p(),()=>{var _;if(t.off("styledata",p),t.style&&t.style._loaded&&t.getSource(u)){const o=(_=t.getStyle())===null||_===void 0?void 0:_.layers;if(o)for(const x of o)x.source===u&&t.removeLayer(x.id);t.removeSource(u)}}}},[t]);let h=t&&t.style&&t.getSource(u);return h?a7(h,e,r.current):h=o7(t,u,e),r.current=e,h&&De.Children.map(e.children,p=>p&&De.cloneElement(p,{source:u}))||null}const l7=NG(()=>Promise.resolve().then(()=>Oge),void 0),Fge=De.forwardRef(function(t,r){return U9(t,r,l7)}),$ge=W9,Nge=X9,Uge=J9,Vge=n7,Gge=s7;var u7={},d4={},p4={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(){for(var u=arguments.length,h=new Array(u),p=0;p<u;p++)h[p]=arguments[p];if(typeof window<"u"){var _;typeof window.gtag>"u"&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)}),(_=window).gtag.apply(_,h)}},r=t;e.default=r})(p4);var m4={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=p;var t=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;function r(_){return _.toString().trim().replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(o,x,E){return x>0&&x+o.length!==E.length&&o.search(t)>-1&&E.charAt(x-2)!==":"&&(E.charAt(x+o.length)!=="-"||E.charAt(x-1)==="-")&&E.charAt(x-1).search(/[^\s-]/)<0?o.toLowerCase():o.substr(1).search(/[A-Z]|\../)>-1?o:o.charAt(0).toUpperCase()+o.substr(1)})}function i(_){return typeof _=="string"&&_.indexOf("@")!==-1}var u="REDACTED (Potential Email Address)";function h(_){return i(_)?(console.warn("This arg looks like an email address, redacting."),u):_}function p(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,E=_||"";return o&&(E=r(_)),x&&(E=h(E)),E}})(m4);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.GA4=void 0;var t=p(p4),r=p(m4),i=["eventCategory","eventAction","eventLabel","eventValue","hitType"],u=["title","location"],h=["page","hitType"];function p(be){return be&&be.__esModule?be:{default:be}}function _(be,_e){if(be==null)return{};var Me=o(be,_e),ke,Ce;if(Object.getOwnPropertySymbols){var Oe=Object.getOwnPropertySymbols(be);for(Ce=0;Ce<Oe.length;Ce++)ke=Oe[Ce],!(_e.indexOf(ke)>=0)&&Object.prototype.propertyIsEnumerable.call(be,ke)&&(Me[ke]=be[ke])}return Me}function o(be,_e){if(be==null)return{};var Me={},ke=Object.keys(be),Ce,Oe;for(Oe=0;Oe<ke.length;Oe++)Ce=ke[Oe],!(_e.indexOf(Ce)>=0)&&(Me[Ce]=be[Ce]);return Me}function x(be){"@babel/helpers - typeof";return x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_e){return typeof _e}:function(_e){return _e&&typeof Symbol=="function"&&_e.constructor===Symbol&&_e!==Symbol.prototype?"symbol":typeof _e},x(be)}function E(be){return L(be)||O(be)||V(be)||A()}function A(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O(be){if(typeof Symbol<"u"&&be[Symbol.iterator]!=null||be["@@iterator"]!=null)return Array.from(be)}function L(be){if(Array.isArray(be))return U(be)}function j(be,_e){var Me=Object.keys(be);if(Object.getOwnPropertySymbols){var ke=Object.getOwnPropertySymbols(be);_e&&(ke=ke.filter(function(Ce){return Object.getOwnPropertyDescriptor(be,Ce).enumerable})),Me.push.apply(Me,ke)}return Me}function F(be){for(var _e=1;_e<arguments.length;_e++){var Me=arguments[_e]!=null?arguments[_e]:{};_e%2?j(Object(Me),!0).forEach(function(ke){xe(be,ke,Me[ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(be,Object.getOwnPropertyDescriptors(Me)):j(Object(Me)).forEach(function(ke){Object.defineProperty(be,ke,Object.getOwnPropertyDescriptor(Me,ke))})}return be}function Z(be,_e){return q(be)||G(be,_e)||V(be,_e)||$()}function $(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V(be,_e){if(be){if(typeof be=="string")return U(be,_e);var Me=Object.prototype.toString.call(be).slice(8,-1);if(Me==="Object"&&be.constructor&&(Me=be.constructor.name),Me==="Map"||Me==="Set")return Array.from(be);if(Me==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Me))return U(be,_e)}}function U(be,_e){(_e==null||_e>be.length)&&(_e=be.length);for(var Me=0,ke=new Array(_e);Me<_e;Me++)ke[Me]=be[Me];return ke}function G(be,_e){var Me=be==null?null:typeof Symbol<"u"&&be[Symbol.iterator]||be["@@iterator"];if(Me!=null){var ke,Ce,Oe,at,ft=[],st=!0,Ot=!1;try{if(Oe=(Me=Me.call(be)).next,_e!==0)for(;!(st=(ke=Oe.call(Me)).done)&&(ft.push(ke.value),ft.length!==_e);st=!0);}catch(St){Ot=!0,Ce=St}finally{try{if(!st&&Me.return!=null&&(at=Me.return(),Object(at)!==at))return}finally{if(Ot)throw Ce}}return ft}}function q(be){if(Array.isArray(be))return be}function K(be,_e){if(!(be instanceof _e))throw new TypeError("Cannot call a class as a function")}function re(be,_e){for(var Me=0;Me<_e.length;Me++){var ke=_e[Me];ke.enumerable=ke.enumerable||!1,ke.configurable=!0,"value"in ke&&(ke.writable=!0),Object.defineProperty(be,ge(ke.key),ke)}}function pe(be,_e,Me){return _e&&re(be.prototype,_e),Object.defineProperty(be,"prototype",{writable:!1}),be}function xe(be,_e,Me){return _e=ge(_e),_e in be?Object.defineProperty(be,_e,{value:Me,enumerable:!0,configurable:!0,writable:!0}):be[_e]=Me,be}function ge(be){var _e=Be(be,"string");return x(_e)==="symbol"?_e:String(_e)}function Be(be,_e){if(x(be)!=="object"||be===null)return be;var Me=be[Symbol.toPrimitive];if(Me!==void 0){var ke=Me.call(be,_e);if(x(ke)!=="object")return ke;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_e==="string"?String:Number)(be)}var $e=function(){function be(){var _e=this;K(this,be),xe(this,"reset",function(){_e.isInitialized=!1,_e._testMode=!1,_e._currentMeasurementId,_e._hasLoadedGA=!1,_e._isQueuing=!1,_e._queueGtag=[]}),xe(this,"_gtag",function(){for(var Me=arguments.length,ke=new Array(Me),Ce=0;Ce<Me;Ce++)ke[Ce]=arguments[Ce];_e._testMode||_e._isQueuing?_e._queueGtag.push(ke):t.default.apply(void 0,ke)}),xe(this,"_loadGA",function(Me,ke){var Ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"https://www.googletagmanager.com/gtag/js";if(!(typeof window>"u"||typeof document>"u")&&!_e._hasLoadedGA){var Oe=document.createElement("script");Oe.async=!0,Oe.src="".concat(Ce,"?id=").concat(Me),ke&&Oe.setAttribute("nonce",ke),document.body.appendChild(Oe),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},_e._hasLoadedGA=!0}}),xe(this,"_toGtagOptions",function(Me){if(Me){var ke={cookieUpdate:"cookie_update",cookieExpires:"cookie_expires",cookieDomain:"cookie_domain",cookieFlags:"cookie_flags",userId:"user_id",clientId:"client_id",anonymizeIp:"anonymize_ip",contentGroup1:"content_group1",contentGroup2:"content_group2",contentGroup3:"content_group3",contentGroup4:"content_group4",contentGroup5:"content_group5",allowAdFeatures:"allow_google_signals",allowAdPersonalizationSignals:"allow_ad_personalization_signals",nonInteraction:"non_interaction",page:"page_path",hitCallback:"event_callback"},Ce=Object.entries(Me).reduce(function(Oe,at){var ft=Z(at,2),st=ft[0],Ot=ft[1];return ke[st]?Oe[ke[st]]=Ot:Oe[st]=Ot,Oe},{});return Ce}}),xe(this,"initialize",function(Me){var ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Me)throw new Error("Require GA_MEASUREMENT_ID");var Ce=typeof Me=="string"?[{trackingId:Me}]:Me;_e._currentMeasurementId=Ce[0].trackingId;var Oe=ke.gaOptions,at=ke.gtagOptions,ft=ke.nonce,st=ke.testMode,Ot=st===void 0?!1:st,St=ke.gtagUrl;if(_e._testMode=Ot,Ot||_e._loadGA(_e._currentMeasurementId,ft,St),_e.isInitialized||(_e._gtag("js",new Date),Ce.forEach(function(Kr){var yr=F(F(F({},_e._toGtagOptions(F(F({},Oe),Kr.gaOptions))),at),Kr.gtagOptions);Object.keys(yr).length?_e._gtag("config",Kr.trackingId,yr):_e._gtag("config",Kr.trackingId)})),_e.isInitialized=!0,!Ot){var pr=E(_e._queueGtag);for(_e._queueGtag=[],_e._isQueuing=!1;pr.length;){var Tr=pr.shift();_e._gtag.apply(_e,E(Tr)),Tr[0]==="get"&&(_e._isQueuing=!0)}}}),xe(this,"set",function(Me){if(!Me){console.warn("`fieldsObject` is required in .set()");return}if(x(Me)!=="object"){console.warn("Expected `fieldsObject` arg to be an Object");return}Object.keys(Me).length===0&&console.warn("empty `fieldsObject` given to .set()"),_e._gaCommand("set",Me)}),xe(this,"_gaCommandSendEvent",function(Me,ke,Ce,Oe,at){_e._gtag("event",ke,F(F({event_category:Me,event_label:Ce,value:Oe},at&&{non_interaction:at.nonInteraction}),_e._toGtagOptions(at)))}),xe(this,"_gaCommandSendEventParameters",function(){for(var Me=arguments.length,ke=new Array(Me),Ce=0;Ce<Me;Ce++)ke[Ce]=arguments[Ce];if(typeof ke[0]=="string")_e._gaCommandSendEvent.apply(_e,E(ke.slice(1)));else{var Oe=ke[0],at=Oe.eventCategory,ft=Oe.eventAction,st=Oe.eventLabel,Ot=Oe.eventValue;Oe.hitType;var St=_(Oe,i);_e._gaCommandSendEvent(at,ft,st,Ot,St)}}),xe(this,"_gaCommandSendTiming",function(Me,ke,Ce,Oe){_e._gtag("event","timing_complete",{name:ke,value:Ce,event_category:Me,event_label:Oe})}),xe(this,"_gaCommandSendPageview",function(Me,ke){if(ke&&Object.keys(ke).length){var Ce=_e._toGtagOptions(ke),Oe=Ce.title,at=Ce.location,ft=_(Ce,u);_e._gtag("event","page_view",F(F(F(F({},Me&&{page_path:Me}),Oe&&{page_title:Oe}),at&&{page_location:at}),ft))}else Me?_e._gtag("event","page_view",{page_path:Me}):_e._gtag("event","page_view")}),xe(this,"_gaCommandSendPageviewParameters",function(){for(var Me=arguments.length,ke=new Array(Me),Ce=0;Ce<Me;Ce++)ke[Ce]=arguments[Ce];if(typeof ke[0]=="string")_e._gaCommandSendPageview.apply(_e,E(ke.slice(1)));else{var Oe=ke[0],at=Oe.page;Oe.hitType;var ft=_(Oe,h);_e._gaCommandSendPageview(at,ft)}}),xe(this,"_gaCommandSend",function(){for(var Me=arguments.length,ke=new Array(Me),Ce=0;Ce<Me;Ce++)ke[Ce]=arguments[Ce];var Oe=typeof ke[0]=="string"?ke[0]:ke[0].hitType;switch(Oe){case"event":_e._gaCommandSendEventParameters.apply(_e,ke);break;case"pageview":_e._gaCommandSendPageviewParameters.apply(_e,ke);break;case"timing":_e._gaCommandSendTiming.apply(_e,E(ke.slice(1)));break;case"screenview":case"transaction":case"item":case"social":case"exception":console.warn("Unsupported send command: ".concat(Oe));break;default:console.warn("Send command doesn't exist: ".concat(Oe))}}),xe(this,"_gaCommandSet",function(){for(var Me=arguments.length,ke=new Array(Me),Ce=0;Ce<Me;Ce++)ke[Ce]=arguments[Ce];typeof ke[0]=="string"&&(ke[0]=xe({},ke[0],ke[1])),_e._gtag("set",_e._toGtagOptions(ke[0]))}),xe(this,"_gaCommand",function(Me){for(var ke=arguments.length,Ce=new Array(ke>1?ke-1:0),Oe=1;Oe<ke;Oe++)Ce[Oe-1]=arguments[Oe];switch(Me){case"send":_e._gaCommandSend.apply(_e,Ce);break;case"set":_e._gaCommandSet.apply(_e,Ce);break;default:console.warn("Command doesn't exist: ".concat(Me))}}),xe(this,"ga",function(){for(var Me=arguments.length,ke=new Array(Me),Ce=0;Ce<Me;Ce++)ke[Ce]=arguments[Ce];if(typeof ke[0]=="string")_e._gaCommand.apply(_e,ke);else{var Oe=ke[0];_e._gtag("get",_e._currentMeasurementId,"client_id",function(at){_e._isQueuing=!1;var ft=_e._queueGtag;for(Oe({get:function(St){return St==="clientId"?at:St==="trackingId"?_e._currentMeasurementId:St==="apiVersion"?"1":void 0}});ft.length;){var st=ft.shift();_e._gtag.apply(_e,E(st))}}),_e._isQueuing=!0}return _e.ga}),xe(this,"event",function(Me,ke){if(typeof Me=="string")_e._gtag("event",Me,_e._toGtagOptions(ke));else{var Ce=Me.action,Oe=Me.category,at=Me.label,ft=Me.value,st=Me.nonInteraction,Ot=Me.transport;if(!Oe||!Ce){console.warn("args.category AND args.action are required in event()");return}var St={hitType:"event",eventCategory:(0,r.default)(Oe),eventAction:(0,r.default)(Ce)};at&&(St.eventLabel=(0,r.default)(at)),typeof ft<"u"&&(typeof ft!="number"?console.warn("Expected `args.value` arg to be a Number."):St.eventValue=ft),typeof st<"u"&&(typeof st!="boolean"?console.warn("`args.nonInteraction` must be a boolean."):St.nonInteraction=st),typeof Ot<"u"&&(typeof Ot!="string"?console.warn("`args.transport` must be a string."):(["beacon","xhr","image"].indexOf(Ot)===-1&&console.warn("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),St.transport=Ot)),_e._gaCommand("send",St)}}),xe(this,"send",function(Me){_e._gaCommand("send",Me)}),this.reset()}return pe(be,[{key:"gtag",value:function(){this._gtag.apply(this,arguments)}}]),be}();e.GA4=$e;var Ve=new $e;e.default=Ve})(d4);(function(e){function t(_){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},t(_)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.ReactGAImplementation=void 0;var r=u(d4);function i(_){if(typeof WeakMap!="function")return null;var o=new WeakMap,x=new WeakMap;return(i=function(A){return A?x:o})(_)}function u(_,o){if(_&&_.__esModule)return _;if(_===null||t(_)!=="object"&&typeof _!="function")return{default:_};var x=i(o);if(x&&x.has(_))return x.get(_);var E={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in _)if(O!=="default"&&Object.prototype.hasOwnProperty.call(_,O)){var L=A?Object.getOwnPropertyDescriptor(_,O):null;L&&(L.get||L.set)?Object.defineProperty(E,O,L):E[O]=_[O]}return E.default=_,x&&x.set(_,E),E}var h=r.GA4;e.ReactGAImplementation=h;var p=r.default;e.default=p})(u7);function g4(e){var t,r,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var u=e.length;for(t=0;t<u;t++)e[t]&&(r=g4(e[t]))&&(i&&(i+=" "),i+=r)}else for(r in e)e[r]&&(i&&(i+=" "),i+=r);return i}function en(){for(var e,t,r=0,i="",u=arguments.length;r<u;r++)(e=arguments[r])&&(t=g4(e))&&(i&&(i+=" "),i+=t);return i}var c7=Array.isArray,xo=c7,h7=typeof Bm=="object"&&Bm&&Bm.Object===Object&&Bm,y4=h7,f7=y4,d7=typeof self=="object"&&self&&self.Object===Object&&self,p7=f7||d7||Function("return this")(),bs=p7,m7=bs,g7=m7.Symbol,fy=g7,Ck=fy,_4=Object.prototype,y7=_4.hasOwnProperty,_7=_4.toString,Pm=Ck?Ck.toStringTag:void 0;function v7(e){var t=y7.call(e,Pm),r=e[Pm];try{e[Pm]=void 0;var i=!0}catch{}var u=_7.call(e);return i&&(t?e[Pm]=r:delete e[Pm]),u}var x7=v7,b7=Object.prototype,w7=b7.toString;function T7(e){return w7.call(e)}var S7=T7,Ok=fy,E7=x7,A7=S7,P7="[object Null]",M7="[object Undefined]",Ik=Ok?Ok.toStringTag:void 0;function C7(e){return e==null?e===void 0?M7:P7:Ik&&Ik in Object(e)?E7(e):A7(e)}var hl=C7;function O7(e){return e!=null&&typeof e=="object"}var fl=O7,I7=hl,k7=fl,D7="[object Symbol]";function L7(e){return typeof e=="symbol"||k7(e)&&I7(e)==D7}var Td=L7,z7=xo,R7=Td,B7=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,j7=/^\w*$/;function F7(e,t){if(z7(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||R7(e)?!0:j7.test(e)||!B7.test(e)||t!=null&&e in Object(t)}var VA=F7;function $7(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var vu=$7;const Sd=Xr(vu);var N7=hl,U7=vu,V7="[object AsyncFunction]",G7="[object Function]",W7="[object GeneratorFunction]",q7="[object Proxy]";function Z7(e){if(!U7(e))return!1;var t=N7(e);return t==G7||t==W7||t==V7||t==q7}var GA=Z7;const xr=Xr(GA);var H7=bs,X7=H7["__core-js_shared__"],K7=X7,Fw=K7,kk=function(){var e=/[^.]+$/.exec(Fw&&Fw.keys&&Fw.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Y7(e){return!!kk&&kk in e}var J7=Y7,Q7=Function.prototype,eW=Q7.toString;function tW(e){if(e!=null){try{return eW.call(e)}catch{}try{return e+""}catch{}}return""}var v4=tW,rW=GA,nW=J7,iW=vu,oW=v4,aW=/[\\^$.*+?()[\]{}|]/g,sW=/^\[object .+?Constructor\]$/,lW=Function.prototype,uW=Object.prototype,cW=lW.toString,hW=uW.hasOwnProperty,fW=RegExp("^"+cW.call(hW).replace(aW,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function dW(e){if(!iW(e)||nW(e))return!1;var t=rW(e)?fW:sW;return t.test(oW(e))}var pW=dW;function mW(e,t){return e==null?void 0:e[t]}var gW=mW,yW=pW,_W=gW;function vW(e,t){var r=_W(e,t);return yW(r)?r:void 0}var Wc=vW,xW=Wc,bW=xW(Object,"create"),Fx=bW,Dk=Fx;function wW(){this.__data__=Dk?Dk(null):{},this.size=0}var TW=wW;function SW(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var EW=SW,AW=Fx,PW="__lodash_hash_undefined__",MW=Object.prototype,CW=MW.hasOwnProperty;function OW(e){var t=this.__data__;if(AW){var r=t[e];return r===PW?void 0:r}return CW.call(t,e)?t[e]:void 0}var IW=OW,kW=Fx,DW=Object.prototype,LW=DW.hasOwnProperty;function zW(e){var t=this.__data__;return kW?t[e]!==void 0:LW.call(t,e)}var RW=zW,BW=Fx,jW="__lodash_hash_undefined__";function FW(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=BW&&t===void 0?jW:t,this}var $W=FW,NW=TW,UW=EW,VW=IW,GW=RW,WW=$W;function Ed(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Ed.prototype.clear=NW;Ed.prototype.delete=UW;Ed.prototype.get=VW;Ed.prototype.has=GW;Ed.prototype.set=WW;var qW=Ed;function ZW(){this.__data__=[],this.size=0}var HW=ZW;function XW(e,t){return e===t||e!==e&&t!==t}var WA=XW,KW=WA;function YW(e,t){for(var r=e.length;r--;)if(KW(e[r][0],t))return r;return-1}var $x=YW,JW=$x,QW=Array.prototype,eq=QW.splice;function tq(e){var t=this.__data__,r=JW(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():eq.call(t,r,1),--this.size,!0}var rq=tq,nq=$x;function iq(e){var t=this.__data__,r=nq(t,e);return r<0?void 0:t[r][1]}var oq=iq,aq=$x;function sq(e){return aq(this.__data__,e)>-1}var lq=sq,uq=$x;function cq(e,t){var r=this.__data__,i=uq(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var hq=cq,fq=HW,dq=rq,pq=oq,mq=lq,gq=hq;function Ad(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Ad.prototype.clear=fq;Ad.prototype.delete=dq;Ad.prototype.get=pq;Ad.prototype.has=mq;Ad.prototype.set=gq;var Nx=Ad,yq=Wc,_q=bs,vq=yq(_q,"Map"),qA=vq,Lk=qW,xq=Nx,bq=qA;function wq(){this.size=0,this.__data__={hash:new Lk,map:new(bq||xq),string:new Lk}}var Tq=wq;function Sq(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Eq=Sq,Aq=Eq;function Pq(e,t){var r=e.__data__;return Aq(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Ux=Pq,Mq=Ux;function Cq(e){var t=Mq(this,e).delete(e);return this.size-=t?1:0,t}var Oq=Cq,Iq=Ux;function kq(e){return Iq(this,e).get(e)}var Dq=kq,Lq=Ux;function zq(e){return Lq(this,e).has(e)}var Rq=zq,Bq=Ux;function jq(e,t){var r=Bq(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var Fq=jq,$q=Tq,Nq=Oq,Uq=Dq,Vq=Rq,Gq=Fq;function Pd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Pd.prototype.clear=$q;Pd.prototype.delete=Nq;Pd.prototype.get=Uq;Pd.prototype.has=Vq;Pd.prototype.set=Gq;var ZA=Pd,x4=ZA,Wq="Expected a function";function HA(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Wq);var r=function(){var i=arguments,u=t?t.apply(this,i):i[0],h=r.cache;if(h.has(u))return h.get(u);var p=e.apply(this,i);return r.cache=h.set(u,p)||h,p};return r.cache=new(HA.Cache||x4),r}HA.Cache=x4;var b4=HA;const qq=Xr(b4);var Zq=b4,Hq=500;function Xq(e){var t=Zq(e,function(i){return r.size===Hq&&r.clear(),i}),r=t.cache;return t}var Kq=Xq,Yq=Kq,Jq=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qq=/\\(\\)?/g,eZ=Yq(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Jq,function(r,i,u,h){t.push(u?h.replace(Qq,"$1"):i||r)}),t}),tZ=eZ;function rZ(e,t){for(var r=-1,i=e==null?0:e.length,u=Array(i);++r<i;)u[r]=t(e[r],r,e);return u}var XA=rZ,zk=fy,nZ=XA,iZ=xo,oZ=Td,Rk=zk?zk.prototype:void 0,Bk=Rk?Rk.toString:void 0;function w4(e){if(typeof e=="string")return e;if(iZ(e))return nZ(e,w4)+"";if(oZ(e))return Bk?Bk.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var aZ=w4,sZ=aZ;function lZ(e){return e==null?"":sZ(e)}var T4=lZ,uZ=xo,cZ=VA,hZ=tZ,fZ=T4;function dZ(e,t){return uZ(e)?e:cZ(e,t)?[e]:hZ(fZ(e))}var S4=dZ,pZ=Td;function mZ(e){if(typeof e=="string"||pZ(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Vx=mZ,gZ=S4,yZ=Vx;function _Z(e,t){t=gZ(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[yZ(t[r++])];return r&&r==i?e:void 0}var KA=_Z,vZ=KA;function xZ(e,t,r){var i=e==null?void 0:vZ(e,t);return i===void 0?r:i}var E4=xZ;const aa=Xr(E4);function bZ(e){return e==null}var wZ=bZ;const Qr=Xr(wZ);var TZ=hl,SZ=xo,EZ=fl,AZ="[object String]";function PZ(e){return typeof e=="string"||!SZ(e)&&EZ(e)&&TZ(e)==AZ}var MZ=PZ;const dy=Xr(MZ);var A4={exports:{}},on={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YA=Symbol.for("react.element"),JA=Symbol.for("react.portal"),Gx=Symbol.for("react.fragment"),Wx=Symbol.for("react.strict_mode"),qx=Symbol.for("react.profiler"),Zx=Symbol.for("react.provider"),Hx=Symbol.for("react.context"),CZ=Symbol.for("react.server_context"),Xx=Symbol.for("react.forward_ref"),Kx=Symbol.for("react.suspense"),Yx=Symbol.for("react.suspense_list"),Jx=Symbol.for("react.memo"),Qx=Symbol.for("react.lazy"),OZ=Symbol.for("react.offscreen"),P4;P4=Symbol.for("react.module.reference");function ca(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case YA:switch(e=e.type,e){case Gx:case qx:case Wx:case Kx:case Yx:return e;default:switch(e=e&&e.$$typeof,e){case CZ:case Hx:case Xx:case Qx:case Jx:case Zx:return e;default:return t}}case JA:return t}}}on.ContextConsumer=Hx;on.ContextProvider=Zx;on.Element=YA;on.ForwardRef=Xx;on.Fragment=Gx;on.Lazy=Qx;on.Memo=Jx;on.Portal=JA;on.Profiler=qx;on.StrictMode=Wx;on.Suspense=Kx;on.SuspenseList=Yx;on.isAsyncMode=function(){return!1};on.isConcurrentMode=function(){return!1};on.isContextConsumer=function(e){return ca(e)===Hx};on.isContextProvider=function(e){return ca(e)===Zx};on.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===YA};on.isForwardRef=function(e){return ca(e)===Xx};on.isFragment=function(e){return ca(e)===Gx};on.isLazy=function(e){return ca(e)===Qx};on.isMemo=function(e){return ca(e)===Jx};on.isPortal=function(e){return ca(e)===JA};on.isProfiler=function(e){return ca(e)===qx};on.isStrictMode=function(e){return ca(e)===Wx};on.isSuspense=function(e){return ca(e)===Kx};on.isSuspenseList=function(e){return ca(e)===Yx};on.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Gx||e===qx||e===Wx||e===Kx||e===Yx||e===OZ||typeof e=="object"&&e!==null&&(e.$$typeof===Qx||e.$$typeof===Jx||e.$$typeof===Zx||e.$$typeof===Hx||e.$$typeof===Xx||e.$$typeof===P4||e.getModuleId!==void 0)};on.typeOf=ca;A4.exports=on;var IZ=A4.exports,kZ=hl,DZ=fl,LZ="[object Number]";function zZ(e){return typeof e=="number"||DZ(e)&&kZ(e)==LZ}var M4=zZ;const RZ=Xr(M4);var BZ=M4;function jZ(e){return BZ(e)&&e!=+e}var FZ=jZ;const py=Xr(FZ);var Wa=function(t){return t===0?0:t>0?1:-1},bc=function(t){return dy(t)&&t.indexOf("%")===t.length-1},zt=function(t){return RZ(t)&&!py(t)},ci=function(t){return zt(t)||dy(t)},$Z=0,e1=function(t){var r=++$Z;return"".concat(t||"").concat(r)},Bc=function(t,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!zt(t)&&!dy(t))return i;var h;if(bc(t)){var p=t.indexOf("%");h=r*parseFloat(t.slice(0,p))/100}else h=+t;return py(h)&&(h=i),u&&h>r&&(h=r),h},Yl=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},NZ=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,i={},u=0;u<r;u++)if(!i[t[u]])i[t[u]]=!0;else return!0;return!1},Qh=function(t,r){return zt(t)&&zt(r)?function(i){return t+i*(r-t)}:function(){return r}};function xS(e,t,r){return!e||!e.length?null:e.find(function(i){return i&&(typeof t=="function"?t(i):aa(i,t))===r})}function Lf(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var i in t)if({}.hasOwnProperty.call(t,i)&&!{}.hasOwnProperty.call(e,i))return!1;return!0}function bS(e){"@babel/helpers - typeof";return bS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bS(e)}var UZ=["viewBox","children"],VZ=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],jk=["points","pathLength"],$w={svg:UZ,polygon:jk,polyline:jk},QA=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],b0=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(De.isValidElement(t)&&(i=t.props),!Sd(i))return null;var u={};return Object.keys(i).forEach(function(h){QA.includes(h)&&(u[h]=r||function(p){return i[h](i,p)})}),u},GZ=function(t,r,i){return function(u){return t(r,i,u),null}},w0=function(t,r,i){if(!Sd(t)||bS(t)!=="object")return null;var u=null;return Object.keys(t).forEach(function(h){var p=t[h];QA.includes(h)&&typeof p=="function"&&(u||(u={}),u[h]=GZ(p,r,i))}),u},WZ=["children"],qZ=["children"];function Fk(e,t){if(e==null)return{};var r=ZZ(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function ZZ(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var $k={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},el=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Nk=null,Nw=null,eP=function e(t){if(t===Nk&&Array.isArray(Nw))return Nw;var r=[];return De.Children.forEach(t,function(i){Qr(i)||(IZ.isFragment(i)?r=r.concat(e(i.props.children)):r.push(i))}),Nw=r,Nk=t,r};function Ha(e,t){var r=[],i=[];return Array.isArray(t)?i=t.map(function(u){return el(u)}):i=[el(t)],eP(e).forEach(function(u){var h=aa(u,"type.displayName")||aa(u,"type.name");i.indexOf(h)!==-1&&r.push(u)}),r}function Co(e,t){var r=Ha(e,t);return r&&r[0]}var Uk=function(t){if(!t||!t.props)return!1;var r=t.props,i=r.width,u=r.height;return!(!zt(i)||i<=0||!zt(u)||u<=0)},HZ=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],XZ=function(t){return t&&t.type&&dy(t.type)&&HZ.indexOf(t.type)>=0},KZ=function(t,r,i,u){var h,p=(h=$w==null?void 0:$w[u])!==null&&h!==void 0?h:[];return r.startsWith("data-")||!xr(t)&&(u&&p.includes(r)||VZ.includes(r))||i&&QA.includes(r)},Hr=function(t,r,i){if(!t||typeof t=="function"||typeof t=="boolean")return null;var u=t;if(De.isValidElement(t)&&(u=t.props),!Sd(u))return null;var h={};return Object.keys(u).forEach(function(p){var _;KZ((_=u)===null||_===void 0?void 0:_[p],p,r,i)&&(h[p]=u[p])}),h},wS=function e(t,r){if(t===r)return!0;var i=De.Children.count(t);if(i!==De.Children.count(r))return!1;if(i===0)return!0;if(i===1)return Vk(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var u=0;u<i;u++){var h=t[u],p=r[u];if(Array.isArray(h)||Array.isArray(p)){if(!e(h,p))return!1}else if(!Vk(h,p))return!1}return!0},Vk=function(t,r){if(Qr(t)&&Qr(r))return!0;if(!Qr(t)&&!Qr(r)){var i=t.props||{},u=i.children,h=Fk(i,WZ),p=r.props||{},_=p.children,o=Fk(p,qZ);return u&&_?Lf(h,o)&&wS(u,_):!u&&!_?Lf(h,o):!1}return!1},Gk=function(t,r){var i=[],u={};return eP(t).forEach(function(h,p){if(XZ(h))i.push(h);else if(h){var _=el(h.type),o=r[_]||{},x=o.handler,E=o.once;if(x&&(!E||!u[_])){var A=x(h,_,p);i.push(A),u[_]=!0}}}),i},YZ=function(t){var r=t&&t.type;return r&&$k[r]?$k[r]:null},JZ=function(t,r){return eP(r).indexOf(t)},QZ=["children","width","height","viewBox","className","style","title","desc"];function TS(){return TS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},TS.apply(this,arguments)}function eH(e,t){if(e==null)return{};var r=tH(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function tH(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function SS(e){var t=e.children,r=e.width,i=e.height,u=e.viewBox,h=e.className,p=e.style,_=e.title,o=e.desc,x=eH(e,QZ),E=u||{width:r,height:i,x:0,y:0},A=en("recharts-surface",h);return Fe.createElement("svg",TS({},Hr(x,!0,"svg"),{className:A,width:r,height:i,style:p,viewBox:"".concat(E.x," ").concat(E.y," ").concat(E.width," ").concat(E.height)}),Fe.createElement("title",null,_),Fe.createElement("desc",null,o),t)}var rH=["children","className"];function ES(){return ES=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ES.apply(this,arguments)}function nH(e,t){if(e==null)return{};var r=iH(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function iH(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var xi=Fe.forwardRef(function(e,t){var r=e.children,i=e.className,u=nH(e,rH),h=en("recharts-layer",i);return Fe.createElement("g",ES({className:h},Hr(u,!0),{ref:t}),r)}),tl=function(t,r){for(var i=arguments.length,u=new Array(i>2?i-2:0),h=2;h<i;h++)u[h-2]=arguments[h]};function oH(e,t,r){var i=-1,u=e.length;t<0&&(t=-t>u?0:u+t),r=r>u?u:r,r<0&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0;for(var h=Array(u);++i<u;)h[i]=e[i+t];return h}var aH=oH,sH=aH;function lH(e,t,r){var i=e.length;return r=r===void 0?i:r,!t&&r>=i?e:sH(e,t,r)}var uH=lH,cH="\\ud800-\\udfff",hH="\\u0300-\\u036f",fH="\\ufe20-\\ufe2f",dH="\\u20d0-\\u20ff",pH=hH+fH+dH,mH="\\ufe0e\\ufe0f",gH="\\u200d",yH=RegExp("["+gH+cH+pH+mH+"]");function _H(e){return yH.test(e)}var C4=_H;function vH(e){return e.split("")}var xH=vH,O4="\\ud800-\\udfff",bH="\\u0300-\\u036f",wH="\\ufe20-\\ufe2f",TH="\\u20d0-\\u20ff",SH=bH+wH+TH,EH="\\ufe0e\\ufe0f",AH="["+O4+"]",AS="["+SH+"]",PS="\\ud83c[\\udffb-\\udfff]",PH="(?:"+AS+"|"+PS+")",I4="[^"+O4+"]",k4="(?:\\ud83c[\\udde6-\\uddff]){2}",D4="[\\ud800-\\udbff][\\udc00-\\udfff]",MH="\\u200d",L4=PH+"?",z4="["+EH+"]?",CH="(?:"+MH+"(?:"+[I4,k4,D4].join("|")+")"+z4+L4+")*",OH=z4+L4+CH,IH="(?:"+[I4+AS+"?",AS,k4,D4,AH].join("|")+")",kH=RegExp(PS+"(?="+PS+")|"+IH+OH,"g");function DH(e){return e.match(kH)||[]}var LH=DH,zH=xH,RH=C4,BH=LH;function jH(e){return RH(e)?BH(e):zH(e)}var FH=jH,$H=uH,NH=C4,UH=FH,VH=T4;function GH(e){return function(t){t=VH(t);var r=NH(t)?UH(t):void 0,i=r?r[0]:t.charAt(0),u=r?$H(r,1).join(""):t.slice(1);return i[e]()+u}}var WH=GH,qH=WH,ZH=qH("toUpperCase"),HH=ZH;const t1=Xr(HH);function mn(e){return function(){return e}}const R4=Math.cos,T0=Math.sin,Ka=Math.sqrt,S0=Math.PI,r1=2*S0,MS=Math.PI,CS=2*MS,pc=1e-6,XH=CS-pc;function B4(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function KH(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return B4;const r=10**t;return function(i){this._+=i[0];for(let u=1,h=i.length;u<h;++u)this._+=Math.round(arguments[u]*r)/r+i[u]}}class YH{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?B4:KH(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,i,u){this._append`Q${+t},${+r},${this._x1=+i},${this._y1=+u}`}bezierCurveTo(t,r,i,u,h,p){this._append`C${+t},${+r},${+i},${+u},${this._x1=+h},${this._y1=+p}`}arcTo(t,r,i,u,h){if(t=+t,r=+r,i=+i,u=+u,h=+h,h<0)throw new Error(`negative radius: ${h}`);let p=this._x1,_=this._y1,o=i-t,x=u-r,E=p-t,A=_-r,O=E*E+A*A;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(O>pc)if(!(Math.abs(A*o-x*E)>pc)||!h)this._append`L${this._x1=t},${this._y1=r}`;else{let L=i-p,j=u-_,F=o*o+x*x,Z=L*L+j*j,$=Math.sqrt(F),V=Math.sqrt(O),U=h*Math.tan((MS-Math.acos((F+O-Z)/(2*$*V)))/2),G=U/V,q=U/$;Math.abs(G-1)>pc&&this._append`L${t+G*E},${r+G*A}`,this._append`A${h},${h},0,0,${+(A*L>E*j)},${this._x1=t+q*o},${this._y1=r+q*x}`}}arc(t,r,i,u,h,p){if(t=+t,r=+r,i=+i,p=!!p,i<0)throw new Error(`negative radius: ${i}`);let _=i*Math.cos(u),o=i*Math.sin(u),x=t+_,E=r+o,A=1^p,O=p?u-h:h-u;this._x1===null?this._append`M${x},${E}`:(Math.abs(this._x1-x)>pc||Math.abs(this._y1-E)>pc)&&this._append`L${x},${E}`,i&&(O<0&&(O=O%CS+CS),O>XH?this._append`A${i},${i},0,1,${A},${t-_},${r-o}A${i},${i},0,1,${A},${this._x1=x},${this._y1=E}`:O>pc&&this._append`A${i},${i},0,${+(O>=MS)},${A},${this._x1=t+i*Math.cos(h)},${this._y1=r+i*Math.sin(h)}`)}rect(t,r,i,u){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${i=+i}v${+u}h${-i}Z`}toString(){return this._}}function tP(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const i=Math.floor(r);if(!(i>=0))throw new RangeError(`invalid digits: ${r}`);t=i}return e},()=>new YH(t)}function rP(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function j4(e){this._context=e}j4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function n1(e){return new j4(e)}function F4(e){return e[0]}function $4(e){return e[1]}function N4(e,t){var r=mn(!0),i=null,u=n1,h=null,p=tP(_);e=typeof e=="function"?e:e===void 0?F4:mn(e),t=typeof t=="function"?t:t===void 0?$4:mn(t);function _(o){var x,E=(o=rP(o)).length,A,O=!1,L;for(i==null&&(h=u(L=p())),x=0;x<=E;++x)!(x<E&&r(A=o[x],x,o))===O&&((O=!O)?h.lineStart():h.lineEnd()),O&&h.point(+e(A,x,o),+t(A,x,o));if(L)return h=null,L+""||null}return _.x=function(o){return arguments.length?(e=typeof o=="function"?o:mn(+o),_):e},_.y=function(o){return arguments.length?(t=typeof o=="function"?o:mn(+o),_):t},_.defined=function(o){return arguments.length?(r=typeof o=="function"?o:mn(!!o),_):r},_.curve=function(o){return arguments.length?(u=o,i!=null&&(h=u(i)),_):u},_.context=function(o){return arguments.length?(o==null?i=h=null:h=u(i=o),_):i},_}function pv(e,t,r){var i=null,u=mn(!0),h=null,p=n1,_=null,o=tP(x);e=typeof e=="function"?e:e===void 0?F4:mn(+e),t=typeof t=="function"?t:mn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?$4:mn(+r);function x(A){var O,L,j,F=(A=rP(A)).length,Z,$=!1,V,U=new Array(F),G=new Array(F);for(h==null&&(_=p(V=o())),O=0;O<=F;++O){if(!(O<F&&u(Z=A[O],O,A))===$)if($=!$)L=O,_.areaStart(),_.lineStart();else{for(_.lineEnd(),_.lineStart(),j=O-1;j>=L;--j)_.point(U[j],G[j]);_.lineEnd(),_.areaEnd()}$&&(U[O]=+e(Z,O,A),G[O]=+t(Z,O,A),_.point(i?+i(Z,O,A):U[O],r?+r(Z,O,A):G[O]))}if(V)return _=null,V+""||null}function E(){return N4().defined(u).curve(p).context(h)}return x.x=function(A){return arguments.length?(e=typeof A=="function"?A:mn(+A),i=null,x):e},x.x0=function(A){return arguments.length?(e=typeof A=="function"?A:mn(+A),x):e},x.x1=function(A){return arguments.length?(i=A==null?null:typeof A=="function"?A:mn(+A),x):i},x.y=function(A){return arguments.length?(t=typeof A=="function"?A:mn(+A),r=null,x):t},x.y0=function(A){return arguments.length?(t=typeof A=="function"?A:mn(+A),x):t},x.y1=function(A){return arguments.length?(r=A==null?null:typeof A=="function"?A:mn(+A),x):r},x.lineX0=x.lineY0=function(){return E().x(e).y(t)},x.lineY1=function(){return E().x(e).y(r)},x.lineX1=function(){return E().x(i).y(t)},x.defined=function(A){return arguments.length?(u=typeof A=="function"?A:mn(!!A),x):u},x.curve=function(A){return arguments.length?(p=A,h!=null&&(_=p(h)),x):p},x.context=function(A){return arguments.length?(A==null?h=_=null:_=p(h=A),x):h},x}class U4{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function JH(e){return new U4(e,!0)}function QH(e){return new U4(e,!1)}const nP={draw(e,t){const r=Ka(t/S0);e.moveTo(r,0),e.arc(0,0,r,0,r1)}},eX={draw(e,t){const r=Ka(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},V4=Ka(1/3),tX=V4*2,rX={draw(e,t){const r=Ka(t/tX),i=r*V4;e.moveTo(0,-r),e.lineTo(i,0),e.lineTo(0,r),e.lineTo(-i,0),e.closePath()}},nX={draw(e,t){const r=Ka(t),i=-r/2;e.rect(i,i,r,r)}},iX=.8908130915292852,G4=T0(S0/10)/T0(7*S0/10),oX=T0(r1/10)*G4,aX=-R4(r1/10)*G4,sX={draw(e,t){const r=Ka(t*iX),i=oX*r,u=aX*r;e.moveTo(0,-r),e.lineTo(i,u);for(let h=1;h<5;++h){const p=r1*h/5,_=R4(p),o=T0(p);e.lineTo(o*r,-_*r),e.lineTo(_*i-o*u,o*i+_*u)}e.closePath()}},Uw=Ka(3),lX={draw(e,t){const r=-Ka(t/(Uw*3));e.moveTo(0,r*2),e.lineTo(-Uw*r,-r),e.lineTo(Uw*r,-r),e.closePath()}},Xo=-.5,Ko=Ka(3)/2,OS=1/Ka(12),uX=(OS/2+1)*3,cX={draw(e,t){const r=Ka(t/uX),i=r/2,u=r*OS,h=i,p=r*OS+r,_=-h,o=p;e.moveTo(i,u),e.lineTo(h,p),e.lineTo(_,o),e.lineTo(Xo*i-Ko*u,Ko*i+Xo*u),e.lineTo(Xo*h-Ko*p,Ko*h+Xo*p),e.lineTo(Xo*_-Ko*o,Ko*_+Xo*o),e.lineTo(Xo*i+Ko*u,Xo*u-Ko*i),e.lineTo(Xo*h+Ko*p,Xo*p-Ko*h),e.lineTo(Xo*_+Ko*o,Xo*o-Ko*_),e.closePath()}};function hX(e,t){let r=null,i=tP(u);e=typeof e=="function"?e:mn(e||nP),t=typeof t=="function"?t:mn(t===void 0?64:+t);function u(){let h;if(r||(r=h=i()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),h)return r=null,h+""||null}return u.type=function(h){return arguments.length?(e=typeof h=="function"?h:mn(h),u):e},u.size=function(h){return arguments.length?(t=typeof h=="function"?h:mn(+h),u):t},u.context=function(h){return arguments.length?(r=h??null,u):r},u}function E0(){}function A0(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function W4(e){this._context=e}W4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:A0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:A0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function fX(e){return new W4(e)}function q4(e){this._context=e}q4.prototype={areaStart:E0,areaEnd:E0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:A0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function dX(e){return new q4(e)}function Z4(e){this._context=e}Z4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,i):this._context.moveTo(r,i);break;case 3:this._point=4;default:A0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pX(e){return new Z4(e)}function H4(e){this._context=e}H4.prototype={areaStart:E0,areaEnd:E0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function mX(e){return new H4(e)}function Wk(e){return e<0?-1:1}function qk(e,t,r){var i=e._x1-e._x0,u=t-e._x1,h=(e._y1-e._y0)/(i||u<0&&-0),p=(r-e._y1)/(u||i<0&&-0),_=(h*u+p*i)/(i+u);return(Wk(h)+Wk(p))*Math.min(Math.abs(h),Math.abs(p),.5*Math.abs(_))||0}function Zk(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Vw(e,t,r){var i=e._x0,u=e._y0,h=e._x1,p=e._y1,_=(h-i)/3;e._context.bezierCurveTo(i+_,u+_*t,h-_,p-_*r,h,p)}function P0(e){this._context=e}P0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Vw(this,this._t0,Zk(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Vw(this,Zk(this,r=qk(this,e,t)),r);break;default:Vw(this,this._t0,r=qk(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function X4(e){this._context=new K4(e)}(X4.prototype=Object.create(P0.prototype)).point=function(e,t){P0.prototype.point.call(this,t,e)};function K4(e){this._context=e}K4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,i,u,h){this._context.bezierCurveTo(t,e,i,r,h,u)}};function gX(e){return new P0(e)}function yX(e){return new X4(e)}function Y4(e){this._context=e}Y4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var i=Hk(e),u=Hk(t),h=0,p=1;p<r;++h,++p)this._context.bezierCurveTo(i[0][h],u[0][h],i[1][h],u[1][h],e[p],t[p]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Hk(e){var t,r=e.length-1,i,u=new Array(r),h=new Array(r),p=new Array(r);for(u[0]=0,h[0]=2,p[0]=e[0]+2*e[1],t=1;t<r-1;++t)u[t]=1,h[t]=4,p[t]=4*e[t]+2*e[t+1];for(u[r-1]=2,h[r-1]=7,p[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)i=u[t]/h[t-1],h[t]-=i,p[t]-=i*p[t-1];for(u[r-1]=p[r-1]/h[r-1],t=r-2;t>=0;--t)u[t]=(p[t]-u[t+1])/h[t];for(h[r-1]=(e[r]+u[r-1])/2,t=0;t<r-1;++t)h[t]=2*e[t+1]-u[t+1];return[u,h]}function _X(e){return new Y4(e)}function i1(e,t){this._context=e,this._t=t}i1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function vX(e){return new i1(e,.5)}function xX(e){return new i1(e,0)}function bX(e){return new i1(e,1)}function Kf(e,t){if((p=e.length)>1)for(var r=1,i,u,h=e[t[0]],p,_=h.length;r<p;++r)for(u=h,h=e[t[r]],i=0;i<_;++i)h[i][1]+=h[i][0]=isNaN(u[i][1])?u[i][0]:u[i][1]}function IS(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function wX(e,t){return e[t]}function TX(e){const t=[];return t.key=e,t}function SX(){var e=mn([]),t=IS,r=Kf,i=wX;function u(h){var p=Array.from(e.apply(this,arguments),TX),_,o=p.length,x=-1,E;for(const A of h)for(_=0,++x;_<o;++_)(p[_][x]=[0,+i(A,p[_].key,x,h)]).data=A;for(_=0,E=rP(t(p));_<o;++_)p[E[_]].index=_;return r(p,E),p}return u.keys=function(h){return arguments.length?(e=typeof h=="function"?h:mn(Array.from(h)),u):e},u.value=function(h){return arguments.length?(i=typeof h=="function"?h:mn(+h),u):i},u.order=function(h){return arguments.length?(t=h==null?IS:typeof h=="function"?h:mn(Array.from(h)),u):t},u.offset=function(h){return arguments.length?(r=h??Kf,u):r},u}function EX(e,t){if((i=e.length)>0){for(var r,i,u=0,h=e[0].length,p;u<h;++u){for(p=r=0;r<i;++r)p+=e[r][u][1]||0;if(p)for(r=0;r<i;++r)e[r][u][1]/=p}Kf(e,t)}}function AX(e,t){if((u=e.length)>0){for(var r=0,i=e[t[0]],u,h=i.length;r<h;++r){for(var p=0,_=0;p<u;++p)_+=e[p][r][1]||0;i[r][1]+=i[r][0]=-_/2}Kf(e,t)}}function PX(e,t){if(!(!((p=e.length)>0)||!((h=(u=e[t[0]]).length)>0))){for(var r=0,i=1,u,h,p;i<h;++i){for(var _=0,o=0,x=0;_<p;++_){for(var E=e[t[_]],A=E[i][1]||0,O=E[i-1][1]||0,L=(A-O)/2,j=0;j<_;++j){var F=e[t[j]],Z=F[i][1]||0,$=F[i-1][1]||0;L+=Z-$}o+=A,x+=L*A}u[i-1][1]+=u[i-1][0]=r,o&&(r-=x/o)}u[i-1][1]+=u[i-1][0]=r,Kf(e,t)}}function Sg(e){"@babel/helpers - typeof";return Sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sg(e)}var MX=["type","size","sizeType"];function kS(){return kS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},kS.apply(this,arguments)}function Xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Kk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xk(Object(r),!0).forEach(function(i){CX(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xk(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function CX(e,t,r){return t=OX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OX(e){var t=IX(e,"string");return Sg(t)=="symbol"?t:t+""}function IX(e,t){if(Sg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Sg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kX(e,t){if(e==null)return{};var r=DX(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function DX(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var J4={symbolCircle:nP,symbolCross:eX,symbolDiamond:rX,symbolSquare:nX,symbolStar:sX,symbolTriangle:lX,symbolWye:cX},LX=Math.PI/180,zX=function(t){var r="symbol".concat(t1(t));return J4[r]||nP},RX=function(t,r,i){if(r==="area")return t;switch(i){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var u=18*LX;return 1.25*t*t*(Math.tan(u)-Math.tan(u*2)*Math.pow(Math.tan(u),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},BX=function(t,r){J4["symbol".concat(t1(t))]=r},iP=function(t){var r=t.type,i=r===void 0?"circle":r,u=t.size,h=u===void 0?64:u,p=t.sizeType,_=p===void 0?"area":p,o=kX(t,MX),x=Kk(Kk({},o),{},{type:i,size:h,sizeType:_}),E=function(){var Z=zX(i),$=hX().type(Z).size(RX(h,_,i));return $()},A=x.className,O=x.cx,L=x.cy,j=Hr(x,!0);return O===+O&&L===+L&&h===+h?Fe.createElement("path",kS({},j,{className:en("recharts-symbols",A),transform:"translate(".concat(O,", ").concat(L,")"),d:E()})):null};iP.registerSymbol=BX;function Yf(e){"@babel/helpers - typeof";return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yf(e)}function DS(){return DS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},DS.apply(this,arguments)}function Yk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function jX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yk(Object(r),!0).forEach(function(i){Eg(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yk(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function FX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $X(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,ej(i.key),i)}}function NX(e,t,r){return t&&$X(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function UX(e,t,r){return t=M0(t),VX(e,Q4()?Reflect.construct(t,r||[],M0(e).constructor):t.apply(e,r))}function VX(e,t){if(t&&(Yf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GX(e)}function GX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q4(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q4=function(){return!!e})()}function M0(e){return M0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},M0(e)}function WX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LS(e,t)}function LS(e,t){return LS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},LS(e,t)}function Eg(e,t,r){return t=ej(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ej(e){var t=qX(e,"string");return Yf(t)=="symbol"?t:t+""}function qX(e,t){if(Yf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Yf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Yo=32,oP=function(e){function t(){return FX(this,t),UX(this,t,arguments)}return WX(t,e),NX(t,[{key:"renderIcon",value:function(i){var u=this.props.inactiveColor,h=Yo/2,p=Yo/6,_=Yo/3,o=i.inactive?u:i.color;if(i.type==="plainline")return Fe.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:h,x2:Yo,y2:h,className:"recharts-legend-icon"});if(i.type==="line")return Fe.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(h,"h").concat(_,`
            A`).concat(p,",").concat(p,",0,1,1,").concat(2*_,",").concat(h,`
            H`).concat(Yo,"M").concat(2*_,",").concat(h,`
            A`).concat(p,",").concat(p,",0,1,1,").concat(_,",").concat(h),className:"recharts-legend-icon"});if(i.type==="rect")return Fe.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(Yo/8,"h").concat(Yo,"v").concat(Yo*3/4,"h").concat(-Yo,"z"),className:"recharts-legend-icon"});if(Fe.isValidElement(i.legendIcon)){var x=jX({},i);return delete x.legendIcon,Fe.cloneElement(i.legendIcon,x)}return Fe.createElement(iP,{fill:o,cx:h,cy:h,size:Yo,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,u=this.props,h=u.payload,p=u.iconSize,_=u.layout,o=u.formatter,x=u.inactiveColor,E={x:0,y:0,width:Yo,height:Yo},A={display:_==="horizontal"?"inline-block":"block",marginRight:10},O={display:"inline-block",verticalAlign:"middle",marginRight:4};return h.map(function(L,j){var F=L.formatter||o,Z=en(Eg(Eg({"recharts-legend-item":!0},"legend-item-".concat(j),!0),"inactive",L.inactive));if(L.type==="none")return null;var $=xr(L.value)?null:L.value;tl(!xr(L.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var V=L.inactive?x:L.color;return Fe.createElement("li",DS({className:Z,style:A,key:"legend-item-".concat(j)},w0(i.props,L,j)),Fe.createElement(SS,{width:p,height:p,viewBox:E,style:O},i.renderIcon(L)),Fe.createElement("span",{className:"recharts-legend-item-text",style:{color:V}},F?F($,L,j):$))})}},{key:"render",value:function(){var i=this.props,u=i.payload,h=i.layout,p=i.align;if(!u||!u.length)return null;var _={padding:0,margin:0,textAlign:h==="horizontal"?p:"left"};return Fe.createElement("ul",{className:"recharts-default-legend",style:_},this.renderItems())}}])}(De.PureComponent);Eg(oP,"displayName","Legend");Eg(oP,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var ZX=Nx;function HX(){this.__data__=new ZX,this.size=0}var XX=HX;function KX(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var YX=KX;function JX(e){return this.__data__.get(e)}var QX=JX;function eK(e){return this.__data__.has(e)}var tK=eK,rK=Nx,nK=qA,iK=ZA,oK=200;function aK(e,t){var r=this.__data__;if(r instanceof rK){var i=r.__data__;if(!nK||i.length<oK-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new iK(i)}return r.set(e,t),this.size=r.size,this}var sK=aK,lK=Nx,uK=XX,cK=YX,hK=QX,fK=tK,dK=sK;function Md(e){var t=this.__data__=new lK(e);this.size=t.size}Md.prototype.clear=uK;Md.prototype.delete=cK;Md.prototype.get=hK;Md.prototype.has=fK;Md.prototype.set=dK;var tj=Md,pK="__lodash_hash_undefined__";function mK(e){return this.__data__.set(e,pK),this}var gK=mK;function yK(e){return this.__data__.has(e)}var _K=yK,vK=ZA,xK=gK,bK=_K;function C0(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new vK;++t<r;)this.add(e[t])}C0.prototype.add=C0.prototype.push=xK;C0.prototype.has=bK;var rj=C0;function wK(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var nj=wK;function TK(e,t){return e.has(t)}var ij=TK,SK=rj,EK=nj,AK=ij,PK=1,MK=2;function CK(e,t,r,i,u,h){var p=r&PK,_=e.length,o=t.length;if(_!=o&&!(p&&o>_))return!1;var x=h.get(e),E=h.get(t);if(x&&E)return x==t&&E==e;var A=-1,O=!0,L=r&MK?new SK:void 0;for(h.set(e,t),h.set(t,e);++A<_;){var j=e[A],F=t[A];if(i)var Z=p?i(F,j,A,t,e,h):i(j,F,A,e,t,h);if(Z!==void 0){if(Z)continue;O=!1;break}if(L){if(!EK(t,function($,V){if(!AK(L,V)&&(j===$||u(j,$,r,i,h)))return L.push(V)})){O=!1;break}}else if(!(j===F||u(j,F,r,i,h))){O=!1;break}}return h.delete(e),h.delete(t),O}var oj=CK,OK=bs,IK=OK.Uint8Array,kK=IK;function DK(e){var t=-1,r=Array(e.size);return e.forEach(function(i,u){r[++t]=[u,i]}),r}var LK=DK;function zK(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var aP=zK,Jk=fy,Qk=kK,RK=WA,BK=oj,jK=LK,FK=aP,$K=1,NK=2,UK="[object Boolean]",VK="[object Date]",GK="[object Error]",WK="[object Map]",qK="[object Number]",ZK="[object RegExp]",HK="[object Set]",XK="[object String]",KK="[object Symbol]",YK="[object ArrayBuffer]",JK="[object DataView]",eD=Jk?Jk.prototype:void 0,Gw=eD?eD.valueOf:void 0;function QK(e,t,r,i,u,h,p){switch(r){case JK:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case YK:return!(e.byteLength!=t.byteLength||!h(new Qk(e),new Qk(t)));case UK:case VK:case qK:return RK(+e,+t);case GK:return e.name==t.name&&e.message==t.message;case ZK:case XK:return e==t+"";case WK:var _=jK;case HK:var o=i&$K;if(_||(_=FK),e.size!=t.size&&!o)return!1;var x=p.get(e);if(x)return x==t;i|=NK,p.set(e,t);var E=BK(_(e),_(t),i,u,h,p);return p.delete(e),E;case KK:if(Gw)return Gw.call(e)==Gw.call(t)}return!1}var eY=QK;function tY(e,t){for(var r=-1,i=t.length,u=e.length;++r<i;)e[u+r]=t[r];return e}var aj=tY,rY=aj,nY=xo;function iY(e,t,r){var i=t(e);return nY(e)?i:rY(i,r(e))}var oY=iY;function aY(e,t){for(var r=-1,i=e==null?0:e.length,u=0,h=[];++r<i;){var p=e[r];t(p,r,e)&&(h[u++]=p)}return h}var sY=aY;function lY(){return[]}var uY=lY,cY=sY,hY=uY,fY=Object.prototype,dY=fY.propertyIsEnumerable,tD=Object.getOwnPropertySymbols,pY=tD?function(e){return e==null?[]:(e=Object(e),cY(tD(e),function(t){return dY.call(e,t)}))}:hY,mY=pY;function gY(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var yY=gY,_Y=hl,vY=fl,xY="[object Arguments]";function bY(e){return vY(e)&&_Y(e)==xY}var wY=bY,rD=wY,TY=fl,sj=Object.prototype,SY=sj.hasOwnProperty,EY=sj.propertyIsEnumerable,AY=rD(function(){return arguments}())?rD:function(e){return TY(e)&&SY.call(e,"callee")&&!EY.call(e,"callee")},sP=AY,O0={exports:{}};function PY(){return!1}var MY=PY;O0.exports;(function(e,t){var r=bs,i=MY,u=t&&!t.nodeType&&t,h=u&&!0&&e&&!e.nodeType&&e,p=h&&h.exports===u,_=p?r.Buffer:void 0,o=_?_.isBuffer:void 0,x=o||i;e.exports=x})(O0,O0.exports);var lj=O0.exports,CY=9007199254740991,OY=/^(?:0|[1-9]\d*)$/;function IY(e,t){var r=typeof e;return t=t??CY,!!t&&(r=="number"||r!="symbol"&&OY.test(e))&&e>-1&&e%1==0&&e<t}var lP=IY,kY=9007199254740991;function DY(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=kY}var uP=DY,LY=hl,zY=uP,RY=fl,BY="[object Arguments]",jY="[object Array]",FY="[object Boolean]",$Y="[object Date]",NY="[object Error]",UY="[object Function]",VY="[object Map]",GY="[object Number]",WY="[object Object]",qY="[object RegExp]",ZY="[object Set]",HY="[object String]",XY="[object WeakMap]",KY="[object ArrayBuffer]",YY="[object DataView]",JY="[object Float32Array]",QY="[object Float64Array]",eJ="[object Int8Array]",tJ="[object Int16Array]",rJ="[object Int32Array]",nJ="[object Uint8Array]",iJ="[object Uint8ClampedArray]",oJ="[object Uint16Array]",aJ="[object Uint32Array]",xn={};xn[JY]=xn[QY]=xn[eJ]=xn[tJ]=xn[rJ]=xn[nJ]=xn[iJ]=xn[oJ]=xn[aJ]=!0;xn[BY]=xn[jY]=xn[KY]=xn[FY]=xn[YY]=xn[$Y]=xn[NY]=xn[UY]=xn[VY]=xn[GY]=xn[WY]=xn[qY]=xn[ZY]=xn[HY]=xn[XY]=!1;function sJ(e){return RY(e)&&zY(e.length)&&!!xn[LY(e)]}var lJ=sJ;function uJ(e){return function(t){return e(t)}}var uj=uJ,I0={exports:{}};I0.exports;(function(e,t){var r=y4,i=t&&!t.nodeType&&t,u=i&&!0&&e&&!e.nodeType&&e,h=u&&u.exports===i,p=h&&r.process,_=function(){try{var o=u&&u.require&&u.require("util").types;return o||p&&p.binding&&p.binding("util")}catch{}}();e.exports=_})(I0,I0.exports);var cJ=I0.exports,hJ=lJ,fJ=uj,nD=cJ,iD=nD&&nD.isTypedArray,dJ=iD?fJ(iD):hJ,cj=dJ,pJ=yY,mJ=sP,gJ=xo,yJ=lj,_J=lP,vJ=cj,xJ=Object.prototype,bJ=xJ.hasOwnProperty;function wJ(e,t){var r=gJ(e),i=!r&&mJ(e),u=!r&&!i&&yJ(e),h=!r&&!i&&!u&&vJ(e),p=r||i||u||h,_=p?pJ(e.length,String):[],o=_.length;for(var x in e)(t||bJ.call(e,x))&&!(p&&(x=="length"||u&&(x=="offset"||x=="parent")||h&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||_J(x,o)))&&_.push(x);return _}var TJ=wJ,SJ=Object.prototype;function EJ(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||SJ;return e===r}var AJ=EJ;function PJ(e,t){return function(r){return e(t(r))}}var hj=PJ,MJ=hj,CJ=MJ(Object.keys,Object),OJ=CJ,IJ=AJ,kJ=OJ,DJ=Object.prototype,LJ=DJ.hasOwnProperty;function zJ(e){if(!IJ(e))return kJ(e);var t=[];for(var r in Object(e))LJ.call(e,r)&&r!="constructor"&&t.push(r);return t}var RJ=zJ,BJ=GA,jJ=uP;function FJ(e){return e!=null&&jJ(e.length)&&!BJ(e)}var my=FJ,$J=TJ,NJ=RJ,UJ=my;function VJ(e){return UJ(e)?$J(e):NJ(e)}var o1=VJ,GJ=oY,WJ=mY,qJ=o1;function ZJ(e){return GJ(e,qJ,WJ)}var HJ=ZJ,oD=HJ,XJ=1,KJ=Object.prototype,YJ=KJ.hasOwnProperty;function JJ(e,t,r,i,u,h){var p=r&XJ,_=oD(e),o=_.length,x=oD(t),E=x.length;if(o!=E&&!p)return!1;for(var A=o;A--;){var O=_[A];if(!(p?O in t:YJ.call(t,O)))return!1}var L=h.get(e),j=h.get(t);if(L&&j)return L==t&&j==e;var F=!0;h.set(e,t),h.set(t,e);for(var Z=p;++A<o;){O=_[A];var $=e[O],V=t[O];if(i)var U=p?i(V,$,O,t,e,h):i($,V,O,e,t,h);if(!(U===void 0?$===V||u($,V,r,i,h):U)){F=!1;break}Z||(Z=O=="constructor")}if(F&&!Z){var G=e.constructor,q=t.constructor;G!=q&&"constructor"in e&&"constructor"in t&&!(typeof G=="function"&&G instanceof G&&typeof q=="function"&&q instanceof q)&&(F=!1)}return h.delete(e),h.delete(t),F}var QJ=JJ,eQ=Wc,tQ=bs,rQ=eQ(tQ,"DataView"),nQ=rQ,iQ=Wc,oQ=bs,aQ=iQ(oQ,"Promise"),sQ=aQ,lQ=Wc,uQ=bs,cQ=lQ(uQ,"Set"),fj=cQ,hQ=Wc,fQ=bs,dQ=hQ(fQ,"WeakMap"),pQ=dQ,zS=nQ,RS=qA,BS=sQ,jS=fj,FS=pQ,dj=hl,Cd=v4,aD="[object Map]",mQ="[object Object]",sD="[object Promise]",lD="[object Set]",uD="[object WeakMap]",cD="[object DataView]",gQ=Cd(zS),yQ=Cd(RS),_Q=Cd(BS),vQ=Cd(jS),xQ=Cd(FS),mc=dj;(zS&&mc(new zS(new ArrayBuffer(1)))!=cD||RS&&mc(new RS)!=aD||BS&&mc(BS.resolve())!=sD||jS&&mc(new jS)!=lD||FS&&mc(new FS)!=uD)&&(mc=function(e){var t=dj(e),r=t==mQ?e.constructor:void 0,i=r?Cd(r):"";if(i)switch(i){case gQ:return cD;case yQ:return aD;case _Q:return sD;case vQ:return lD;case xQ:return uD}return t});var bQ=mc,Ww=tj,wQ=oj,TQ=eY,SQ=QJ,hD=bQ,fD=xo,dD=lj,EQ=cj,AQ=1,pD="[object Arguments]",mD="[object Array]",mv="[object Object]",PQ=Object.prototype,gD=PQ.hasOwnProperty;function MQ(e,t,r,i,u,h){var p=fD(e),_=fD(t),o=p?mD:hD(e),x=_?mD:hD(t);o=o==pD?mv:o,x=x==pD?mv:x;var E=o==mv,A=x==mv,O=o==x;if(O&&dD(e)){if(!dD(t))return!1;p=!0,E=!1}if(O&&!E)return h||(h=new Ww),p||EQ(e)?wQ(e,t,r,i,u,h):TQ(e,t,o,r,i,u,h);if(!(r&AQ)){var L=E&&gD.call(e,"__wrapped__"),j=A&&gD.call(t,"__wrapped__");if(L||j){var F=L?e.value():e,Z=j?t.value():t;return h||(h=new Ww),u(F,Z,r,i,h)}}return O?(h||(h=new Ww),SQ(e,t,r,i,u,h)):!1}var CQ=MQ,OQ=CQ,yD=fl;function pj(e,t,r,i,u){return e===t?!0:e==null||t==null||!yD(e)&&!yD(t)?e!==e&&t!==t:OQ(e,t,r,i,pj,u)}var cP=pj,IQ=tj,kQ=cP,DQ=1,LQ=2;function zQ(e,t,r,i){var u=r.length,h=u,p=!i;if(e==null)return!h;for(e=Object(e);u--;){var _=r[u];if(p&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++u<h;){_=r[u];var o=_[0],x=e[o],E=_[1];if(p&&_[2]){if(x===void 0&&!(o in e))return!1}else{var A=new IQ;if(i)var O=i(x,E,o,e,t,A);if(!(O===void 0?kQ(E,x,DQ|LQ,i,A):O))return!1}}return!0}var RQ=zQ,BQ=vu;function jQ(e){return e===e&&!BQ(e)}var mj=jQ,FQ=mj,$Q=o1;function NQ(e){for(var t=$Q(e),r=t.length;r--;){var i=t[r],u=e[i];t[r]=[i,u,FQ(u)]}return t}var UQ=NQ;function VQ(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var gj=VQ,GQ=RQ,WQ=UQ,qQ=gj;function ZQ(e){var t=WQ(e);return t.length==1&&t[0][2]?qQ(t[0][0],t[0][1]):function(r){return r===e||GQ(r,e,t)}}var HQ=ZQ;function XQ(e,t){return e!=null&&t in Object(e)}var KQ=XQ,YQ=S4,JQ=sP,QQ=xo,e2=lP,t2=uP,r2=Vx;function n2(e,t,r){t=YQ(t,e);for(var i=-1,u=t.length,h=!1;++i<u;){var p=r2(t[i]);if(!(h=e!=null&&r(e,p)))break;e=e[p]}return h||++i!=u?h:(u=e==null?0:e.length,!!u&&t2(u)&&e2(p,u)&&(QQ(e)||JQ(e)))}var i2=n2,o2=KQ,a2=i2;function s2(e,t){return e!=null&&a2(e,t,o2)}var l2=s2,u2=cP,c2=E4,h2=l2,f2=VA,d2=mj,p2=gj,m2=Vx,g2=1,y2=2;function _2(e,t){return f2(e)&&d2(t)?p2(m2(e),t):function(r){var i=c2(r,e);return i===void 0&&i===t?h2(r,e):u2(t,i,g2|y2)}}var v2=_2;function x2(e){return e}var Od=x2;function b2(e){return function(t){return t==null?void 0:t[e]}}var w2=b2,T2=KA;function S2(e){return function(t){return T2(t,e)}}var E2=S2,A2=w2,P2=E2,M2=VA,C2=Vx;function O2(e){return M2(e)?A2(C2(e)):P2(e)}var I2=O2,k2=HQ,D2=v2,L2=Od,z2=xo,R2=I2;function B2(e){return typeof e=="function"?e:e==null?L2:typeof e=="object"?z2(e)?D2(e[0],e[1]):k2(e):R2(e)}var xu=B2;function j2(e,t,r,i){for(var u=e.length,h=r+(i?1:-1);i?h--:++h<u;)if(t(e[h],h,e))return h;return-1}var yj=j2;function F2(e){return e!==e}var $2=F2;function N2(e,t,r){for(var i=r-1,u=e.length;++i<u;)if(e[i]===t)return i;return-1}var U2=N2,V2=yj,G2=$2,W2=U2;function q2(e,t,r){return t===t?W2(e,t,r):V2(e,G2,r)}var Z2=q2,H2=Z2;function X2(e,t){var r=e==null?0:e.length;return!!r&&H2(e,t,0)>-1}var K2=X2;function Y2(e,t,r){for(var i=-1,u=e==null?0:e.length;++i<u;)if(r(t,e[i]))return!0;return!1}var J2=Y2;function Q2(){}var eee=Q2,qw=fj,tee=eee,ree=aP,nee=1/0,iee=qw&&1/ree(new qw([,-0]))[1]==nee?function(e){return new qw(e)}:tee,oee=iee,aee=rj,see=K2,lee=J2,uee=ij,cee=oee,hee=aP,fee=200;function dee(e,t,r){var i=-1,u=see,h=e.length,p=!0,_=[],o=_;if(r)p=!1,u=lee;else if(h>=fee){var x=t?null:cee(e);if(x)return hee(x);p=!1,u=uee,o=new aee}else o=t?[]:_;e:for(;++i<h;){var E=e[i],A=t?t(E):E;if(E=r||E!==0?E:0,p&&A===A){for(var O=o.length;O--;)if(o[O]===A)continue e;t&&o.push(A),_.push(E)}else u(o,A,r)||(o!==_&&o.push(A),_.push(E))}return _}var pee=dee,mee=xu,gee=pee;function yee(e,t){return e&&e.length?gee(e,mee(t)):[]}var _ee=yee;const _D=Xr(_ee);function _j(e,t,r){return t===!0?_D(e,r):xr(t)?_D(e,t):e}function Jf(e){"@babel/helpers - typeof";return Jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jf(e)}var vee=["ref"];function vD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Vs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vD(Object(r),!0).forEach(function(i){a1(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vD(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function xee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xD(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,xj(i.key),i)}}function bee(e,t,r){return t&&xD(e.prototype,t),r&&xD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wee(e,t,r){return t=k0(t),Tee(e,vj()?Reflect.construct(t,r||[],k0(e).constructor):t.apply(e,r))}function Tee(e,t){if(t&&(Jf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return See(e)}function See(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vj=function(){return!!e})()}function k0(e){return k0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},k0(e)}function Eee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$S(e,t)}function $S(e,t){return $S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},$S(e,t)}function a1(e,t,r){return t=xj(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xj(e){var t=Aee(e,"string");return Jf(t)=="symbol"?t:t+""}function Aee(e,t){if(Jf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Jf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Pee(e,t){if(e==null)return{};var r=Mee(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function Mee(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function Cee(e){return e.value}function Oee(e,t){if(Fe.isValidElement(e))return Fe.cloneElement(e,t);if(typeof e=="function")return Fe.createElement(e,t);t.ref;var r=Pee(t,vee);return Fe.createElement(oP,r)}var bD=1,zf=function(e){function t(){var r;xee(this,t);for(var i=arguments.length,u=new Array(i),h=0;h<i;h++)u[h]=arguments[h];return r=wee(this,t,[].concat(u)),a1(r,"lastBoundingBox",{width:-1,height:-1}),r}return Eee(t,e),bee(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();return i.height=this.wrapperNode.offsetHeight,i.width=this.wrapperNode.offsetWidth,i}return null}},{key:"updateBBox",value:function(){var i=this.props.onBBoxUpdate,u=this.getBBox();u?(Math.abs(u.width-this.lastBoundingBox.width)>bD||Math.abs(u.height-this.lastBoundingBox.height)>bD)&&(this.lastBoundingBox.width=u.width,this.lastBoundingBox.height=u.height,i&&i(u)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,i&&i(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Vs({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(i){var u=this.props,h=u.layout,p=u.align,_=u.verticalAlign,o=u.margin,x=u.chartWidth,E=u.chartHeight,A,O;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(p==="center"&&h==="vertical"){var L=this.getBBoxSnapshot();A={left:((x||0)-L.width)/2}}else A=p==="right"?{right:o&&o.right||0}:{left:o&&o.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(_==="middle"){var j=this.getBBoxSnapshot();O={top:((E||0)-j.height)/2}}else O=_==="bottom"?{bottom:o&&o.bottom||0}:{top:o&&o.top||0};return Vs(Vs({},A),O)}},{key:"render",value:function(){var i=this,u=this.props,h=u.content,p=u.width,_=u.height,o=u.wrapperStyle,x=u.payloadUniqBy,E=u.payload,A=Vs(Vs({position:"absolute",width:p||"auto",height:_||"auto"},this.getDefaultPosition(o)),o);return Fe.createElement("div",{className:"recharts-legend-wrapper",style:A,ref:function(L){i.wrapperNode=L}},Oee(h,Vs(Vs({},this.props),{},{payload:_j(E,x,Cee)})))}}],[{key:"getWithHeight",value:function(i,u){var h=Vs(Vs({},this.defaultProps),i.props),p=h.layout;return p==="vertical"&&zt(i.props.height)?{height:i.props.height}:p==="horizontal"?{width:i.props.width||u}:null}}])}(De.PureComponent);a1(zf,"displayName","Legend");a1(zf,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var wD=fy,Iee=sP,kee=xo,TD=wD?wD.isConcatSpreadable:void 0;function Dee(e){return kee(e)||Iee(e)||!!(TD&&e&&e[TD])}var Lee=Dee,zee=aj,Ree=Lee;function bj(e,t,r,i,u){var h=-1,p=e.length;for(r||(r=Ree),u||(u=[]);++h<p;){var _=e[h];t>0&&r(_)?t>1?bj(_,t-1,r,i,u):zee(u,_):i||(u[u.length]=_)}return u}var wj=bj;function Bee(e){return function(t,r,i){for(var u=-1,h=Object(t),p=i(t),_=p.length;_--;){var o=p[e?_:++u];if(r(h[o],o,h)===!1)break}return t}}var jee=Bee,Fee=jee,$ee=Fee(),Nee=$ee,Uee=Nee,Vee=o1;function Gee(e,t){return e&&Uee(e,t,Vee)}var Tj=Gee,Wee=my;function qee(e,t){return function(r,i){if(r==null)return r;if(!Wee(r))return e(r,i);for(var u=r.length,h=t?u:-1,p=Object(r);(t?h--:++h<u)&&i(p[h],h,p)!==!1;);return r}}var Zee=qee,Hee=Tj,Xee=Zee,Kee=Xee(Hee),hP=Kee,Yee=hP,Jee=my;function Qee(e,t){var r=-1,i=Jee(e)?Array(e.length):[];return Yee(e,function(u,h,p){i[++r]=t(u,h,p)}),i}var Sj=Qee;function ete(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var tte=ete,SD=Td;function rte(e,t){if(e!==t){var r=e!==void 0,i=e===null,u=e===e,h=SD(e),p=t!==void 0,_=t===null,o=t===t,x=SD(t);if(!_&&!x&&!h&&e>t||h&&p&&o&&!_&&!x||i&&p&&o||!r&&o||!u)return 1;if(!i&&!h&&!x&&e<t||x&&r&&u&&!i&&!h||_&&r&&u||!p&&u||!o)return-1}return 0}var nte=rte,ite=nte;function ote(e,t,r){for(var i=-1,u=e.criteria,h=t.criteria,p=u.length,_=r.length;++i<p;){var o=ite(u[i],h[i]);if(o){if(i>=_)return o;var x=r[i];return o*(x=="desc"?-1:1)}}return e.index-t.index}var ate=ote,Zw=XA,ste=KA,lte=xu,ute=Sj,cte=tte,hte=uj,fte=ate,dte=Od,pte=xo;function mte(e,t,r){t.length?t=Zw(t,function(h){return pte(h)?function(p){return ste(p,h.length===1?h[0]:h)}:h}):t=[dte];var i=-1;t=Zw(t,hte(lte));var u=ute(e,function(h,p,_){var o=Zw(t,function(x){return x(h)});return{criteria:o,index:++i,value:h}});return cte(u,function(h,p){return fte(h,p,r)})}var gte=mte;function yte(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var _te=yte,vte=_te,ED=Math.max;function xte(e,t,r){return t=ED(t===void 0?e.length-1:t,0),function(){for(var i=arguments,u=-1,h=ED(i.length-t,0),p=Array(h);++u<h;)p[u]=i[t+u];u=-1;for(var _=Array(t+1);++u<t;)_[u]=i[u];return _[t]=r(p),vte(e,this,_)}}var bte=xte;function wte(e){return function(){return e}}var Tte=wte,Ste=Wc,Ete=function(){try{var e=Ste(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Ej=Ete,Ate=Tte,AD=Ej,Pte=Od,Mte=AD?function(e,t){return AD(e,"toString",{configurable:!0,enumerable:!1,value:Ate(t),writable:!0})}:Pte,Cte=Mte,Ote=800,Ite=16,kte=Date.now;function Dte(e){var t=0,r=0;return function(){var i=kte(),u=Ite-(i-r);if(r=i,u>0){if(++t>=Ote)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Lte=Dte,zte=Cte,Rte=Lte,Bte=Rte(zte),jte=Bte,Fte=Od,$te=bte,Nte=jte;function Ute(e,t){return Nte($te(e,t,Fte),e+"")}var Vte=Ute,Gte=WA,Wte=my,qte=lP,Zte=vu;function Hte(e,t,r){if(!Zte(r))return!1;var i=typeof t;return(i=="number"?Wte(r)&&qte(t,r.length):i=="string"&&t in r)?Gte(r[t],e):!1}var s1=Hte,Xte=wj,Kte=gte,Yte=Vte,PD=s1,Jte=Yte(function(e,t){if(e==null)return[];var r=t.length;return r>1&&PD(e,t[0],t[1])?t=[]:r>2&&PD(t[0],t[1],t[2])&&(t=[t[0]]),Kte(e,Xte(t,1),[])}),Qte=Jte;const fP=Xr(Qte);function Ag(e){"@babel/helpers - typeof";return Ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ag(e)}function NS(){return NS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},NS.apply(this,arguments)}function ere(e,t){return ire(e)||nre(e,t)||rre(e,t)||tre()}function tre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rre(e,t){if(e){if(typeof e=="string")return MD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MD(e,t)}}function MD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function nre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t!==0)for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function ire(e){if(Array.isArray(e))return e}function CD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Hw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CD(Object(r),!0).forEach(function(i){ore(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CD(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function ore(e,t,r){return t=are(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function are(e){var t=sre(e,"string");return Ag(t)=="symbol"?t:t+""}function sre(e,t){if(Ag(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Ag(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lre(e){return Array.isArray(e)&&ci(e[0])&&ci(e[1])?e.join(" ~ "):e}var ure=function(t){var r=t.separator,i=r===void 0?" : ":r,u=t.contentStyle,h=u===void 0?{}:u,p=t.itemStyle,_=p===void 0?{}:p,o=t.labelStyle,x=o===void 0?{}:o,E=t.payload,A=t.formatter,O=t.itemSorter,L=t.wrapperClassName,j=t.labelClassName,F=t.label,Z=t.labelFormatter,$=t.accessibilityLayer,V=$===void 0?!1:$,U=function(){if(E&&E.length){var $e={padding:0,margin:0},Ve=(O?fP(E,O):E).map(function(be,_e){if(be.type==="none")return null;var Me=Hw({display:"block",paddingTop:4,paddingBottom:4,color:be.color||"#000"},_),ke=be.formatter||A||lre,Ce=be.value,Oe=be.name,at=Ce,ft=Oe;if(ke&&at!=null&&ft!=null){var st=ke(Ce,Oe,be,_e,E);if(Array.isArray(st)){var Ot=ere(st,2);at=Ot[0],ft=Ot[1]}else at=st}return Fe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(_e),style:Me},ci(ft)?Fe.createElement("span",{className:"recharts-tooltip-item-name"},ft):null,ci(ft)?Fe.createElement("span",{className:"recharts-tooltip-item-separator"},i):null,Fe.createElement("span",{className:"recharts-tooltip-item-value"},at),Fe.createElement("span",{className:"recharts-tooltip-item-unit"},be.unit||""))});return Fe.createElement("ul",{className:"recharts-tooltip-item-list",style:$e},Ve)}return null},G=Hw({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},h),q=Hw({margin:0},x),K=!Qr(F),re=K?F:"",pe=en("recharts-default-tooltip",L),xe=en("recharts-tooltip-label",j);K&&Z&&E!==void 0&&E!==null&&(re=Z(F,E));var ge=V?{role:"status","aria-live":"assertive"}:{};return Fe.createElement("div",NS({className:pe,style:G},ge),Fe.createElement("p",{className:xe,style:q},Fe.isValidElement(re)?re:"".concat(re)),U())};function Pg(e){"@babel/helpers - typeof";return Pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pg(e)}function gv(e,t,r){return t=cre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cre(e){var t=hre(e,"string");return Pg(t)=="symbol"?t:t+""}function hre(e,t){if(Pg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Pg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mm="recharts-tooltip-wrapper",fre={visibility:"hidden"};function dre(e){var t=e.coordinate,r=e.translateX,i=e.translateY;return en(Mm,gv(gv(gv(gv({},"".concat(Mm,"-right"),zt(r)&&t&&zt(t.x)&&r>=t.x),"".concat(Mm,"-left"),zt(r)&&t&&zt(t.x)&&r<t.x),"".concat(Mm,"-bottom"),zt(i)&&t&&zt(t.y)&&i>=t.y),"".concat(Mm,"-top"),zt(i)&&t&&zt(t.y)&&i<t.y))}function OD(e){var t=e.allowEscapeViewBox,r=e.coordinate,i=e.key,u=e.offsetTopLeft,h=e.position,p=e.reverseDirection,_=e.tooltipDimension,o=e.viewBox,x=e.viewBoxDimension;if(h&&zt(h[i]))return h[i];var E=r[i]-_-u,A=r[i]+u;if(t[i])return p[i]?E:A;if(p[i]){var O=E,L=o[i];return O<L?Math.max(A,o[i]):Math.max(E,o[i])}var j=A+_,F=o[i]+x;return j>F?Math.max(E,o[i]):Math.max(A,o[i])}function pre(e){var t=e.translateX,r=e.translateY,i=e.useTranslate3d;return{transform:i?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function mre(e){var t=e.allowEscapeViewBox,r=e.coordinate,i=e.offsetTopLeft,u=e.position,h=e.reverseDirection,p=e.tooltipBox,_=e.useTranslate3d,o=e.viewBox,x,E,A;return p.height>0&&p.width>0&&r?(E=OD({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:i,position:u,reverseDirection:h,tooltipDimension:p.width,viewBox:o,viewBoxDimension:o.width}),A=OD({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:i,position:u,reverseDirection:h,tooltipDimension:p.height,viewBox:o,viewBoxDimension:o.height}),x=pre({translateX:E,translateY:A,useTranslate3d:_})):x=fre,{cssProperties:x,cssClasses:dre({translateX:E,translateY:A,coordinate:r})}}function Qf(e){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qf(e)}function ID(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function kD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ID(Object(r),!0).forEach(function(i){VS(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ID(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function gre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yre(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Pj(i.key),i)}}function _re(e,t,r){return t&&yre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vre(e,t,r){return t=D0(t),xre(e,Aj()?Reflect.construct(t,r||[],D0(e).constructor):t.apply(e,r))}function xre(e,t){if(t&&(Qf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bre(e)}function bre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Aj=function(){return!!e})()}function D0(e){return D0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},D0(e)}function wre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&US(e,t)}function US(e,t){return US=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},US(e,t)}function VS(e,t,r){return t=Pj(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pj(e){var t=Tre(e,"string");return Qf(t)=="symbol"?t:t+""}function Tre(e,t){if(Qf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Qf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var DD=1,Sre=function(e){function t(){var r;gre(this,t);for(var i=arguments.length,u=new Array(i),h=0;h<i;h++)u[h]=arguments[h];return r=vre(this,t,[].concat(u)),VS(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),VS(r,"handleKeyDown",function(p){if(p.key==="Escape"){var _,o,x,E;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(_=(o=r.props.coordinate)===null||o===void 0?void 0:o.x)!==null&&_!==void 0?_:0,y:(x=(E=r.props.coordinate)===null||E===void 0?void 0:E.y)!==null&&x!==void 0?x:0}})}}),r}return wre(t,e),_re(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();(Math.abs(i.width-this.state.lastBoundingBox.width)>DD||Math.abs(i.height-this.state.lastBoundingBox.height)>DD)&&this.setState({lastBoundingBox:{width:i.width,height:i.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var i,u;this.props.active&&this.updateBBox(),this.state.dismissed&&(((i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==this.state.dismissedAtCoordinate.x||((u=this.props.coordinate)===null||u===void 0?void 0:u.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var i=this,u=this.props,h=u.active,p=u.allowEscapeViewBox,_=u.animationDuration,o=u.animationEasing,x=u.children,E=u.coordinate,A=u.hasPayload,O=u.isAnimationActive,L=u.offset,j=u.position,F=u.reverseDirection,Z=u.useTranslate3d,$=u.viewBox,V=u.wrapperStyle,U=mre({allowEscapeViewBox:p,coordinate:E,offsetTopLeft:L,position:j,reverseDirection:F,tooltipBox:this.state.lastBoundingBox,useTranslate3d:Z,viewBox:$}),G=U.cssClasses,q=U.cssProperties,K=kD(kD({transition:O&&h?"transform ".concat(_,"ms ").concat(o):void 0},q),{},{pointerEvents:"none",visibility:!this.state.dismissed&&h&&A?"visible":"hidden",position:"absolute",top:0,left:0},V);return Fe.createElement("div",{tabIndex:-1,className:G,style:K,ref:function(pe){i.wrapperNode=pe}},x)}}])}(De.PureComponent),Ere=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},gy={isSsr:Ere()};function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}function LD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function zD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LD(Object(r),!0).forEach(function(i){dP(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LD(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Are(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pre(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Cj(i.key),i)}}function Mre(e,t,r){return t&&Pre(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cre(e,t,r){return t=L0(t),Ore(e,Mj()?Reflect.construct(t,r||[],L0(e).constructor):t.apply(e,r))}function Ore(e,t){if(t&&(ed(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ire(e)}function Ire(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mj=function(){return!!e})()}function L0(e){return L0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},L0(e)}function kre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GS(e,t)}function GS(e,t){return GS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},GS(e,t)}function dP(e,t,r){return t=Cj(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cj(e){var t=Dre(e,"string");return ed(t)=="symbol"?t:t+""}function Dre(e,t){if(ed(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(ed(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Lre(e){return e.dataKey}function zre(e,t){return Fe.isValidElement(e)?Fe.cloneElement(e,t):typeof e=="function"?Fe.createElement(e,t):Fe.createElement(ure,t)}var Ws=function(e){function t(){return Are(this,t),Cre(this,t,arguments)}return kre(t,e),Mre(t,[{key:"render",value:function(){var i=this,u=this.props,h=u.active,p=u.allowEscapeViewBox,_=u.animationDuration,o=u.animationEasing,x=u.content,E=u.coordinate,A=u.filterNull,O=u.isAnimationActive,L=u.offset,j=u.payload,F=u.payloadUniqBy,Z=u.position,$=u.reverseDirection,V=u.useTranslate3d,U=u.viewBox,G=u.wrapperStyle,q=j??[];A&&q.length&&(q=_j(j.filter(function(re){return re.value!=null&&(re.hide!==!0||i.props.includeHidden)}),F,Lre));var K=q.length>0;return Fe.createElement(Sre,{allowEscapeViewBox:p,animationDuration:_,animationEasing:o,isAnimationActive:O,active:h,coordinate:E,hasPayload:K,offset:L,position:Z,reverseDirection:$,useTranslate3d:V,viewBox:U,wrapperStyle:G},zre(x,zD(zD({},this.props),{},{payload:q})))}}])}(De.PureComponent);dP(Ws,"displayName","Tooltip");dP(Ws,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!gy.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Rre=bs,Bre=function(){return Rre.Date.now()},jre=Bre,Fre=/\s/;function $re(e){for(var t=e.length;t--&&Fre.test(e.charAt(t)););return t}var Nre=$re,Ure=Nre,Vre=/^\s+/;function Gre(e){return e&&e.slice(0,Ure(e)+1).replace(Vre,"")}var Wre=Gre,qre=Wre,RD=vu,Zre=Td,BD=NaN,Hre=/^[-+]0x[0-9a-f]+$/i,Xre=/^0b[01]+$/i,Kre=/^0o[0-7]+$/i,Yre=parseInt;function Jre(e){if(typeof e=="number")return e;if(Zre(e))return BD;if(RD(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=RD(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=qre(e);var r=Xre.test(e);return r||Kre.test(e)?Yre(e.slice(2),r?2:8):Hre.test(e)?BD:+e}var Oj=Jre,Qre=vu,Xw=jre,jD=Oj,ene="Expected a function",tne=Math.max,rne=Math.min;function nne(e,t,r){var i,u,h,p,_,o,x=0,E=!1,A=!1,O=!0;if(typeof e!="function")throw new TypeError(ene);t=jD(t)||0,Qre(r)&&(E=!!r.leading,A="maxWait"in r,h=A?tne(jD(r.maxWait)||0,t):h,O="trailing"in r?!!r.trailing:O);function L(K){var re=i,pe=u;return i=u=void 0,x=K,p=e.apply(pe,re),p}function j(K){return x=K,_=setTimeout($,t),E?L(K):p}function F(K){var re=K-o,pe=K-x,xe=t-re;return A?rne(xe,h-pe):xe}function Z(K){var re=K-o,pe=K-x;return o===void 0||re>=t||re<0||A&&pe>=h}function $(){var K=Xw();if(Z(K))return V(K);_=setTimeout($,F(K))}function V(K){return _=void 0,O&&i?L(K):(i=u=void 0,p)}function U(){_!==void 0&&clearTimeout(_),x=0,i=o=u=_=void 0}function G(){return _===void 0?p:V(Xw())}function q(){var K=Xw(),re=Z(K);if(i=arguments,u=this,o=K,re){if(_===void 0)return j(o);if(A)return clearTimeout(_),_=setTimeout($,t),L(o)}return _===void 0&&(_=setTimeout($,t)),p}return q.cancel=U,q.flush=G,q}var ine=nne,one=ine,ane=vu,sne="Expected a function";function lne(e,t,r){var i=!0,u=!0;if(typeof e!="function")throw new TypeError(sne);return ane(r)&&(i="leading"in r?!!r.leading:i,u="trailing"in r?!!r.trailing:u),one(e,t,{leading:i,maxWait:t,trailing:u})}var une=lne;const Ij=Xr(une);function Mg(e){"@babel/helpers - typeof";return Mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mg(e)}function FD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function yv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FD(Object(r),!0).forEach(function(i){cne(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FD(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function cne(e,t,r){return t=hne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hne(e){var t=fne(e,"string");return Mg(t)=="symbol"?t:t+""}function fne(e,t){if(Mg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Mg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dne(e,t){return yne(e)||gne(e,t)||mne(e,t)||pne()}function pne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mne(e,t){if(e){if(typeof e=="string")return $D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $D(e,t)}}function $D(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function gne(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t!==0)for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function yne(e){if(Array.isArray(e))return e}var Wge=De.forwardRef(function(e,t){var r=e.aspect,i=e.initialDimension,u=i===void 0?{width:-1,height:-1}:i,h=e.width,p=h===void 0?"100%":h,_=e.height,o=_===void 0?"100%":_,x=e.minWidth,E=x===void 0?0:x,A=e.minHeight,O=e.maxHeight,L=e.children,j=e.debounce,F=j===void 0?0:j,Z=e.id,$=e.className,V=e.onResize,U=e.style,G=U===void 0?{}:U,q=De.useRef(null),K=De.useRef();K.current=V,De.useImperativeHandle(t,function(){return Object.defineProperty(q.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),q.current},configurable:!0})});var re=De.useState({containerWidth:u.width,containerHeight:u.height}),pe=dne(re,2),xe=pe[0],ge=pe[1],Be=De.useCallback(function(Ve,be){ge(function(_e){var Me=Math.round(Ve),ke=Math.round(be);return _e.containerWidth===Me&&_e.containerHeight===ke?_e:{containerWidth:Me,containerHeight:ke}})},[]);De.useEffect(function(){var Ve=function(Oe){var at,ft=Oe[0].contentRect,st=ft.width,Ot=ft.height;Be(st,Ot),(at=K.current)===null||at===void 0||at.call(K,st,Ot)};F>0&&(Ve=Ij(Ve,F,{trailing:!0,leading:!1}));var be=new ResizeObserver(Ve),_e=q.current.getBoundingClientRect(),Me=_e.width,ke=_e.height;return Be(Me,ke),be.observe(q.current),function(){be.disconnect()}},[Be,F]);var $e=De.useMemo(function(){var Ve=xe.containerWidth,be=xe.containerHeight;if(Ve<0||be<0)return null;tl(bc(p)||bc(o),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,p,o),tl(!r||r>0,"The aspect(%s) must be greater than zero.",r);var _e=bc(p)?Ve:p,Me=bc(o)?be:o;r&&r>0&&(_e?Me=_e/r:Me&&(_e=Me*r),O&&Me>O&&(Me=O)),tl(_e>0||Me>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,_e,Me,p,o,E,A,r);var ke=!Array.isArray(L)&&el(L.type).endsWith("Chart");return Fe.Children.map(L,function(Ce){return Fe.isValidElement(Ce)?De.cloneElement(Ce,yv({width:_e,height:Me},ke?{style:yv({height:"100%",width:"100%",maxHeight:Me,maxWidth:_e},Ce.props.style)}:{})):Ce})},[r,L,o,O,A,E,xe,p]);return Fe.createElement("div",{id:Z?"".concat(Z):void 0,className:en("recharts-responsive-container",$),style:yv(yv({},G),{},{width:p,height:o,minWidth:E,minHeight:A,maxHeight:O}),ref:q},$e)}),kj=function(t){return null};kj.displayName="Cell";function Cg(e){"@babel/helpers - typeof";return Cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cg(e)}function ND(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function WS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ND(Object(r),!0).forEach(function(i){_ne(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ND(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function _ne(e,t,r){return t=vne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vne(e){var t=xne(e,"string");return Cg(t)=="symbol"?t:t+""}function xne(e,t){if(Cg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Cg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ef={widthCache:{},cacheCount:0},bne=2e3,wne={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},UD="recharts_measurement_span";function Tne(e){var t=WS({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var eg=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||gy.isSsr)return{width:0,height:0};var i=Tne(r),u=JSON.stringify({text:t,copyStyle:i});if(ef.widthCache[u])return ef.widthCache[u];try{var h=document.getElementById(UD);h||(h=document.createElement("span"),h.setAttribute("id",UD),h.setAttribute("aria-hidden","true"),document.body.appendChild(h));var p=WS(WS({},wne),i);Object.assign(h.style,p),h.textContent="".concat(t);var _=h.getBoundingClientRect(),o={width:_.width,height:_.height};return ef.widthCache[u]=o,++ef.cacheCount>bne&&(ef.cacheCount=0,ef.widthCache={}),o}catch{return{width:0,height:0}}},Sne=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Og(e){"@babel/helpers - typeof";return Og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Og(e)}function z0(e,t){return Mne(e)||Pne(e,t)||Ane(e,t)||Ene()}function Ene(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ane(e,t){if(e){if(typeof e=="string")return VD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VD(e,t)}}function VD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function Pne(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;o=!1}else for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function Mne(e){if(Array.isArray(e))return e}function Cne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GD(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Ine(i.key),i)}}function One(e,t,r){return t&&GD(e.prototype,t),r&&GD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ine(e){var t=kne(e,"string");return Og(t)=="symbol"?t:t+""}function kne(e,t){if(Og(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Og(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var WD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Dne=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Lne=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Dj={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},zne=Object.keys(Dj),xf="NaN";function Rne(e,t){return e*Dj[t]}var _v=function(){function e(t,r){Cne(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!Dne.test(r)&&(this.num=NaN,this.unit=""),zne.includes(r)&&(this.num=Rne(t,r),this.unit="px")}return One(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var i,u=(i=Lne.exec(r))!==null&&i!==void 0?i:[],h=z0(u,3),p=h[1],_=h[2];return new e(parseFloat(p),_??"")}}])}();function Lj(e){if(e.includes(xf))return xf;for(var t=e;t.includes("*")||t.includes("/");){var r,i=(r=WD.exec(t))!==null&&r!==void 0?r:[],u=z0(i,4),h=u[1],p=u[2],_=u[3],o=_v.parse(h??""),x=_v.parse(_??""),E=p==="*"?o.multiply(x):o.divide(x);if(E.isNaN())return xf;t=t.replace(WD,E.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var A,O=(A=qD.exec(t))!==null&&A!==void 0?A:[],L=z0(O,4),j=L[1],F=L[2],Z=L[3],$=_v.parse(j??""),V=_v.parse(Z??""),U=F==="+"?$.add(V):$.subtract(V);if(U.isNaN())return xf;t=t.replace(qD,U.toString())}return t}var ZD=/\(([^()]*)\)/;function Bne(e){for(var t=e;t.includes("(");){var r=ZD.exec(t),i=z0(r,2),u=i[1];t=t.replace(ZD,Lj(u))}return t}function jne(e){var t=e.replace(/\s+/g,"");return t=Bne(t),t=Lj(t),t}function Fne(e){try{return jne(e)}catch{return xf}}function Kw(e){var t=Fne(e.slice(5,-1));return t===xf?"":t}var $ne=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Nne=["dx","dy","angle","className","breakAll"];function qS(){return qS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},qS.apply(this,arguments)}function HD(e,t){if(e==null)return{};var r=Une(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function Une(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function XD(e,t){return qne(e)||Wne(e,t)||Gne(e,t)||Vne()}function Vne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gne(e,t){if(e){if(typeof e=="string")return KD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KD(e,t)}}function KD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function Wne(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;o=!1}else for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function qne(e){if(Array.isArray(e))return e}var zj=/[ \f\n\r\t\v\u2028\u2029]+/,Rj=function(t){var r=t.children,i=t.breakAll,u=t.style;try{var h=[];Qr(r)||(i?h=r.toString().split(""):h=r.toString().split(zj));var p=h.map(function(o){return{word:o,width:eg(o,u).width}}),_=i?0:eg(" ",u).width;return{wordsWithComputedWidth:p,spaceWidth:_}}catch{return null}},Zne=function(t,r,i,u,h){var p=t.maxLines,_=t.children,o=t.style,x=t.breakAll,E=zt(p),A=_,O=function(){var _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return _e.reduce(function(Me,ke){var Ce=ke.word,Oe=ke.width,at=Me[Me.length-1];if(at&&(u==null||h||at.width+Oe+i<Number(u)))at.words.push(Ce),at.width+=Oe+i;else{var ft={words:[Ce],width:Oe};Me.push(ft)}return Me},[])},L=O(r),j=function(_e){return _e.reduce(function(Me,ke){return Me.width>ke.width?Me:ke})};if(!E)return L;for(var F="…",Z=function(_e){var Me=A.slice(0,_e),ke=Rj({breakAll:x,style:o,children:Me+F}).wordsWithComputedWidth,Ce=O(ke),Oe=Ce.length>p||j(Ce).width>Number(u);return[Oe,Ce]},$=0,V=A.length-1,U=0,G;$<=V&&U<=A.length-1;){var q=Math.floor(($+V)/2),K=q-1,re=Z(K),pe=XD(re,2),xe=pe[0],ge=pe[1],Be=Z(q),$e=XD(Be,1),Ve=$e[0];if(!xe&&!Ve&&($=q+1),xe&&Ve&&(V=q-1),!xe&&Ve){G=ge;break}U++}return G||L},YD=function(t){var r=Qr(t)?[]:t.toString().split(zj);return[{words:r}]},Hne=function(t){var r=t.width,i=t.scaleToFit,u=t.children,h=t.style,p=t.breakAll,_=t.maxLines;if((r||i)&&!gy.isSsr){var o,x,E=Rj({breakAll:p,children:u,style:h});if(E){var A=E.wordsWithComputedWidth,O=E.spaceWidth;o=A,x=O}else return YD(u);return Zne({breakAll:p,children:u,maxLines:_,style:h},o,x,r,i)}return YD(u)},JD="#808080",R0=function(t){var r=t.x,i=r===void 0?0:r,u=t.y,h=u===void 0?0:u,p=t.lineHeight,_=p===void 0?"1em":p,o=t.capHeight,x=o===void 0?"0.71em":o,E=t.scaleToFit,A=E===void 0?!1:E,O=t.textAnchor,L=O===void 0?"start":O,j=t.verticalAnchor,F=j===void 0?"end":j,Z=t.fill,$=Z===void 0?JD:Z,V=HD(t,$ne),U=De.useMemo(function(){return Hne({breakAll:V.breakAll,children:V.children,maxLines:V.maxLines,scaleToFit:A,style:V.style,width:V.width})},[V.breakAll,V.children,V.maxLines,A,V.style,V.width]),G=V.dx,q=V.dy,K=V.angle,re=V.className,pe=V.breakAll,xe=HD(V,Nne);if(!ci(i)||!ci(h))return null;var ge=i+(zt(G)?G:0),Be=h+(zt(q)?q:0),$e;switch(F){case"start":$e=Kw("calc(".concat(x,")"));break;case"middle":$e=Kw("calc(".concat((U.length-1)/2," * -").concat(_," + (").concat(x," / 2))"));break;default:$e=Kw("calc(".concat(U.length-1," * -").concat(_,")"));break}var Ve=[];if(A){var be=U[0].width,_e=V.width;Ve.push("scale(".concat((zt(_e)?_e/be:1)/be,")"))}return K&&Ve.push("rotate(".concat(K,", ").concat(ge,", ").concat(Be,")")),Ve.length&&(xe.transform=Ve.join(" ")),Fe.createElement("text",qS({},Hr(xe,!0),{x:ge,y:Be,className:en("recharts-text",re),textAnchor:L,fill:$.includes("url")?JD:$}),U.map(function(Me,ke){var Ce=Me.words.join(pe?"":" ");return Fe.createElement("tspan",{x:ge,dy:ke===0?$e:_,key:"".concat(Ce,"-").concat(ke)},Ce)}))};function cu(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Xne(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function pP(e){let t,r,i;e.length!==2?(t=cu,r=(_,o)=>cu(e(_),o),i=(_,o)=>e(_)-o):(t=e===cu||e===Xne?e:Kne,r=e,i=e);function u(_,o,x=0,E=_.length){if(x<E){if(t(o,o)!==0)return E;do{const A=x+E>>>1;r(_[A],o)<0?x=A+1:E=A}while(x<E)}return x}function h(_,o,x=0,E=_.length){if(x<E){if(t(o,o)!==0)return E;do{const A=x+E>>>1;r(_[A],o)<=0?x=A+1:E=A}while(x<E)}return x}function p(_,o,x=0,E=_.length){const A=u(_,o,x,E-1);return A>x&&i(_[A-1],o)>-i(_[A],o)?A-1:A}return{left:u,center:p,right:h}}function Kne(){return 0}function Bj(e){return e===null?NaN:+e}function*Yne(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const Jne=pP(cu),yy=Jne.right;pP(Bj).center;class QD extends Map{constructor(t,r=tie){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[i,u]of t)this.set(i,u)}get(t){return super.get(e3(this,t))}has(t){return super.has(e3(this,t))}set(t,r){return super.set(Qne(this,t),r)}delete(t){return super.delete(eie(this,t))}}function e3({_intern:e,_key:t},r){const i=t(r);return e.has(i)?e.get(i):r}function Qne({_intern:e,_key:t},r){const i=t(r);return e.has(i)?e.get(i):(e.set(i,r),r)}function eie({_intern:e,_key:t},r){const i=t(r);return e.has(i)&&(r=e.get(i),e.delete(i)),r}function tie(e){return e!==null&&typeof e=="object"?e.valueOf():e}function rie(e=cu){if(e===cu)return jj;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const i=e(t,r);return i||i===0?i:(e(r,r)===0)-(e(t,t)===0)}}function jj(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const nie=Math.sqrt(50),iie=Math.sqrt(10),oie=Math.sqrt(2);function B0(e,t,r){const i=(t-e)/Math.max(0,r),u=Math.floor(Math.log10(i)),h=i/Math.pow(10,u),p=h>=nie?10:h>=iie?5:h>=oie?2:1;let _,o,x;return u<0?(x=Math.pow(10,-u)/p,_=Math.round(e*x),o=Math.round(t*x),_/x<e&&++_,o/x>t&&--o,x=-x):(x=Math.pow(10,u)*p,_=Math.round(e/x),o=Math.round(t/x),_*x<e&&++_,o*x>t&&--o),o<_&&.5<=r&&r<2?B0(e,t,r*2):[_,o,x]}function ZS(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const i=t<e,[u,h,p]=i?B0(t,e,r):B0(e,t,r);if(!(h>=u))return[];const _=h-u+1,o=new Array(_);if(i)if(p<0)for(let x=0;x<_;++x)o[x]=(h-x)/-p;else for(let x=0;x<_;++x)o[x]=(h-x)*p;else if(p<0)for(let x=0;x<_;++x)o[x]=(u+x)/-p;else for(let x=0;x<_;++x)o[x]=(u+x)*p;return o}function HS(e,t,r){return t=+t,e=+e,r=+r,B0(e,t,r)[2]}function XS(e,t,r){t=+t,e=+e,r=+r;const i=t<e,u=i?HS(t,e,r):HS(e,t,r);return(i?-1:1)*(u<0?1/-u:u)}function t3(e,t){let r;for(const i of e)i!=null&&(r<i||r===void 0&&i>=i)&&(r=i);return r}function r3(e,t){let r;for(const i of e)i!=null&&(r>i||r===void 0&&i>=i)&&(r=i);return r}function Fj(e,t,r=0,i=1/0,u){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),i=Math.floor(Math.min(e.length-1,i)),!(r<=t&&t<=i))return e;for(u=u===void 0?jj:rie(u);i>r;){if(i-r>600){const o=i-r+1,x=t-r+1,E=Math.log(o),A=.5*Math.exp(2*E/3),O=.5*Math.sqrt(E*A*(o-A)/o)*(x-o/2<0?-1:1),L=Math.max(r,Math.floor(t-x*A/o+O)),j=Math.min(i,Math.floor(t+(o-x)*A/o+O));Fj(e,t,L,j,u)}const h=e[t];let p=r,_=i;for(Cm(e,r,t),u(e[i],h)>0&&Cm(e,r,i);p<_;){for(Cm(e,p,_),++p,--_;u(e[p],h)<0;)++p;for(;u(e[_],h)>0;)--_}u(e[r],h)===0?Cm(e,r,_):(++_,Cm(e,_,i)),_<=t&&(r=_+1),t<=_&&(i=_-1)}return e}function Cm(e,t,r){const i=e[t];e[t]=e[r],e[r]=i}function aie(e,t,r){if(e=Float64Array.from(Yne(e)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return r3(e);if(t>=1)return t3(e);var i,u=(i-1)*t,h=Math.floor(u),p=t3(Fj(e,h).subarray(0,h+1)),_=r3(e.subarray(h+1));return p+(_-p)*(u-h)}}function sie(e,t,r=Bj){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+r(e[0],0,e);if(t>=1)return+r(e[i-1],i-1,e);var i,u=(i-1)*t,h=Math.floor(u),p=+r(e[h],h,e),_=+r(e[h+1],h+1,e);return p+(_-p)*(u-h)}}function lie(e,t,r){e=+e,t=+t,r=(u=arguments.length)<2?(t=e,e=0,1):u<3?1:+r;for(var i=-1,u=Math.max(0,Math.ceil((t-e)/r))|0,h=new Array(u);++i<u;)h[i]=e+i*r;return h}function ha(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function dl(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const KS=Symbol("implicit");function mP(){var e=new QD,t=[],r=[],i=KS;function u(h){let p=e.get(h);if(p===void 0){if(i!==KS)return i;e.set(h,p=t.push(h)-1)}return r[p%r.length]}return u.domain=function(h){if(!arguments.length)return t.slice();t=[],e=new QD;for(const p of h)e.has(p)||e.set(p,t.push(p)-1);return u},u.range=function(h){return arguments.length?(r=Array.from(h),u):r.slice()},u.unknown=function(h){return arguments.length?(i=h,u):i},u.copy=function(){return mP(t,r).unknown(i)},ha.apply(u,arguments),u}function Ig(){var e=mP().unknown(void 0),t=e.domain,r=e.range,i=0,u=1,h,p,_=!1,o=0,x=0,E=.5;delete e.unknown;function A(){var O=t().length,L=u<i,j=L?u:i,F=L?i:u;h=(F-j)/Math.max(1,O-o+x*2),_&&(h=Math.floor(h)),j+=(F-j-h*(O-o))*E,p=h*(1-o),_&&(j=Math.round(j),p=Math.round(p));var Z=lie(O).map(function($){return j+h*$});return r(L?Z.reverse():Z)}return e.domain=function(O){return arguments.length?(t(O),A()):t()},e.range=function(O){return arguments.length?([i,u]=O,i=+i,u=+u,A()):[i,u]},e.rangeRound=function(O){return[i,u]=O,i=+i,u=+u,_=!0,A()},e.bandwidth=function(){return p},e.step=function(){return h},e.round=function(O){return arguments.length?(_=!!O,A()):_},e.padding=function(O){return arguments.length?(o=Math.min(1,x=+O),A()):o},e.paddingInner=function(O){return arguments.length?(o=Math.min(1,O),A()):o},e.paddingOuter=function(O){return arguments.length?(x=+O,A()):x},e.align=function(O){return arguments.length?(E=Math.max(0,Math.min(1,O)),A()):E},e.copy=function(){return Ig(t(),[i,u]).round(_).paddingInner(o).paddingOuter(x).align(E)},ha.apply(A(),arguments)}function $j(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return $j(t())},e}function tg(){return $j(Ig.apply(null,arguments).paddingInner(1))}function gP(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Nj(e,t){var r=Object.create(e.prototype);for(var i in t)r[i]=t[i];return r}function _y(){}var kg=.7,j0=1/kg,Rf="\\s*([+-]?\\d+)\\s*",Dg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ys="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uie=/^#([0-9a-f]{3,8})$/,cie=new RegExp(`^rgb\\(${Rf},${Rf},${Rf}\\)$`),hie=new RegExp(`^rgb\\(${ys},${ys},${ys}\\)$`),fie=new RegExp(`^rgba\\(${Rf},${Rf},${Rf},${Dg}\\)$`),die=new RegExp(`^rgba\\(${ys},${ys},${ys},${Dg}\\)$`),pie=new RegExp(`^hsl\\(${Dg},${ys},${ys}\\)$`),mie=new RegExp(`^hsla\\(${Dg},${ys},${ys},${Dg}\\)$`),n3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};gP(_y,Lg,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:i3,formatHex:i3,formatHex8:gie,formatHsl:yie,formatRgb:o3,toString:o3});function i3(){return this.rgb().formatHex()}function gie(){return this.rgb().formatHex8()}function yie(){return Uj(this).formatHsl()}function o3(){return this.rgb().formatRgb()}function Lg(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=uie.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?a3(t):r===3?new go(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?vv(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?vv(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=cie.exec(e))?new go(t[1],t[2],t[3],1):(t=hie.exec(e))?new go(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=fie.exec(e))?vv(t[1],t[2],t[3],t[4]):(t=die.exec(e))?vv(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=pie.exec(e))?u3(t[1],t[2]/100,t[3]/100,1):(t=mie.exec(e))?u3(t[1],t[2]/100,t[3]/100,t[4]):n3.hasOwnProperty(e)?a3(n3[e]):e==="transparent"?new go(NaN,NaN,NaN,0):null}function a3(e){return new go(e>>16&255,e>>8&255,e&255,1)}function vv(e,t,r,i){return i<=0&&(e=t=r=NaN),new go(e,t,r,i)}function _ie(e){return e instanceof _y||(e=Lg(e)),e?(e=e.rgb(),new go(e.r,e.g,e.b,e.opacity)):new go}function YS(e,t,r,i){return arguments.length===1?_ie(e):new go(e,t,r,i??1)}function go(e,t,r,i){this.r=+e,this.g=+t,this.b=+r,this.opacity=+i}gP(go,YS,Nj(_y,{brighter(e){return e=e==null?j0:Math.pow(j0,e),new go(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?kg:Math.pow(kg,e),new go(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new go(Mc(this.r),Mc(this.g),Mc(this.b),F0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:s3,formatHex:s3,formatHex8:vie,formatRgb:l3,toString:l3}));function s3(){return`#${wc(this.r)}${wc(this.g)}${wc(this.b)}`}function vie(){return`#${wc(this.r)}${wc(this.g)}${wc(this.b)}${wc((isNaN(this.opacity)?1:this.opacity)*255)}`}function l3(){const e=F0(this.opacity);return`${e===1?"rgb(":"rgba("}${Mc(this.r)}, ${Mc(this.g)}, ${Mc(this.b)}${e===1?")":`, ${e})`}`}function F0(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Mc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function wc(e){return e=Mc(e),(e<16?"0":"")+e.toString(16)}function u3(e,t,r,i){return i<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ua(e,t,r,i)}function Uj(e){if(e instanceof Ua)return new Ua(e.h,e.s,e.l,e.opacity);if(e instanceof _y||(e=Lg(e)),!e)return new Ua;if(e instanceof Ua)return e;e=e.rgb();var t=e.r/255,r=e.g/255,i=e.b/255,u=Math.min(t,r,i),h=Math.max(t,r,i),p=NaN,_=h-u,o=(h+u)/2;return _?(t===h?p=(r-i)/_+(r<i)*6:r===h?p=(i-t)/_+2:p=(t-r)/_+4,_/=o<.5?h+u:2-h-u,p*=60):_=o>0&&o<1?0:p,new Ua(p,_,o,e.opacity)}function xie(e,t,r,i){return arguments.length===1?Uj(e):new Ua(e,t,r,i??1)}function Ua(e,t,r,i){this.h=+e,this.s=+t,this.l=+r,this.opacity=+i}gP(Ua,xie,Nj(_y,{brighter(e){return e=e==null?j0:Math.pow(j0,e),new Ua(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?kg:Math.pow(kg,e),new Ua(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*t,u=2*r-i;return new go(Yw(e>=240?e-240:e+120,u,i),Yw(e,u,i),Yw(e<120?e+240:e-120,u,i),this.opacity)},clamp(){return new Ua(c3(this.h),xv(this.s),xv(this.l),F0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=F0(this.opacity);return`${e===1?"hsl(":"hsla("}${c3(this.h)}, ${xv(this.s)*100}%, ${xv(this.l)*100}%${e===1?")":`, ${e})`}`}}));function c3(e){return e=(e||0)%360,e<0?e+360:e}function xv(e){return Math.max(0,Math.min(1,e||0))}function Yw(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const yP=e=>()=>e;function bie(e,t){return function(r){return e+r*t}}function wie(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(i){return Math.pow(e+i*t,r)}}function Tie(e){return(e=+e)==1?Vj:function(t,r){return r-t?wie(t,r,e):yP(isNaN(t)?r:t)}}function Vj(e,t){var r=t-e;return r?bie(e,r):yP(isNaN(e)?t:e)}const h3=function e(t){var r=Tie(t);function i(u,h){var p=r((u=YS(u)).r,(h=YS(h)).r),_=r(u.g,h.g),o=r(u.b,h.b),x=Vj(u.opacity,h.opacity);return function(E){return u.r=p(E),u.g=_(E),u.b=o(E),u.opacity=x(E),u+""}}return i.gamma=e,i}(1);function Sie(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,i=t.slice(),u;return function(h){for(u=0;u<r;++u)i[u]=e[u]*(1-h)+t[u]*h;return i}}function Eie(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Aie(e,t){var r=t?t.length:0,i=e?Math.min(r,e.length):0,u=new Array(i),h=new Array(r),p;for(p=0;p<i;++p)u[p]=Id(e[p],t[p]);for(;p<r;++p)h[p]=t[p];return function(_){for(p=0;p<i;++p)h[p]=u[p](_);return h}}function Pie(e,t){var r=new Date;return e=+e,t=+t,function(i){return r.setTime(e*(1-i)+t*i),r}}function $0(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Mie(e,t){var r={},i={},u;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(u in t)u in e?r[u]=Id(e[u],t[u]):i[u]=t[u];return function(h){for(u in r)i[u]=r[u](h);return i}}var JS=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jw=new RegExp(JS.source,"g");function Cie(e){return function(){return e}}function Oie(e){return function(t){return e(t)+""}}function Iie(e,t){var r=JS.lastIndex=Jw.lastIndex=0,i,u,h,p=-1,_=[],o=[];for(e=e+"",t=t+"";(i=JS.exec(e))&&(u=Jw.exec(t));)(h=u.index)>r&&(h=t.slice(r,h),_[p]?_[p]+=h:_[++p]=h),(i=i[0])===(u=u[0])?_[p]?_[p]+=u:_[++p]=u:(_[++p]=null,o.push({i:p,x:$0(i,u)})),r=Jw.lastIndex;return r<t.length&&(h=t.slice(r),_[p]?_[p]+=h:_[++p]=h),_.length<2?o[0]?Oie(o[0].x):Cie(t):(t=o.length,function(x){for(var E=0,A;E<t;++E)_[(A=o[E]).i]=A.x(x);return _.join("")})}function Id(e,t){var r=typeof t,i;return t==null||r==="boolean"?yP(t):(r==="number"?$0:r==="string"?(i=Lg(t))?(t=i,h3):Iie:t instanceof Lg?h3:t instanceof Date?Pie:Eie(t)?Sie:Array.isArray(t)?Aie:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Mie:$0)(e,t)}function _P(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function kie(e,t){t===void 0&&(t=e,e=Id);for(var r=0,i=t.length-1,u=t[0],h=new Array(i<0?0:i);r<i;)h[r]=e(u,u=t[++r]);return function(p){var _=Math.max(0,Math.min(i-1,Math.floor(p*=i)));return h[_](p-_)}}function Die(e){return function(){return e}}function N0(e){return+e}var f3=[0,1];function Ji(e){return e}function QS(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Die(isNaN(t)?NaN:.5)}function Lie(e,t){var r;return e>t&&(r=e,e=t,t=r),function(i){return Math.max(e,Math.min(t,i))}}function zie(e,t,r){var i=e[0],u=e[1],h=t[0],p=t[1];return u<i?(i=QS(u,i),h=r(p,h)):(i=QS(i,u),h=r(h,p)),function(_){return h(i(_))}}function Rie(e,t,r){var i=Math.min(e.length,t.length)-1,u=new Array(i),h=new Array(i),p=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++p<i;)u[p]=QS(e[p],e[p+1]),h[p]=r(t[p],t[p+1]);return function(_){var o=yy(e,_,1,i)-1;return h[o](u[o](_))}}function vy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function l1(){var e=f3,t=f3,r=Id,i,u,h,p=Ji,_,o,x;function E(){var O=Math.min(e.length,t.length);return p!==Ji&&(p=Lie(e[0],e[O-1])),_=O>2?Rie:zie,o=x=null,A}function A(O){return O==null||isNaN(O=+O)?h:(o||(o=_(e.map(i),t,r)))(i(p(O)))}return A.invert=function(O){return p(u((x||(x=_(t,e.map(i),$0)))(O)))},A.domain=function(O){return arguments.length?(e=Array.from(O,N0),E()):e.slice()},A.range=function(O){return arguments.length?(t=Array.from(O),E()):t.slice()},A.rangeRound=function(O){return t=Array.from(O),r=_P,E()},A.clamp=function(O){return arguments.length?(p=O?!0:Ji,E()):p!==Ji},A.interpolate=function(O){return arguments.length?(r=O,E()):r},A.unknown=function(O){return arguments.length?(h=O,A):h},function(O,L){return i=O,u=L,E()}}function vP(){return l1()(Ji,Ji)}function Bie(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function U0(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,i=e.slice(0,r);return[i.length>1?i[0]+i.slice(2):i,+e.slice(r+1)]}function td(e){return e=U0(Math.abs(e)),e?e[1]:NaN}function jie(e,t){return function(r,i){for(var u=r.length,h=[],p=0,_=e[0],o=0;u>0&&_>0&&(o+_+1>i&&(_=Math.max(1,i-o)),h.push(r.substring(u-=_,u+_)),!((o+=_+1)>i));)_=e[p=(p+1)%e.length];return h.reverse().join(t)}}function Fie(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var $ie=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function zg(e){if(!(t=$ie.exec(e)))throw new Error("invalid format: "+e);var t;return new xP({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}zg.prototype=xP.prototype;function xP(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}xP.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Nie(e){e:for(var t=e.length,r=1,i=-1,u;r<t;++r)switch(e[r]){case".":i=u=r;break;case"0":i===0&&(i=r),u=r;break;default:if(!+e[r])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(u+1):e}var Gj;function Uie(e,t){var r=U0(e,t);if(!r)return e+"";var i=r[0],u=r[1],h=u-(Gj=Math.max(-8,Math.min(8,Math.floor(u/3)))*3)+1,p=i.length;return h===p?i:h>p?i+new Array(h-p+1).join("0"):h>0?i.slice(0,h)+"."+i.slice(h):"0."+new Array(1-h).join("0")+U0(e,Math.max(0,t+h-1))[0]}function d3(e,t){var r=U0(e,t);if(!r)return e+"";var i=r[0],u=r[1];return u<0?"0."+new Array(-u).join("0")+i:i.length>u+1?i.slice(0,u+1)+"."+i.slice(u+1):i+new Array(u-i.length+2).join("0")}const p3={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Bie,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>d3(e*100,t),r:d3,s:Uie,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function m3(e){return e}var g3=Array.prototype.map,y3=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Vie(e){var t=e.grouping===void 0||e.thousands===void 0?m3:jie(g3.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",u=e.decimal===void 0?".":e.decimal+"",h=e.numerals===void 0?m3:Fie(g3.call(e.numerals,String)),p=e.percent===void 0?"%":e.percent+"",_=e.minus===void 0?"−":e.minus+"",o=e.nan===void 0?"NaN":e.nan+"";function x(A){A=zg(A);var O=A.fill,L=A.align,j=A.sign,F=A.symbol,Z=A.zero,$=A.width,V=A.comma,U=A.precision,G=A.trim,q=A.type;q==="n"?(V=!0,q="g"):p3[q]||(U===void 0&&(U=12),G=!0,q="g"),(Z||O==="0"&&L==="=")&&(Z=!0,O="0",L="=");var K=F==="$"?r:F==="#"&&/[boxX]/.test(q)?"0"+q.toLowerCase():"",re=F==="$"?i:/[%p]/.test(q)?p:"",pe=p3[q],xe=/[defgprs%]/.test(q);U=U===void 0?6:/[gprs]/.test(q)?Math.max(1,Math.min(21,U)):Math.max(0,Math.min(20,U));function ge(Be){var $e=K,Ve=re,be,_e,Me;if(q==="c")Ve=pe(Be)+Ve,Be="";else{Be=+Be;var ke=Be<0||1/Be<0;if(Be=isNaN(Be)?o:pe(Math.abs(Be),U),G&&(Be=Nie(Be)),ke&&+Be==0&&j!=="+"&&(ke=!1),$e=(ke?j==="("?j:_:j==="-"||j==="("?"":j)+$e,Ve=(q==="s"?y3[8+Gj/3]:"")+Ve+(ke&&j==="("?")":""),xe){for(be=-1,_e=Be.length;++be<_e;)if(Me=Be.charCodeAt(be),48>Me||Me>57){Ve=(Me===46?u+Be.slice(be+1):Be.slice(be))+Ve,Be=Be.slice(0,be);break}}}V&&!Z&&(Be=t(Be,1/0));var Ce=$e.length+Be.length+Ve.length,Oe=Ce<$?new Array($-Ce+1).join(O):"";switch(V&&Z&&(Be=t(Oe+Be,Oe.length?$-Ve.length:1/0),Oe=""),L){case"<":Be=$e+Be+Ve+Oe;break;case"=":Be=$e+Oe+Be+Ve;break;case"^":Be=Oe.slice(0,Ce=Oe.length>>1)+$e+Be+Ve+Oe.slice(Ce);break;default:Be=Oe+$e+Be+Ve;break}return h(Be)}return ge.toString=function(){return A+""},ge}function E(A,O){var L=x((A=zg(A),A.type="f",A)),j=Math.max(-8,Math.min(8,Math.floor(td(O)/3)))*3,F=Math.pow(10,-j),Z=y3[8+j/3];return function($){return L(F*$)+Z}}return{format:x,formatPrefix:E}}var bv,bP,Wj;Gie({thousands:",",grouping:[3],currency:["$",""]});function Gie(e){return bv=Vie(e),bP=bv.format,Wj=bv.formatPrefix,bv}function Wie(e){return Math.max(0,-td(Math.abs(e)))}function qie(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(td(t)/3)))*3-td(Math.abs(e)))}function Zie(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,td(t)-td(e))+1}function qj(e,t,r,i){var u=XS(e,t,r),h;switch(i=zg(i??",f"),i.type){case"s":{var p=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(h=qie(u,p))&&(i.precision=h),Wj(i,p)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(h=Zie(u,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=h-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(h=Wie(u))&&(i.precision=h-(i.type==="%")*2);break}}return bP(i)}function bu(e){var t=e.domain;return e.ticks=function(r){var i=t();return ZS(i[0],i[i.length-1],r??10)},e.tickFormat=function(r,i){var u=t();return qj(u[0],u[u.length-1],r??10,i)},e.nice=function(r){r==null&&(r=10);var i=t(),u=0,h=i.length-1,p=i[u],_=i[h],o,x,E=10;for(_<p&&(x=p,p=_,_=x,x=u,u=h,h=x);E-- >0;){if(x=HS(p,_,r),x===o)return i[u]=p,i[h]=_,t(i);if(x>0)p=Math.floor(p/x)*x,_=Math.ceil(_/x)*x;else if(x<0)p=Math.ceil(p*x)/x,_=Math.floor(_*x)/x;else break;o=x}return e},e}function V0(){var e=vP();return e.copy=function(){return vy(e,V0())},ha.apply(e,arguments),bu(e)}function Zj(e){var t;function r(i){return i==null||isNaN(i=+i)?t:i}return r.invert=r,r.domain=r.range=function(i){return arguments.length?(e=Array.from(i,N0),r):e.slice()},r.unknown=function(i){return arguments.length?(t=i,r):t},r.copy=function(){return Zj(e).unknown(t)},e=arguments.length?Array.from(e,N0):[0,1],bu(r)}function Hj(e,t){e=e.slice();var r=0,i=e.length-1,u=e[r],h=e[i],p;return h<u&&(p=r,r=i,i=p,p=u,u=h,h=p),e[r]=t.floor(u),e[i]=t.ceil(h),e}function _3(e){return Math.log(e)}function v3(e){return Math.exp(e)}function Hie(e){return-Math.log(-e)}function Xie(e){return-Math.exp(-e)}function Kie(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Yie(e){return e===10?Kie:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Jie(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function x3(e){return(t,r)=>-e(-t,r)}function wP(e){const t=e(_3,v3),r=t.domain;let i=10,u,h;function p(){return u=Jie(i),h=Yie(i),r()[0]<0?(u=x3(u),h=x3(h),e(Hie,Xie)):e(_3,v3),t}return t.base=function(_){return arguments.length?(i=+_,p()):i},t.domain=function(_){return arguments.length?(r(_),p()):r()},t.ticks=_=>{const o=r();let x=o[0],E=o[o.length-1];const A=E<x;A&&([x,E]=[E,x]);let O=u(x),L=u(E),j,F;const Z=_==null?10:+_;let $=[];if(!(i%1)&&L-O<Z){if(O=Math.floor(O),L=Math.ceil(L),x>0){for(;O<=L;++O)for(j=1;j<i;++j)if(F=O<0?j/h(-O):j*h(O),!(F<x)){if(F>E)break;$.push(F)}}else for(;O<=L;++O)for(j=i-1;j>=1;--j)if(F=O>0?j/h(-O):j*h(O),!(F<x)){if(F>E)break;$.push(F)}$.length*2<Z&&($=ZS(x,E,Z))}else $=ZS(O,L,Math.min(L-O,Z)).map(h);return A?$.reverse():$},t.tickFormat=(_,o)=>{if(_==null&&(_=10),o==null&&(o=i===10?"s":","),typeof o!="function"&&(!(i%1)&&(o=zg(o)).precision==null&&(o.trim=!0),o=bP(o)),_===1/0)return o;const x=Math.max(1,i*_/t.ticks().length);return E=>{let A=E/h(Math.round(u(E)));return A*i<i-.5&&(A*=i),A<=x?o(E):""}},t.nice=()=>r(Hj(r(),{floor:_=>h(Math.floor(u(_))),ceil:_=>h(Math.ceil(u(_)))})),t}function Xj(){const e=wP(l1()).domain([1,10]);return e.copy=()=>vy(e,Xj()).base(e.base()),ha.apply(e,arguments),e}function b3(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function w3(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function TP(e){var t=1,r=e(b3(t),w3(t));return r.constant=function(i){return arguments.length?e(b3(t=+i),w3(t)):t},bu(r)}function Kj(){var e=TP(l1());return e.copy=function(){return vy(e,Kj()).constant(e.constant())},ha.apply(e,arguments)}function T3(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Qie(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function eoe(e){return e<0?-e*e:e*e}function SP(e){var t=e(Ji,Ji),r=1;function i(){return r===1?e(Ji,Ji):r===.5?e(Qie,eoe):e(T3(r),T3(1/r))}return t.exponent=function(u){return arguments.length?(r=+u,i()):r},bu(t)}function EP(){var e=SP(l1());return e.copy=function(){return vy(e,EP()).exponent(e.exponent())},ha.apply(e,arguments),e}function toe(){return EP.apply(null,arguments).exponent(.5)}function S3(e){return Math.sign(e)*e*e}function roe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Yj(){var e=vP(),t=[0,1],r=!1,i;function u(h){var p=roe(e(h));return isNaN(p)?i:r?Math.round(p):p}return u.invert=function(h){return e.invert(S3(h))},u.domain=function(h){return arguments.length?(e.domain(h),u):e.domain()},u.range=function(h){return arguments.length?(e.range((t=Array.from(h,N0)).map(S3)),u):t.slice()},u.rangeRound=function(h){return u.range(h).round(!0)},u.round=function(h){return arguments.length?(r=!!h,u):r},u.clamp=function(h){return arguments.length?(e.clamp(h),u):e.clamp()},u.unknown=function(h){return arguments.length?(i=h,u):i},u.copy=function(){return Yj(e.domain(),t).round(r).clamp(e.clamp()).unknown(i)},ha.apply(u,arguments),bu(u)}function Jj(){var e=[],t=[],r=[],i;function u(){var p=0,_=Math.max(1,t.length);for(r=new Array(_-1);++p<_;)r[p-1]=sie(e,p/_);return h}function h(p){return p==null||isNaN(p=+p)?i:t[yy(r,p)]}return h.invertExtent=function(p){var _=t.indexOf(p);return _<0?[NaN,NaN]:[_>0?r[_-1]:e[0],_<r.length?r[_]:e[e.length-1]]},h.domain=function(p){if(!arguments.length)return e.slice();e=[];for(let _ of p)_!=null&&!isNaN(_=+_)&&e.push(_);return e.sort(cu),u()},h.range=function(p){return arguments.length?(t=Array.from(p),u()):t.slice()},h.unknown=function(p){return arguments.length?(i=p,h):i},h.quantiles=function(){return r.slice()},h.copy=function(){return Jj().domain(e).range(t).unknown(i)},ha.apply(h,arguments)}function Qj(){var e=0,t=1,r=1,i=[.5],u=[0,1],h;function p(o){return o!=null&&o<=o?u[yy(i,o,0,r)]:h}function _(){var o=-1;for(i=new Array(r);++o<r;)i[o]=((o+1)*t-(o-r)*e)/(r+1);return p}return p.domain=function(o){return arguments.length?([e,t]=o,e=+e,t=+t,_()):[e,t]},p.range=function(o){return arguments.length?(r=(u=Array.from(o)).length-1,_()):u.slice()},p.invertExtent=function(o){var x=u.indexOf(o);return x<0?[NaN,NaN]:x<1?[e,i[0]]:x>=r?[i[r-1],t]:[i[x-1],i[x]]},p.unknown=function(o){return arguments.length&&(h=o),p},p.thresholds=function(){return i.slice()},p.copy=function(){return Qj().domain([e,t]).range(u).unknown(h)},ha.apply(bu(p),arguments)}function e5(){var e=[.5],t=[0,1],r,i=1;function u(h){return h!=null&&h<=h?t[yy(e,h,0,i)]:r}return u.domain=function(h){return arguments.length?(e=Array.from(h),i=Math.min(e.length,t.length-1),u):e.slice()},u.range=function(h){return arguments.length?(t=Array.from(h),i=Math.min(e.length,t.length-1),u):t.slice()},u.invertExtent=function(h){var p=t.indexOf(h);return[e[p-1],e[p]]},u.unknown=function(h){return arguments.length?(r=h,u):r},u.copy=function(){return e5().domain(e).range(t).unknown(r)},ha.apply(u,arguments)}const Qw=new Date,eT=new Date;function hi(e,t,r,i){function u(h){return e(h=arguments.length===0?new Date:new Date(+h)),h}return u.floor=h=>(e(h=new Date(+h)),h),u.ceil=h=>(e(h=new Date(h-1)),t(h,1),e(h),h),u.round=h=>{const p=u(h),_=u.ceil(h);return h-p<_-h?p:_},u.offset=(h,p)=>(t(h=new Date(+h),p==null?1:Math.floor(p)),h),u.range=(h,p,_)=>{const o=[];if(h=u.ceil(h),_=_==null?1:Math.floor(_),!(h<p)||!(_>0))return o;let x;do o.push(x=new Date(+h)),t(h,_),e(h);while(x<h&&h<p);return o},u.filter=h=>hi(p=>{if(p>=p)for(;e(p),!h(p);)p.setTime(p-1)},(p,_)=>{if(p>=p)if(_<0)for(;++_<=0;)for(;t(p,-1),!h(p););else for(;--_>=0;)for(;t(p,1),!h(p););}),r&&(u.count=(h,p)=>(Qw.setTime(+h),eT.setTime(+p),e(Qw),e(eT),Math.floor(r(Qw,eT))),u.every=h=>(h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?u.filter(i?p=>i(p)%h===0:p=>u.count(0,p)%h===0):u)),u}const G0=hi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);G0.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?hi(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):G0);G0.range;const Xs=1e3,na=Xs*60,Ks=na*60,sl=Ks*24,AP=sl*7,E3=sl*30,tT=sl*365,Tc=hi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Xs)},(e,t)=>(t-e)/Xs,e=>e.getUTCSeconds());Tc.range;const PP=hi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Xs)},(e,t)=>{e.setTime(+e+t*na)},(e,t)=>(t-e)/na,e=>e.getMinutes());PP.range;const MP=hi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*na)},(e,t)=>(t-e)/na,e=>e.getUTCMinutes());MP.range;const CP=hi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Xs-e.getMinutes()*na)},(e,t)=>{e.setTime(+e+t*Ks)},(e,t)=>(t-e)/Ks,e=>e.getHours());CP.range;const OP=hi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ks)},(e,t)=>(t-e)/Ks,e=>e.getUTCHours());OP.range;const xy=hi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*na)/sl,e=>e.getDate()-1);xy.range;const u1=hi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/sl,e=>e.getUTCDate()-1);u1.range;const t5=hi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/sl,e=>Math.floor(e/sl));t5.range;function qc(e){return hi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*na)/AP)}const c1=qc(0),W0=qc(1),noe=qc(2),ioe=qc(3),rd=qc(4),ooe=qc(5),aoe=qc(6);c1.range;W0.range;noe.range;ioe.range;rd.range;ooe.range;aoe.range;function Zc(e){return hi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/AP)}const h1=Zc(0),q0=Zc(1),soe=Zc(2),loe=Zc(3),nd=Zc(4),uoe=Zc(5),coe=Zc(6);h1.range;q0.range;soe.range;loe.range;nd.range;uoe.range;coe.range;const IP=hi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());IP.range;const kP=hi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());kP.range;const ll=hi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ll.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:hi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ll.range;const ul=hi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ul.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:hi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ul.range;function r5(e,t,r,i,u,h){const p=[[Tc,1,Xs],[Tc,5,5*Xs],[Tc,15,15*Xs],[Tc,30,30*Xs],[h,1,na],[h,5,5*na],[h,15,15*na],[h,30,30*na],[u,1,Ks],[u,3,3*Ks],[u,6,6*Ks],[u,12,12*Ks],[i,1,sl],[i,2,2*sl],[r,1,AP],[t,1,E3],[t,3,3*E3],[e,1,tT]];function _(x,E,A){const O=E<x;O&&([x,E]=[E,x]);const L=A&&typeof A.range=="function"?A:o(x,E,A),j=L?L.range(x,+E+1):[];return O?j.reverse():j}function o(x,E,A){const O=Math.abs(E-x)/A,L=pP(([,,Z])=>Z).right(p,O);if(L===p.length)return e.every(XS(x/tT,E/tT,A));if(L===0)return G0.every(Math.max(XS(x,E,A),1));const[j,F]=p[O/p[L-1][2]<p[L][2]/O?L-1:L];return j.every(F)}return[_,o]}const[hoe,foe]=r5(ul,kP,h1,t5,OP,MP),[doe,poe]=r5(ll,IP,c1,xy,CP,PP);function rT(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function nT(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Om(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function moe(e){var t=e.dateTime,r=e.date,i=e.time,u=e.periods,h=e.days,p=e.shortDays,_=e.months,o=e.shortMonths,x=Im(u),E=km(u),A=Im(h),O=km(h),L=Im(p),j=km(p),F=Im(_),Z=km(_),$=Im(o),V=km(o),U={a:ke,A:Ce,b:Oe,B:at,c:null,d:I3,e:I3,f:joe,g:Hoe,G:Koe,H:zoe,I:Roe,j:Boe,L:n5,m:Foe,M:$oe,p:ft,q:st,Q:L3,s:z3,S:Noe,u:Uoe,U:Voe,V:Goe,w:Woe,W:qoe,x:null,X:null,y:Zoe,Y:Xoe,Z:Yoe,"%":D3},G={a:Ot,A:St,b:pr,B:Tr,c:null,d:k3,e:k3,f:tae,g:hae,G:dae,H:Joe,I:Qoe,j:eae,L:o5,m:rae,M:nae,p:Kr,q:yr,Q:L3,s:z3,S:iae,u:oae,U:aae,V:sae,w:lae,W:uae,x:null,X:null,y:cae,Y:fae,Z:pae,"%":D3},q={a:ge,A:Be,b:$e,B:Ve,c:be,d:C3,e:C3,f:Ioe,g:M3,G:P3,H:O3,I:O3,j:Poe,L:Ooe,m:Aoe,M:Moe,p:xe,q:Eoe,Q:Doe,s:Loe,S:Coe,u:xoe,U:boe,V:woe,w:voe,W:Toe,x:_e,X:Me,y:M3,Y:P3,Z:Soe,"%":koe};U.x=K(r,U),U.X=K(i,U),U.c=K(t,U),G.x=K(r,G),G.X=K(i,G),G.c=K(t,G);function K(kt,Xt){return function(Jt){var et=[],Or=-1,Qt=0,Ir=kt.length,ir,kr,qn;for(Jt instanceof Date||(Jt=new Date(+Jt));++Or<Ir;)kt.charCodeAt(Or)===37&&(et.push(kt.slice(Qt,Or)),(kr=A3[ir=kt.charAt(++Or)])!=null?ir=kt.charAt(++Or):kr=ir==="e"?" ":"0",(qn=Xt[ir])&&(ir=qn(Jt,kr)),et.push(ir),Qt=Or+1);return et.push(kt.slice(Qt,Or)),et.join("")}}function re(kt,Xt){return function(Jt){var et=Om(1900,void 0,1),Or=pe(et,kt,Jt+="",0),Qt,Ir;if(Or!=Jt.length)return null;if("Q"in et)return new Date(et.Q);if("s"in et)return new Date(et.s*1e3+("L"in et?et.L:0));if(Xt&&!("Z"in et)&&(et.Z=0),"p"in et&&(et.H=et.H%12+et.p*12),et.m===void 0&&(et.m="q"in et?et.q:0),"V"in et){if(et.V<1||et.V>53)return null;"w"in et||(et.w=1),"Z"in et?(Qt=nT(Om(et.y,0,1)),Ir=Qt.getUTCDay(),Qt=Ir>4||Ir===0?q0.ceil(Qt):q0(Qt),Qt=u1.offset(Qt,(et.V-1)*7),et.y=Qt.getUTCFullYear(),et.m=Qt.getUTCMonth(),et.d=Qt.getUTCDate()+(et.w+6)%7):(Qt=rT(Om(et.y,0,1)),Ir=Qt.getDay(),Qt=Ir>4||Ir===0?W0.ceil(Qt):W0(Qt),Qt=xy.offset(Qt,(et.V-1)*7),et.y=Qt.getFullYear(),et.m=Qt.getMonth(),et.d=Qt.getDate()+(et.w+6)%7)}else("W"in et||"U"in et)&&("w"in et||(et.w="u"in et?et.u%7:"W"in et?1:0),Ir="Z"in et?nT(Om(et.y,0,1)).getUTCDay():rT(Om(et.y,0,1)).getDay(),et.m=0,et.d="W"in et?(et.w+6)%7+et.W*7-(Ir+5)%7:et.w+et.U*7-(Ir+6)%7);return"Z"in et?(et.H+=et.Z/100|0,et.M+=et.Z%100,nT(et)):rT(et)}}function pe(kt,Xt,Jt,et){for(var Or=0,Qt=Xt.length,Ir=Jt.length,ir,kr;Or<Qt;){if(et>=Ir)return-1;if(ir=Xt.charCodeAt(Or++),ir===37){if(ir=Xt.charAt(Or++),kr=q[ir in A3?Xt.charAt(Or++):ir],!kr||(et=kr(kt,Jt,et))<0)return-1}else if(ir!=Jt.charCodeAt(et++))return-1}return et}function xe(kt,Xt,Jt){var et=x.exec(Xt.slice(Jt));return et?(kt.p=E.get(et[0].toLowerCase()),Jt+et[0].length):-1}function ge(kt,Xt,Jt){var et=L.exec(Xt.slice(Jt));return et?(kt.w=j.get(et[0].toLowerCase()),Jt+et[0].length):-1}function Be(kt,Xt,Jt){var et=A.exec(Xt.slice(Jt));return et?(kt.w=O.get(et[0].toLowerCase()),Jt+et[0].length):-1}function $e(kt,Xt,Jt){var et=$.exec(Xt.slice(Jt));return et?(kt.m=V.get(et[0].toLowerCase()),Jt+et[0].length):-1}function Ve(kt,Xt,Jt){var et=F.exec(Xt.slice(Jt));return et?(kt.m=Z.get(et[0].toLowerCase()),Jt+et[0].length):-1}function be(kt,Xt,Jt){return pe(kt,t,Xt,Jt)}function _e(kt,Xt,Jt){return pe(kt,r,Xt,Jt)}function Me(kt,Xt,Jt){return pe(kt,i,Xt,Jt)}function ke(kt){return p[kt.getDay()]}function Ce(kt){return h[kt.getDay()]}function Oe(kt){return o[kt.getMonth()]}function at(kt){return _[kt.getMonth()]}function ft(kt){return u[+(kt.getHours()>=12)]}function st(kt){return 1+~~(kt.getMonth()/3)}function Ot(kt){return p[kt.getUTCDay()]}function St(kt){return h[kt.getUTCDay()]}function pr(kt){return o[kt.getUTCMonth()]}function Tr(kt){return _[kt.getUTCMonth()]}function Kr(kt){return u[+(kt.getUTCHours()>=12)]}function yr(kt){return 1+~~(kt.getUTCMonth()/3)}return{format:function(kt){var Xt=K(kt+="",U);return Xt.toString=function(){return kt},Xt},parse:function(kt){var Xt=re(kt+="",!1);return Xt.toString=function(){return kt},Xt},utcFormat:function(kt){var Xt=K(kt+="",G);return Xt.toString=function(){return kt},Xt},utcParse:function(kt){var Xt=re(kt+="",!0);return Xt.toString=function(){return kt},Xt}}}var A3={"-":"",_:" ",0:"0"},wi=/^\s*\d+/,goe=/^%/,yoe=/[\\^$*+?|[\]().{}]/g;function Vr(e,t,r){var i=e<0?"-":"",u=(i?-e:e)+"",h=u.length;return i+(h<r?new Array(r-h+1).join(t)+u:u)}function _oe(e){return e.replace(yoe,"\\$&")}function Im(e){return new RegExp("^(?:"+e.map(_oe).join("|")+")","i")}function km(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function voe(e,t,r){var i=wi.exec(t.slice(r,r+1));return i?(e.w=+i[0],r+i[0].length):-1}function xoe(e,t,r){var i=wi.exec(t.slice(r,r+1));return i?(e.u=+i[0],r+i[0].length):-1}function boe(e,t,r){var i=wi.exec(t.slice(r,r+2));return i?(e.U=+i[0],r+i[0].length):-1}function woe(e,t,r){var i=wi.exec(t.slice(r,r+2));return i?(e.V=+i[0],r+i[0].length):-1}function Toe(e,t,r){var i=wi.exec(t.slice(r,r+2));return i?(e.W=+i[0],r+i[0].length):-1}function P3(e,t,r){var i=wi.exec(t.slice(r,r+4));return i?(e.y=+i[0],r+i[0].length):-1}function M3(e,t,r){var i=wi.exec(t.slice(r,r+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),r+i[0].length):-1}function Soe(e,t,r){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),r+i[0].length):-1}function Eoe(e,t,r){var i=wi.exec(t.slice(r,r+1));return i?(e.q=i[0]*3-3,r+i[0].length):-1}function Aoe(e,t,r){var i=wi.exec(t.slice(r,r+2));return i?(e.m=i[0]-1,r+i[0].length):-1}function C3(e,t,r){var i=wi.exec(t.slice(r,r+2));return i?(e.d=+i[0],r+i[0].length):-1}function Poe(e,t,r){var i=wi.exec(t.slice(r,r+3));return i?(e.m=0,e.d=+i[0],r+i[0].length):-1}function O3(e,t,r){var i=wi.exec(t.slice(r,r+2));return i?(e.H=+i[0],r+i[0].length):-1}function Moe(e,t,r){var i=wi.exec(t.slice(r,r+2));return i?(e.M=+i[0],r+i[0].length):-1}function Coe(e,t,r){var i=wi.exec(t.slice(r,r+2));return i?(e.S=+i[0],r+i[0].length):-1}function Ooe(e,t,r){var i=wi.exec(t.slice(r,r+3));return i?(e.L=+i[0],r+i[0].length):-1}function Ioe(e,t,r){var i=wi.exec(t.slice(r,r+6));return i?(e.L=Math.floor(i[0]/1e3),r+i[0].length):-1}function koe(e,t,r){var i=goe.exec(t.slice(r,r+1));return i?r+i[0].length:-1}function Doe(e,t,r){var i=wi.exec(t.slice(r));return i?(e.Q=+i[0],r+i[0].length):-1}function Loe(e,t,r){var i=wi.exec(t.slice(r));return i?(e.s=+i[0],r+i[0].length):-1}function I3(e,t){return Vr(e.getDate(),t,2)}function zoe(e,t){return Vr(e.getHours(),t,2)}function Roe(e,t){return Vr(e.getHours()%12||12,t,2)}function Boe(e,t){return Vr(1+xy.count(ll(e),e),t,3)}function n5(e,t){return Vr(e.getMilliseconds(),t,3)}function joe(e,t){return n5(e,t)+"000"}function Foe(e,t){return Vr(e.getMonth()+1,t,2)}function $oe(e,t){return Vr(e.getMinutes(),t,2)}function Noe(e,t){return Vr(e.getSeconds(),t,2)}function Uoe(e){var t=e.getDay();return t===0?7:t}function Voe(e,t){return Vr(c1.count(ll(e)-1,e),t,2)}function i5(e){var t=e.getDay();return t>=4||t===0?rd(e):rd.ceil(e)}function Goe(e,t){return e=i5(e),Vr(rd.count(ll(e),e)+(ll(e).getDay()===4),t,2)}function Woe(e){return e.getDay()}function qoe(e,t){return Vr(W0.count(ll(e)-1,e),t,2)}function Zoe(e,t){return Vr(e.getFullYear()%100,t,2)}function Hoe(e,t){return e=i5(e),Vr(e.getFullYear()%100,t,2)}function Xoe(e,t){return Vr(e.getFullYear()%1e4,t,4)}function Koe(e,t){var r=e.getDay();return e=r>=4||r===0?rd(e):rd.ceil(e),Vr(e.getFullYear()%1e4,t,4)}function Yoe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Vr(t/60|0,"0",2)+Vr(t%60,"0",2)}function k3(e,t){return Vr(e.getUTCDate(),t,2)}function Joe(e,t){return Vr(e.getUTCHours(),t,2)}function Qoe(e,t){return Vr(e.getUTCHours()%12||12,t,2)}function eae(e,t){return Vr(1+u1.count(ul(e),e),t,3)}function o5(e,t){return Vr(e.getUTCMilliseconds(),t,3)}function tae(e,t){return o5(e,t)+"000"}function rae(e,t){return Vr(e.getUTCMonth()+1,t,2)}function nae(e,t){return Vr(e.getUTCMinutes(),t,2)}function iae(e,t){return Vr(e.getUTCSeconds(),t,2)}function oae(e){var t=e.getUTCDay();return t===0?7:t}function aae(e,t){return Vr(h1.count(ul(e)-1,e),t,2)}function a5(e){var t=e.getUTCDay();return t>=4||t===0?nd(e):nd.ceil(e)}function sae(e,t){return e=a5(e),Vr(nd.count(ul(e),e)+(ul(e).getUTCDay()===4),t,2)}function lae(e){return e.getUTCDay()}function uae(e,t){return Vr(q0.count(ul(e)-1,e),t,2)}function cae(e,t){return Vr(e.getUTCFullYear()%100,t,2)}function hae(e,t){return e=a5(e),Vr(e.getUTCFullYear()%100,t,2)}function fae(e,t){return Vr(e.getUTCFullYear()%1e4,t,4)}function dae(e,t){var r=e.getUTCDay();return e=r>=4||r===0?nd(e):nd.ceil(e),Vr(e.getUTCFullYear()%1e4,t,4)}function pae(){return"+0000"}function D3(){return"%"}function L3(e){return+e}function z3(e){return Math.floor(+e/1e3)}var tf,s5,l5;mae({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function mae(e){return tf=moe(e),s5=tf.format,tf.parse,l5=tf.utcFormat,tf.utcParse,tf}function gae(e){return new Date(e)}function yae(e){return e instanceof Date?+e:+new Date(+e)}function DP(e,t,r,i,u,h,p,_,o,x){var E=vP(),A=E.invert,O=E.domain,L=x(".%L"),j=x(":%S"),F=x("%I:%M"),Z=x("%I %p"),$=x("%a %d"),V=x("%b %d"),U=x("%B"),G=x("%Y");function q(K){return(o(K)<K?L:_(K)<K?j:p(K)<K?F:h(K)<K?Z:i(K)<K?u(K)<K?$:V:r(K)<K?U:G)(K)}return E.invert=function(K){return new Date(A(K))},E.domain=function(K){return arguments.length?O(Array.from(K,yae)):O().map(gae)},E.ticks=function(K){var re=O();return e(re[0],re[re.length-1],K??10)},E.tickFormat=function(K,re){return re==null?q:x(re)},E.nice=function(K){var re=O();return(!K||typeof K.range!="function")&&(K=t(re[0],re[re.length-1],K??10)),K?O(Hj(re,K)):E},E.copy=function(){return vy(E,DP(e,t,r,i,u,h,p,_,o,x))},E}function _ae(){return ha.apply(DP(doe,poe,ll,IP,c1,xy,CP,PP,Tc,s5).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function vae(){return ha.apply(DP(hoe,foe,ul,kP,h1,u1,OP,MP,Tc,l5).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function f1(){var e=0,t=1,r,i,u,h,p=Ji,_=!1,o;function x(A){return A==null||isNaN(A=+A)?o:p(u===0?.5:(A=(h(A)-r)*u,_?Math.max(0,Math.min(1,A)):A))}x.domain=function(A){return arguments.length?([e,t]=A,r=h(e=+e),i=h(t=+t),u=r===i?0:1/(i-r),x):[e,t]},x.clamp=function(A){return arguments.length?(_=!!A,x):_},x.interpolator=function(A){return arguments.length?(p=A,x):p};function E(A){return function(O){var L,j;return arguments.length?([L,j]=O,p=A(L,j),x):[p(0),p(1)]}}return x.range=E(Id),x.rangeRound=E(_P),x.unknown=function(A){return arguments.length?(o=A,x):o},function(A){return h=A,r=A(e),i=A(t),u=r===i?0:1/(i-r),x}}function wu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function u5(){var e=bu(f1()(Ji));return e.copy=function(){return wu(e,u5())},dl.apply(e,arguments)}function c5(){var e=wP(f1()).domain([1,10]);return e.copy=function(){return wu(e,c5()).base(e.base())},dl.apply(e,arguments)}function h5(){var e=TP(f1());return e.copy=function(){return wu(e,h5()).constant(e.constant())},dl.apply(e,arguments)}function LP(){var e=SP(f1());return e.copy=function(){return wu(e,LP()).exponent(e.exponent())},dl.apply(e,arguments)}function xae(){return LP.apply(null,arguments).exponent(.5)}function f5(){var e=[],t=Ji;function r(i){if(i!=null&&!isNaN(i=+i))return t((yy(e,i,1)-1)/(e.length-1))}return r.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let u of i)u!=null&&!isNaN(u=+u)&&e.push(u);return e.sort(cu),r},r.interpolator=function(i){return arguments.length?(t=i,r):t},r.range=function(){return e.map((i,u)=>t(u/(e.length-1)))},r.quantiles=function(i){return Array.from({length:i+1},(u,h)=>aie(e,h/i))},r.copy=function(){return f5(t).domain(e)},dl.apply(r,arguments)}function d1(){var e=0,t=.5,r=1,i=1,u,h,p,_,o,x=Ji,E,A=!1,O;function L(F){return isNaN(F=+F)?O:(F=.5+((F=+E(F))-h)*(i*F<i*h?_:o),x(A?Math.max(0,Math.min(1,F)):F))}L.domain=function(F){return arguments.length?([e,t,r]=F,u=E(e=+e),h=E(t=+t),p=E(r=+r),_=u===h?0:.5/(h-u),o=h===p?0:.5/(p-h),i=h<u?-1:1,L):[e,t,r]},L.clamp=function(F){return arguments.length?(A=!!F,L):A},L.interpolator=function(F){return arguments.length?(x=F,L):x};function j(F){return function(Z){var $,V,U;return arguments.length?([$,V,U]=Z,x=kie(F,[$,V,U]),L):[x(0),x(.5),x(1)]}}return L.range=j(Id),L.rangeRound=j(_P),L.unknown=function(F){return arguments.length?(O=F,L):O},function(F){return E=F,u=F(e),h=F(t),p=F(r),_=u===h?0:.5/(h-u),o=h===p?0:.5/(p-h),i=h<u?-1:1,L}}function d5(){var e=bu(d1()(Ji));return e.copy=function(){return wu(e,d5())},dl.apply(e,arguments)}function p5(){var e=wP(d1()).domain([.1,1,10]);return e.copy=function(){return wu(e,p5()).base(e.base())},dl.apply(e,arguments)}function m5(){var e=TP(d1());return e.copy=function(){return wu(e,m5()).constant(e.constant())},dl.apply(e,arguments)}function zP(){var e=SP(d1());return e.copy=function(){return wu(e,zP()).exponent(e.exponent())},dl.apply(e,arguments)}function bae(){return zP.apply(null,arguments).exponent(.5)}const R3=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ig,scaleDiverging:d5,scaleDivergingLog:p5,scaleDivergingPow:zP,scaleDivergingSqrt:bae,scaleDivergingSymlog:m5,scaleIdentity:Zj,scaleImplicit:KS,scaleLinear:V0,scaleLog:Xj,scaleOrdinal:mP,scalePoint:tg,scalePow:EP,scaleQuantile:Jj,scaleQuantize:Qj,scaleRadial:Yj,scaleSequential:u5,scaleSequentialLog:c5,scaleSequentialPow:LP,scaleSequentialQuantile:f5,scaleSequentialSqrt:xae,scaleSequentialSymlog:h5,scaleSqrt:toe,scaleSymlog:Kj,scaleThreshold:e5,scaleTime:_ae,scaleUtc:vae,tickFormat:qj},Symbol.toStringTag,{value:"Module"}));var wae=Td;function Tae(e,t,r){for(var i=-1,u=e.length;++i<u;){var h=e[i],p=t(h);if(p!=null&&(_===void 0?p===p&&!wae(p):r(p,_)))var _=p,o=h}return o}var g5=Tae;function Sae(e,t){return e>t}var Eae=Sae,Aae=g5,Pae=Eae,Mae=Od;function Cae(e){return e&&e.length?Aae(e,Mae,Pae):void 0}var Oae=Cae;const p1=Xr(Oae);function Iae(e,t){return e<t}var kae=Iae,Dae=g5,Lae=kae,zae=Od;function Rae(e){return e&&e.length?Dae(e,zae,Lae):void 0}var Bae=Rae;const m1=Xr(Bae);var jae=XA,Fae=xu,$ae=Sj,Nae=xo;function Uae(e,t){var r=Nae(e)?jae:$ae;return r(e,Fae(t))}var Vae=Uae,Gae=wj,Wae=Vae;function qae(e,t){return Gae(Wae(e,t),1)}var Zae=qae;const Hae=Xr(Zae);var Xae=cP;function Kae(e,t){return Xae(e,t)}var Yae=Kae;const RP=Xr(Yae);var kd=1e9,Jae={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},jP,Mn=!0,ua="[DecimalError] ",Cc=ua+"Invalid argument: ",BP=ua+"Exponent out of range: ",Dd=Math.floor,gc=Math.pow,Qae=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ko,_i=1e7,bn=7,y5=9007199254740991,Z0=Dd(y5/bn),Nt={};Nt.absoluteValue=Nt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Nt.comparedTo=Nt.cmp=function(e){var t,r,i,u,h=this;if(e=new h.constructor(e),h.s!==e.s)return h.s||-e.s;if(h.e!==e.e)return h.e>e.e^h.s<0?1:-1;for(i=h.d.length,u=e.d.length,t=0,r=i<u?i:u;t<r;++t)if(h.d[t]!==e.d[t])return h.d[t]>e.d[t]^h.s<0?1:-1;return i===u?0:i>u^h.s<0?1:-1};Nt.decimalPlaces=Nt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*bn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Nt.dividedBy=Nt.div=function(e){return rl(this,new this.constructor(e))};Nt.dividedToIntegerBy=Nt.idiv=function(e){var t=this,r=t.constructor;return hn(rl(t,new r(e),0,1),r.precision)};Nt.equals=Nt.eq=function(e){return!this.cmp(e)};Nt.exponent=function(){return ti(this)};Nt.greaterThan=Nt.gt=function(e){return this.cmp(e)>0};Nt.greaterThanOrEqualTo=Nt.gte=function(e){return this.cmp(e)>=0};Nt.isInteger=Nt.isint=function(){return this.e>this.d.length-2};Nt.isNegative=Nt.isneg=function(){return this.s<0};Nt.isPositive=Nt.ispos=function(){return this.s>0};Nt.isZero=function(){return this.s===0};Nt.lessThan=Nt.lt=function(e){return this.cmp(e)<0};Nt.lessThanOrEqualTo=Nt.lte=function(e){return this.cmp(e)<1};Nt.logarithm=Nt.log=function(e){var t,r=this,i=r.constructor,u=i.precision,h=u+5;if(e===void 0)e=new i(10);else if(e=new i(e),e.s<1||e.eq(ko))throw Error(ua+"NaN");if(r.s<1)throw Error(ua+(r.s?"NaN":"-Infinity"));return r.eq(ko)?new i(0):(Mn=!1,t=rl(Rg(r,h),Rg(e,h),h),Mn=!0,hn(t,u))};Nt.minus=Nt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?x5(t,e):_5(t,(e.s=-e.s,e))};Nt.modulo=Nt.mod=function(e){var t,r=this,i=r.constructor,u=i.precision;if(e=new i(e),!e.s)throw Error(ua+"NaN");return r.s?(Mn=!1,t=rl(r,e,0,1).times(e),Mn=!0,r.minus(t)):hn(new i(r),u)};Nt.naturalExponential=Nt.exp=function(){return v5(this)};Nt.naturalLogarithm=Nt.ln=function(){return Rg(this)};Nt.negated=Nt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Nt.plus=Nt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?_5(t,e):x5(t,(e.s=-e.s,e))};Nt.precision=Nt.sd=function(e){var t,r,i,u=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Cc+e);if(t=ti(u)+1,i=u.d.length-1,r=i*bn+1,i=u.d[i],i){for(;i%10==0;i/=10)r--;for(i=u.d[0];i>=10;i/=10)r++}return e&&t>r?t:r};Nt.squareRoot=Nt.sqrt=function(){var e,t,r,i,u,h,p,_=this,o=_.constructor;if(_.s<1){if(!_.s)return new o(0);throw Error(ua+"NaN")}for(e=ti(_),Mn=!1,u=Math.sqrt(+_),u==0||u==1/0?(t=ds(_.d),(t.length+e)%2==0&&(t+="0"),u=Math.sqrt(t),e=Dd((e+1)/2)-(e<0||e%2),u==1/0?t="5e"+e:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),i=new o(t)):i=new o(u.toString()),r=o.precision,u=p=r+3;;)if(h=i,i=h.plus(rl(_,h,p+2)).times(.5),ds(h.d).slice(0,p)===(t=ds(i.d)).slice(0,p)){if(t=t.slice(p-3,p+1),u==p&&t=="4999"){if(hn(h,r+1,0),h.times(h).eq(_)){i=h;break}}else if(t!="9999")break;p+=4}return Mn=!0,hn(i,r)};Nt.times=Nt.mul=function(e){var t,r,i,u,h,p,_,o,x,E=this,A=E.constructor,O=E.d,L=(e=new A(e)).d;if(!E.s||!e.s)return new A(0);for(e.s*=E.s,r=E.e+e.e,o=O.length,x=L.length,o<x&&(h=O,O=L,L=h,p=o,o=x,x=p),h=[],p=o+x,i=p;i--;)h.push(0);for(i=x;--i>=0;){for(t=0,u=o+i;u>i;)_=h[u]+L[i]*O[u-i-1]+t,h[u--]=_%_i|0,t=_/_i|0;h[u]=(h[u]+t)%_i|0}for(;!h[--p];)h.pop();return t?++r:h.shift(),e.d=h,e.e=r,Mn?hn(e,A.precision):e};Nt.toDecimalPlaces=Nt.todp=function(e,t){var r=this,i=r.constructor;return r=new i(r),e===void 0?r:(vs(e,0,kd),t===void 0?t=i.rounding:vs(t,0,8),hn(r,e+ti(r)+1,t))};Nt.toExponential=function(e,t){var r,i=this,u=i.constructor;return e===void 0?r=jc(i,!0):(vs(e,0,kd),t===void 0?t=u.rounding:vs(t,0,8),i=hn(new u(i),e+1,t),r=jc(i,!0,e+1)),r};Nt.toFixed=function(e,t){var r,i,u=this,h=u.constructor;return e===void 0?jc(u):(vs(e,0,kd),t===void 0?t=h.rounding:vs(t,0,8),i=hn(new h(u),e+ti(u)+1,t),r=jc(i.abs(),!1,e+ti(i)+1),u.isneg()&&!u.isZero()?"-"+r:r)};Nt.toInteger=Nt.toint=function(){var e=this,t=e.constructor;return hn(new t(e),ti(e)+1,t.rounding)};Nt.toNumber=function(){return+this};Nt.toPower=Nt.pow=function(e){var t,r,i,u,h,p,_=this,o=_.constructor,x=12,E=+(e=new o(e));if(!e.s)return new o(ko);if(_=new o(_),!_.s){if(e.s<1)throw Error(ua+"Infinity");return _}if(_.eq(ko))return _;if(i=o.precision,e.eq(ko))return hn(_,i);if(t=e.e,r=e.d.length-1,p=t>=r,h=_.s,p){if((r=E<0?-E:E)<=y5){for(u=new o(ko),t=Math.ceil(i/bn+4),Mn=!1;r%2&&(u=u.times(_),j3(u.d,t)),r=Dd(r/2),r!==0;)_=_.times(_),j3(_.d,t);return Mn=!0,e.s<0?new o(ko).div(u):hn(u,i)}}else if(h<0)throw Error(ua+"NaN");return h=h<0&&e.d[Math.max(t,r)]&1?-1:1,_.s=1,Mn=!1,u=e.times(Rg(_,i+x)),Mn=!0,u=v5(u),u.s=h,u};Nt.toPrecision=function(e,t){var r,i,u=this,h=u.constructor;return e===void 0?(r=ti(u),i=jc(u,r<=h.toExpNeg||r>=h.toExpPos)):(vs(e,1,kd),t===void 0?t=h.rounding:vs(t,0,8),u=hn(new h(u),e,t),r=ti(u),i=jc(u,e<=r||r<=h.toExpNeg,e)),i};Nt.toSignificantDigits=Nt.tosd=function(e,t){var r=this,i=r.constructor;return e===void 0?(e=i.precision,t=i.rounding):(vs(e,1,kd),t===void 0?t=i.rounding:vs(t,0,8)),hn(new i(r),e,t)};Nt.toString=Nt.valueOf=Nt.val=Nt.toJSON=Nt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ti(e),r=e.constructor;return jc(e,t<=r.toExpNeg||t>=r.toExpPos)};function _5(e,t){var r,i,u,h,p,_,o,x,E=e.constructor,A=E.precision;if(!e.s||!t.s)return t.s||(t=new E(e)),Mn?hn(t,A):t;if(o=e.d,x=t.d,p=e.e,u=t.e,o=o.slice(),h=p-u,h){for(h<0?(i=o,h=-h,_=x.length):(i=x,u=p,_=o.length),p=Math.ceil(A/bn),_=p>_?p+1:_+1,h>_&&(h=_,i.length=1),i.reverse();h--;)i.push(0);i.reverse()}for(_=o.length,h=x.length,_-h<0&&(h=_,i=x,x=o,o=i),r=0;h;)r=(o[--h]=o[h]+x[h]+r)/_i|0,o[h]%=_i;for(r&&(o.unshift(r),++u),_=o.length;o[--_]==0;)o.pop();return t.d=o,t.e=u,Mn?hn(t,A):t}function vs(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Cc+e)}function ds(e){var t,r,i,u=e.length-1,h="",p=e[0];if(u>0){for(h+=p,t=1;t<u;t++)i=e[t]+"",r=bn-i.length,r&&(h+=Hl(r)),h+=i;p=e[t],i=p+"",r=bn-i.length,r&&(h+=Hl(r))}else if(p===0)return"0";for(;p%10===0;)p/=10;return h+p}var rl=function(){function e(i,u){var h,p=0,_=i.length;for(i=i.slice();_--;)h=i[_]*u+p,i[_]=h%_i|0,p=h/_i|0;return p&&i.unshift(p),i}function t(i,u,h,p){var _,o;if(h!=p)o=h>p?1:-1;else for(_=o=0;_<h;_++)if(i[_]!=u[_]){o=i[_]>u[_]?1:-1;break}return o}function r(i,u,h){for(var p=0;h--;)i[h]-=p,p=i[h]<u[h]?1:0,i[h]=p*_i+i[h]-u[h];for(;!i[0]&&i.length>1;)i.shift()}return function(i,u,h,p){var _,o,x,E,A,O,L,j,F,Z,$,V,U,G,q,K,re,pe,xe=i.constructor,ge=i.s==u.s?1:-1,Be=i.d,$e=u.d;if(!i.s)return new xe(i);if(!u.s)throw Error(ua+"Division by zero");for(o=i.e-u.e,re=$e.length,q=Be.length,L=new xe(ge),j=L.d=[],x=0;$e[x]==(Be[x]||0);)++x;if($e[x]>(Be[x]||0)&&--o,h==null?V=h=xe.precision:p?V=h+(ti(i)-ti(u))+1:V=h,V<0)return new xe(0);if(V=V/bn+2|0,x=0,re==1)for(E=0,$e=$e[0],V++;(x<q||E)&&V--;x++)U=E*_i+(Be[x]||0),j[x]=U/$e|0,E=U%$e|0;else{for(E=_i/($e[0]+1)|0,E>1&&($e=e($e,E),Be=e(Be,E),re=$e.length,q=Be.length),G=re,F=Be.slice(0,re),Z=F.length;Z<re;)F[Z++]=0;pe=$e.slice(),pe.unshift(0),K=$e[0],$e[1]>=_i/2&&++K;do E=0,_=t($e,F,re,Z),_<0?($=F[0],re!=Z&&($=$*_i+(F[1]||0)),E=$/K|0,E>1?(E>=_i&&(E=_i-1),A=e($e,E),O=A.length,Z=F.length,_=t(A,F,O,Z),_==1&&(E--,r(A,re<O?pe:$e,O))):(E==0&&(_=E=1),A=$e.slice()),O=A.length,O<Z&&A.unshift(0),r(F,A,Z),_==-1&&(Z=F.length,_=t($e,F,re,Z),_<1&&(E++,r(F,re<Z?pe:$e,Z))),Z=F.length):_===0&&(E++,F=[0]),j[x++]=E,_&&F[0]?F[Z++]=Be[G]||0:(F=[Be[G]],Z=1);while((G++<q||F[0]!==void 0)&&V--)}return j[0]||j.shift(),L.e=o,hn(L,p?h+ti(L)+1:h)}}();function v5(e,t){var r,i,u,h,p,_,o=0,x=0,E=e.constructor,A=E.precision;if(ti(e)>16)throw Error(BP+ti(e));if(!e.s)return new E(ko);for(Mn=!1,_=A,p=new E(.03125);e.abs().gte(.1);)e=e.times(p),x+=5;for(i=Math.log(gc(2,x))/Math.LN10*2+5|0,_+=i,r=u=h=new E(ko),E.precision=_;;){if(u=hn(u.times(e),_),r=r.times(++o),p=h.plus(rl(u,r,_)),ds(p.d).slice(0,_)===ds(h.d).slice(0,_)){for(;x--;)h=hn(h.times(h),_);return E.precision=A,t==null?(Mn=!0,hn(h,A)):h}h=p}}function ti(e){for(var t=e.e*bn,r=e.d[0];r>=10;r/=10)t++;return t}function iT(e,t,r){if(t>e.LN10.sd())throw Mn=!0,r&&(e.precision=r),Error(ua+"LN10 precision limit exceeded");return hn(new e(e.LN10),t)}function Hl(e){for(var t="";e--;)t+="0";return t}function Rg(e,t){var r,i,u,h,p,_,o,x,E,A=1,O=10,L=e,j=L.d,F=L.constructor,Z=F.precision;if(L.s<1)throw Error(ua+(L.s?"NaN":"-Infinity"));if(L.eq(ko))return new F(0);if(t==null?(Mn=!1,x=Z):x=t,L.eq(10))return t==null&&(Mn=!0),iT(F,x);if(x+=O,F.precision=x,r=ds(j),i=r.charAt(0),h=ti(L),Math.abs(h)<15e14){for(;i<7&&i!=1||i==1&&r.charAt(1)>3;)L=L.times(e),r=ds(L.d),i=r.charAt(0),A++;h=ti(L),i>1?(L=new F("0."+r),h++):L=new F(i+"."+r.slice(1))}else return o=iT(F,x+2,Z).times(h+""),L=Rg(new F(i+"."+r.slice(1)),x-O).plus(o),F.precision=Z,t==null?(Mn=!0,hn(L,Z)):L;for(_=p=L=rl(L.minus(ko),L.plus(ko),x),E=hn(L.times(L),x),u=3;;){if(p=hn(p.times(E),x),o=_.plus(rl(p,new F(u),x)),ds(o.d).slice(0,x)===ds(_.d).slice(0,x))return _=_.times(2),h!==0&&(_=_.plus(iT(F,x+2,Z).times(h+""))),_=rl(_,new F(A),x),F.precision=Z,t==null?(Mn=!0,hn(_,Z)):_;_=o,u+=2}}function B3(e,t){var r,i,u;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(r<0&&(r=i),r+=+t.slice(i+1),t=t.substring(0,i)):r<0&&(r=t.length),i=0;t.charCodeAt(i)===48;)++i;for(u=t.length;t.charCodeAt(u-1)===48;)--u;if(t=t.slice(i,u),t){if(u-=i,r=r-i-1,e.e=Dd(r/bn),e.d=[],i=(r+1)%bn,r<0&&(i+=bn),i<u){for(i&&e.d.push(+t.slice(0,i)),u-=bn;i<u;)e.d.push(+t.slice(i,i+=bn));t=t.slice(i),i=bn-t.length}else i-=u;for(;i--;)t+="0";if(e.d.push(+t),Mn&&(e.e>Z0||e.e<-Z0))throw Error(BP+r)}else e.s=0,e.e=0,e.d=[0];return e}function hn(e,t,r){var i,u,h,p,_,o,x,E,A=e.d;for(p=1,h=A[0];h>=10;h/=10)p++;if(i=t-p,i<0)i+=bn,u=t,x=A[E=0];else{if(E=Math.ceil((i+1)/bn),h=A.length,E>=h)return e;for(x=h=A[E],p=1;h>=10;h/=10)p++;i%=bn,u=i-bn+p}if(r!==void 0&&(h=gc(10,p-u-1),_=x/h%10|0,o=t<0||A[E+1]!==void 0||x%h,o=r<4?(_||o)&&(r==0||r==(e.s<0?3:2)):_>5||_==5&&(r==4||o||r==6&&(i>0?u>0?x/gc(10,p-u):0:A[E-1])%10&1||r==(e.s<0?8:7))),t<1||!A[0])return o?(h=ti(e),A.length=1,t=t-h-1,A[0]=gc(10,(bn-t%bn)%bn),e.e=Dd(-t/bn)||0):(A.length=1,A[0]=e.e=e.s=0),e;if(i==0?(A.length=E,h=1,E--):(A.length=E+1,h=gc(10,bn-i),A[E]=u>0?(x/gc(10,p-u)%gc(10,u)|0)*h:0),o)for(;;)if(E==0){(A[0]+=h)==_i&&(A[0]=1,++e.e);break}else{if(A[E]+=h,A[E]!=_i)break;A[E--]=0,h=1}for(i=A.length;A[--i]===0;)A.pop();if(Mn&&(e.e>Z0||e.e<-Z0))throw Error(BP+ti(e));return e}function x5(e,t){var r,i,u,h,p,_,o,x,E,A,O=e.constructor,L=O.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new O(e),Mn?hn(t,L):t;if(o=e.d,A=t.d,i=t.e,x=e.e,o=o.slice(),p=x-i,p){for(E=p<0,E?(r=o,p=-p,_=A.length):(r=A,i=x,_=o.length),u=Math.max(Math.ceil(L/bn),_)+2,p>u&&(p=u,r.length=1),r.reverse(),u=p;u--;)r.push(0);r.reverse()}else{for(u=o.length,_=A.length,E=u<_,E&&(_=u),u=0;u<_;u++)if(o[u]!=A[u]){E=o[u]<A[u];break}p=0}for(E&&(r=o,o=A,A=r,t.s=-t.s),_=o.length,u=A.length-_;u>0;--u)o[_++]=0;for(u=A.length;u>p;){if(o[--u]<A[u]){for(h=u;h&&o[--h]===0;)o[h]=_i-1;--o[h],o[u]+=_i}o[u]-=A[u]}for(;o[--_]===0;)o.pop();for(;o[0]===0;o.shift())--i;return o[0]?(t.d=o,t.e=i,Mn?hn(t,L):t):new O(0)}function jc(e,t,r){var i,u=ti(e),h=ds(e.d),p=h.length;return t?(r&&(i=r-p)>0?h=h.charAt(0)+"."+h.slice(1)+Hl(i):p>1&&(h=h.charAt(0)+"."+h.slice(1)),h=h+(u<0?"e":"e+")+u):u<0?(h="0."+Hl(-u-1)+h,r&&(i=r-p)>0&&(h+=Hl(i))):u>=p?(h+=Hl(u+1-p),r&&(i=r-u-1)>0&&(h=h+"."+Hl(i))):((i=u+1)<p&&(h=h.slice(0,i)+"."+h.slice(i)),r&&(i=r-p)>0&&(u+1===p&&(h+="."),h+=Hl(i))),e.s<0?"-"+h:h}function j3(e,t){if(e.length>t)return e.length=t,!0}function b5(e){var t,r,i;function u(h){var p=this;if(!(p instanceof u))return new u(h);if(p.constructor=u,h instanceof u){p.s=h.s,p.e=h.e,p.d=(h=h.d)?h.slice():h;return}if(typeof h=="number"){if(h*0!==0)throw Error(Cc+h);if(h>0)p.s=1;else if(h<0)h=-h,p.s=-1;else{p.s=0,p.e=0,p.d=[0];return}if(h===~~h&&h<1e7){p.e=0,p.d=[h];return}return B3(p,h.toString())}else if(typeof h!="string")throw Error(Cc+h);if(h.charCodeAt(0)===45?(h=h.slice(1),p.s=-1):p.s=1,Qae.test(h))B3(p,h);else throw Error(Cc+h)}if(u.prototype=Nt,u.ROUND_UP=0,u.ROUND_DOWN=1,u.ROUND_CEIL=2,u.ROUND_FLOOR=3,u.ROUND_HALF_UP=4,u.ROUND_HALF_DOWN=5,u.ROUND_HALF_EVEN=6,u.ROUND_HALF_CEIL=7,u.ROUND_HALF_FLOOR=8,u.clone=b5,u.config=u.set=ese,e===void 0&&(e={}),e)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<i.length;)e.hasOwnProperty(r=i[t++])||(e[r]=this[r]);return u.config(e),u}function ese(e){if(!e||typeof e!="object")throw Error(ua+"Object expected");var t,r,i,u=["precision",1,kd,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<u.length;t+=3)if((i=e[r=u[t]])!==void 0)if(Dd(i)===i&&i>=u[t+1]&&i<=u[t+2])this[r]=i;else throw Error(Cc+r+": "+i);if((i=e[r="LN10"])!==void 0)if(i==Math.LN10)this[r]=new this(i);else throw Error(Cc+r+": "+i);return this}var jP=b5(Jae);ko=new jP(1);const ln=jP;function tse(e){return ose(e)||ise(e)||nse(e)||rse()}function rse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nse(e,t){if(e){if(typeof e=="string")return eE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eE(e,t)}}function ise(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function ose(e){if(Array.isArray(e))return eE(e)}function eE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var ase=function(t){return t},w5={},T5=function(t){return t===w5},F3=function(t){return function r(){return arguments.length===0||arguments.length===1&&T5(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},sse=function e(t,r){return t===1?r:F3(function(){for(var i=arguments.length,u=new Array(i),h=0;h<i;h++)u[h]=arguments[h];var p=u.filter(function(_){return _!==w5}).length;return p>=t?r.apply(void 0,u):e(t-p,F3(function(){for(var _=arguments.length,o=new Array(_),x=0;x<_;x++)o[x]=arguments[x];var E=u.map(function(A){return T5(A)?o.shift():A});return r.apply(void 0,tse(E).concat(o))}))})},g1=function(t){return sse(t.length,t)},tE=function(t,r){for(var i=[],u=t;u<r;++u)i[u-t]=u;return i},lse=g1(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),use=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];if(!r.length)return ase;var u=r.reverse(),h=u[0],p=u.slice(1);return function(){return p.reduce(function(_,o){return o(_)},h.apply(void 0,arguments))}},rE=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},S5=function(t){var r=null,i=null;return function(){for(var u=arguments.length,h=new Array(u),p=0;p<u;p++)h[p]=arguments[p];return r&&h.every(function(_,o){return _===r[o]})||(r=h,i=t.apply(void 0,h)),i}};function cse(e){var t;return e===0?t=1:t=Math.floor(new ln(e).abs().log(10).toNumber())+1,t}function hse(e,t,r){for(var i=new ln(e),u=0,h=[];i.lt(t)&&u<1e5;)h.push(i.toNumber()),i=i.add(r),u++;return h}var fse=g1(function(e,t,r){var i=+e,u=+t;return i+r*(u-i)}),dse=g1(function(e,t,r){var i=t-+e;return i=i||1/0,(r-e)/i}),pse=g1(function(e,t,r){var i=t-+e;return i=i||1/0,Math.max(0,Math.min(1,(r-e)/i))});const y1={rangeStep:hse,getDigitCount:cse,interpolateNumber:fse,uninterpolateNumber:dse,uninterpolateTruncation:pse};function nE(e){return yse(e)||gse(e)||E5(e)||mse()}function mse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gse(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function yse(e){if(Array.isArray(e))return iE(e)}function Bg(e,t){return xse(e)||vse(e,t)||E5(e,t)||_se()}function _se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E5(e,t){if(e){if(typeof e=="string")return iE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iE(e,t)}}function iE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function vse(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],i=!0,u=!1,h=void 0;try{for(var p=e[Symbol.iterator](),_;!(i=(_=p.next()).done)&&(r.push(_.value),!(t&&r.length===t));i=!0);}catch(o){u=!0,h=o}finally{try{!i&&p.return!=null&&p.return()}finally{if(u)throw h}}return r}}function xse(e){if(Array.isArray(e))return e}function A5(e){var t=Bg(e,2),r=t[0],i=t[1],u=r,h=i;return r>i&&(u=i,h=r),[u,h]}function P5(e,t,r){if(e.lte(0))return new ln(0);var i=y1.getDigitCount(e.toNumber()),u=new ln(10).pow(i),h=e.div(u),p=i!==1?.05:.1,_=new ln(Math.ceil(h.div(p).toNumber())).add(r).mul(p),o=_.mul(u);return t?o:new ln(Math.ceil(o))}function bse(e,t,r){var i=1,u=new ln(e);if(!u.isint()&&r){var h=Math.abs(e);h<1?(i=new ln(10).pow(y1.getDigitCount(e)-1),u=new ln(Math.floor(u.div(i).toNumber())).mul(i)):h>1&&(u=new ln(Math.floor(e)))}else e===0?u=new ln(Math.floor((t-1)/2)):r||(u=new ln(Math.floor(e)));var p=Math.floor((t-1)/2),_=use(lse(function(o){return u.add(new ln(o-p).mul(i)).toNumber()}),tE);return _(0,t)}function M5(e,t,r,i){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new ln(0),tickMin:new ln(0),tickMax:new ln(0)};var h=P5(new ln(t).sub(e).div(r-1),i,u),p;e<=0&&t>=0?p=new ln(0):(p=new ln(e).add(t).div(2),p=p.sub(new ln(p).mod(h)));var _=Math.ceil(p.sub(e).div(h).toNumber()),o=Math.ceil(new ln(t).sub(p).div(h).toNumber()),x=_+o+1;return x>r?M5(e,t,r,i,u+1):(x<r&&(o=t>0?o+(r-x):o,_=t>0?_:_+(r-x)),{step:h,tickMin:p.sub(new ln(_).mul(h)),tickMax:p.add(new ln(o).mul(h))})}function wse(e){var t=Bg(e,2),r=t[0],i=t[1],u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,p=Math.max(u,2),_=A5([r,i]),o=Bg(_,2),x=o[0],E=o[1];if(x===-1/0||E===1/0){var A=E===1/0?[x].concat(nE(tE(0,u-1).map(function(){return 1/0}))):[].concat(nE(tE(0,u-1).map(function(){return-1/0})),[E]);return r>i?rE(A):A}if(x===E)return bse(x,u,h);var O=M5(x,E,p,h),L=O.step,j=O.tickMin,F=O.tickMax,Z=y1.rangeStep(j,F.add(new ln(.1).mul(L)),L);return r>i?rE(Z):Z}function Tse(e,t){var r=Bg(e,2),i=r[0],u=r[1],h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,p=A5([i,u]),_=Bg(p,2),o=_[0],x=_[1];if(o===-1/0||x===1/0)return[i,u];if(o===x)return[o];var E=Math.max(t,2),A=P5(new ln(x).sub(o).div(E-1),h,0),O=[].concat(nE(y1.rangeStep(new ln(o),new ln(x).sub(new ln(.99).mul(A)),A)),[x]);return i>u?rE(O):O}var Sse=S5(wse),Ese=S5(Tse),Ase="Invariant failed";function Fc(e,t){throw new Error(Ase)}var Pse=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function H0(){return H0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},H0.apply(this,arguments)}function Mse(e,t){return kse(e)||Ise(e,t)||Ose(e,t)||Cse()}function Cse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ose(e,t){if(e){if(typeof e=="string")return $3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $3(e,t)}}function $3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function Ise(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t!==0)for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function kse(e){if(Array.isArray(e))return e}function Dse(e,t){if(e==null)return{};var r=Lse(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function Lse(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function zse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rse(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,I5(i.key),i)}}function Bse(e,t,r){return t&&Rse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jse(e,t,r){return t=X0(t),Fse(e,C5()?Reflect.construct(t,r||[],X0(e).constructor):t.apply(e,r))}function Fse(e,t){if(t&&(id(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $se(e)}function $se(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C5(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(C5=function(){return!!e})()}function X0(e){return X0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},X0(e)}function Nse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oE(e,t)}function oE(e,t){return oE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},oE(e,t)}function O5(e,t,r){return t=I5(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I5(e){var t=Use(e,"string");return id(t)=="symbol"?t:t+""}function Use(e,t){if(id(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(id(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var _1=function(e){function t(){return zse(this,t),jse(this,t,arguments)}return Nse(t,e),Bse(t,[{key:"render",value:function(){var i=this.props,u=i.offset,h=i.layout,p=i.width,_=i.dataKey,o=i.data,x=i.dataPointFormatter,E=i.xAxis,A=i.yAxis,O=Dse(i,Pse),L=Hr(O,!1);this.props.direction==="x"&&E.type!=="number"&&Fc();var j=o.map(function(F){var Z=x(F,_),$=Z.x,V=Z.y,U=Z.value,G=Z.errorVal;if(!G)return null;var q=[],K,re;if(Array.isArray(G)){var pe=Mse(G,2);K=pe[0],re=pe[1]}else K=re=G;if(h==="vertical"){var xe=E.scale,ge=V+u,Be=ge+p,$e=ge-p,Ve=xe(U-K),be=xe(U+re);q.push({x1:be,y1:Be,x2:be,y2:$e}),q.push({x1:Ve,y1:ge,x2:be,y2:ge}),q.push({x1:Ve,y1:Be,x2:Ve,y2:$e})}else if(h==="horizontal"){var _e=A.scale,Me=$+u,ke=Me-p,Ce=Me+p,Oe=_e(U-K),at=_e(U+re);q.push({x1:ke,y1:at,x2:Ce,y2:at}),q.push({x1:Me,y1:Oe,x2:Me,y2:at}),q.push({x1:ke,y1:Oe,x2:Ce,y2:Oe})}return Fe.createElement(xi,H0({className:"recharts-errorBar",key:"bar-".concat(q.map(function(ft){return"".concat(ft.x1,"-").concat(ft.x2,"-").concat(ft.y1,"-").concat(ft.y2)}))},L),q.map(function(ft){return Fe.createElement("line",H0({},ft,{key:"line-".concat(ft.x1,"-").concat(ft.x2,"-").concat(ft.y1,"-").concat(ft.y2)}))}))});return Fe.createElement(xi,{className:"recharts-errorBars"},j)}}])}(Fe.Component);O5(_1,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});O5(_1,"displayName","ErrorBar");function jg(e){"@babel/helpers - typeof";return jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jg(e)}function N3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function hc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N3(Object(r),!0).forEach(function(i){Vse(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Vse(e,t,r){return t=Gse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gse(e){var t=Wse(e,"string");return jg(t)=="symbol"?t:t+""}function Wse(e,t){if(jg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(jg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k5=function(t){var r=t.children,i=t.formattedGraphicalItems,u=t.legendWidth,h=t.legendContent,p=Co(r,zf);if(!p)return null;var _=zf.defaultProps,o=_!==void 0?hc(hc({},_),p.props):{},x;return p.props&&p.props.payload?x=p.props&&p.props.payload:h==="children"?x=(i||[]).reduce(function(E,A){var O=A.item,L=A.props,j=L.sectors||L.data||[];return E.concat(j.map(function(F){return{type:p.props.iconType||O.props.legendType,value:F.name,color:F.fill,payload:F}}))},[]):x=(i||[]).map(function(E){var A=E.item,O=A.type.defaultProps,L=O!==void 0?hc(hc({},O),A.props):{},j=L.dataKey,F=L.name,Z=L.legendType,$=L.hide;return{inactive:$,dataKey:j,type:o.iconType||Z||"square",color:FP(A),value:F||j,payload:L}}),hc(hc(hc({},o),zf.getWithHeight(p,u)),{},{payload:x,item:p})};function Fg(e){"@babel/helpers - typeof";return Fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fg(e)}function U3(e){return Xse(e)||Hse(e)||Zse(e)||qse()}function qse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zse(e,t){if(e){if(typeof e=="string")return aE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aE(e,t)}}function Hse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xse(e){if(Array.isArray(e))return aE(e)}function aE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function V3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Vn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V3(Object(r),!0).forEach(function(i){Bf(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Bf(e,t,r){return t=Kse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kse(e){var t=Yse(e,"string");return Fg(t)=="symbol"?t:t+""}function Yse(e,t){if(Fg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Fg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xs(e,t,r){return Qr(e)||Qr(t)?r:ci(t)?aa(e,t,r):xr(t)?t(e):r}function rg(e,t,r,i){var u=Hae(e,function(_){return xs(_,t)});if(r==="number"){var h=u.filter(function(_){return zt(_)||parseFloat(_)});return h.length?[m1(h),p1(h)]:[1/0,-1/0]}var p=i?u.filter(function(_){return!Qr(_)}):u;return p.map(function(_){return ci(_)||_ instanceof Date?_:""})}var Jse=function(t){var r,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],u=arguments.length>2?arguments[2]:void 0,h=arguments.length>3?arguments[3]:void 0,p=-1,_=(r=i==null?void 0:i.length)!==null&&r!==void 0?r:0;if(_<=1)return 0;if(h&&h.axisType==="angleAxis"&&Math.abs(Math.abs(h.range[1]-h.range[0])-360)<=1e-6)for(var o=h.range,x=0;x<_;x++){var E=x>0?u[x-1].coordinate:u[_-1].coordinate,A=u[x].coordinate,O=x>=_-1?u[0].coordinate:u[x+1].coordinate,L=void 0;if(Wa(A-E)!==Wa(O-A)){var j=[];if(Wa(O-A)===Wa(o[1]-o[0])){L=O;var F=A+o[1]-o[0];j[0]=Math.min(F,(F+E)/2),j[1]=Math.max(F,(F+E)/2)}else{L=E;var Z=O+o[1]-o[0];j[0]=Math.min(A,(Z+A)/2),j[1]=Math.max(A,(Z+A)/2)}var $=[Math.min(A,(L+A)/2),Math.max(A,(L+A)/2)];if(t>$[0]&&t<=$[1]||t>=j[0]&&t<=j[1]){p=u[x].index;break}}else{var V=Math.min(E,O),U=Math.max(E,O);if(t>(V+A)/2&&t<=(U+A)/2){p=u[x].index;break}}}else for(var G=0;G<_;G++)if(G===0&&t<=(i[G].coordinate+i[G+1].coordinate)/2||G>0&&G<_-1&&t>(i[G].coordinate+i[G-1].coordinate)/2&&t<=(i[G].coordinate+i[G+1].coordinate)/2||G===_-1&&t>(i[G].coordinate+i[G-1].coordinate)/2){p=i[G].index;break}return p},FP=function(t){var r,i=t,u=i.type.displayName,h=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Vn(Vn({},t.type.defaultProps),t.props):t.props,p=h.stroke,_=h.fill,o;switch(u){case"Line":o=p;break;case"Area":case"Radar":o=p&&p!=="none"?p:_;break;default:o=_;break}return o},Qse=function(t){var r=t.barSize,i=t.totalSize,u=t.stackGroups,h=u===void 0?{}:u;if(!h)return{};for(var p={},_=Object.keys(h),o=0,x=_.length;o<x;o++)for(var E=h[_[o]].stackGroups,A=Object.keys(E),O=0,L=A.length;O<L;O++){var j=E[A[O]],F=j.items,Z=j.cateAxisId,$=F.filter(function(re){return el(re.type).indexOf("Bar")>=0});if($&&$.length){var V=$[0].type.defaultProps,U=V!==void 0?Vn(Vn({},V),$[0].props):$[0].props,G=U.barSize,q=U[Z];p[q]||(p[q]=[]);var K=Qr(G)?r:G;p[q].push({item:$[0],stackList:$.slice(1),barSize:Qr(K)?void 0:Bc(K,i,0)})}}return p},ele=function(t){var r=t.barGap,i=t.barCategoryGap,u=t.bandSize,h=t.sizeList,p=h===void 0?[]:h,_=t.maxBarSize,o=p.length;if(o<1)return null;var x=Bc(r,u,0,!0),E,A=[];if(p[0].barSize===+p[0].barSize){var O=!1,L=u/o,j=p.reduce(function(G,q){return G+q.barSize||0},0);j+=(o-1)*x,j>=u&&(j-=(o-1)*x,x=0),j>=u&&L>0&&(O=!0,L*=.9,j=o*L);var F=(u-j)/2>>0,Z={offset:F-x,size:0};E=p.reduce(function(G,q){var K={item:q.item,position:{offset:Z.offset+Z.size+x,size:O?L:q.barSize}},re=[].concat(U3(G),[K]);return Z=re[re.length-1].position,q.stackList&&q.stackList.length&&q.stackList.forEach(function(pe){re.push({item:pe,position:Z})}),re},A)}else{var $=Bc(i,u,0,!0);u-2*$-(o-1)*x<=0&&(x=0);var V=(u-2*$-(o-1)*x)/o;V>1&&(V>>=0);var U=_===+_?Math.min(V,_):V;E=p.reduce(function(G,q,K){var re=[].concat(U3(G),[{item:q.item,position:{offset:$+(V+x)*K+(V-U)/2,size:U}}]);return q.stackList&&q.stackList.length&&q.stackList.forEach(function(pe){re.push({item:pe,position:re[re.length-1].position})}),re},A)}return E},tle=function(t,r,i,u){var h=i.children,p=i.width,_=i.margin,o=p-(_.left||0)-(_.right||0),x=k5({children:h,legendWidth:o});if(x){var E=u||{},A=E.width,O=E.height,L=x.align,j=x.verticalAlign,F=x.layout;if((F==="vertical"||F==="horizontal"&&j==="middle")&&L!=="center"&&zt(t[L]))return Vn(Vn({},t),{},Bf({},L,t[L]+(A||0)));if((F==="horizontal"||F==="vertical"&&L==="center")&&j!=="middle"&&zt(t[j]))return Vn(Vn({},t),{},Bf({},j,t[j]+(O||0)))}return t},rle=function(t,r,i){return Qr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||i==="x"?r==="xAxis":i==="y"?r==="yAxis":!0},D5=function(t,r,i,u,h){var p=r.props.children,_=Ha(p,_1).filter(function(x){return rle(u,h,x.props.direction)});if(_&&_.length){var o=_.map(function(x){return x.props.dataKey});return t.reduce(function(x,E){var A=xs(E,i);if(Qr(A))return x;var O=Array.isArray(A)?[m1(A),p1(A)]:[A,A],L=o.reduce(function(j,F){var Z=xs(E,F,0),$=O[0]-Math.abs(Array.isArray(Z)?Z[0]:Z),V=O[1]+Math.abs(Array.isArray(Z)?Z[1]:Z);return[Math.min($,j[0]),Math.max(V,j[1])]},[1/0,-1/0]);return[Math.min(L[0],x[0]),Math.max(L[1],x[1])]},[1/0,-1/0])}return null},nle=function(t,r,i,u,h){var p=r.map(function(_){return D5(t,_,i,h,u)}).filter(function(_){return!Qr(_)});return p&&p.length?p.reduce(function(_,o){return[Math.min(_[0],o[0]),Math.max(_[1],o[1])]},[1/0,-1/0]):null},L5=function(t,r,i,u,h){var p=r.map(function(o){var x=o.props.dataKey;return i==="number"&&x&&D5(t,o,x,u)||rg(t,x,i,h)});if(i==="number")return p.reduce(function(o,x){return[Math.min(o[0],x[0]),Math.max(o[1],x[1])]},[1/0,-1/0]);var _={};return p.reduce(function(o,x){for(var E=0,A=x.length;E<A;E++)_[x[E]]||(_[x[E]]=!0,o.push(x[E]));return o},[])},z5=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},R5=function(t,r,i,u){if(u)return t.map(function(o){return o.coordinate});var h,p,_=t.map(function(o){return o.coordinate===r&&(h=!0),o.coordinate===i&&(p=!0),o.coordinate});return h||_.push(r),p||_.push(i),_},Ys=function(t,r,i){if(!t)return null;var u=t.scale,h=t.duplicateDomain,p=t.type,_=t.range,o=t.realScaleType==="scaleBand"?u.bandwidth()/2:2,x=(r||i)&&p==="category"&&u.bandwidth?u.bandwidth()/o:0;if(x=t.axisType==="angleAxis"&&(_==null?void 0:_.length)>=2?Wa(_[0]-_[1])*2*x:x,r&&(t.ticks||t.niceTicks)){var E=(t.ticks||t.niceTicks).map(function(A){var O=h?h.indexOf(A):A;return{coordinate:u(O)+x,value:A,offset:x}});return E.filter(function(A){return!py(A.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(A,O){return{coordinate:u(A)+x,value:A,index:O,offset:x}}):u.ticks&&!i?u.ticks(t.tickCount).map(function(A){return{coordinate:u(A)+x,value:A,offset:x}}):u.domain().map(function(A,O){return{coordinate:u(A)+x,value:h?h[A]:A,index:O,offset:x}})},oT=new WeakMap,wv=function(t,r){if(typeof r!="function")return t;oT.has(t)||oT.set(t,new WeakMap);var i=oT.get(t);if(i.has(r))return i.get(r);var u=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return i.set(r,u),u},ile=function(t,r,i){var u=t.scale,h=t.type,p=t.layout,_=t.axisType;if(u==="auto")return p==="radial"&&_==="radiusAxis"?{scale:Ig(),realScaleType:"band"}:p==="radial"&&_==="angleAxis"?{scale:V0(),realScaleType:"linear"}:h==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!i)?{scale:tg(),realScaleType:"point"}:h==="category"?{scale:Ig(),realScaleType:"band"}:{scale:V0(),realScaleType:"linear"};if(dy(u)){var o="scale".concat(t1(u));return{scale:(R3[o]||tg)(),realScaleType:R3[o]?o:"point"}}return xr(u)?{scale:u}:{scale:tg(),realScaleType:"point"}},G3=1e-4,ole=function(t){var r=t.domain();if(!(!r||r.length<=2)){var i=r.length,u=t.range(),h=Math.min(u[0],u[1])-G3,p=Math.max(u[0],u[1])+G3,_=t(r[0]),o=t(r[i-1]);(_<h||_>p||o<h||o>p)&&t.domain([r[0],r[i-1]])}},ale=function(t,r){if(!t)return null;for(var i=0,u=t.length;i<u;i++)if(t[i].item===r)return t[i].position;return null},sle=function(t,r){if(!r||r.length!==2||!zt(r[0])||!zt(r[1]))return t;var i=Math.min(r[0],r[1]),u=Math.max(r[0],r[1]),h=[t[0],t[1]];return(!zt(t[0])||t[0]<i)&&(h[0]=i),(!zt(t[1])||t[1]>u)&&(h[1]=u),h[0]>u&&(h[0]=u),h[1]<i&&(h[1]=i),h},lle=function(t){var r=t.length;if(!(r<=0))for(var i=0,u=t[0].length;i<u;++i)for(var h=0,p=0,_=0;_<r;++_){var o=py(t[_][i][1])?t[_][i][0]:t[_][i][1];o>=0?(t[_][i][0]=h,t[_][i][1]=h+o,h=t[_][i][1]):(t[_][i][0]=p,t[_][i][1]=p+o,p=t[_][i][1])}},ule=function(t){var r=t.length;if(!(r<=0))for(var i=0,u=t[0].length;i<u;++i)for(var h=0,p=0;p<r;++p){var _=py(t[p][i][1])?t[p][i][0]:t[p][i][1];_>=0?(t[p][i][0]=h,t[p][i][1]=h+_,h=t[p][i][1]):(t[p][i][0]=0,t[p][i][1]=0)}},cle={sign:lle,expand:EX,none:Kf,silhouette:AX,wiggle:PX,positive:ule},hle=function(t,r,i){var u=r.map(function(_){return _.props.dataKey}),h=cle[i],p=SX().keys(u).value(function(_,o){return+xs(_,o,0)}).order(IS).offset(h);return p(t)},fle=function(t,r,i,u,h,p){if(!t)return null;var _=p?r.reverse():r,o={},x=_.reduce(function(A,O){var L,j=(L=O.type)!==null&&L!==void 0&&L.defaultProps?Vn(Vn({},O.type.defaultProps),O.props):O.props,F=j.stackId,Z=j.hide;if(Z)return A;var $=j[i],V=A[$]||{hasStack:!1,stackGroups:{}};if(ci(F)){var U=V.stackGroups[F]||{numericAxisId:i,cateAxisId:u,items:[]};U.items.push(O),V.hasStack=!0,V.stackGroups[F]=U}else V.stackGroups[e1("_stackId_")]={numericAxisId:i,cateAxisId:u,items:[O]};return Vn(Vn({},A),{},Bf({},$,V))},o),E={};return Object.keys(x).reduce(function(A,O){var L=x[O];if(L.hasStack){var j={};L.stackGroups=Object.keys(L.stackGroups).reduce(function(F,Z){var $=L.stackGroups[Z];return Vn(Vn({},F),{},Bf({},Z,{numericAxisId:i,cateAxisId:u,items:$.items,stackedData:hle(t,$.items,h)}))},j)}return Vn(Vn({},A),{},Bf({},O,L))},E)},dle=function(t,r){var i=r.realScaleType,u=r.type,h=r.tickCount,p=r.originalDomain,_=r.allowDecimals,o=i||r.scale;if(o!=="auto"&&o!=="linear")return null;if(h&&u==="number"&&p&&(p[0]==="auto"||p[1]==="auto")){var x=t.domain();if(!x.length)return null;var E=Sse(x,h,_);return t.domain([m1(E),p1(E)]),{niceTicks:E}}if(h&&u==="number"){var A=t.domain(),O=Ese(A,h,_);return{niceTicks:O}}return null},W3=function(t){var r=t.axis,i=t.ticks,u=t.offset,h=t.bandSize,p=t.entry,_=t.index;if(r.type==="category")return i[_]?i[_].coordinate+u:null;var o=xs(p,r.dataKey,r.domain[_]);return Qr(o)?null:r.scale(o)-h/2+u},ple=function(t){var r=t.numericAxis,i=r.scale.domain();if(r.type==="number"){var u=Math.min(i[0],i[1]),h=Math.max(i[0],i[1]);return u<=0&&h>=0?0:h<0?h:u}return i[0]},mle=function(t,r){var i,u=(i=t.type)!==null&&i!==void 0&&i.defaultProps?Vn(Vn({},t.type.defaultProps),t.props):t.props,h=u.stackId;if(ci(h)){var p=r[h];if(p){var _=p.items.indexOf(t);return _>=0?p.stackedData[_]:null}}return null},gle=function(t){return t.reduce(function(r,i){return[m1(i.concat([r[0]]).filter(zt)),p1(i.concat([r[1]]).filter(zt))]},[1/0,-1/0])},B5=function(t,r,i){return Object.keys(t).reduce(function(u,h){var p=t[h],_=p.stackedData,o=_.reduce(function(x,E){var A=gle(E.slice(r,i+1));return[Math.min(x[0],A[0]),Math.max(x[1],A[1])]},[1/0,-1/0]);return[Math.min(o[0],u[0]),Math.max(o[1],u[1])]},[1/0,-1/0]).map(function(u){return u===1/0||u===-1/0?0:u})},q3=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Z3=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,sE=function(t,r,i){if(xr(t))return t(r,i);if(!Array.isArray(t))return r;var u=[];if(zt(t[0]))u[0]=i?t[0]:Math.min(t[0],r[0]);else if(q3.test(t[0])){var h=+q3.exec(t[0])[1];u[0]=r[0]-h}else xr(t[0])?u[0]=t[0](r[0]):u[0]=r[0];if(zt(t[1]))u[1]=i?t[1]:Math.max(t[1],r[1]);else if(Z3.test(t[1])){var p=+Z3.exec(t[1])[1];u[1]=r[1]+p}else xr(t[1])?u[1]=t[1](r[1]):u[1]=r[1];return u},K0=function(t,r,i){if(t&&t.scale&&t.scale.bandwidth){var u=t.scale.bandwidth();if(!i||u>0)return u}if(t&&r&&r.length>=2){for(var h=fP(r,function(A){return A.coordinate}),p=1/0,_=1,o=h.length;_<o;_++){var x=h[_],E=h[_-1];p=Math.min((x.coordinate||0)-(E.coordinate||0),p)}return p===1/0?0:p}return i?void 0:0},H3=function(t,r,i){return!t||!t.length||RP(t,aa(i,"type.defaultProps.domain"))?r:t},j5=function(t,r){var i=t.type.defaultProps?Vn(Vn({},t.type.defaultProps),t.props):t.props,u=i.dataKey,h=i.name,p=i.unit,_=i.formatter,o=i.tooltipType,x=i.chartType,E=i.hide;return Vn(Vn({},Hr(t,!1)),{},{dataKey:u,unit:p,formatter:_,name:h||u,color:FP(t),value:xs(r,u),type:o,payload:r,chartType:x,hide:E})};function $g(e){"@babel/helpers - typeof";return $g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$g(e)}function X3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function K3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X3(Object(r),!0).forEach(function(i){yle(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function yle(e,t,r){return t=_le(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _le(e){var t=vle(e,"string");return $g(t)=="symbol"?t:t+""}function vle(e,t){if($g(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if($g(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y0=Math.PI/180,xle=function(t){return t*180/Math.PI},Ai=function(t,r,i,u){return{x:t+Math.cos(-Y0*u)*i,y:r+Math.sin(-Y0*u)*i}},ble=function(t,r){var i=t.x,u=t.y,h=r.x,p=r.y;return Math.sqrt(Math.pow(i-h,2)+Math.pow(u-p,2))},wle=function(t,r){var i=t.x,u=t.y,h=r.cx,p=r.cy,_=ble({x:i,y:u},{x:h,y:p});if(_<=0)return{radius:_};var o=(i-h)/_,x=Math.acos(o);return u>p&&(x=2*Math.PI-x),{radius:_,angle:xle(x),angleInRadian:x}},Tle=function(t){var r=t.startAngle,i=t.endAngle,u=Math.floor(r/360),h=Math.floor(i/360),p=Math.min(u,h);return{startAngle:r-p*360,endAngle:i-p*360}},Sle=function(t,r){var i=r.startAngle,u=r.endAngle,h=Math.floor(i/360),p=Math.floor(u/360),_=Math.min(h,p);return t+_*360},Y3=function(t,r){var i=t.x,u=t.y,h=wle({x:i,y:u},r),p=h.radius,_=h.angle,o=r.innerRadius,x=r.outerRadius;if(p<o||p>x)return!1;if(p===0)return!0;var E=Tle(r),A=E.startAngle,O=E.endAngle,L=_,j;if(A<=O){for(;L>O;)L-=360;for(;L<A;)L+=360;j=L>=A&&L<=O}else{for(;L>A;)L-=360;for(;L<O;)L+=360;j=L>=O&&L<=A}return j?K3(K3({},r),{},{radius:p,angle:Sle(L,r)}):null};function Ng(e){"@babel/helpers - typeof";return Ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ng(e)}var Ele=["offset"];function Ale(e){return Ole(e)||Cle(e)||Mle(e)||Ple()}function Ple(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mle(e,t){if(e){if(typeof e=="string")return lE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lE(e,t)}}function Cle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ole(e){if(Array.isArray(e))return lE(e)}function lE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function Ile(e,t){if(e==null)return{};var r=kle(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function kle(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function J3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function ai(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J3(Object(r),!0).forEach(function(i){Dle(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Dle(e,t,r){return t=Lle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lle(e){var t=zle(e,"string");return Ng(t)=="symbol"?t:t+""}function zle(e,t){if(Ng(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Ng(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ug(){return Ug=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Ug.apply(this,arguments)}var Rle=function(t){var r=t.value,i=t.formatter,u=Qr(t.children)?r:t.children;return xr(i)?i(u):u},Ble=function(t,r){var i=Wa(r-t),u=Math.min(Math.abs(r-t),360);return i*u},jle=function(t,r,i){var u=t.position,h=t.viewBox,p=t.offset,_=t.className,o=h,x=o.cx,E=o.cy,A=o.innerRadius,O=o.outerRadius,L=o.startAngle,j=o.endAngle,F=o.clockWise,Z=(A+O)/2,$=Ble(L,j),V=$>=0?1:-1,U,G;u==="insideStart"?(U=L+V*p,G=F):u==="insideEnd"?(U=j-V*p,G=!F):u==="end"&&(U=j+V*p,G=F),G=$<=0?G:!G;var q=Ai(x,E,Z,U),K=Ai(x,E,Z,U+(G?1:-1)*359),re="M".concat(q.x,",").concat(q.y,`
    A`).concat(Z,",").concat(Z,",0,1,").concat(G?0:1,`,
    `).concat(K.x,",").concat(K.y),pe=Qr(t.id)?e1("recharts-radial-line-"):t.id;return Fe.createElement("text",Ug({},i,{dominantBaseline:"central",className:en("recharts-radial-bar-label",_)}),Fe.createElement("defs",null,Fe.createElement("path",{id:pe,d:re})),Fe.createElement("textPath",{xlinkHref:"#".concat(pe)},r))},Fle=function(t){var r=t.viewBox,i=t.offset,u=t.position,h=r,p=h.cx,_=h.cy,o=h.innerRadius,x=h.outerRadius,E=h.startAngle,A=h.endAngle,O=(E+A)/2;if(u==="outside"){var L=Ai(p,_,x+i,O),j=L.x,F=L.y;return{x:j,y:F,textAnchor:j>=p?"start":"end",verticalAnchor:"middle"}}if(u==="center")return{x:p,y:_,textAnchor:"middle",verticalAnchor:"middle"};if(u==="centerTop")return{x:p,y:_,textAnchor:"middle",verticalAnchor:"start"};if(u==="centerBottom")return{x:p,y:_,textAnchor:"middle",verticalAnchor:"end"};var Z=(o+x)/2,$=Ai(p,_,Z,O),V=$.x,U=$.y;return{x:V,y:U,textAnchor:"middle",verticalAnchor:"middle"}},$le=function(t){var r=t.viewBox,i=t.parentViewBox,u=t.offset,h=t.position,p=r,_=p.x,o=p.y,x=p.width,E=p.height,A=E>=0?1:-1,O=A*u,L=A>0?"end":"start",j=A>0?"start":"end",F=x>=0?1:-1,Z=F*u,$=F>0?"end":"start",V=F>0?"start":"end";if(h==="top"){var U={x:_+x/2,y:o-A*u,textAnchor:"middle",verticalAnchor:L};return ai(ai({},U),i?{height:Math.max(o-i.y,0),width:x}:{})}if(h==="bottom"){var G={x:_+x/2,y:o+E+O,textAnchor:"middle",verticalAnchor:j};return ai(ai({},G),i?{height:Math.max(i.y+i.height-(o+E),0),width:x}:{})}if(h==="left"){var q={x:_-Z,y:o+E/2,textAnchor:$,verticalAnchor:"middle"};return ai(ai({},q),i?{width:Math.max(q.x-i.x,0),height:E}:{})}if(h==="right"){var K={x:_+x+Z,y:o+E/2,textAnchor:V,verticalAnchor:"middle"};return ai(ai({},K),i?{width:Math.max(i.x+i.width-K.x,0),height:E}:{})}var re=i?{width:x,height:E}:{};return h==="insideLeft"?ai({x:_+Z,y:o+E/2,textAnchor:V,verticalAnchor:"middle"},re):h==="insideRight"?ai({x:_+x-Z,y:o+E/2,textAnchor:$,verticalAnchor:"middle"},re):h==="insideTop"?ai({x:_+x/2,y:o+O,textAnchor:"middle",verticalAnchor:j},re):h==="insideBottom"?ai({x:_+x/2,y:o+E-O,textAnchor:"middle",verticalAnchor:L},re):h==="insideTopLeft"?ai({x:_+Z,y:o+O,textAnchor:V,verticalAnchor:j},re):h==="insideTopRight"?ai({x:_+x-Z,y:o+O,textAnchor:$,verticalAnchor:j},re):h==="insideBottomLeft"?ai({x:_+Z,y:o+E-O,textAnchor:V,verticalAnchor:L},re):h==="insideBottomRight"?ai({x:_+x-Z,y:o+E-O,textAnchor:$,verticalAnchor:L},re):Sd(h)&&(zt(h.x)||bc(h.x))&&(zt(h.y)||bc(h.y))?ai({x:_+Bc(h.x,x),y:o+Bc(h.y,E),textAnchor:"end",verticalAnchor:"end"},re):ai({x:_+x/2,y:o+E/2,textAnchor:"middle",verticalAnchor:"middle"},re)},Nle=function(t){return"cx"in t&&zt(t.cx)};function Ui(e){var t=e.offset,r=t===void 0?5:t,i=Ile(e,Ele),u=ai({offset:r},i),h=u.viewBox,p=u.position,_=u.value,o=u.children,x=u.content,E=u.className,A=E===void 0?"":E,O=u.textBreakAll;if(!h||Qr(_)&&Qr(o)&&!De.isValidElement(x)&&!xr(x))return null;if(De.isValidElement(x))return De.cloneElement(x,u);var L;if(xr(x)){if(L=De.createElement(x,u),De.isValidElement(L))return L}else L=Rle(u);var j=Nle(h),F=Hr(u,!0);if(j&&(p==="insideStart"||p==="insideEnd"||p==="end"))return jle(u,L,F);var Z=j?Fle(u):$le(u);return Fe.createElement(R0,Ug({className:en("recharts-label",A)},F,Z,{breakAll:O}),L)}Ui.displayName="Label";var F5=function(t){var r=t.cx,i=t.cy,u=t.angle,h=t.startAngle,p=t.endAngle,_=t.r,o=t.radius,x=t.innerRadius,E=t.outerRadius,A=t.x,O=t.y,L=t.top,j=t.left,F=t.width,Z=t.height,$=t.clockWise,V=t.labelViewBox;if(V)return V;if(zt(F)&&zt(Z)){if(zt(A)&&zt(O))return{x:A,y:O,width:F,height:Z};if(zt(L)&&zt(j))return{x:L,y:j,width:F,height:Z}}return zt(A)&&zt(O)?{x:A,y:O,width:0,height:0}:zt(r)&&zt(i)?{cx:r,cy:i,startAngle:h||u||0,endAngle:p||u||0,innerRadius:x||0,outerRadius:E||o||_||0,clockWise:$}:t.viewBox?t.viewBox:{}},Ule=function(t,r){return t?t===!0?Fe.createElement(Ui,{key:"label-implicit",viewBox:r}):ci(t)?Fe.createElement(Ui,{key:"label-implicit",viewBox:r,value:t}):De.isValidElement(t)?t.type===Ui?De.cloneElement(t,{key:"label-implicit",viewBox:r}):Fe.createElement(Ui,{key:"label-implicit",content:t,viewBox:r}):xr(t)?Fe.createElement(Ui,{key:"label-implicit",content:t,viewBox:r}):Sd(t)?Fe.createElement(Ui,Ug({viewBox:r},t,{key:"label-implicit"})):null:null},Vle=function(t,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&i&&!t.label)return null;var u=t.children,h=F5(t),p=Ha(u,Ui).map(function(o,x){return De.cloneElement(o,{viewBox:r||h,key:"label-".concat(x)})});if(!i)return p;var _=Ule(t.label,r||h);return[_].concat(Ale(p))};Ui.parseViewBox=F5;Ui.renderCallByParent=Vle;function Gle(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Wle=Gle;const qle=Xr(Wle);function Vg(e){"@babel/helpers - typeof";return Vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vg(e)}var Zle=["valueAccessor"],Hle=["data","dataKey","clockWise","id","textBreakAll"];function Xle(e){return Qle(e)||Jle(e)||Yle(e)||Kle()}function Kle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yle(e,t){if(e){if(typeof e=="string")return uE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uE(e,t)}}function Jle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qle(e){if(Array.isArray(e))return uE(e)}function uE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function J0(){return J0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},J0.apply(this,arguments)}function Q3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function eL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q3(Object(r),!0).forEach(function(i){eue(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function eue(e,t,r){return t=tue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tue(e){var t=rue(e,"string");return Vg(t)=="symbol"?t:t+""}function rue(e,t){if(Vg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Vg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tL(e,t){if(e==null)return{};var r=nue(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function nue(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var iue=function(t){return Array.isArray(t.value)?qle(t.value):t.value};function Oc(e){var t=e.valueAccessor,r=t===void 0?iue:t,i=tL(e,Zle),u=i.data,h=i.dataKey,p=i.clockWise,_=i.id,o=i.textBreakAll,x=tL(i,Hle);return!u||!u.length?null:Fe.createElement(xi,{className:"recharts-label-list"},u.map(function(E,A){var O=Qr(h)?r(E,A):xs(E&&E.payload,h),L=Qr(_)?{}:{id:"".concat(_,"-").concat(A)};return Fe.createElement(Ui,J0({},Hr(E,!0),x,L,{parentViewBox:E.parentViewBox,value:O,textBreakAll:o,viewBox:Ui.parseViewBox(Qr(p)?E:eL(eL({},E),{},{clockWise:p})),key:"label-".concat(A),index:A}))}))}Oc.displayName="LabelList";function oue(e,t){return e?e===!0?Fe.createElement(Oc,{key:"labelList-implicit",data:t}):Fe.isValidElement(e)||xr(e)?Fe.createElement(Oc,{key:"labelList-implicit",data:t,content:e}):Sd(e)?Fe.createElement(Oc,J0({data:t},e,{key:"labelList-implicit"})):null:null}function aue(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var i=e.children,u=Ha(i,Oc).map(function(p,_){return De.cloneElement(p,{data:t,key:"labelList-".concat(_)})});if(!r)return u;var h=oue(e.label,t);return[h].concat(Xle(u))}Oc.renderCallByParent=aue;function Gg(e){"@babel/helpers - typeof";return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gg(e)}function cE(){return cE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},cE.apply(this,arguments)}function rL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function nL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rL(Object(r),!0).forEach(function(i){sue(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function sue(e,t,r){return t=lue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lue(e){var t=uue(e,"string");return Gg(t)=="symbol"?t:t+""}function uue(e,t){if(Gg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Gg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cue=function(t,r){var i=Wa(r-t),u=Math.min(Math.abs(r-t),359.999);return i*u},Tv=function(t){var r=t.cx,i=t.cy,u=t.radius,h=t.angle,p=t.sign,_=t.isExternal,o=t.cornerRadius,x=t.cornerIsExternal,E=o*(_?1:-1)+u,A=Math.asin(o/E)/Y0,O=x?h:h+p*A,L=Ai(r,i,E,O),j=Ai(r,i,u,O),F=x?h-p*A:h,Z=Ai(r,i,E*Math.cos(A*Y0),F);return{center:L,circleTangency:j,lineTangency:Z,theta:A}},$5=function(t){var r=t.cx,i=t.cy,u=t.innerRadius,h=t.outerRadius,p=t.startAngle,_=t.endAngle,o=cue(p,_),x=p+o,E=Ai(r,i,h,p),A=Ai(r,i,h,x),O="M ".concat(E.x,",").concat(E.y,`
    A `).concat(h,",").concat(h,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(p>x),`,
    `).concat(A.x,",").concat(A.y,`
  `);if(u>0){var L=Ai(r,i,u,p),j=Ai(r,i,u,x);O+="L ".concat(j.x,",").concat(j.y,`
            A `).concat(u,",").concat(u,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(p<=x),`,
            `).concat(L.x,",").concat(L.y," Z")}else O+="L ".concat(r,",").concat(i," Z");return O},hue=function(t){var r=t.cx,i=t.cy,u=t.innerRadius,h=t.outerRadius,p=t.cornerRadius,_=t.forceCornerRadius,o=t.cornerIsExternal,x=t.startAngle,E=t.endAngle,A=Wa(E-x),O=Tv({cx:r,cy:i,radius:h,angle:x,sign:A,cornerRadius:p,cornerIsExternal:o}),L=O.circleTangency,j=O.lineTangency,F=O.theta,Z=Tv({cx:r,cy:i,radius:h,angle:E,sign:-A,cornerRadius:p,cornerIsExternal:o}),$=Z.circleTangency,V=Z.lineTangency,U=Z.theta,G=o?Math.abs(x-E):Math.abs(x-E)-F-U;if(G<0)return _?"M ".concat(j.x,",").concat(j.y,`
        a`).concat(p,",").concat(p,",0,0,1,").concat(p*2,`,0
        a`).concat(p,",").concat(p,",0,0,1,").concat(-p*2,`,0
      `):$5({cx:r,cy:i,innerRadius:u,outerRadius:h,startAngle:x,endAngle:E});var q="M ".concat(j.x,",").concat(j.y,`
    A`).concat(p,",").concat(p,",0,0,").concat(+(A<0),",").concat(L.x,",").concat(L.y,`
    A`).concat(h,",").concat(h,",0,").concat(+(G>180),",").concat(+(A<0),",").concat($.x,",").concat($.y,`
    A`).concat(p,",").concat(p,",0,0,").concat(+(A<0),",").concat(V.x,",").concat(V.y,`
  `);if(u>0){var K=Tv({cx:r,cy:i,radius:u,angle:x,sign:A,isExternal:!0,cornerRadius:p,cornerIsExternal:o}),re=K.circleTangency,pe=K.lineTangency,xe=K.theta,ge=Tv({cx:r,cy:i,radius:u,angle:E,sign:-A,isExternal:!0,cornerRadius:p,cornerIsExternal:o}),Be=ge.circleTangency,$e=ge.lineTangency,Ve=ge.theta,be=o?Math.abs(x-E):Math.abs(x-E)-xe-Ve;if(be<0&&p===0)return"".concat(q,"L").concat(r,",").concat(i,"Z");q+="L".concat($e.x,",").concat($e.y,`
      A`).concat(p,",").concat(p,",0,0,").concat(+(A<0),",").concat(Be.x,",").concat(Be.y,`
      A`).concat(u,",").concat(u,",0,").concat(+(be>180),",").concat(+(A>0),",").concat(re.x,",").concat(re.y,`
      A`).concat(p,",").concat(p,",0,0,").concat(+(A<0),",").concat(pe.x,",").concat(pe.y,"Z")}else q+="L".concat(r,",").concat(i,"Z");return q},fue={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},N5=function(t){var r=nL(nL({},fue),t),i=r.cx,u=r.cy,h=r.innerRadius,p=r.outerRadius,_=r.cornerRadius,o=r.forceCornerRadius,x=r.cornerIsExternal,E=r.startAngle,A=r.endAngle,O=r.className;if(p<h||E===A)return null;var L=en("recharts-sector",O),j=p-h,F=Bc(_,j,0,!0),Z;return F>0&&Math.abs(E-A)<360?Z=hue({cx:i,cy:u,innerRadius:h,outerRadius:p,cornerRadius:Math.min(F,j/2),forceCornerRadius:o,cornerIsExternal:x,startAngle:E,endAngle:A}):Z=$5({cx:i,cy:u,innerRadius:h,outerRadius:p,startAngle:E,endAngle:A}),Fe.createElement("path",cE({},Hr(r,!0),{className:L,d:Z,role:"img"}))};function Wg(e){"@babel/helpers - typeof";return Wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wg(e)}function hE(){return hE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},hE.apply(this,arguments)}function iL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function oL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iL(Object(r),!0).forEach(function(i){due(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function due(e,t,r){return t=pue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pue(e){var t=mue(e,"string");return Wg(t)=="symbol"?t:t+""}function mue(e,t){if(Wg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Wg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aL={curveBasisClosed:dX,curveBasisOpen:pX,curveBasis:fX,curveBumpX:JH,curveBumpY:QH,curveLinearClosed:mX,curveLinear:n1,curveMonotoneX:gX,curveMonotoneY:yX,curveNatural:_X,curveStep:vX,curveStepAfter:bX,curveStepBefore:xX},Sv=function(t){return t.x===+t.x&&t.y===+t.y},Dm=function(t){return t.x},Lm=function(t){return t.y},gue=function(t,r){if(xr(t))return t;var i="curve".concat(t1(t));return(i==="curveMonotone"||i==="curveBump")&&r?aL["".concat(i).concat(r==="vertical"?"Y":"X")]:aL[i]||n1},yue=function(t){var r=t.type,i=r===void 0?"linear":r,u=t.points,h=u===void 0?[]:u,p=t.baseLine,_=t.layout,o=t.connectNulls,x=o===void 0?!1:o,E=gue(i,_),A=x?h.filter(function(F){return Sv(F)}):h,O;if(Array.isArray(p)){var L=x?p.filter(function(F){return Sv(F)}):p,j=A.map(function(F,Z){return oL(oL({},F),{},{base:L[Z]})});return _==="vertical"?O=pv().y(Lm).x1(Dm).x0(function(F){return F.base.x}):O=pv().x(Dm).y1(Lm).y0(function(F){return F.base.y}),O.defined(Sv).curve(E),O(j)}return _==="vertical"&&zt(p)?O=pv().y(Lm).x1(Dm).x0(p):zt(p)?O=pv().x(Dm).y1(Lm).y0(p):O=N4().x(Dm).y(Lm),O.defined(Sv).curve(E),O(A)},sL=function(t){var r=t.className,i=t.points,u=t.path,h=t.pathRef;if((!i||!i.length)&&!u)return null;var p=i&&i.length?yue(t):u;return Fe.createElement("path",hE({},Hr(t,!1),b0(t),{className:en("recharts-curve",r),d:p,ref:h}))},_ue=Object.getOwnPropertyNames,vue=Object.getOwnPropertySymbols,xue=Object.prototype.hasOwnProperty;function lL(e,t){return function(i,u,h){return e(i,u,h)&&t(i,u,h)}}function Ev(e){return function(r,i,u){if(!r||!i||typeof r!="object"||typeof i!="object")return e(r,i,u);var h=u.cache,p=h.get(r),_=h.get(i);if(p&&_)return p===i&&_===r;h.set(r,i),h.set(i,r);var o=e(r,i,u);return h.delete(r),h.delete(i),o}}function uL(e){return _ue(e).concat(vue(e))}var bue=Object.hasOwn||function(e,t){return xue.call(e,t)};function Hc(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var wue="__v",Tue="__o",Sue="_owner",cL=Object.getOwnPropertyDescriptor,hL=Object.keys;function Eue(e,t,r){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!r.equals(e[i],t[i],i,i,e,t,r))return!1;return!0}function Aue(e,t){return Hc(e.getTime(),t.getTime())}function Pue(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Mue(e,t){return e===t}function fL(e,t,r){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var u=new Array(i),h=e.entries(),p,_,o=0;(p=h.next())&&!p.done;){for(var x=t.entries(),E=!1,A=0;(_=x.next())&&!_.done;){if(u[A]){A++;continue}var O=p.value,L=_.value;if(r.equals(O[0],L[0],o,A,e,t,r)&&r.equals(O[1],L[1],O[0],L[0],e,t,r)){E=u[A]=!0;break}A++}if(!E)return!1;o++}return!0}var Cue=Hc;function Oue(e,t,r){var i=hL(e),u=i.length;if(hL(t).length!==u)return!1;for(;u-- >0;)if(!U5(e,t,r,i[u]))return!1;return!0}function zm(e,t,r){var i=uL(e),u=i.length;if(uL(t).length!==u)return!1;for(var h,p,_;u-- >0;)if(h=i[u],!U5(e,t,r,h)||(p=cL(e,h),_=cL(t,h),(p||_)&&(!p||!_||p.configurable!==_.configurable||p.enumerable!==_.enumerable||p.writable!==_.writable)))return!1;return!0}function Iue(e,t){return Hc(e.valueOf(),t.valueOf())}function kue(e,t){return e.source===t.source&&e.flags===t.flags}function dL(e,t,r){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var u=new Array(i),h=e.values(),p,_;(p=h.next())&&!p.done;){for(var o=t.values(),x=!1,E=0;(_=o.next())&&!_.done;){if(!u[E]&&r.equals(p.value,_.value,p.value,_.value,e,t,r)){x=u[E]=!0;break}E++}if(!x)return!1}return!0}function Due(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function Lue(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function U5(e,t,r,i){return(i===Sue||i===Tue||i===wue)&&(e.$$typeof||t.$$typeof)?!0:bue(t,i)&&r.equals(e[i],t[i],i,i,e,t,r)}var zue="[object Arguments]",Rue="[object Boolean]",Bue="[object Date]",jue="[object Error]",Fue="[object Map]",$ue="[object Number]",Nue="[object Object]",Uue="[object RegExp]",Vue="[object Set]",Gue="[object String]",Wue="[object URL]",que=Array.isArray,pL=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,mL=Object.assign,Zue=Object.prototype.toString.call.bind(Object.prototype.toString);function Hue(e){var t=e.areArraysEqual,r=e.areDatesEqual,i=e.areErrorsEqual,u=e.areFunctionsEqual,h=e.areMapsEqual,p=e.areNumbersEqual,_=e.areObjectsEqual,o=e.arePrimitiveWrappersEqual,x=e.areRegExpsEqual,E=e.areSetsEqual,A=e.areTypedArraysEqual,O=e.areUrlsEqual;return function(j,F,Z){if(j===F)return!0;if(j==null||F==null)return!1;var $=typeof j;if($!==typeof F)return!1;if($!=="object")return $==="number"?p(j,F,Z):$==="function"?u(j,F,Z):!1;var V=j.constructor;if(V!==F.constructor)return!1;if(V===Object)return _(j,F,Z);if(que(j))return t(j,F,Z);if(pL!=null&&pL(j))return A(j,F,Z);if(V===Date)return r(j,F,Z);if(V===RegExp)return x(j,F,Z);if(V===Map)return h(j,F,Z);if(V===Set)return E(j,F,Z);var U=Zue(j);return U===Bue?r(j,F,Z):U===Uue?x(j,F,Z):U===Fue?h(j,F,Z):U===Vue?E(j,F,Z):U===Nue?typeof j.then!="function"&&typeof F.then!="function"&&_(j,F,Z):U===Wue?O(j,F,Z):U===jue?i(j,F,Z):U===zue?_(j,F,Z):U===Rue||U===$ue||U===Gue?o(j,F,Z):!1}}function Xue(e){var t=e.circular,r=e.createCustomConfig,i=e.strict,u={areArraysEqual:i?zm:Eue,areDatesEqual:Aue,areErrorsEqual:Pue,areFunctionsEqual:Mue,areMapsEqual:i?lL(fL,zm):fL,areNumbersEqual:Cue,areObjectsEqual:i?zm:Oue,arePrimitiveWrappersEqual:Iue,areRegExpsEqual:kue,areSetsEqual:i?lL(dL,zm):dL,areTypedArraysEqual:i?zm:Due,areUrlsEqual:Lue};if(r&&(u=mL({},u,r(u))),t){var h=Ev(u.areArraysEqual),p=Ev(u.areMapsEqual),_=Ev(u.areObjectsEqual),o=Ev(u.areSetsEqual);u=mL({},u,{areArraysEqual:h,areMapsEqual:p,areObjectsEqual:_,areSetsEqual:o})}return u}function Kue(e){return function(t,r,i,u,h,p,_){return e(t,r,_)}}function Yue(e){var t=e.circular,r=e.comparator,i=e.createState,u=e.equals,h=e.strict;if(i)return function(o,x){var E=i(),A=E.cache,O=A===void 0?t?new WeakMap:void 0:A,L=E.meta;return r(o,x,{cache:O,equals:u,meta:L,strict:h})};if(t)return function(o,x){return r(o,x,{cache:new WeakMap,equals:u,meta:void 0,strict:h})};var p={cache:void 0,equals:u,meta:void 0,strict:h};return function(o,x){return r(o,x,p)}}var Jue=Tu();Tu({strict:!0});Tu({circular:!0});Tu({circular:!0,strict:!0});Tu({createInternalComparator:function(){return Hc}});Tu({strict:!0,createInternalComparator:function(){return Hc}});Tu({circular:!0,createInternalComparator:function(){return Hc}});Tu({circular:!0,createInternalComparator:function(){return Hc},strict:!0});function Tu(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,i=e.createInternalComparator,u=e.createState,h=e.strict,p=h===void 0?!1:h,_=Xue(e),o=Hue(_),x=i?i(o):Kue(o);return Yue({circular:r,comparator:o,createState:u,equals:x,strict:p})}function Que(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function gL(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,i=function u(h){r<0&&(r=h),h-r>t?(e(h),r=-1):Que(u)};requestAnimationFrame(i)}function fE(e){"@babel/helpers - typeof";return fE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fE(e)}function ece(e){return ice(e)||nce(e)||rce(e)||tce()}function tce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rce(e,t){if(e){if(typeof e=="string")return yL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yL(e,t)}}function yL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function nce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ice(e){if(Array.isArray(e))return e}function oce(){var e={},t=function(){return null},r=!1,i=function u(h){if(!r){if(Array.isArray(h)){if(!h.length)return;var p=h,_=ece(p),o=_[0],x=_.slice(1);if(typeof o=="number"){gL(u.bind(null,x),o);return}u(o),gL(u.bind(null,x));return}fE(h)==="object"&&(e=h,t(e)),typeof h=="function"&&h()}};return{stop:function(){r=!0},start:function(h){r=!1,i(h)},subscribe:function(h){return t=h,function(){t=function(){return null}}}}}function qg(e){"@babel/helpers - typeof";return qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qg(e)}function _L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function vL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_L(Object(r),!0).forEach(function(i){V5(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_L(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function V5(e,t,r){return t=ace(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ace(e){var t=sce(e,"string");return qg(t)==="symbol"?t:String(t)}function sce(e,t){if(qg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(qg(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lce=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(i,u){return i.filter(function(h){return u.includes(h)})})},uce=function(t){return t},cce=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},ng=function(t,r){return Object.keys(r).reduce(function(i,u){return vL(vL({},i),{},V5({},u,t(u,r[u])))},{})},xL=function(t,r,i){return t.map(function(u){return"".concat(cce(u)," ").concat(r,"ms ").concat(i)}).join(",")};function hce(e,t){return pce(e)||dce(e,t)||G5(e,t)||fce()}function fce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t!==0)for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function pce(e){if(Array.isArray(e))return e}function mce(e){return _ce(e)||yce(e)||G5(e)||gce()}function gce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G5(e,t){if(e){if(typeof e=="string")return dE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dE(e,t)}}function yce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _ce(e){if(Array.isArray(e))return dE(e)}function dE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var Q0=1e-4,W5=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},q5=function(t,r){return t.map(function(i,u){return i*Math.pow(r,u)}).reduce(function(i,u){return i+u})},bL=function(t,r){return function(i){var u=W5(t,r);return q5(u,i)}},vce=function(t,r){return function(i){var u=W5(t,r),h=[].concat(mce(u.map(function(p,_){return p*_}).slice(1)),[0]);return q5(h,i)}},wL=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var u=r[0],h=r[1],p=r[2],_=r[3];if(r.length===1)switch(r[0]){case"linear":u=0,h=0,p=1,_=1;break;case"ease":u=.25,h=.1,p=.25,_=1;break;case"ease-in":u=.42,h=0,p=1,_=1;break;case"ease-out":u=.42,h=0,p=.58,_=1;break;case"ease-in-out":u=0,h=0,p=.58,_=1;break;default:{var o=r[0].split("(");if(o[0]==="cubic-bezier"&&o[1].split(")")[0].split(",").length===4){var x=o[1].split(")")[0].split(",").map(function(Z){return parseFloat(Z)}),E=hce(x,4);u=E[0],h=E[1],p=E[2],_=E[3]}}}var A=bL(u,p),O=bL(h,_),L=vce(u,p),j=function($){return $>1?1:$<0?0:$},F=function($){for(var V=$>1?1:$,U=V,G=0;G<8;++G){var q=A(U)-V,K=L(U);if(Math.abs(q-V)<Q0||K<Q0)return O(U);U=j(U-q/K)}return O(U)};return F.isStepper=!1,F},xce=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,i=r===void 0?100:r,u=t.damping,h=u===void 0?8:u,p=t.dt,_=p===void 0?17:p,o=function(E,A,O){var L=-(E-A)*i,j=O*h,F=O+(L-j)*_/1e3,Z=O*_/1e3+E;return Math.abs(Z-A)<Q0&&Math.abs(F)<Q0?[A,0]:[Z,F]};return o.isStepper=!0,o.dt=_,o},bce=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var u=r[0];if(typeof u=="string")switch(u){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return wL(u);case"spring":return xce();default:if(u.split("(")[0]==="cubic-bezier")return wL(u)}return typeof u=="function"?u:null};function Zg(e){"@babel/helpers - typeof";return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zg(e)}function TL(e){return Sce(e)||Tce(e)||Z5(e)||wce()}function wce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sce(e){if(Array.isArray(e))return mE(e)}function SL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Si(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SL(Object(r),!0).forEach(function(i){pE(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function pE(e,t,r){return t=Ece(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ece(e){var t=Ace(e,"string");return Zg(t)==="symbol"?t:String(t)}function Ace(e,t){if(Zg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Zg(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pce(e,t){return Oce(e)||Cce(e,t)||Z5(e,t)||Mce()}function Mce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z5(e,t){if(e){if(typeof e=="string")return mE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mE(e,t)}}function mE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function Cce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t!==0)for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function Oce(e){if(Array.isArray(e))return e}var ex=function(t,r,i){return t+(r-t)*i},gE=function(t){var r=t.from,i=t.to;return r!==i},Ice=function e(t,r,i){var u=ng(function(h,p){if(gE(p)){var _=t(p.from,p.to,p.velocity),o=Pce(_,2),x=o[0],E=o[1];return Si(Si({},p),{},{from:x,velocity:E})}return p},r);return i<1?ng(function(h,p){return gE(p)?Si(Si({},p),{},{velocity:ex(p.velocity,u[h].velocity,i),from:ex(p.from,u[h].from,i)}):p},r):e(t,u,i-1)};const kce=function(e,t,r,i,u){var h=lce(e,t),p=h.reduce(function(Z,$){return Si(Si({},Z),{},pE({},$,[e[$],t[$]]))},{}),_=h.reduce(function(Z,$){return Si(Si({},Z),{},pE({},$,{from:e[$],velocity:0,to:t[$]}))},{}),o=-1,x,E,A=function(){return null},O=function(){return ng(function($,V){return V.from},_)},L=function(){return!Object.values(_).filter(gE).length},j=function($){x||(x=$);var V=$-x,U=V/r.dt;_=Ice(r,_,U),u(Si(Si(Si({},e),t),O())),x=$,L()||(o=requestAnimationFrame(A))},F=function($){E||(E=$);var V=($-E)/i,U=ng(function(q,K){return ex.apply(void 0,TL(K).concat([r(V)]))},p);if(u(Si(Si(Si({},e),t),U)),V<1)o=requestAnimationFrame(A);else{var G=ng(function(q,K){return ex.apply(void 0,TL(K).concat([r(1)]))},p);u(Si(Si(Si({},e),t),G))}};return A=r.isStepper?j:F,function(){return requestAnimationFrame(A),function(){cancelAnimationFrame(o)}}};function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}var Dce=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Lce(e,t){if(e==null)return{};var r=zce(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function zce(e,t){if(e==null)return{};var r={},i=Object.keys(e),u,h;for(h=0;h<i.length;h++)u=i[h],!(t.indexOf(u)>=0)&&(r[u]=e[u]);return r}function aT(e){return Fce(e)||jce(e)||Bce(e)||Rce()}function Rce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bce(e,t){if(e){if(typeof e=="string")return yE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yE(e,t)}}function jce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fce(e){if(Array.isArray(e))return yE(e)}function yE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function EL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Ra(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EL(Object(r),!0).forEach(function(i){Um(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Um(e,t,r){return t=H5(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nce(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,H5(i.key),i)}}function Uce(e,t,r){return t&&Nce(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function H5(e){var t=Vce(e,"string");return od(t)==="symbol"?t:String(t)}function Vce(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(od(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_E(e,t)}function _E(e,t){return _E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},_E(e,t)}function Wce(e){var t=qce();return function(){var i=tx(e),u;if(t){var h=tx(this).constructor;u=Reflect.construct(i,arguments,h)}else u=i.apply(this,arguments);return vE(this,u)}}function vE(e,t){if(t&&(od(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xE(e)}function xE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tx(e){return tx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tx(e)}var pu=function(e){Gce(r,e);var t=Wce(r);function r(i,u){var h;$ce(this,r),h=t.call(this,i,u);var p=h.props,_=p.isActive,o=p.attributeName,x=p.from,E=p.to,A=p.steps,O=p.children,L=p.duration;if(h.handleStyleChange=h.handleStyleChange.bind(xE(h)),h.changeStyle=h.changeStyle.bind(xE(h)),!_||L<=0)return h.state={style:{}},typeof O=="function"&&(h.state={style:E}),vE(h);if(A&&A.length)h.state={style:A[0].style};else if(x){if(typeof O=="function")return h.state={style:x},vE(h);h.state={style:o?Um({},o,x):x}}else h.state={style:{}};return h}return Uce(r,[{key:"componentDidMount",value:function(){var u=this.props,h=u.isActive,p=u.canBegin;this.mounted=!0,!(!h||!p)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(u){var h=this.props,p=h.isActive,_=h.canBegin,o=h.attributeName,x=h.shouldReAnimate,E=h.to,A=h.from,O=this.state.style;if(_){if(!p){var L={style:o?Um({},o,E):E};this.state&&O&&(o&&O[o]!==E||!o&&O!==E)&&this.setState(L);return}if(!(Jue(u.to,E)&&u.canBegin&&u.isActive)){var j=!u.canBegin||!u.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var F=j||x?A:u.to;if(this.state&&O){var Z={style:o?Um({},o,F):F};(o&&O[o]!==F||!o&&O!==F)&&this.setState(Z)}this.runAnimation(Ra(Ra({},this.props),{},{from:F,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var u=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),u&&u()}},{key:"handleStyleChange",value:function(u){this.changeStyle(u)}},{key:"changeStyle",value:function(u){this.mounted&&this.setState({style:u})}},{key:"runJSAnimation",value:function(u){var h=this,p=u.from,_=u.to,o=u.duration,x=u.easing,E=u.begin,A=u.onAnimationEnd,O=u.onAnimationStart,L=kce(p,_,bce(x),o,this.changeStyle),j=function(){h.stopJSAnimation=L()};this.manager.start([O,E,j,o,A])}},{key:"runStepAnimation",value:function(u){var h=this,p=u.steps,_=u.begin,o=u.onAnimationStart,x=p[0],E=x.style,A=x.duration,O=A===void 0?0:A,L=function(F,Z,$){if($===0)return F;var V=Z.duration,U=Z.easing,G=U===void 0?"ease":U,q=Z.style,K=Z.properties,re=Z.onAnimationEnd,pe=$>0?p[$-1]:Z,xe=K||Object.keys(q);if(typeof G=="function"||G==="spring")return[].concat(aT(F),[h.runJSAnimation.bind(h,{from:pe.style,to:q,duration:V,easing:G}),V]);var ge=xL(xe,V,G),Be=Ra(Ra(Ra({},pe.style),q),{},{transition:ge});return[].concat(aT(F),[Be,V,re]).filter(uce)};return this.manager.start([o].concat(aT(p.reduce(L,[E,Math.max(O,_)])),[u.onAnimationEnd]))}},{key:"runAnimation",value:function(u){this.manager||(this.manager=oce());var h=u.begin,p=u.duration,_=u.attributeName,o=u.to,x=u.easing,E=u.onAnimationStart,A=u.onAnimationEnd,O=u.steps,L=u.children,j=this.manager;if(this.unSubscribe=j.subscribe(this.handleStyleChange),typeof x=="function"||typeof L=="function"||x==="spring"){this.runJSAnimation(u);return}if(O.length>1){this.runStepAnimation(u);return}var F=_?Um({},_,o):o,Z=xL(Object.keys(F),p,x);j.start([E,h,Ra(Ra({},F),{},{transition:Z}),p,A])}},{key:"render",value:function(){var u=this.props,h=u.children;u.begin;var p=u.duration;u.attributeName,u.easing;var _=u.isActive;u.steps,u.from,u.to,u.canBegin,u.onAnimationEnd,u.shouldReAnimate,u.onAnimationReStart;var o=Lce(u,Dce),x=De.Children.count(h),E=this.state.style;if(typeof h=="function")return h(E);if(!_||x===0||p<=0)return h;var A=function(L){var j=L.props,F=j.style,Z=F===void 0?{}:F,$=j.className,V=De.cloneElement(L,Ra(Ra({},o),{},{style:Ra(Ra({},Z),E),className:$}));return V};return x===1?A(De.Children.only(h)):Fe.createElement("div",null,De.Children.map(h,function(O){return A(O)}))}}]),r}(De.PureComponent);pu.displayName="Animate";pu.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};pu.propTypes={from:Jr.oneOfType([Jr.object,Jr.string]),to:Jr.oneOfType([Jr.object,Jr.string]),attributeName:Jr.string,duration:Jr.number,begin:Jr.number,easing:Jr.oneOfType([Jr.string,Jr.func]),steps:Jr.arrayOf(Jr.shape({duration:Jr.number.isRequired,style:Jr.object.isRequired,easing:Jr.oneOfType([Jr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Jr.func]),properties:Jr.arrayOf("string"),onAnimationEnd:Jr.func})),children:Jr.oneOfType([Jr.node,Jr.func]),isActive:Jr.bool,canBegin:Jr.bool,onAnimationEnd:Jr.func,shouldReAnimate:Jr.bool,onAnimationStart:Jr.func,onAnimationReStart:Jr.func};function Hg(e){"@babel/helpers - typeof";return Hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hg(e)}function rx(){return rx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},rx.apply(this,arguments)}function Zce(e,t){return Yce(e)||Kce(e,t)||Xce(e,t)||Hce()}function Hce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xce(e,t){if(e){if(typeof e=="string")return AL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AL(e,t)}}function AL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function Kce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t!==0)for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function Yce(e){if(Array.isArray(e))return e}function PL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function ML(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PL(Object(r),!0).forEach(function(i){Jce(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Jce(e,t,r){return t=Qce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qce(e){var t=ehe(e,"string");return Hg(t)=="symbol"?t:t+""}function ehe(e,t){if(Hg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Hg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CL=function(t,r,i,u,h){var p=Math.min(Math.abs(i)/2,Math.abs(u)/2),_=u>=0?1:-1,o=i>=0?1:-1,x=u>=0&&i>=0||u<0&&i<0?1:0,E;if(p>0&&h instanceof Array){for(var A=[0,0,0,0],O=0,L=4;O<L;O++)A[O]=h[O]>p?p:h[O];E="M".concat(t,",").concat(r+_*A[0]),A[0]>0&&(E+="A ".concat(A[0],",").concat(A[0],",0,0,").concat(x,",").concat(t+o*A[0],",").concat(r)),E+="L ".concat(t+i-o*A[1],",").concat(r),A[1]>0&&(E+="A ".concat(A[1],",").concat(A[1],",0,0,").concat(x,`,
        `).concat(t+i,",").concat(r+_*A[1])),E+="L ".concat(t+i,",").concat(r+u-_*A[2]),A[2]>0&&(E+="A ".concat(A[2],",").concat(A[2],",0,0,").concat(x,`,
        `).concat(t+i-o*A[2],",").concat(r+u)),E+="L ".concat(t+o*A[3],",").concat(r+u),A[3]>0&&(E+="A ".concat(A[3],",").concat(A[3],",0,0,").concat(x,`,
        `).concat(t,",").concat(r+u-_*A[3])),E+="Z"}else if(p>0&&h===+h&&h>0){var j=Math.min(p,h);E="M ".concat(t,",").concat(r+_*j,`
            A `).concat(j,",").concat(j,",0,0,").concat(x,",").concat(t+o*j,",").concat(r,`
            L `).concat(t+i-o*j,",").concat(r,`
            A `).concat(j,",").concat(j,",0,0,").concat(x,",").concat(t+i,",").concat(r+_*j,`
            L `).concat(t+i,",").concat(r+u-_*j,`
            A `).concat(j,",").concat(j,",0,0,").concat(x,",").concat(t+i-o*j,",").concat(r+u,`
            L `).concat(t+o*j,",").concat(r+u,`
            A `).concat(j,",").concat(j,",0,0,").concat(x,",").concat(t,",").concat(r+u-_*j," Z")}else E="M ".concat(t,",").concat(r," h ").concat(i," v ").concat(u," h ").concat(-i," Z");return E},the=function(t,r){if(!t||!r)return!1;var i=t.x,u=t.y,h=r.x,p=r.y,_=r.width,o=r.height;if(Math.abs(_)>0&&Math.abs(o)>0){var x=Math.min(h,h+_),E=Math.max(h,h+_),A=Math.min(p,p+o),O=Math.max(p,p+o);return i>=x&&i<=E&&u>=A&&u<=O}return!1},rhe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},$P=function(t){var r=ML(ML({},rhe),t),i=De.useRef(),u=De.useState(-1),h=Zce(u,2),p=h[0],_=h[1];De.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var G=i.current.getTotalLength();G&&_(G)}catch{}},[]);var o=r.x,x=r.y,E=r.width,A=r.height,O=r.radius,L=r.className,j=r.animationEasing,F=r.animationDuration,Z=r.animationBegin,$=r.isAnimationActive,V=r.isUpdateAnimationActive;if(o!==+o||x!==+x||E!==+E||A!==+A||E===0||A===0)return null;var U=en("recharts-rectangle",L);return V?Fe.createElement(pu,{canBegin:p>0,from:{width:E,height:A,x:o,y:x},to:{width:E,height:A,x:o,y:x},duration:F,animationEasing:j,isActive:V},function(G){var q=G.width,K=G.height,re=G.x,pe=G.y;return Fe.createElement(pu,{canBegin:p>0,from:"0px ".concat(p===-1?1:p,"px"),to:"".concat(p,"px 0px"),attributeName:"strokeDasharray",begin:Z,duration:F,isActive:$,easing:j},Fe.createElement("path",rx({},Hr(r,!0),{className:U,d:CL(re,pe,q,K,O),ref:i})))}):Fe.createElement("path",rx({},Hr(r,!0),{className:U,d:CL(o,x,E,A,O)}))};function bE(){return bE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},bE.apply(this,arguments)}var X5=function(t){var r=t.cx,i=t.cy,u=t.r,h=t.className,p=en("recharts-dot",h);return r===+r&&i===+i&&u===+u?Fe.createElement("circle",bE({},Hr(t,!1),b0(t),{className:p,cx:r,cy:i,r:u})):null};function Xg(e){"@babel/helpers - typeof";return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xg(e)}var nhe=["x","y","top","left","width","height","className"];function wE(){return wE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},wE.apply(this,arguments)}function OL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function ihe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OL(Object(r),!0).forEach(function(i){ohe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function ohe(e,t,r){return t=ahe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ahe(e){var t=she(e,"string");return Xg(t)=="symbol"?t:t+""}function she(e,t){if(Xg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Xg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lhe(e,t){if(e==null)return{};var r=uhe(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function uhe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var che=function(t,r,i,u,h,p){return"M".concat(t,",").concat(h,"v").concat(u,"M").concat(p,",").concat(r,"h").concat(i)},hhe=function(t){var r=t.x,i=r===void 0?0:r,u=t.y,h=u===void 0?0:u,p=t.top,_=p===void 0?0:p,o=t.left,x=o===void 0?0:o,E=t.width,A=E===void 0?0:E,O=t.height,L=O===void 0?0:O,j=t.className,F=lhe(t,nhe),Z=ihe({x:i,y:h,top:_,left:x,width:A,height:L},F);return!zt(i)||!zt(h)||!zt(A)||!zt(L)||!zt(_)||!zt(x)?null:Fe.createElement("path",wE({},Hr(Z,!0),{className:en("recharts-cross",j),d:che(i,h,A,L,_,x)}))},fhe=hj,dhe=fhe(Object.getPrototypeOf,Object),phe=dhe,mhe=hl,ghe=phe,yhe=fl,_he="[object Object]",vhe=Function.prototype,xhe=Object.prototype,K5=vhe.toString,bhe=xhe.hasOwnProperty,whe=K5.call(Object);function The(e){if(!yhe(e)||mhe(e)!=_he)return!1;var t=ghe(e);if(t===null)return!0;var r=bhe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&K5.call(r)==whe}var She=The;const Ehe=Xr(She);var Ahe=hl,Phe=fl,Mhe="[object Boolean]";function Che(e){return e===!0||e===!1||Phe(e)&&Ahe(e)==Mhe}var Ohe=Che;const Ihe=Xr(Ohe);function Kg(e){"@babel/helpers - typeof";return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kg(e)}function nx(){return nx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},nx.apply(this,arguments)}function khe(e,t){return Rhe(e)||zhe(e,t)||Lhe(e,t)||Dhe()}function Dhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lhe(e,t){if(e){if(typeof e=="string")return IL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IL(e,t)}}function IL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function zhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t!==0)for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function Rhe(e){if(Array.isArray(e))return e}function kL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function DL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kL(Object(r),!0).forEach(function(i){Bhe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Bhe(e,t,r){return t=jhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jhe(e){var t=Fhe(e,"string");return Kg(t)=="symbol"?t:t+""}function Fhe(e,t){if(Kg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Kg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LL=function(t,r,i,u,h){var p=i-u,_;return _="M ".concat(t,",").concat(r),_+="L ".concat(t+i,",").concat(r),_+="L ".concat(t+i-p/2,",").concat(r+h),_+="L ".concat(t+i-p/2-u,",").concat(r+h),_+="L ".concat(t,",").concat(r," Z"),_},$he={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Nhe=function(t){var r=DL(DL({},$he),t),i=De.useRef(),u=De.useState(-1),h=khe(u,2),p=h[0],_=h[1];De.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var U=i.current.getTotalLength();U&&_(U)}catch{}},[]);var o=r.x,x=r.y,E=r.upperWidth,A=r.lowerWidth,O=r.height,L=r.className,j=r.animationEasing,F=r.animationDuration,Z=r.animationBegin,$=r.isUpdateAnimationActive;if(o!==+o||x!==+x||E!==+E||A!==+A||O!==+O||E===0&&A===0||O===0)return null;var V=en("recharts-trapezoid",L);return $?Fe.createElement(pu,{canBegin:p>0,from:{upperWidth:0,lowerWidth:0,height:O,x:o,y:x},to:{upperWidth:E,lowerWidth:A,height:O,x:o,y:x},duration:F,animationEasing:j,isActive:$},function(U){var G=U.upperWidth,q=U.lowerWidth,K=U.height,re=U.x,pe=U.y;return Fe.createElement(pu,{canBegin:p>0,from:"0px ".concat(p===-1?1:p,"px"),to:"".concat(p,"px 0px"),attributeName:"strokeDasharray",begin:Z,duration:F,easing:j},Fe.createElement("path",nx({},Hr(r,!0),{className:V,d:LL(re,pe,G,q,K),ref:i})))}):Fe.createElement("g",null,Fe.createElement("path",nx({},Hr(r,!0),{className:V,d:LL(o,x,E,A,O)})))},Uhe=["option","shapeType","propTransformer","activeClassName","isActive"];function Yg(e){"@babel/helpers - typeof";return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yg(e)}function Vhe(e,t){if(e==null)return{};var r=Ghe(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function Ghe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function zL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function ix(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zL(Object(r),!0).forEach(function(i){Whe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Whe(e,t,r){return t=qhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qhe(e){var t=Zhe(e,"string");return Yg(t)=="symbol"?t:t+""}function Zhe(e,t){if(Yg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Yg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hhe(e,t){return ix(ix({},t),e)}function Xhe(e,t){return e==="symbols"}function RL(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Fe.createElement($P,r);case"trapezoid":return Fe.createElement(Nhe,r);case"sector":return Fe.createElement(N5,r);case"symbols":if(Xhe(t))return Fe.createElement(iP,r);break;default:return null}}function Khe(e){return De.isValidElement(e)?e.props:e}function Yhe(e){var t=e.option,r=e.shapeType,i=e.propTransformer,u=i===void 0?Hhe:i,h=e.activeClassName,p=h===void 0?"recharts-active-shape":h,_=e.isActive,o=Vhe(e,Uhe),x;if(De.isValidElement(t))x=De.cloneElement(t,ix(ix({},o),Khe(t)));else if(xr(t))x=t(o);else if(Ehe(t)&&!Ihe(t)){var E=u(t,o);x=Fe.createElement(RL,{shapeType:r,elementProps:E})}else{var A=o;x=Fe.createElement(RL,{shapeType:r,elementProps:A})}return _?Fe.createElement(xi,{className:p},x):x}function v1(e,t){return t!=null&&"trapezoids"in e.props}function x1(e,t){return t!=null&&"sectors"in e.props}function Jg(e,t){return t!=null&&"points"in e.props}function Jhe(e,t){var r,i,u=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,h=e.y===(t==null||(i=t.labelViewBox)===null||i===void 0?void 0:i.y)||e.y===t.y;return u&&h}function Qhe(e,t){var r=e.endAngle===t.endAngle,i=e.startAngle===t.startAngle;return r&&i}function efe(e,t){var r=e.x===t.x,i=e.y===t.y,u=e.z===t.z;return r&&i&&u}function tfe(e,t){var r;return v1(e,t)?r=Jhe:x1(e,t)?r=Qhe:Jg(e,t)&&(r=efe),r}function rfe(e,t){var r;return v1(e,t)?r="trapezoids":x1(e,t)?r="sectors":Jg(e,t)&&(r="points"),r}function nfe(e,t){if(v1(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(x1(e,t)){var i;return(i=t.tooltipPayload)===null||i===void 0||(i=i[0])===null||i===void 0||(i=i.payload)===null||i===void 0?void 0:i.payload}return Jg(e,t)?t.payload:{}}function ife(e){var t=e.activeTooltipItem,r=e.graphicalItem,i=e.itemData,u=rfe(r,t),h=nfe(r,t),p=i.filter(function(o,x){var E=RP(h,o),A=r.props[u].filter(function(j){var F=tfe(r,t);return F(j,t)}),O=r.props[u].indexOf(A[A.length-1]),L=x===O;return E&&L}),_=i.indexOf(p[p.length-1]);return _}var ofe=Math.ceil,afe=Math.max;function sfe(e,t,r,i){for(var u=-1,h=afe(ofe((t-e)/(r||1)),0),p=Array(h);h--;)p[i?h:++u]=e,e+=r;return p}var lfe=sfe,ufe=Oj,BL=1/0,cfe=17976931348623157e292;function hfe(e){if(!e)return e===0?e:0;if(e=ufe(e),e===BL||e===-BL){var t=e<0?-1:1;return t*cfe}return e===e?e:0}var Y5=hfe,ffe=lfe,dfe=s1,sT=Y5;function pfe(e){return function(t,r,i){return i&&typeof i!="number"&&dfe(t,r,i)&&(r=i=void 0),t=sT(t),r===void 0?(r=t,t=0):r=sT(r),i=i===void 0?t<r?1:-1:sT(i),ffe(t,r,i,e)}}var mfe=pfe,gfe=mfe,yfe=gfe(),_fe=yfe;const ox=Xr(_fe);function Qg(e){"@babel/helpers - typeof";return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qg(e)}function jL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function FL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jL(Object(r),!0).forEach(function(i){J5(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function J5(e,t,r){return t=vfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vfe(e){var t=xfe(e,"string");return Qg(t)=="symbol"?t:t+""}function xfe(e,t){if(Qg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(Qg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bfe=["Webkit","Moz","O","ms"],wfe=function(t,r){var i=t.replace(/(\w)/,function(h){return h.toUpperCase()}),u=bfe.reduce(function(h,p){return FL(FL({},h),{},J5({},p+i,r))},{});return u[t]=r,u};function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function ax(){return ax=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ax.apply(this,arguments)}function $L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function lT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$L(Object(r),!0).forEach(function(i){Po(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$L(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Tfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NL(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,eF(i.key),i)}}function Sfe(e,t,r){return t&&NL(e.prototype,t),r&&NL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Efe(e,t,r){return t=sx(t),Afe(e,Q5()?Reflect.construct(t,r||[],sx(e).constructor):t.apply(e,r))}function Afe(e,t){if(t&&(ad(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pfe(e)}function Pfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q5(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q5=function(){return!!e})()}function sx(e){return sx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sx(e)}function Mfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TE(e,t)}function TE(e,t){return TE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},TE(e,t)}function Po(e,t,r){return t=eF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eF(e){var t=Cfe(e,"string");return ad(t)=="symbol"?t:t+""}function Cfe(e,t){if(ad(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(ad(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ofe=function(t){var r=t.data,i=t.startIndex,u=t.endIndex,h=t.x,p=t.width,_=t.travellerWidth;if(!r||!r.length)return{};var o=r.length,x=tg().domain(ox(0,o)).range([h,h+p-_]),E=x.domain().map(function(A){return x(A)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:x(i),endX:x(u),scale:x,scaleValues:E}},UL=function(t){return t.changedTouches&&!!t.changedTouches.length},sd=function(e){function t(r){var i;return Tfe(this,t),i=Efe(this,t,[r]),Po(i,"handleDrag",function(u){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(u):i.state.isSlideMoving&&i.handleSlideDrag(u)}),Po(i,"handleTouchMove",function(u){u.changedTouches!=null&&u.changedTouches.length>0&&i.handleDrag(u.changedTouches[0])}),Po(i,"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var u=i.props,h=u.endIndex,p=u.onDragEnd,_=u.startIndex;p==null||p({endIndex:h,startIndex:_})}),i.detachDragEndListener()}),Po(i,"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),Po(i,"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),Po(i,"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),Po(i,"handleSlideDragStart",function(u){var h=UL(u)?u.changedTouches[0]:u;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:h.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(i,"startX"),endX:i.handleTravellerDragStart.bind(i,"endX")},i.state={},i}return Mfe(t,e),Sfe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var u=i.startX,h=i.endX,p=this.state.scaleValues,_=this.props,o=_.gap,x=_.data,E=x.length-1,A=Math.min(u,h),O=Math.max(u,h),L=t.getIndexInRange(p,A),j=t.getIndexInRange(p,O);return{startIndex:L-L%o,endIndex:j===E?E:j-j%o}}},{key:"getTextOfTick",value:function(i){var u=this.props,h=u.data,p=u.tickFormatter,_=u.dataKey,o=xs(h[i],_,i);return xr(p)?p(o,i):o}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var u=this.state,h=u.slideMoveStartX,p=u.startX,_=u.endX,o=this.props,x=o.x,E=o.width,A=o.travellerWidth,O=o.startIndex,L=o.endIndex,j=o.onChange,F=i.pageX-h;F>0?F=Math.min(F,x+E-A-_,x+E-A-p):F<0&&(F=Math.max(F,x-p,x-_));var Z=this.getIndex({startX:p+F,endX:_+F});(Z.startIndex!==O||Z.endIndex!==L)&&j&&j(Z),this.setState({startX:p+F,endX:_+F,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,u){var h=UL(u)?u.changedTouches[0]:u;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:h.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var u=this.state,h=u.brushMoveStartX,p=u.movingTravellerId,_=u.endX,o=u.startX,x=this.state[p],E=this.props,A=E.x,O=E.width,L=E.travellerWidth,j=E.onChange,F=E.gap,Z=E.data,$={startX:this.state.startX,endX:this.state.endX},V=i.pageX-h;V>0?V=Math.min(V,A+O-L-x):V<0&&(V=Math.max(V,A-x)),$[p]=x+V;var U=this.getIndex($),G=U.startIndex,q=U.endIndex,K=function(){var pe=Z.length-1;return p==="startX"&&(_>o?G%F===0:q%F===0)||_<o&&q===pe||p==="endX"&&(_>o?q%F===0:G%F===0)||_>o&&q===pe};this.setState(Po(Po({},p,x+V),"brushMoveStartX",i.pageX),function(){j&&K()&&j(U)})}},{key:"handleTravellerMoveKeyboard",value:function(i,u){var h=this,p=this.state,_=p.scaleValues,o=p.startX,x=p.endX,E=this.state[u],A=_.indexOf(E);if(A!==-1){var O=A+i;if(!(O===-1||O>=_.length)){var L=_[O];u==="startX"&&L>=x||u==="endX"&&L<=o||this.setState(Po({},u,L),function(){h.props.onChange(h.getIndex({startX:h.state.startX,endX:h.state.endX}))})}}}},{key:"renderBackground",value:function(){var i=this.props,u=i.x,h=i.y,p=i.width,_=i.height,o=i.fill,x=i.stroke;return Fe.createElement("rect",{stroke:x,fill:o,x:u,y:h,width:p,height:_})}},{key:"renderPanorama",value:function(){var i=this.props,u=i.x,h=i.y,p=i.width,_=i.height,o=i.data,x=i.children,E=i.padding,A=De.Children.only(x);return A?Fe.cloneElement(A,{x:u,y:h,width:p,height:_,margin:E,compact:!0,data:o}):null}},{key:"renderTravellerLayer",value:function(i,u){var h,p,_=this,o=this.props,x=o.y,E=o.travellerWidth,A=o.height,O=o.traveller,L=o.ariaLabel,j=o.data,F=o.startIndex,Z=o.endIndex,$=Math.max(i,this.props.x),V=lT(lT({},Hr(this.props,!1)),{},{x:$,y:x,width:E,height:A}),U=L||"Min value: ".concat((h=j[F])===null||h===void 0?void 0:h.name,", Max value: ").concat((p=j[Z])===null||p===void 0?void 0:p.name);return Fe.createElement(xi,{tabIndex:0,role:"slider","aria-label":U,"aria-valuenow":i,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[u],onTouchStart:this.travellerDragStartHandlers[u],onKeyDown:function(q){["ArrowLeft","ArrowRight"].includes(q.key)&&(q.preventDefault(),q.stopPropagation(),_.handleTravellerMoveKeyboard(q.key==="ArrowRight"?1:-1,u))},onFocus:function(){_.setState({isTravellerFocused:!0})},onBlur:function(){_.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(O,V))}},{key:"renderSlide",value:function(i,u){var h=this.props,p=h.y,_=h.height,o=h.stroke,x=h.travellerWidth,E=Math.min(i,u)+x,A=Math.max(Math.abs(u-i)-x,0);return Fe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:o,fillOpacity:.2,x:E,y:p,width:A,height:_})}},{key:"renderText",value:function(){var i=this.props,u=i.startIndex,h=i.endIndex,p=i.y,_=i.height,o=i.travellerWidth,x=i.stroke,E=this.state,A=E.startX,O=E.endX,L=5,j={pointerEvents:"none",fill:x};return Fe.createElement(xi,{className:"recharts-brush-texts"},Fe.createElement(R0,ax({textAnchor:"end",verticalAnchor:"middle",x:Math.min(A,O)-L,y:p+_/2},j),this.getTextOfTick(u)),Fe.createElement(R0,ax({textAnchor:"start",verticalAnchor:"middle",x:Math.max(A,O)+o+L,y:p+_/2},j),this.getTextOfTick(h)))}},{key:"render",value:function(){var i=this.props,u=i.data,h=i.className,p=i.children,_=i.x,o=i.y,x=i.width,E=i.height,A=i.alwaysShowText,O=this.state,L=O.startX,j=O.endX,F=O.isTextActive,Z=O.isSlideMoving,$=O.isTravellerMoving,V=O.isTravellerFocused;if(!u||!u.length||!zt(_)||!zt(o)||!zt(x)||!zt(E)||x<=0||E<=0)return null;var U=en("recharts-brush",h),G=Fe.Children.count(p)===1,q=wfe("userSelect","none");return Fe.createElement(xi,{className:U,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:q},this.renderBackground(),G&&this.renderPanorama(),this.renderSlide(L,j),this.renderTravellerLayer(L,"startX"),this.renderTravellerLayer(j,"endX"),(F||Z||$||V||A)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var u=i.x,h=i.y,p=i.width,_=i.height,o=i.stroke,x=Math.floor(h+_/2)-1;return Fe.createElement(Fe.Fragment,null,Fe.createElement("rect",{x:u,y:h,width:p,height:_,fill:o,stroke:"none"}),Fe.createElement("line",{x1:u+1,y1:x,x2:u+p-1,y2:x,fill:"none",stroke:"#fff"}),Fe.createElement("line",{x1:u+1,y1:x+2,x2:u+p-1,y2:x+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,u){var h;return Fe.isValidElement(i)?h=Fe.cloneElement(i,u):xr(i)?h=i(u):h=t.renderDefaultTraveller(u),h}},{key:"getDerivedStateFromProps",value:function(i,u){var h=i.data,p=i.width,_=i.x,o=i.travellerWidth,x=i.updateId,E=i.startIndex,A=i.endIndex;if(h!==u.prevData||x!==u.prevUpdateId)return lT({prevData:h,prevTravellerWidth:o,prevUpdateId:x,prevX:_,prevWidth:p},h&&h.length?Ofe({data:h,width:p,x:_,travellerWidth:o,startIndex:E,endIndex:A}):{scale:null,scaleValues:null});if(u.scale&&(p!==u.prevWidth||_!==u.prevX||o!==u.prevTravellerWidth)){u.scale.range([_,_+p-o]);var O=u.scale.domain().map(function(L){return u.scale(L)});return{prevData:h,prevTravellerWidth:o,prevUpdateId:x,prevX:_,prevWidth:p,startX:u.scale(i.startIndex),endX:u.scale(i.endIndex),scaleValues:O}}return null}},{key:"getIndexInRange",value:function(i,u){for(var h=i.length,p=0,_=h-1;_-p>1;){var o=Math.floor((p+_)/2);i[o]>u?_=o:p=o}return u>=i[_]?_:p}}])}(De.PureComponent);Po(sd,"displayName","Brush");Po(sd,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Ife=hP;function kfe(e,t){var r;return Ife(e,function(i,u,h){return r=t(i,u,h),!r}),!!r}var Dfe=kfe,Lfe=nj,zfe=xu,Rfe=Dfe,Bfe=xo,jfe=s1;function Ffe(e,t,r){var i=Bfe(e)?Lfe:Rfe;return r&&jfe(e,t,r)&&(t=void 0),i(e,zfe(t))}var $fe=Ffe;const Nfe=Xr($fe);var _s=function(t,r){var i=t.alwaysShow,u=t.ifOverflow;return i&&(u="extendDomain"),u===r},VL=Ej;function Ufe(e,t,r){t=="__proto__"&&VL?VL(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Vfe=Ufe,Gfe=Vfe,Wfe=Tj,qfe=xu;function Zfe(e,t){var r={};return t=qfe(t),Wfe(e,function(i,u,h){Gfe(r,u,t(i,u,h))}),r}var Hfe=Zfe;const Xfe=Xr(Hfe);function Kfe(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(!t(e[r],r,e))return!1;return!0}var Yfe=Kfe,Jfe=hP;function Qfe(e,t){var r=!0;return Jfe(e,function(i,u,h){return r=!!t(i,u,h),r}),r}var ede=Qfe,tde=Yfe,rde=ede,nde=xu,ide=xo,ode=s1;function ade(e,t,r){var i=ide(e)?tde:rde;return r&&ode(e,t,r)&&(t=void 0),i(e,nde(t))}var sde=ade;const tF=Xr(sde);var lde=["x","y"];function ey(e){"@babel/helpers - typeof";return ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ey(e)}function SE(){return SE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},SE.apply(this,arguments)}function GL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Rm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GL(Object(r),!0).forEach(function(i){ude(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function ude(e,t,r){return t=cde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cde(e){var t=hde(e,"string");return ey(t)=="symbol"?t:t+""}function hde(e,t){if(ey(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(ey(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fde(e,t){if(e==null)return{};var r=dde(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function dde(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function pde(e,t){var r=e.x,i=e.y,u=fde(e,lde),h="".concat(r),p=parseInt(h,10),_="".concat(i),o=parseInt(_,10),x="".concat(t.height||u.height),E=parseInt(x,10),A="".concat(t.width||u.width),O=parseInt(A,10);return Rm(Rm(Rm(Rm(Rm({},t),u),p?{x:p}:{}),o?{y:o}:{}),{},{height:E,width:O,name:t.name,radius:t.radius})}function WL(e){return Fe.createElement(Yhe,SE({shapeType:"rectangle",propTransformer:pde,activeClassName:"recharts-active-bar"},e))}var mde=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(i,u){if(typeof t=="number")return t;var h=typeof i=="number";return h?t(i,u):(h||Fc(),r)}},gde=["value","background"],rF;function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function yde(e,t){if(e==null)return{};var r=_de(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function _de(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function lx(){return lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},lx.apply(this,arguments)}function qL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Qn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qL(Object(r),!0).forEach(function(i){eu(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function vde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZL(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,iF(i.key),i)}}function xde(e,t,r){return t&&ZL(e.prototype,t),r&&ZL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bde(e,t,r){return t=ux(t),wde(e,nF()?Reflect.construct(t,r||[],ux(e).constructor):t.apply(e,r))}function wde(e,t){if(t&&(ld(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tde(e)}function Tde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nF=function(){return!!e})()}function ux(e){return ux=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ux(e)}function Sde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EE(e,t)}function EE(e,t){return EE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},EE(e,t)}function eu(e,t,r){return t=iF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iF(e){var t=Ede(e,"string");return ld(t)=="symbol"?t:t+""}function Ede(e,t){if(ld(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(ld(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ld=function(e){function t(){var r;vde(this,t);for(var i=arguments.length,u=new Array(i),h=0;h<i;h++)u[h]=arguments[h];return r=bde(this,t,[].concat(u)),eu(r,"state",{isAnimationFinished:!1}),eu(r,"id",e1("recharts-bar-")),eu(r,"handleAnimationEnd",function(){var p=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),p&&p()}),eu(r,"handleAnimationStart",function(){var p=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),p&&p()}),r}return Sde(t,e),xde(t,[{key:"renderRectanglesStatically",value:function(i){var u=this,h=this.props,p=h.shape,_=h.dataKey,o=h.activeIndex,x=h.activeBar,E=Hr(this.props,!1);return i&&i.map(function(A,O){var L=O===o,j=L?x:p,F=Qn(Qn(Qn({},E),A),{},{isActive:L,option:j,index:O,dataKey:_,onAnimationStart:u.handleAnimationStart,onAnimationEnd:u.handleAnimationEnd});return Fe.createElement(xi,lx({className:"recharts-bar-rectangle"},w0(u.props,A,O),{key:"rectangle-".concat(A==null?void 0:A.x,"-").concat(A==null?void 0:A.y,"-").concat(A==null?void 0:A.value,"-").concat(O)}),Fe.createElement(WL,F))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,u=this.props,h=u.data,p=u.layout,_=u.isAnimationActive,o=u.animationBegin,x=u.animationDuration,E=u.animationEasing,A=u.animationId,O=this.state.prevData;return Fe.createElement(pu,{begin:o,duration:x,isActive:_,easing:E,from:{t:0},to:{t:1},key:"bar-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(L){var j=L.t,F=h.map(function(Z,$){var V=O&&O[$];if(V){var U=Qh(V.x,Z.x),G=Qh(V.y,Z.y),q=Qh(V.width,Z.width),K=Qh(V.height,Z.height);return Qn(Qn({},Z),{},{x:U(j),y:G(j),width:q(j),height:K(j)})}if(p==="horizontal"){var re=Qh(0,Z.height),pe=re(j);return Qn(Qn({},Z),{},{y:Z.y+Z.height-pe,height:pe})}var xe=Qh(0,Z.width),ge=xe(j);return Qn(Qn({},Z),{},{width:ge})});return Fe.createElement(xi,null,i.renderRectanglesStatically(F))})}},{key:"renderRectangles",value:function(){var i=this.props,u=i.data,h=i.isAnimationActive,p=this.state.prevData;return h&&u&&u.length&&(!p||!RP(p,u))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(u)}},{key:"renderBackground",value:function(){var i=this,u=this.props,h=u.data,p=u.dataKey,_=u.activeIndex,o=Hr(this.props.background,!1);return h.map(function(x,E){x.value;var A=x.background,O=yde(x,gde);if(!A)return null;var L=Qn(Qn(Qn(Qn(Qn({},O),{},{fill:"#eee"},A),o),w0(i.props,x,E)),{},{onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd,dataKey:p,index:E,className:"recharts-bar-background-rectangle"});return Fe.createElement(WL,lx({key:"background-bar-".concat(E),option:i.props.background,isActive:E===_},L))})}},{key:"renderErrorBar",value:function(i,u){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var h=this.props,p=h.data,_=h.xAxis,o=h.yAxis,x=h.layout,E=h.children,A=Ha(E,_1);if(!A)return null;var O=x==="vertical"?p[0].height/2:p[0].width/2,L=function(Z,$){var V=Array.isArray(Z.value)?Z.value[1]:Z.value;return{x:Z.x,y:Z.y,value:V,errorVal:xs(Z,$)}},j={clipPath:i?"url(#clipPath-".concat(u,")"):null};return Fe.createElement(xi,j,A.map(function(F){return Fe.cloneElement(F,{key:"error-bar-".concat(u,"-").concat(F.props.dataKey),data:p,xAxis:_,yAxis:o,layout:x,offset:O,dataPointFormatter:L})}))}},{key:"render",value:function(){var i=this.props,u=i.hide,h=i.data,p=i.className,_=i.xAxis,o=i.yAxis,x=i.left,E=i.top,A=i.width,O=i.height,L=i.isAnimationActive,j=i.background,F=i.id;if(u||!h||!h.length)return null;var Z=this.state.isAnimationFinished,$=en("recharts-bar",p),V=_&&_.allowDataOverflow,U=o&&o.allowDataOverflow,G=V||U,q=Qr(F)?this.id:F;return Fe.createElement(xi,{className:$},V||U?Fe.createElement("defs",null,Fe.createElement("clipPath",{id:"clipPath-".concat(q)},Fe.createElement("rect",{x:V?x:x-A/2,y:U?E:E-O/2,width:V?A:A*2,height:U?O:O*2}))):null,Fe.createElement(xi,{className:"recharts-bar-rectangles",clipPath:G?"url(#clipPath-".concat(q,")"):null},j?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(G,q),(!L||Z)&&Oc.renderCallByParent(this.props,h))}}],[{key:"getDerivedStateFromProps",value:function(i,u){return i.animationId!==u.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:u.curData}:i.data!==u.curData?{curData:i.data}:null}}])}(De.PureComponent);rF=Ld;eu(Ld,"displayName","Bar");eu(Ld,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!gy.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});eu(Ld,"getComposedData",function(e){var t=e.props,r=e.item,i=e.barPosition,u=e.bandSize,h=e.xAxis,p=e.yAxis,_=e.xAxisTicks,o=e.yAxisTicks,x=e.stackedData,E=e.dataStartIndex,A=e.displayedData,O=e.offset,L=ale(i,r);if(!L)return null;var j=t.layout,F=r.type.defaultProps,Z=F!==void 0?Qn(Qn({},F),r.props):r.props,$=Z.dataKey,V=Z.children,U=Z.minPointSize,G=j==="horizontal"?p:h,q=x?G.scale.domain():null,K=ple({numericAxis:G}),re=Ha(V,kj),pe=A.map(function(xe,ge){var Be,$e,Ve,be,_e,Me;x?Be=sle(x[E+ge],q):(Be=xs(xe,$),Array.isArray(Be)||(Be=[K,Be]));var ke=mde(U,rF.defaultProps.minPointSize)(Be[1],ge);if(j==="horizontal"){var Ce,Oe=[p.scale(Be[0]),p.scale(Be[1])],at=Oe[0],ft=Oe[1];$e=W3({axis:h,ticks:_,bandSize:u,offset:L.offset,entry:xe,index:ge}),Ve=(Ce=ft??at)!==null&&Ce!==void 0?Ce:void 0,be=L.size;var st=at-ft;if(_e=Number.isNaN(st)?0:st,Me={x:$e,y:p.y,width:be,height:p.height},Math.abs(ke)>0&&Math.abs(_e)<Math.abs(ke)){var Ot=Wa(_e||ke)*(Math.abs(ke)-Math.abs(_e));Ve-=Ot,_e+=Ot}}else{var St=[h.scale(Be[0]),h.scale(Be[1])],pr=St[0],Tr=St[1];if($e=pr,Ve=W3({axis:p,ticks:o,bandSize:u,offset:L.offset,entry:xe,index:ge}),be=Tr-pr,_e=L.size,Me={x:h.x,y:Ve,width:h.width,height:_e},Math.abs(ke)>0&&Math.abs(be)<Math.abs(ke)){var Kr=Wa(be||ke)*(Math.abs(ke)-Math.abs(be));be+=Kr}}return Qn(Qn(Qn({},xe),{},{x:$e,y:Ve,width:be,height:_e,value:x?Be:Be[1],payload:xe,background:Me},re&&re[ge]&&re[ge].props),{},{tooltipPayload:[j5(r,xe)],tooltipPosition:{x:$e+be/2,y:Ve+_e/2}})});return Qn({data:pe,layout:j},O)});function ty(e){"@babel/helpers - typeof";return ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ty(e)}function Ade(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HL(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,oF(i.key),i)}}function Pde(e,t,r){return t&&HL(e.prototype,t),r&&HL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function $a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XL(Object(r),!0).forEach(function(i){b1(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function b1(e,t,r){return t=oF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oF(e){var t=Mde(e,"string");return ty(t)=="symbol"?t:t+""}function Mde(e,t){if(ty(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(ty(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cde=function(t,r,i,u,h){var p=t.width,_=t.height,o=t.layout,x=t.children,E=Object.keys(r),A={left:i.left,leftMirror:i.left,right:p-i.right,rightMirror:p-i.right,top:i.top,topMirror:i.top,bottom:_-i.bottom,bottomMirror:_-i.bottom},O=!!Co(x,Ld);return E.reduce(function(L,j){var F=r[j],Z=F.orientation,$=F.domain,V=F.padding,U=V===void 0?{}:V,G=F.mirror,q=F.reversed,K="".concat(Z).concat(G?"Mirror":""),re,pe,xe,ge,Be;if(F.type==="number"&&(F.padding==="gap"||F.padding==="no-gap")){var $e=$[1]-$[0],Ve=1/0,be=F.categoricalDomain.sort();if(be.forEach(function(St,pr){pr>0&&(Ve=Math.min((St||0)-(be[pr-1]||0),Ve))}),Number.isFinite(Ve)){var _e=Ve/$e,Me=F.layout==="vertical"?i.height:i.width;if(F.padding==="gap"&&(re=_e*Me/2),F.padding==="no-gap"){var ke=Bc(t.barCategoryGap,_e*Me),Ce=_e*Me/2;re=Ce-ke-(Ce-ke)/Me*ke}}}u==="xAxis"?pe=[i.left+(U.left||0)+(re||0),i.left+i.width-(U.right||0)-(re||0)]:u==="yAxis"?pe=o==="horizontal"?[i.top+i.height-(U.bottom||0),i.top+(U.top||0)]:[i.top+(U.top||0)+(re||0),i.top+i.height-(U.bottom||0)-(re||0)]:pe=F.range,q&&(pe=[pe[1],pe[0]]);var Oe=ile(F,h,O),at=Oe.scale,ft=Oe.realScaleType;at.domain($).range(pe),ole(at);var st=dle(at,$a($a({},F),{},{realScaleType:ft}));u==="xAxis"?(Be=Z==="top"&&!G||Z==="bottom"&&G,xe=i.left,ge=A[K]-Be*F.height):u==="yAxis"&&(Be=Z==="left"&&!G||Z==="right"&&G,xe=A[K]-Be*F.width,ge=i.top);var Ot=$a($a($a({},F),st),{},{realScaleType:ft,x:xe,y:ge,scale:at,width:u==="xAxis"?i.width:F.width,height:u==="yAxis"?i.height:F.height});return Ot.bandSize=K0(Ot,st),!F.hide&&u==="xAxis"?A[K]+=(Be?-1:1)*Ot.height:F.hide||(A[K]+=(Be?-1:1)*Ot.width),$a($a({},L),{},b1({},j,Ot))},{})},aF=function(t,r){var i=t.x,u=t.y,h=r.x,p=r.y;return{x:Math.min(i,h),y:Math.min(u,p),width:Math.abs(h-i),height:Math.abs(p-u)}},Ode=function(t){var r=t.x1,i=t.y1,u=t.x2,h=t.y2;return aF({x:r,y:i},{x:u,y:h})},sF=function(){function e(t){Ade(this,e),this.scale=t}return Pde(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=i.bandAware,h=i.position;if(r!==void 0){if(h)switch(h){case"start":return this.scale(r);case"middle":{var p=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+p}case"end":{var _=this.bandwidth?this.bandwidth():0;return this.scale(r)+_}default:return this.scale(r)}if(u){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}return this.scale(r)}}},{key:"isInRange",value:function(r){var i=this.range(),u=i[0],h=i[i.length-1];return u<=h?r>=u&&r<=h:r>=h&&r<=u}}],[{key:"create",value:function(r){return new e(r)}}])}();b1(sF,"EPS",1e-4);var NP=function(t){var r=Object.keys(t).reduce(function(i,u){return $a($a({},i),{},b1({},u,sF.create(t[u])))},{});return $a($a({},r),{},{apply:function(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=h.bandAware,_=h.position;return Xfe(u,function(o,x){return r[x].apply(o,{bandAware:p,position:_})})},isInRange:function(u){return tF(u,function(h,p){return r[p].isInRange(h)})}})};function Ide(e){return(e%180+180)%180}var kde=function(t){var r=t.width,i=t.height,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=Ide(u),p=h*Math.PI/180,_=Math.atan(i/r),o=p>_&&p<Math.PI-_?i/Math.sin(p):r/Math.cos(p);return Math.abs(o)},Dde=xu,Lde=my,zde=o1;function Rde(e){return function(t,r,i){var u=Object(t);if(!Lde(t)){var h=Dde(r);t=zde(t),r=function(_){return h(u[_],_,u)}}var p=e(t,r,i);return p>-1?u[h?t[p]:p]:void 0}}var Bde=Rde,jde=Y5;function Fde(e){var t=jde(e),r=t%1;return t===t?r?t-r:t:0}var $de=Fde,Nde=yj,Ude=xu,Vde=$de,Gde=Math.max;function Wde(e,t,r){var i=e==null?0:e.length;if(!i)return-1;var u=r==null?0:Vde(r);return u<0&&(u=Gde(i+u,0)),Nde(e,Ude(t),u)}var qde=Wde,Zde=Bde,Hde=qde,Xde=Zde(Hde),Kde=Xde;const Yde=Xr(Kde);var Jde=qq(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),UP=De.createContext(void 0),VP=De.createContext(void 0),lF=De.createContext(void 0),uF=De.createContext({}),cF=De.createContext(void 0),hF=De.createContext(0),fF=De.createContext(0),KL=function(t){var r=t.state,i=r.xAxisMap,u=r.yAxisMap,h=r.offset,p=t.clipPathId,_=t.children,o=t.width,x=t.height,E=Jde(h);return Fe.createElement(UP.Provider,{value:i},Fe.createElement(VP.Provider,{value:u},Fe.createElement(uF.Provider,{value:h},Fe.createElement(lF.Provider,{value:E},Fe.createElement(cF.Provider,{value:p},Fe.createElement(hF.Provider,{value:x},Fe.createElement(fF.Provider,{value:o},_)))))))},Qde=function(){return De.useContext(cF)},dF=function(t){var r=De.useContext(UP);r==null&&Fc();var i=r[t];return i==null&&Fc(),i},epe=function(){var t=De.useContext(UP);return Yl(t)},tpe=function(){var t=De.useContext(VP),r=Yde(t,function(i){return tF(i.domain,Number.isFinite)});return r||Yl(t)},pF=function(t){var r=De.useContext(VP);r==null&&Fc();var i=r[t];return i==null&&Fc(),i},rpe=function(){var t=De.useContext(lF);return t},npe=function(){return De.useContext(uF)},GP=function(){return De.useContext(fF)},WP=function(){return De.useContext(hF)};function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function ipe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ope(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,gF(i.key),i)}}function ape(e,t,r){return t&&ope(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function spe(e,t,r){return t=cx(t),lpe(e,mF()?Reflect.construct(t,r||[],cx(e).constructor):t.apply(e,r))}function lpe(e,t){if(t&&(ud(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return upe(e)}function upe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mF=function(){return!!e})()}function cx(e){return cx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cx(e)}function cpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AE(e,t)}function AE(e,t){return AE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},AE(e,t)}function YL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function JL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YL(Object(r),!0).forEach(function(i){qP(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YL(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function qP(e,t,r){return t=gF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gF(e){var t=hpe(e,"string");return ud(t)=="symbol"?t:t+""}function hpe(e,t){if(ud(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(ud(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function fpe(e,t){return gpe(e)||mpe(e,t)||ppe(e,t)||dpe()}function dpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ppe(e,t){if(e){if(typeof e=="string")return QL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QL(e,t)}}function QL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function mpe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t!==0)for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function gpe(e){if(Array.isArray(e))return e}function PE(){return PE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},PE.apply(this,arguments)}var ype=function(t,r){var i;return Fe.isValidElement(t)?i=Fe.cloneElement(t,r):xr(t)?i=t(r):i=Fe.createElement("line",PE({},r,{className:"recharts-reference-line-line"})),i},_pe=function(t,r,i,u,h,p,_,o,x){var E=h.x,A=h.y,O=h.width,L=h.height;if(i){var j=x.y,F=t.y.apply(j,{position:p});if(_s(x,"discard")&&!t.y.isInRange(F))return null;var Z=[{x:E+O,y:F},{x:E,y:F}];return o==="left"?Z.reverse():Z}if(r){var $=x.x,V=t.x.apply($,{position:p});if(_s(x,"discard")&&!t.x.isInRange(V))return null;var U=[{x:V,y:A+L},{x:V,y:A}];return _==="top"?U.reverse():U}if(u){var G=x.segment,q=G.map(function(K){return t.apply(K,{position:p})});return _s(x,"discard")&&Nfe(q,function(K){return!t.isInRange(K)})?null:q}return null};function vpe(e){var t=e.x,r=e.y,i=e.segment,u=e.xAxisId,h=e.yAxisId,p=e.shape,_=e.className,o=e.alwaysShow,x=Qde(),E=dF(u),A=pF(h),O=rpe();if(!x||!O)return null;tl(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var L=NP({x:E.scale,y:A.scale}),j=ci(t),F=ci(r),Z=i&&i.length===2,$=_pe(L,j,F,Z,O,e.position,E.orientation,A.orientation,e);if(!$)return null;var V=fpe($,2),U=V[0],G=U.x,q=U.y,K=V[1],re=K.x,pe=K.y,xe=_s(e,"hidden")?"url(#".concat(x,")"):void 0,ge=JL(JL({clipPath:xe},Hr(e,!0)),{},{x1:G,y1:q,x2:re,y2:pe});return Fe.createElement(xi,{className:en("recharts-reference-line",_)},ype(p,ge),Ui.renderCallByParent(e,Ode({x1:G,y1:q,x2:re,y2:pe})))}var ZP=function(e){function t(){return ipe(this,t),spe(this,t,arguments)}return cpe(t,e),ape(t,[{key:"render",value:function(){return Fe.createElement(vpe,this.props)}}])}(Fe.Component);qP(ZP,"displayName","ReferenceLine");qP(ZP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function ME(){return ME=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ME.apply(this,arguments)}function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function ez(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function tz(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ez(Object(r),!0).forEach(function(i){w1(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ez(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function xpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bpe(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_F(i.key),i)}}function wpe(e,t,r){return t&&bpe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tpe(e,t,r){return t=hx(t),Spe(e,yF()?Reflect.construct(t,r||[],hx(e).constructor):t.apply(e,r))}function Spe(e,t){if(t&&(cd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Epe(e)}function Epe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yF=function(){return!!e})()}function hx(e){return hx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hx(e)}function Ape(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CE(e,t)}function CE(e,t){return CE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},CE(e,t)}function w1(e,t,r){return t=_F(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _F(e){var t=Ppe(e,"string");return cd(t)=="symbol"?t:t+""}function Ppe(e,t){if(cd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(cd(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Mpe=function(t){var r=t.x,i=t.y,u=t.xAxis,h=t.yAxis,p=NP({x:u.scale,y:h.scale}),_=p.apply({x:r,y:i},{bandAware:!0});return _s(t,"discard")&&!p.isInRange(_)?null:_},T1=function(e){function t(){return xpe(this,t),Tpe(this,t,arguments)}return Ape(t,e),wpe(t,[{key:"render",value:function(){var i=this.props,u=i.x,h=i.y,p=i.r,_=i.alwaysShow,o=i.clipPathId,x=ci(u),E=ci(h);if(tl(_===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!x||!E)return null;var A=Mpe(this.props);if(!A)return null;var O=A.x,L=A.y,j=this.props,F=j.shape,Z=j.className,$=_s(this.props,"hidden")?"url(#".concat(o,")"):void 0,V=tz(tz({clipPath:$},Hr(this.props,!0)),{},{cx:O,cy:L});return Fe.createElement(xi,{className:en("recharts-reference-dot",Z)},t.renderDot(F,V),Ui.renderCallByParent(this.props,{x:O-p,y:L-p,width:2*p,height:2*p}))}}])}(Fe.Component);w1(T1,"displayName","ReferenceDot");w1(T1,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});w1(T1,"renderDot",function(e,t){var r;return Fe.isValidElement(e)?r=Fe.cloneElement(e,t):xr(e)?r=e(t):r=Fe.createElement(X5,ME({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function OE(){return OE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},OE.apply(this,arguments)}function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}function rz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function nz(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rz(Object(r),!0).forEach(function(i){S1(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rz(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Cpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ope(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,xF(i.key),i)}}function Ipe(e,t,r){return t&&Ope(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kpe(e,t,r){return t=fx(t),Dpe(e,vF()?Reflect.construct(t,r||[],fx(e).constructor):t.apply(e,r))}function Dpe(e,t){if(t&&(hd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lpe(e)}function Lpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vF=function(){return!!e})()}function fx(e){return fx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fx(e)}function zpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IE(e,t)}function IE(e,t){return IE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},IE(e,t)}function S1(e,t,r){return t=xF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xF(e){var t=Rpe(e,"string");return hd(t)=="symbol"?t:t+""}function Rpe(e,t){if(hd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(hd(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Bpe=function(t,r,i,u,h){var p=h.x1,_=h.x2,o=h.y1,x=h.y2,E=h.xAxis,A=h.yAxis;if(!E||!A)return null;var O=NP({x:E.scale,y:A.scale}),L={x:t?O.x.apply(p,{position:"start"}):O.x.rangeMin,y:i?O.y.apply(o,{position:"start"}):O.y.rangeMin},j={x:r?O.x.apply(_,{position:"end"}):O.x.rangeMax,y:u?O.y.apply(x,{position:"end"}):O.y.rangeMax};return _s(h,"discard")&&(!O.isInRange(L)||!O.isInRange(j))?null:aF(L,j)},E1=function(e){function t(){return Cpe(this,t),kpe(this,t,arguments)}return zpe(t,e),Ipe(t,[{key:"render",value:function(){var i=this.props,u=i.x1,h=i.x2,p=i.y1,_=i.y2,o=i.className,x=i.alwaysShow,E=i.clipPathId;tl(x===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var A=ci(u),O=ci(h),L=ci(p),j=ci(_),F=this.props.shape;if(!A&&!O&&!L&&!j&&!F)return null;var Z=Bpe(A,O,L,j,this.props);if(!Z&&!F)return null;var $=_s(this.props,"hidden")?"url(#".concat(E,")"):void 0;return Fe.createElement(xi,{className:en("recharts-reference-area",o)},t.renderRect(F,nz(nz({clipPath:$},Hr(this.props,!0)),Z)),Ui.renderCallByParent(this.props,Z))}}])}(Fe.Component);S1(E1,"displayName","ReferenceArea");S1(E1,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});S1(E1,"renderRect",function(e,t){var r;return Fe.isValidElement(e)?r=Fe.cloneElement(e,t):xr(e)?r=e(t):r=Fe.createElement($P,OE({},t,{className:"recharts-reference-area-rect"})),r});function bF(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var i=[],u=0;u<e.length;u+=t)i.push(e[u]);return i}function jpe(e,t,r){var i={width:e.width+t.width,height:e.height+t.height};return kde(i,r)}function Fpe(e,t,r){var i=r==="width",u=e.x,h=e.y,p=e.width,_=e.height;return t===1?{start:i?u:h,end:i?u+p:h+_}:{start:i?u+p:h+_,end:i?u:h}}function dx(e,t,r,i,u){if(e*t<e*i||e*t>e*u)return!1;var h=r();return e*(t-e*h/2-i)>=0&&e*(t+e*h/2-u)<=0}function $pe(e,t){return bF(e,t+1)}function Npe(e,t,r,i,u){for(var h=(i||[]).slice(),p=t.start,_=t.end,o=0,x=1,E=p,A=function(){var j=i==null?void 0:i[o];if(j===void 0)return{v:bF(i,x)};var F=o,Z,$=function(){return Z===void 0&&(Z=r(j,F)),Z},V=j.coordinate,U=o===0||dx(e,V,$,E,_);U||(o=0,E=p,x+=1),U&&(E=V+e*($()/2+u),o+=x)},O;x<=h.length;)if(O=A(),O)return O.v;return[]}function ry(e){"@babel/helpers - typeof";return ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ry(e)}function iz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function $i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iz(Object(r),!0).forEach(function(i){Upe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iz(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Upe(e,t,r){return t=Vpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vpe(e){var t=Gpe(e,"string");return ry(t)=="symbol"?t:t+""}function Gpe(e,t){if(ry(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(ry(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wpe(e,t,r,i,u){for(var h=(i||[]).slice(),p=h.length,_=t.start,o=t.end,x=function(O){var L=h[O],j,F=function(){return j===void 0&&(j=r(L,O)),j};if(O===p-1){var Z=e*(L.coordinate+e*F()/2-o);h[O]=L=$i($i({},L),{},{tickCoord:Z>0?L.coordinate-Z*e:L.coordinate})}else h[O]=L=$i($i({},L),{},{tickCoord:L.coordinate});var $=dx(e,L.tickCoord,F,_,o);$&&(o=L.tickCoord-e*(F()/2+u),h[O]=$i($i({},L),{},{isShow:!0}))},E=p-1;E>=0;E--)x(E);return h}function qpe(e,t,r,i,u,h){var p=(i||[]).slice(),_=p.length,o=t.start,x=t.end;if(h){var E=i[_-1],A=r(E,_-1),O=e*(E.coordinate+e*A/2-x);p[_-1]=E=$i($i({},E),{},{tickCoord:O>0?E.coordinate-O*e:E.coordinate});var L=dx(e,E.tickCoord,function(){return A},o,x);L&&(x=E.tickCoord-e*(A/2+u),p[_-1]=$i($i({},E),{},{isShow:!0}))}for(var j=h?_-1:_,F=function(V){var U=p[V],G,q=function(){return G===void 0&&(G=r(U,V)),G};if(V===0){var K=e*(U.coordinate-e*q()/2-o);p[V]=U=$i($i({},U),{},{tickCoord:K<0?U.coordinate-K*e:U.coordinate})}else p[V]=U=$i($i({},U),{},{tickCoord:U.coordinate});var re=dx(e,U.tickCoord,q,o,x);re&&(o=U.tickCoord+e*(q()/2+u),p[V]=$i($i({},U),{},{isShow:!0}))},Z=0;Z<j;Z++)F(Z);return p}function HP(e,t,r){var i=e.tick,u=e.ticks,h=e.viewBox,p=e.minTickGap,_=e.orientation,o=e.interval,x=e.tickFormatter,E=e.unit,A=e.angle;if(!u||!u.length||!i)return[];if(zt(o)||gy.isSsr)return $pe(u,typeof o=="number"&&zt(o)?o:0);var O=[],L=_==="top"||_==="bottom"?"width":"height",j=E&&L==="width"?eg(E,{fontSize:t,letterSpacing:r}):{width:0,height:0},F=function(U,G){var q=xr(x)?x(U.value,G):U.value;return L==="width"?jpe(eg(q,{fontSize:t,letterSpacing:r}),j,A):eg(q,{fontSize:t,letterSpacing:r})[L]},Z=u.length>=2?Wa(u[1].coordinate-u[0].coordinate):1,$=Fpe(h,Z,L);return o==="equidistantPreserveStart"?Npe(Z,$,F,u,p):(o==="preserveStart"||o==="preserveStartEnd"?O=qpe(Z,$,F,u,p,o==="preserveStartEnd"):O=Wpe(Z,$,F,u,p),O.filter(function(V){return V.isShow}))}var Zpe=["viewBox"],Hpe=["viewBox"],Xpe=["ticks"];function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function bf(){return bf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},bf.apply(this,arguments)}function oz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Xi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oz(Object(r),!0).forEach(function(i){XP(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oz(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function uT(e,t){if(e==null)return{};var r=Kpe(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function Kpe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function Ype(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function az(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,TF(i.key),i)}}function Jpe(e,t,r){return t&&az(e.prototype,t),r&&az(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qpe(e,t,r){return t=px(t),eme(e,wF()?Reflect.construct(t,r||[],px(e).constructor):t.apply(e,r))}function eme(e,t){if(t&&(fd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tme(e)}function tme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wF=function(){return!!e})()}function px(e){return px=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},px(e)}function rme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kE(e,t)}function kE(e,t){return kE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},kE(e,t)}function XP(e,t,r){return t=TF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TF(e){var t=nme(e,"string");return fd(t)=="symbol"?t:t+""}function nme(e,t){if(fd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(fd(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zd=function(e){function t(r){var i;return Ype(this,t),i=Qpe(this,t,[r]),i.state={fontSize:"",letterSpacing:""},i}return rme(t,e),Jpe(t,[{key:"shouldComponentUpdate",value:function(i,u){var h=i.viewBox,p=uT(i,Zpe),_=this.props,o=_.viewBox,x=uT(_,Hpe);return!Lf(h,o)||!Lf(p,x)||!Lf(u,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var u=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];u&&this.setState({fontSize:window.getComputedStyle(u).fontSize,letterSpacing:window.getComputedStyle(u).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var u=this.props,h=u.x,p=u.y,_=u.width,o=u.height,x=u.orientation,E=u.tickSize,A=u.mirror,O=u.tickMargin,L,j,F,Z,$,V,U=A?-1:1,G=i.tickSize||E,q=zt(i.tickCoord)?i.tickCoord:i.coordinate;switch(x){case"top":L=j=i.coordinate,Z=p+ +!A*o,F=Z-U*G,V=F-U*O,$=q;break;case"left":F=Z=i.coordinate,j=h+ +!A*_,L=j-U*G,$=L-U*O,V=q;break;case"right":F=Z=i.coordinate,j=h+ +A*_,L=j+U*G,$=L+U*O,V=q;break;default:L=j=i.coordinate,Z=p+ +A*o,F=Z+U*G,V=F+U*O,$=q;break}return{line:{x1:L,y1:F,x2:j,y2:Z},tick:{x:$,y:V}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,u=i.orientation,h=i.mirror,p;switch(u){case"left":p=h?"start":"end";break;case"right":p=h?"end":"start";break;default:p="middle";break}return p}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,u=i.orientation,h=i.mirror,p="end";switch(u){case"left":case"right":p="middle";break;case"top":p=h?"start":"end";break;default:p=h?"end":"start";break}return p}},{key:"renderAxisLine",value:function(){var i=this.props,u=i.x,h=i.y,p=i.width,_=i.height,o=i.orientation,x=i.mirror,E=i.axisLine,A=Xi(Xi(Xi({},Hr(this.props,!1)),Hr(E,!1)),{},{fill:"none"});if(o==="top"||o==="bottom"){var O=+(o==="top"&&!x||o==="bottom"&&x);A=Xi(Xi({},A),{},{x1:u,y1:h+O*_,x2:u+p,y2:h+O*_})}else{var L=+(o==="left"&&!x||o==="right"&&x);A=Xi(Xi({},A),{},{x1:u+L*p,y1:h,x2:u+L*p,y2:h+_})}return Fe.createElement("line",bf({},A,{className:en("recharts-cartesian-axis-line",aa(E,"className"))}))}},{key:"renderTicks",value:function(i,u,h){var p=this,_=this.props,o=_.tickLine,x=_.stroke,E=_.tick,A=_.tickFormatter,O=_.unit,L=HP(Xi(Xi({},this.props),{},{ticks:i}),u,h),j=this.getTickTextAnchor(),F=this.getTickVerticalAnchor(),Z=Hr(this.props,!1),$=Hr(E,!1),V=Xi(Xi({},Z),{},{fill:"none"},Hr(o,!1)),U=L.map(function(G,q){var K=p.getTickLineCoord(G),re=K.line,pe=K.tick,xe=Xi(Xi(Xi(Xi({textAnchor:j,verticalAnchor:F},Z),{},{stroke:"none",fill:x},$),pe),{},{index:q,payload:G,visibleTicksCount:L.length,tickFormatter:A});return Fe.createElement(xi,bf({className:"recharts-cartesian-axis-tick",key:"tick-".concat(G.value,"-").concat(G.coordinate,"-").concat(G.tickCoord)},w0(p.props,G,q)),o&&Fe.createElement("line",bf({},V,re,{className:en("recharts-cartesian-axis-tick-line",aa(o,"className"))})),E&&t.renderTickItem(E,xe,"".concat(xr(A)?A(G.value,q):G.value).concat(O||"")))});return Fe.createElement("g",{className:"recharts-cartesian-axis-ticks"},U)}},{key:"render",value:function(){var i=this,u=this.props,h=u.axisLine,p=u.width,_=u.height,o=u.ticksGenerator,x=u.className,E=u.hide;if(E)return null;var A=this.props,O=A.ticks,L=uT(A,Xpe),j=O;return xr(o)&&(j=O&&O.length>0?o(this.props):o(L)),p<=0||_<=0||!j||!j.length?null:Fe.createElement(xi,{className:en("recharts-cartesian-axis",x),ref:function(Z){i.layerReference=Z}},h&&this.renderAxisLine(),this.renderTicks(j,this.state.fontSize,this.state.letterSpacing),Ui.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,u,h){var p;return Fe.isValidElement(i)?p=Fe.cloneElement(i,u):xr(i)?p=i(u):p=Fe.createElement(R0,bf({},u,{className:"recharts-cartesian-axis-tick-value"}),h),p}}])}(De.Component);XP(zd,"displayName","CartesianAxis");XP(zd,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var ime=["x1","y1","x2","y2","key"],ome=["offset"];function $c(e){"@babel/helpers - typeof";return $c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$c(e)}function sz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Vi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sz(Object(r),!0).forEach(function(i){ame(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sz(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function ame(e,t,r){return t=sme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sme(e){var t=lme(e,"string");return $c(t)=="symbol"?t:t+""}function lme(e,t){if($c(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if($c(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sc(){return Sc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Sc.apply(this,arguments)}function lz(e,t){if(e==null)return{};var r=ume(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function ume(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}var cme=function(t){var r=t.fill;if(!r||r==="none")return null;var i=t.fillOpacity,u=t.x,h=t.y,p=t.width,_=t.height,o=t.ry;return Fe.createElement("rect",{x:u,y:h,ry:o,width:p,height:_,stroke:"none",fill:r,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function SF(e,t){var r;if(Fe.isValidElement(e))r=Fe.cloneElement(e,t);else if(xr(e))r=e(t);else{var i=t.x1,u=t.y1,h=t.x2,p=t.y2,_=t.key,o=lz(t,ime),x=Hr(o,!1);x.offset;var E=lz(x,ome);r=Fe.createElement("line",Sc({},E,{x1:i,y1:u,x2:h,y2:p,fill:"none",key:_}))}return r}function hme(e){var t=e.x,r=e.width,i=e.horizontal,u=i===void 0?!0:i,h=e.horizontalPoints;if(!u||!h||!h.length)return null;var p=h.map(function(_,o){var x=Vi(Vi({},e),{},{x1:t,y1:_,x2:t+r,y2:_,key:"line-".concat(o),index:o});return SF(u,x)});return Fe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},p)}function fme(e){var t=e.y,r=e.height,i=e.vertical,u=i===void 0?!0:i,h=e.verticalPoints;if(!u||!h||!h.length)return null;var p=h.map(function(_,o){var x=Vi(Vi({},e),{},{x1:_,y1:t,x2:_,y2:t+r,key:"line-".concat(o),index:o});return SF(u,x)});return Fe.createElement("g",{className:"recharts-cartesian-grid-vertical"},p)}function dme(e){var t=e.horizontalFill,r=e.fillOpacity,i=e.x,u=e.y,h=e.width,p=e.height,_=e.horizontalPoints,o=e.horizontal,x=o===void 0?!0:o;if(!x||!t||!t.length)return null;var E=_.map(function(O){return Math.round(O+u-u)}).sort(function(O,L){return O-L});u!==E[0]&&E.unshift(0);var A=E.map(function(O,L){var j=!E[L+1],F=j?u+p-O:E[L+1]-O;if(F<=0)return null;var Z=L%t.length;return Fe.createElement("rect",{key:"react-".concat(L),y:O,x:i,height:F,width:h,stroke:"none",fill:t[Z],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Fe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},A)}function pme(e){var t=e.vertical,r=t===void 0?!0:t,i=e.verticalFill,u=e.fillOpacity,h=e.x,p=e.y,_=e.width,o=e.height,x=e.verticalPoints;if(!r||!i||!i.length)return null;var E=x.map(function(O){return Math.round(O+h-h)}).sort(function(O,L){return O-L});h!==E[0]&&E.unshift(0);var A=E.map(function(O,L){var j=!E[L+1],F=j?h+_-O:E[L+1]-O;if(F<=0)return null;var Z=L%i.length;return Fe.createElement("rect",{key:"react-".concat(L),x:O,y:p,width:F,height:o,stroke:"none",fill:i[Z],fillOpacity:u,className:"recharts-cartesian-grid-bg"})});return Fe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},A)}var mme=function(t,r){var i=t.xAxis,u=t.width,h=t.height,p=t.offset;return R5(HP(Vi(Vi(Vi({},zd.defaultProps),i),{},{ticks:Ys(i,!0),viewBox:{x:0,y:0,width:u,height:h}})),p.left,p.left+p.width,r)},gme=function(t,r){var i=t.yAxis,u=t.width,h=t.height,p=t.offset;return R5(HP(Vi(Vi(Vi({},zd.defaultProps),i),{},{ticks:Ys(i,!0),viewBox:{x:0,y:0,width:u,height:h}})),p.top,p.top+p.height,r)},rf={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function yme(e){var t,r,i,u,h,p,_=GP(),o=WP(),x=npe(),E=Vi(Vi({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:rf.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:rf.fill,horizontal:(i=e.horizontal)!==null&&i!==void 0?i:rf.horizontal,horizontalFill:(u=e.horizontalFill)!==null&&u!==void 0?u:rf.horizontalFill,vertical:(h=e.vertical)!==null&&h!==void 0?h:rf.vertical,verticalFill:(p=e.verticalFill)!==null&&p!==void 0?p:rf.verticalFill,x:zt(e.x)?e.x:x.left,y:zt(e.y)?e.y:x.top,width:zt(e.width)?e.width:x.width,height:zt(e.height)?e.height:x.height}),A=E.x,O=E.y,L=E.width,j=E.height,F=E.syncWithTicks,Z=E.horizontalValues,$=E.verticalValues,V=epe(),U=tpe();if(!zt(L)||L<=0||!zt(j)||j<=0||!zt(A)||A!==+A||!zt(O)||O!==+O)return null;var G=E.verticalCoordinatesGenerator||mme,q=E.horizontalCoordinatesGenerator||gme,K=E.horizontalPoints,re=E.verticalPoints;if((!K||!K.length)&&xr(q)){var pe=Z&&Z.length,xe=q({yAxis:U?Vi(Vi({},U),{},{ticks:pe?Z:U.ticks}):void 0,width:_,height:o,offset:x},pe?!0:F);tl(Array.isArray(xe),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat($c(xe),"]")),Array.isArray(xe)&&(K=xe)}if((!re||!re.length)&&xr(G)){var ge=$&&$.length,Be=G({xAxis:V?Vi(Vi({},V),{},{ticks:ge?$:V.ticks}):void 0,width:_,height:o,offset:x},ge?!0:F);tl(Array.isArray(Be),"verticalCoordinatesGenerator should return Array but instead it returned [".concat($c(Be),"]")),Array.isArray(Be)&&(re=Be)}return Fe.createElement("g",{className:"recharts-cartesian-grid"},Fe.createElement(cme,{fill:E.fill,fillOpacity:E.fillOpacity,x:E.x,y:E.y,width:E.width,height:E.height,ry:E.ry}),Fe.createElement(hme,Sc({},E,{offset:x,horizontalPoints:K,xAxis:V,yAxis:U})),Fe.createElement(fme,Sc({},E,{offset:x,verticalPoints:re,xAxis:V,yAxis:U})),Fe.createElement(dme,Sc({},E,{horizontalPoints:K})),Fe.createElement(pme,Sc({},E,{verticalPoints:re})))}yme.displayName="CartesianGrid";function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function _me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vme(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,PF(i.key),i)}}function xme(e,t,r){return t&&vme(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function bme(e,t,r){return t=mx(t),wme(e,EF()?Reflect.construct(t,r||[],mx(e).constructor):t.apply(e,r))}function wme(e,t){if(t&&(dd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tme(e)}function Tme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EF=function(){return!!e})()}function mx(e){return mx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mx(e)}function Sme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DE(e,t)}function DE(e,t){return DE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},DE(e,t)}function AF(e,t,r){return t=PF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PF(e){var t=Eme(e,"string");return dd(t)=="symbol"?t:t+""}function Eme(e,t){if(dd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(dd(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function LE(){return LE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},LE.apply(this,arguments)}function Ame(e){var t=e.xAxisId,r=GP(),i=WP(),u=dF(t);return u==null?null:Fe.createElement(zd,LE({},u,{className:en("recharts-".concat(u.axisType," ").concat(u.axisType),u.className),viewBox:{x:0,y:0,width:r,height:i},ticksGenerator:function(p){return Ys(p,!0)}}))}var KP=function(e){function t(){return _me(this,t),bme(this,t,arguments)}return Sme(t,e),xme(t,[{key:"render",value:function(){return Fe.createElement(Ame,this.props)}}])}(Fe.Component);AF(KP,"displayName","XAxis");AF(KP,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function Pme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mme(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,OF(i.key),i)}}function Cme(e,t,r){return t&&Mme(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ome(e,t,r){return t=gx(t),Ime(e,MF()?Reflect.construct(t,r||[],gx(e).constructor):t.apply(e,r))}function Ime(e,t){if(t&&(pd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kme(e)}function kme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MF=function(){return!!e})()}function gx(e){return gx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gx(e)}function Dme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zE(e,t)}function zE(e,t){return zE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},zE(e,t)}function CF(e,t,r){return t=OF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OF(e){var t=Lme(e,"string");return pd(t)=="symbol"?t:t+""}function Lme(e,t){if(pd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(pd(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function RE(){return RE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},RE.apply(this,arguments)}var zme=function(t){var r=t.yAxisId,i=GP(),u=WP(),h=pF(r);return h==null?null:Fe.createElement(zd,RE({},h,{className:en("recharts-".concat(h.axisType," ").concat(h.axisType),h.className),viewBox:{x:0,y:0,width:i,height:u},ticksGenerator:function(_){return Ys(_,!0)}}))},YP=function(e){function t(){return Pme(this,t),Ome(this,t,arguments)}return Dme(t,e),Cme(t,[{key:"render",value:function(){return Fe.createElement(zme,this.props)}}])}(Fe.Component);CF(YP,"displayName","YAxis");CF(YP,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function uz(e){return Fme(e)||jme(e)||Bme(e)||Rme()}function Rme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bme(e,t){if(e){if(typeof e=="string")return BE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BE(e,t)}}function jme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fme(e){if(Array.isArray(e))return BE(e)}function BE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var jE=function(t,r,i,u,h){var p=Ha(t,ZP),_=Ha(t,T1),o=[].concat(uz(p),uz(_)),x=Ha(t,E1),E="".concat(u,"Id"),A=u[0],O=r;if(o.length&&(O=o.reduce(function(F,Z){if(Z.props[E]===i&&_s(Z.props,"extendDomain")&&zt(Z.props[A])){var $=Z.props[A];return[Math.min(F[0],$),Math.max(F[1],$)]}return F},O)),x.length){var L="".concat(A,"1"),j="".concat(A,"2");O=x.reduce(function(F,Z){if(Z.props[E]===i&&_s(Z.props,"extendDomain")&&zt(Z.props[L])&&zt(Z.props[j])){var $=Z.props[L],V=Z.props[j];return[Math.min(F[0],$,V),Math.max(F[1],$,V)]}return F},O)}return h&&h.length&&(O=h.reduce(function(F,Z){return zt(Z)?[Math.min(F[0],Z),Math.max(F[1],Z)]:F},O)),O},IF={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1));function u(o,x,E){this.fn=o,this.context=x,this.once=E||!1}function h(o,x,E,A,O){if(typeof E!="function")throw new TypeError("The listener must be a function");var L=new u(E,A||o,O),j=r?r+x:x;return o._events[j]?o._events[j].fn?o._events[j]=[o._events[j],L]:o._events[j].push(L):(o._events[j]=L,o._eventsCount++),o}function p(o,x){--o._eventsCount===0?o._events=new i:delete o._events[x]}function _(){this._events=new i,this._eventsCount=0}_.prototype.eventNames=function(){var x=[],E,A;if(this._eventsCount===0)return x;for(A in E=this._events)t.call(E,A)&&x.push(r?A.slice(1):A);return Object.getOwnPropertySymbols?x.concat(Object.getOwnPropertySymbols(E)):x},_.prototype.listeners=function(x){var E=r?r+x:x,A=this._events[E];if(!A)return[];if(A.fn)return[A.fn];for(var O=0,L=A.length,j=new Array(L);O<L;O++)j[O]=A[O].fn;return j},_.prototype.listenerCount=function(x){var E=r?r+x:x,A=this._events[E];return A?A.fn?1:A.length:0},_.prototype.emit=function(x,E,A,O,L,j){var F=r?r+x:x;if(!this._events[F])return!1;var Z=this._events[F],$=arguments.length,V,U;if(Z.fn){switch(Z.once&&this.removeListener(x,Z.fn,void 0,!0),$){case 1:return Z.fn.call(Z.context),!0;case 2:return Z.fn.call(Z.context,E),!0;case 3:return Z.fn.call(Z.context,E,A),!0;case 4:return Z.fn.call(Z.context,E,A,O),!0;case 5:return Z.fn.call(Z.context,E,A,O,L),!0;case 6:return Z.fn.call(Z.context,E,A,O,L,j),!0}for(U=1,V=new Array($-1);U<$;U++)V[U-1]=arguments[U];Z.fn.apply(Z.context,V)}else{var G=Z.length,q;for(U=0;U<G;U++)switch(Z[U].once&&this.removeListener(x,Z[U].fn,void 0,!0),$){case 1:Z[U].fn.call(Z[U].context);break;case 2:Z[U].fn.call(Z[U].context,E);break;case 3:Z[U].fn.call(Z[U].context,E,A);break;case 4:Z[U].fn.call(Z[U].context,E,A,O);break;default:if(!V)for(q=1,V=new Array($-1);q<$;q++)V[q-1]=arguments[q];Z[U].fn.apply(Z[U].context,V)}}return!0},_.prototype.on=function(x,E,A){return h(this,x,E,A,!1)},_.prototype.once=function(x,E,A){return h(this,x,E,A,!0)},_.prototype.removeListener=function(x,E,A,O){var L=r?r+x:x;if(!this._events[L])return this;if(!E)return p(this,L),this;var j=this._events[L];if(j.fn)j.fn===E&&(!O||j.once)&&(!A||j.context===A)&&p(this,L);else{for(var F=0,Z=[],$=j.length;F<$;F++)(j[F].fn!==E||O&&!j[F].once||A&&j[F].context!==A)&&Z.push(j[F]);Z.length?this._events[L]=Z.length===1?Z[0]:Z:p(this,L)}return this},_.prototype.removeAllListeners=function(x){var E;return x?(E=r?r+x:x,this._events[E]&&p(this,E)):(this._events=new i,this._eventsCount=0),this},_.prototype.off=_.prototype.removeListener,_.prototype.addListener=_.prototype.on,_.prefixed=r,_.EventEmitter=_,e.exports=_})(IF);var $me=IF.exports;const Nme=Xr($me);var cT=new Nme,hT="recharts.syncMouseEvents";function ny(e){"@babel/helpers - typeof";return ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ny(e)}function Ume(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vme(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,kF(i.key),i)}}function Gme(e,t,r){return t&&Vme(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fT(e,t,r){return t=kF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kF(e){var t=Wme(e,"string");return ny(t)=="symbol"?t:t+""}function Wme(e,t){if(ny(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(ny(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var qme=function(){function e(){Ume(this,e),fT(this,"activeIndex",0),fT(this,"coordinateList",[]),fT(this,"layout","horizontal")}return Gme(e,[{key:"setDetails",value:function(r){var i,u=r.coordinateList,h=u===void 0?null:u,p=r.container,_=p===void 0?null:p,o=r.layout,x=o===void 0?null:o,E=r.offset,A=E===void 0?null:E,O=r.mouseHandlerCallback,L=O===void 0?null:O;this.coordinateList=(i=h??this.coordinateList)!==null&&i!==void 0?i:[],this.container=_??this.container,this.layout=x??this.layout,this.offset=A??this.offset,this.mouseHandlerCallback=L??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,i;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var u=this.container.getBoundingClientRect(),h=u.x,p=u.y,_=u.height,o=this.coordinateList[this.activeIndex].coordinate,x=((r=window)===null||r===void 0?void 0:r.scrollX)||0,E=((i=window)===null||i===void 0?void 0:i.scrollY)||0,A=h+o+x,O=p+this.offset.top+_/2+E;this.mouseHandlerCallback({pageX:A,pageY:O})}}}])}();function Zme(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var i=e==null?void 0:e[0],u=e==null?void 0:e[1];if(i&&u&&zt(i)&&zt(u))return!0}return!1}function Hme(e,t,r,i){var u=i/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-u:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-u,width:e==="horizontal"?i:r.width-1,height:e==="horizontal"?r.height-1:i}}function DF(e){var t=e.cx,r=e.cy,i=e.radius,u=e.startAngle,h=e.endAngle,p=Ai(t,r,i,u),_=Ai(t,r,i,h);return{points:[p,_],cx:t,cy:r,radius:i,startAngle:u,endAngle:h}}function Xme(e,t,r){var i,u,h,p;if(e==="horizontal")i=t.x,h=i,u=r.top,p=r.top+r.height;else if(e==="vertical")u=t.y,p=u,i=r.left,h=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var _=t.cx,o=t.cy,x=t.innerRadius,E=t.outerRadius,A=t.angle,O=Ai(_,o,x,A),L=Ai(_,o,E,A);i=O.x,u=O.y,h=L.x,p=L.y}else return DF(t);return[{x:i,y:u},{x:h,y:p}]}function iy(e){"@babel/helpers - typeof";return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iy(e)}function cz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function Av(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cz(Object(r),!0).forEach(function(i){Kme(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cz(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Kme(e,t,r){return t=Yme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yme(e){var t=Jme(e,"string");return iy(t)=="symbol"?t:t+""}function Jme(e,t){if(iy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(iy(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qme(e){var t,r,i=e.element,u=e.tooltipEventType,h=e.isActive,p=e.activeCoordinate,_=e.activePayload,o=e.offset,x=e.activeTooltipIndex,E=e.tooltipAxisBandSize,A=e.layout,O=e.chartName,L=(t=i.props.cursor)!==null&&t!==void 0?t:(r=i.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!i||!L||!h||!p||O!=="ScatterChart"&&u!=="axis")return null;var j,F=sL;if(O==="ScatterChart")j=p,F=hhe;else if(O==="BarChart")j=Hme(A,p,o,E),F=$P;else if(A==="radial"){var Z=DF(p),$=Z.cx,V=Z.cy,U=Z.radius,G=Z.startAngle,q=Z.endAngle;j={cx:$,cy:V,startAngle:G,endAngle:q,innerRadius:U,outerRadius:U},F=N5}else j={points:Xme(A,p,o)},F=sL;var K=Av(Av(Av(Av({stroke:"#ccc",pointerEvents:"none"},o),j),Hr(L,!1)),{},{payload:_,payloadIndex:x,className:en("recharts-tooltip-cursor",L.className)});return De.isValidElement(L)?De.cloneElement(L,K):De.createElement(F,K)}var ege=["item"],tge=["children","className","width","height","style","compact","title","desc"];function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function wf(){return wf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},wf.apply(this,arguments)}function hz(e,t){return ige(e)||nge(e,t)||zF(e,t)||rge()}function rge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nge(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,u,h,p,_=[],o=!0,x=!1;try{if(h=(r=r.call(e)).next,t!==0)for(;!(o=(i=h.call(r)).done)&&(_.push(i.value),_.length!==t);o=!0);}catch(E){x=!0,u=E}finally{try{if(!o&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw u}}return _}}function ige(e){if(Array.isArray(e))return e}function fz(e,t){if(e==null)return{};var r=oge(e,t),i,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)i=h[u],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function oge(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function age(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sge(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,RF(i.key),i)}}function lge(e,t,r){return t&&sge(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uge(e,t,r){return t=yx(t),cge(e,LF()?Reflect.construct(t,r||[],yx(e).constructor):t.apply(e,r))}function cge(e,t){if(t&&(md(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hge(e)}function hge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LF=function(){return!!e})()}function yx(e){return yx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yx(e)}function fge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FE(e,t)}function FE(e,t){return FE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,u){return i.__proto__=u,i},FE(e,t)}function gd(e){return mge(e)||pge(e)||zF(e)||dge()}function dge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zF(e,t){if(e){if(typeof e=="string")return $E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $E(e,t)}}function pge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mge(e){if(Array.isArray(e))return $E(e)}function $E(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function dz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),r.push.apply(r,i)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dz(Object(r),!0).forEach(function(i){lr(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dz(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function lr(e,t,r){return t=RF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RF(e){var t=gge(e,"string");return md(t)=="symbol"?t:t+""}function gge(e,t){if(md(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(md(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yge={xAxis:["bottom","top"],yAxis:["left","right"]},_ge={width:"100%",height:"100%"},BF={x:0,y:0};function Pv(e){return e}var vge=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},xge=function(t,r,i,u){var h=r.find(function(E){return E&&E.index===i});if(h){if(t==="horizontal")return{x:h.coordinate,y:u.y};if(t==="vertical")return{x:u.x,y:h.coordinate};if(t==="centric"){var p=h.coordinate,_=u.radius;return ut(ut(ut({},u),Ai(u.cx,u.cy,_,p)),{},{angle:p,radius:_})}var o=h.coordinate,x=u.angle;return ut(ut(ut({},u),Ai(u.cx,u.cy,o,x)),{},{angle:x,radius:o})}return BF},A1=function(t,r){var i=r.graphicalItems,u=r.dataStartIndex,h=r.dataEndIndex,p=(i??[]).reduce(function(_,o){var x=o.props.data;return x&&x.length?[].concat(gd(_),gd(x)):_},[]);return p.length>0?p:t&&t.length&&zt(u)&&zt(h)?t.slice(u,h+1):[]};function jF(e){return e==="number"?[0,"auto"]:void 0}var NE=function(t,r,i,u){var h=t.graphicalItems,p=t.tooltipAxis,_=A1(r,t);return i<0||!h||!h.length||i>=_.length?null:h.reduce(function(o,x){var E,A=(E=x.props.data)!==null&&E!==void 0?E:r;A&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=i&&(A=A.slice(t.dataStartIndex,t.dataEndIndex+1));var O;if(p.dataKey&&!p.allowDuplicatedCategory){var L=A===void 0?_:A;O=xS(L,p.dataKey,u)}else O=A&&A[i]||_[i];return O?[].concat(gd(o),[j5(x,O)]):o},[])},pz=function(t,r,i,u){var h=u||{x:t.chartX,y:t.chartY},p=vge(h,i),_=t.orderedTooltipTicks,o=t.tooltipAxis,x=t.tooltipTicks,E=Jse(p,_,x,o);if(E>=0&&x){var A=x[E]&&x[E].value,O=NE(t,r,E,A),L=xge(i,_,E,h);return{activeTooltipIndex:E,activeLabel:A,activePayload:O,activeCoordinate:L}}return null},bge=function(t,r){var i=r.axes,u=r.graphicalItems,h=r.axisType,p=r.axisIdKey,_=r.stackGroups,o=r.dataStartIndex,x=r.dataEndIndex,E=t.layout,A=t.children,O=t.stackOffset,L=z5(E,h);return i.reduce(function(j,F){var Z,$=F.type.defaultProps!==void 0?ut(ut({},F.type.defaultProps),F.props):F.props,V=$.type,U=$.dataKey,G=$.allowDataOverflow,q=$.allowDuplicatedCategory,K=$.scale,re=$.ticks,pe=$.includeHidden,xe=$[p];if(j[xe])return j;var ge=A1(t.data,{graphicalItems:u.filter(function(st){var Ot,St=p in st.props?st.props[p]:(Ot=st.type.defaultProps)===null||Ot===void 0?void 0:Ot[p];return St===xe}),dataStartIndex:o,dataEndIndex:x}),Be=ge.length,$e,Ve,be;Zme($.domain,G,V)&&($e=sE($.domain,null,G),L&&(V==="number"||K!=="auto")&&(be=rg(ge,U,"category")));var _e=jF(V);if(!$e||$e.length===0){var Me,ke=(Me=$.domain)!==null&&Me!==void 0?Me:_e;if(U){if($e=rg(ge,U,V),V==="category"&&L){var Ce=NZ($e);q&&Ce?(Ve=$e,$e=ox(0,Be)):q||($e=H3(ke,$e,F).reduce(function(st,Ot){return st.indexOf(Ot)>=0?st:[].concat(gd(st),[Ot])},[]))}else if(V==="category")q?$e=$e.filter(function(st){return st!==""&&!Qr(st)}):$e=H3(ke,$e,F).reduce(function(st,Ot){return st.indexOf(Ot)>=0||Ot===""||Qr(Ot)?st:[].concat(gd(st),[Ot])},[]);else if(V==="number"){var Oe=nle(ge,u.filter(function(st){var Ot,St,pr=p in st.props?st.props[p]:(Ot=st.type.defaultProps)===null||Ot===void 0?void 0:Ot[p],Tr="hide"in st.props?st.props.hide:(St=st.type.defaultProps)===null||St===void 0?void 0:St.hide;return pr===xe&&(pe||!Tr)}),U,h,E);Oe&&($e=Oe)}L&&(V==="number"||K!=="auto")&&(be=rg(ge,U,"category"))}else L?$e=ox(0,Be):_&&_[xe]&&_[xe].hasStack&&V==="number"?$e=O==="expand"?[0,1]:B5(_[xe].stackGroups,o,x):$e=L5(ge,u.filter(function(st){var Ot=p in st.props?st.props[p]:st.type.defaultProps[p],St="hide"in st.props?st.props.hide:st.type.defaultProps.hide;return Ot===xe&&(pe||!St)}),V,E,!0);if(V==="number")$e=jE(A,$e,xe,h,re),ke&&($e=sE(ke,$e,G));else if(V==="category"&&ke){var at=ke,ft=$e.every(function(st){return at.indexOf(st)>=0});ft&&($e=at)}}return ut(ut({},j),{},lr({},xe,ut(ut({},$),{},{axisType:h,domain:$e,categoricalDomain:be,duplicateDomain:Ve,originalDomain:(Z=$.domain)!==null&&Z!==void 0?Z:_e,isCategorical:L,layout:E})))},{})},wge=function(t,r){var i=r.graphicalItems,u=r.Axis,h=r.axisType,p=r.axisIdKey,_=r.stackGroups,o=r.dataStartIndex,x=r.dataEndIndex,E=t.layout,A=t.children,O=A1(t.data,{graphicalItems:i,dataStartIndex:o,dataEndIndex:x}),L=O.length,j=z5(E,h),F=-1;return i.reduce(function(Z,$){var V=$.type.defaultProps!==void 0?ut(ut({},$.type.defaultProps),$.props):$.props,U=V[p],G=jF("number");if(!Z[U]){F++;var q;return j?q=ox(0,L):_&&_[U]&&_[U].hasStack?(q=B5(_[U].stackGroups,o,x),q=jE(A,q,U,h)):(q=sE(G,L5(O,i.filter(function(K){var re,pe,xe=p in K.props?K.props[p]:(re=K.type.defaultProps)===null||re===void 0?void 0:re[p],ge="hide"in K.props?K.props.hide:(pe=K.type.defaultProps)===null||pe===void 0?void 0:pe.hide;return xe===U&&!ge}),"number",E),u.defaultProps.allowDataOverflow),q=jE(A,q,U,h)),ut(ut({},Z),{},lr({},U,ut(ut({axisType:h},u.defaultProps),{},{hide:!0,orientation:aa(yge,"".concat(h,".").concat(F%2),null),domain:q,originalDomain:G,isCategorical:j,layout:E})))}return Z},{})},Tge=function(t,r){var i=r.axisType,u=i===void 0?"xAxis":i,h=r.AxisComp,p=r.graphicalItems,_=r.stackGroups,o=r.dataStartIndex,x=r.dataEndIndex,E=t.children,A="".concat(u,"Id"),O=Ha(E,h),L={};return O&&O.length?L=bge(t,{axes:O,graphicalItems:p,axisType:u,axisIdKey:A,stackGroups:_,dataStartIndex:o,dataEndIndex:x}):p&&p.length&&(L=wge(t,{Axis:h,graphicalItems:p,axisType:u,axisIdKey:A,stackGroups:_,dataStartIndex:o,dataEndIndex:x})),L},Sge=function(t){var r=Yl(t),i=Ys(r,!1,!0);return{tooltipTicks:i,orderedTooltipTicks:fP(i,function(u){return u.coordinate}),tooltipAxis:r,tooltipAxisBandSize:K0(r,i)}},mz=function(t){var r=t.children,i=t.defaultShowTooltip,u=Co(r,sd),h=0,p=0;return t.data&&t.data.length!==0&&(p=t.data.length-1),u&&u.props&&(u.props.startIndex>=0&&(h=u.props.startIndex),u.props.endIndex>=0&&(p=u.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:h,dataEndIndex:p,activeTooltipIndex:-1,isTooltipActive:!!i}},Ege=function(t){return!t||!t.length?!1:t.some(function(r){var i=el(r&&r.type);return i&&i.indexOf("Bar")>=0})},gz=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Age=function(t,r){var i=t.props,u=t.graphicalItems,h=t.xAxisMap,p=h===void 0?{}:h,_=t.yAxisMap,o=_===void 0?{}:_,x=i.width,E=i.height,A=i.children,O=i.margin||{},L=Co(A,sd),j=Co(A,zf),F=Object.keys(o).reduce(function(q,K){var re=o[K],pe=re.orientation;return!re.mirror&&!re.hide?ut(ut({},q),{},lr({},pe,q[pe]+re.width)):q},{left:O.left||0,right:O.right||0}),Z=Object.keys(p).reduce(function(q,K){var re=p[K],pe=re.orientation;return!re.mirror&&!re.hide?ut(ut({},q),{},lr({},pe,aa(q,"".concat(pe))+re.height)):q},{top:O.top||0,bottom:O.bottom||0}),$=ut(ut({},Z),F),V=$.bottom;L&&($.bottom+=L.props.height||sd.defaultProps.height),j&&r&&($=tle($,u,i,r));var U=x-$.left-$.right,G=E-$.top-$.bottom;return ut(ut({brushBottom:V},$),{},{width:Math.max(U,0),height:Math.max(G,0)})},Pge=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Mge=function(t){var r=t.chartName,i=t.GraphicalChild,u=t.defaultTooltipEventType,h=u===void 0?"axis":u,p=t.validateTooltipEventTypes,_=p===void 0?["axis"]:p,o=t.axisComponents,x=t.legendContent,E=t.formatAxisMap,A=t.defaultProps,O=function($,V){var U=V.graphicalItems,G=V.stackGroups,q=V.offset,K=V.updateId,re=V.dataStartIndex,pe=V.dataEndIndex,xe=$.barSize,ge=$.layout,Be=$.barGap,$e=$.barCategoryGap,Ve=$.maxBarSize,be=gz(ge),_e=be.numericAxisName,Me=be.cateAxisName,ke=Ege(U),Ce=[];return U.forEach(function(Oe,at){var ft=A1($.data,{graphicalItems:[Oe],dataStartIndex:re,dataEndIndex:pe}),st=Oe.type.defaultProps!==void 0?ut(ut({},Oe.type.defaultProps),Oe.props):Oe.props,Ot=st.dataKey,St=st.maxBarSize,pr=st["".concat(_e,"Id")],Tr=st["".concat(Me,"Id")],Kr={},yr=o.reduce(function(fi,ri){var ro=V["".concat(ri.axisType,"Map")],Wi=st["".concat(ri.axisType,"Id")];ro&&ro[Wi]||ri.axisType==="zAxis"||Fc();var no=ro[Wi];return ut(ut({},fi),{},lr(lr({},ri.axisType,no),"".concat(ri.axisType,"Ticks"),Ys(no)))},Kr),kt=yr[Me],Xt=yr["".concat(Me,"Ticks")],Jt=G&&G[pr]&&G[pr].hasStack&&mle(Oe,G[pr].stackGroups),et=el(Oe.type).indexOf("Bar")>=0,Or=K0(kt,Xt),Qt=[],Ir=ke&&Qse({barSize:xe,stackGroups:G,totalSize:Pge(yr,Me)});if(et){var ir,kr,qn=Qr(St)?Ve:St,$n=(ir=(kr=K0(kt,Xt,!0))!==null&&kr!==void 0?kr:qn)!==null&&ir!==void 0?ir:0;Qt=ele({barGap:Be,barCategoryGap:$e,bandSize:$n!==Or?$n:Or,sizeList:Ir[Tr],maxBarSize:qn}),$n!==Or&&(Qt=Qt.map(function(fi){return ut(ut({},fi),{},{position:ut(ut({},fi.position),{},{offset:fi.position.offset-$n/2})})}))}var tn=Oe&&Oe.type&&Oe.type.getComposedData;tn&&Ce.push({props:ut(ut({},tn(ut(ut({},yr),{},{displayedData:ft,props:$,dataKey:Ot,item:Oe,bandSize:Or,barPosition:Qt,offset:q,stackedData:Jt,layout:ge,dataStartIndex:re,dataEndIndex:pe}))),{},lr(lr(lr({key:Oe.key||"item-".concat(at)},_e,yr[_e]),Me,yr[Me]),"animationId",K)),childIndex:JZ(Oe,$.children),item:Oe})}),Ce},L=function($,V){var U=$.props,G=$.dataStartIndex,q=$.dataEndIndex,K=$.updateId;if(!Uk({props:U}))return null;var re=U.children,pe=U.layout,xe=U.stackOffset,ge=U.data,Be=U.reverseStackOrder,$e=gz(pe),Ve=$e.numericAxisName,be=$e.cateAxisName,_e=Ha(re,i),Me=fle(ge,_e,"".concat(Ve,"Id"),"".concat(be,"Id"),xe,Be),ke=o.reduce(function(st,Ot){var St="".concat(Ot.axisType,"Map");return ut(ut({},st),{},lr({},St,Tge(U,ut(ut({},Ot),{},{graphicalItems:_e,stackGroups:Ot.axisType===Ve&&Me,dataStartIndex:G,dataEndIndex:q}))))},{}),Ce=Age(ut(ut({},ke),{},{props:U,graphicalItems:_e}),V==null?void 0:V.legendBBox);Object.keys(ke).forEach(function(st){ke[st]=E(U,ke[st],Ce,st.replace("Map",""),r)});var Oe=ke["".concat(be,"Map")],at=Sge(Oe),ft=O(U,ut(ut({},ke),{},{dataStartIndex:G,dataEndIndex:q,updateId:K,graphicalItems:_e,stackGroups:Me,offset:Ce}));return ut(ut({formattedGraphicalItems:ft,graphicalItems:_e,offset:Ce,stackGroups:Me},at),ke)},j=function(Z){function $(V){var U,G,q;return age(this,$),q=uge(this,$,[V]),lr(q,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),lr(q,"accessibilityManager",new qme),lr(q,"handleLegendBBoxUpdate",function(K){if(K){var re=q.state,pe=re.dataStartIndex,xe=re.dataEndIndex,ge=re.updateId;q.setState(ut({legendBBox:K},L({props:q.props,dataStartIndex:pe,dataEndIndex:xe,updateId:ge},ut(ut({},q.state),{},{legendBBox:K}))))}}),lr(q,"handleReceiveSyncEvent",function(K,re,pe){if(q.props.syncId===K){if(pe===q.eventEmitterSymbol&&typeof q.props.syncMethod!="function")return;q.applySyncEvent(re)}}),lr(q,"handleBrushChange",function(K){var re=K.startIndex,pe=K.endIndex;if(re!==q.state.dataStartIndex||pe!==q.state.dataEndIndex){var xe=q.state.updateId;q.setState(function(){return ut({dataStartIndex:re,dataEndIndex:pe},L({props:q.props,dataStartIndex:re,dataEndIndex:pe,updateId:xe},q.state))}),q.triggerSyncEvent({dataStartIndex:re,dataEndIndex:pe})}}),lr(q,"handleMouseEnter",function(K){var re=q.getMouseInfo(K);if(re){var pe=ut(ut({},re),{},{isTooltipActive:!0});q.setState(pe),q.triggerSyncEvent(pe);var xe=q.props.onMouseEnter;xr(xe)&&xe(pe,K)}}),lr(q,"triggeredAfterMouseMove",function(K){var re=q.getMouseInfo(K),pe=re?ut(ut({},re),{},{isTooltipActive:!0}):{isTooltipActive:!1};q.setState(pe),q.triggerSyncEvent(pe);var xe=q.props.onMouseMove;xr(xe)&&xe(pe,K)}),lr(q,"handleItemMouseEnter",function(K){q.setState(function(){return{isTooltipActive:!0,activeItem:K,activePayload:K.tooltipPayload,activeCoordinate:K.tooltipPosition||{x:K.cx,y:K.cy}}})}),lr(q,"handleItemMouseLeave",function(){q.setState(function(){return{isTooltipActive:!1}})}),lr(q,"handleMouseMove",function(K){K.persist(),q.throttleTriggeredAfterMouseMove(K)}),lr(q,"handleMouseLeave",function(K){q.throttleTriggeredAfterMouseMove.cancel();var re={isTooltipActive:!1};q.setState(re),q.triggerSyncEvent(re);var pe=q.props.onMouseLeave;xr(pe)&&pe(re,K)}),lr(q,"handleOuterEvent",function(K){var re=YZ(K),pe=aa(q.props,"".concat(re));if(re&&xr(pe)){var xe,ge;/.*touch.*/i.test(re)?ge=q.getMouseInfo(K.changedTouches[0]):ge=q.getMouseInfo(K),pe((xe=ge)!==null&&xe!==void 0?xe:{},K)}}),lr(q,"handleClick",function(K){var re=q.getMouseInfo(K);if(re){var pe=ut(ut({},re),{},{isTooltipActive:!0});q.setState(pe),q.triggerSyncEvent(pe);var xe=q.props.onClick;xr(xe)&&xe(pe,K)}}),lr(q,"handleMouseDown",function(K){var re=q.props.onMouseDown;if(xr(re)){var pe=q.getMouseInfo(K);re(pe,K)}}),lr(q,"handleMouseUp",function(K){var re=q.props.onMouseUp;if(xr(re)){var pe=q.getMouseInfo(K);re(pe,K)}}),lr(q,"handleTouchMove",function(K){K.changedTouches!=null&&K.changedTouches.length>0&&q.throttleTriggeredAfterMouseMove(K.changedTouches[0])}),lr(q,"handleTouchStart",function(K){K.changedTouches!=null&&K.changedTouches.length>0&&q.handleMouseDown(K.changedTouches[0])}),lr(q,"handleTouchEnd",function(K){K.changedTouches!=null&&K.changedTouches.length>0&&q.handleMouseUp(K.changedTouches[0])}),lr(q,"handleDoubleClick",function(K){var re=q.props.onDoubleClick;if(xr(re)){var pe=q.getMouseInfo(K);re(pe,K)}}),lr(q,"handleContextMenu",function(K){var re=q.props.onContextMenu;if(xr(re)){var pe=q.getMouseInfo(K);re(pe,K)}}),lr(q,"triggerSyncEvent",function(K){q.props.syncId!==void 0&&cT.emit(hT,q.props.syncId,K,q.eventEmitterSymbol)}),lr(q,"applySyncEvent",function(K){var re=q.props,pe=re.layout,xe=re.syncMethod,ge=q.state.updateId,Be=K.dataStartIndex,$e=K.dataEndIndex;if(K.dataStartIndex!==void 0||K.dataEndIndex!==void 0)q.setState(ut({dataStartIndex:Be,dataEndIndex:$e},L({props:q.props,dataStartIndex:Be,dataEndIndex:$e,updateId:ge},q.state)));else if(K.activeTooltipIndex!==void 0){var Ve=K.chartX,be=K.chartY,_e=K.activeTooltipIndex,Me=q.state,ke=Me.offset,Ce=Me.tooltipTicks;if(!ke)return;if(typeof xe=="function")_e=xe(Ce,K);else if(xe==="value"){_e=-1;for(var Oe=0;Oe<Ce.length;Oe++)if(Ce[Oe].value===K.activeLabel){_e=Oe;break}}var at=ut(ut({},ke),{},{x:ke.left,y:ke.top}),ft=Math.min(Ve,at.x+at.width),st=Math.min(be,at.y+at.height),Ot=Ce[_e]&&Ce[_e].value,St=NE(q.state,q.props.data,_e),pr=Ce[_e]?{x:pe==="horizontal"?Ce[_e].coordinate:ft,y:pe==="horizontal"?st:Ce[_e].coordinate}:BF;q.setState(ut(ut({},K),{},{activeLabel:Ot,activeCoordinate:pr,activePayload:St,activeTooltipIndex:_e}))}else q.setState(K)}),lr(q,"renderCursor",function(K){var re,pe=q.state,xe=pe.isTooltipActive,ge=pe.activeCoordinate,Be=pe.activePayload,$e=pe.offset,Ve=pe.activeTooltipIndex,be=pe.tooltipAxisBandSize,_e=q.getTooltipEventType(),Me=(re=K.props.active)!==null&&re!==void 0?re:xe,ke=q.props.layout,Ce=K.key||"_recharts-cursor";return Fe.createElement(Qme,{key:Ce,activeCoordinate:ge,activePayload:Be,activeTooltipIndex:Ve,chartName:r,element:K,isActive:Me,layout:ke,offset:$e,tooltipAxisBandSize:be,tooltipEventType:_e})}),lr(q,"renderPolarAxis",function(K,re,pe){var xe=aa(K,"type.axisType"),ge=aa(q.state,"".concat(xe,"Map")),Be=K.type.defaultProps,$e=Be!==void 0?ut(ut({},Be),K.props):K.props,Ve=ge&&ge[$e["".concat(xe,"Id")]];return De.cloneElement(K,ut(ut({},Ve),{},{className:en(xe,Ve.className),key:K.key||"".concat(re,"-").concat(pe),ticks:Ys(Ve,!0)}))}),lr(q,"renderPolarGrid",function(K){var re=K.props,pe=re.radialLines,xe=re.polarAngles,ge=re.polarRadius,Be=q.state,$e=Be.radiusAxisMap,Ve=Be.angleAxisMap,be=Yl($e),_e=Yl(Ve),Me=_e.cx,ke=_e.cy,Ce=_e.innerRadius,Oe=_e.outerRadius;return De.cloneElement(K,{polarAngles:Array.isArray(xe)?xe:Ys(_e,!0).map(function(at){return at.coordinate}),polarRadius:Array.isArray(ge)?ge:Ys(be,!0).map(function(at){return at.coordinate}),cx:Me,cy:ke,innerRadius:Ce,outerRadius:Oe,key:K.key||"polar-grid",radialLines:pe})}),lr(q,"renderLegend",function(){var K=q.state.formattedGraphicalItems,re=q.props,pe=re.children,xe=re.width,ge=re.height,Be=q.props.margin||{},$e=xe-(Be.left||0)-(Be.right||0),Ve=k5({children:pe,formattedGraphicalItems:K,legendWidth:$e,legendContent:x});if(!Ve)return null;var be=Ve.item,_e=fz(Ve,ege);return De.cloneElement(be,ut(ut({},_e),{},{chartWidth:xe,chartHeight:ge,margin:Be,onBBoxUpdate:q.handleLegendBBoxUpdate}))}),lr(q,"renderTooltip",function(){var K,re=q.props,pe=re.children,xe=re.accessibilityLayer,ge=Co(pe,Ws);if(!ge)return null;var Be=q.state,$e=Be.isTooltipActive,Ve=Be.activeCoordinate,be=Be.activePayload,_e=Be.activeLabel,Me=Be.offset,ke=(K=ge.props.active)!==null&&K!==void 0?K:$e;return De.cloneElement(ge,{viewBox:ut(ut({},Me),{},{x:Me.left,y:Me.top}),active:ke,label:_e,payload:ke?be:[],coordinate:Ve,accessibilityLayer:xe})}),lr(q,"renderBrush",function(K){var re=q.props,pe=re.margin,xe=re.data,ge=q.state,Be=ge.offset,$e=ge.dataStartIndex,Ve=ge.dataEndIndex,be=ge.updateId;return De.cloneElement(K,{key:K.key||"_recharts-brush",onChange:wv(q.handleBrushChange,K.props.onChange),data:xe,x:zt(K.props.x)?K.props.x:Be.left,y:zt(K.props.y)?K.props.y:Be.top+Be.height+Be.brushBottom-(pe.bottom||0),width:zt(K.props.width)?K.props.width:Be.width,startIndex:$e,endIndex:Ve,updateId:"brush-".concat(be)})}),lr(q,"renderReferenceElement",function(K,re,pe){if(!K)return null;var xe=q,ge=xe.clipPathId,Be=q.state,$e=Be.xAxisMap,Ve=Be.yAxisMap,be=Be.offset,_e=K.type.defaultProps||{},Me=K.props,ke=Me.xAxisId,Ce=ke===void 0?_e.xAxisId:ke,Oe=Me.yAxisId,at=Oe===void 0?_e.yAxisId:Oe;return De.cloneElement(K,{key:K.key||"".concat(re,"-").concat(pe),xAxis:$e[Ce],yAxis:Ve[at],viewBox:{x:be.left,y:be.top,width:be.width,height:be.height},clipPathId:ge})}),lr(q,"renderActivePoints",function(K){var re=K.item,pe=K.activePoint,xe=K.basePoint,ge=K.childIndex,Be=K.isRange,$e=[],Ve=re.props.key,be=re.item.type.defaultProps!==void 0?ut(ut({},re.item.type.defaultProps),re.item.props):re.item.props,_e=be.activeDot,Me=be.dataKey,ke=ut(ut({index:ge,dataKey:Me,cx:pe.x,cy:pe.y,r:4,fill:FP(re.item),strokeWidth:2,stroke:"#fff",payload:pe.payload,value:pe.value},Hr(_e,!1)),b0(_e));return $e.push($.renderActiveDot(_e,ke,"".concat(Ve,"-activePoint-").concat(ge))),xe?$e.push($.renderActiveDot(_e,ut(ut({},ke),{},{cx:xe.x,cy:xe.y}),"".concat(Ve,"-basePoint-").concat(ge))):Be&&$e.push(null),$e}),lr(q,"renderGraphicChild",function(K,re,pe){var xe=q.filterFormatItem(K,re,pe);if(!xe)return null;var ge=q.getTooltipEventType(),Be=q.state,$e=Be.isTooltipActive,Ve=Be.tooltipAxis,be=Be.activeTooltipIndex,_e=Be.activeLabel,Me=q.props.children,ke=Co(Me,Ws),Ce=xe.props,Oe=Ce.points,at=Ce.isRange,ft=Ce.baseLine,st=xe.item.type.defaultProps!==void 0?ut(ut({},xe.item.type.defaultProps),xe.item.props):xe.item.props,Ot=st.activeDot,St=st.hide,pr=st.activeBar,Tr=st.activeShape,Kr=!!(!St&&$e&&ke&&(Ot||pr||Tr)),yr={};ge!=="axis"&&ke&&ke.props.trigger==="click"?yr={onClick:wv(q.handleItemMouseEnter,K.props.onClick)}:ge!=="axis"&&(yr={onMouseLeave:wv(q.handleItemMouseLeave,K.props.onMouseLeave),onMouseEnter:wv(q.handleItemMouseEnter,K.props.onMouseEnter)});var kt=De.cloneElement(K,ut(ut({},xe.props),yr));function Xt(ri){return typeof Ve.dataKey=="function"?Ve.dataKey(ri.payload):null}if(Kr)if(be>=0){var Jt,et;if(Ve.dataKey&&!Ve.allowDuplicatedCategory){var Or=typeof Ve.dataKey=="function"?Xt:"payload.".concat(Ve.dataKey.toString());Jt=xS(Oe,Or,_e),et=at&&ft&&xS(ft,Or,_e)}else Jt=Oe==null?void 0:Oe[be],et=at&&ft&&ft[be];if(Tr||pr){var Qt=K.props.activeIndex!==void 0?K.props.activeIndex:be;return[De.cloneElement(K,ut(ut(ut({},xe.props),yr),{},{activeIndex:Qt})),null,null]}if(!Qr(Jt))return[kt].concat(gd(q.renderActivePoints({item:xe,activePoint:Jt,basePoint:et,childIndex:be,isRange:at})))}else{var Ir,ir=(Ir=q.getItemByXY(q.state.activeCoordinate))!==null&&Ir!==void 0?Ir:{graphicalItem:kt},kr=ir.graphicalItem,qn=kr.item,$n=qn===void 0?K:qn,tn=kr.childIndex,fi=ut(ut(ut({},xe.props),yr),{},{activeIndex:tn});return[De.cloneElement($n,fi),null,null]}return at?[kt,null,null]:[kt,null]}),lr(q,"renderCustomized",function(K,re,pe){return De.cloneElement(K,ut(ut({key:"recharts-customized-".concat(pe)},q.props),q.state))}),lr(q,"renderMap",{CartesianGrid:{handler:Pv,once:!0},ReferenceArea:{handler:q.renderReferenceElement},ReferenceLine:{handler:Pv},ReferenceDot:{handler:q.renderReferenceElement},XAxis:{handler:Pv},YAxis:{handler:Pv},Brush:{handler:q.renderBrush,once:!0},Bar:{handler:q.renderGraphicChild},Line:{handler:q.renderGraphicChild},Area:{handler:q.renderGraphicChild},Radar:{handler:q.renderGraphicChild},RadialBar:{handler:q.renderGraphicChild},Scatter:{handler:q.renderGraphicChild},Pie:{handler:q.renderGraphicChild},Funnel:{handler:q.renderGraphicChild},Tooltip:{handler:q.renderCursor,once:!0},PolarGrid:{handler:q.renderPolarGrid,once:!0},PolarAngleAxis:{handler:q.renderPolarAxis},PolarRadiusAxis:{handler:q.renderPolarAxis},Customized:{handler:q.renderCustomized}}),q.clipPathId="".concat((U=V.id)!==null&&U!==void 0?U:e1("recharts"),"-clip"),q.throttleTriggeredAfterMouseMove=Ij(q.triggeredAfterMouseMove,(G=V.throttleDelay)!==null&&G!==void 0?G:1e3/60),q.state={},q}return fge($,Z),lge($,[{key:"componentDidMount",value:function(){var U,G;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(U=this.props.margin.left)!==null&&U!==void 0?U:0,top:(G=this.props.margin.top)!==null&&G!==void 0?G:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var U=this.props,G=U.children,q=U.data,K=U.height,re=U.layout,pe=Co(G,Ws);if(pe){var xe=pe.props.defaultIndex;if(!(typeof xe!="number"||xe<0||xe>this.state.tooltipTicks.length-1)){var ge=this.state.tooltipTicks[xe]&&this.state.tooltipTicks[xe].value,Be=NE(this.state,q,xe,ge),$e=this.state.tooltipTicks[xe].coordinate,Ve=(this.state.offset.top+K)/2,be=re==="horizontal",_e=be?{x:$e,y:Ve}:{y:$e,x:Ve},Me=this.state.formattedGraphicalItems.find(function(Ce){var Oe=Ce.item;return Oe.type.name==="Scatter"});Me&&(_e=ut(ut({},_e),Me.props.points[xe].tooltipPosition),Be=Me.props.points[xe].tooltipPayload);var ke={activeTooltipIndex:xe,isTooltipActive:!0,activeLabel:ge,activePayload:Be,activeCoordinate:_e};this.setState(ke),this.renderCursor(pe),this.accessibilityManager.setIndex(xe)}}}},{key:"getSnapshotBeforeUpdate",value:function(U,G){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==G.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==U.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==U.margin){var q,K;this.accessibilityManager.setDetails({offset:{left:(q=this.props.margin.left)!==null&&q!==void 0?q:0,top:(K=this.props.margin.top)!==null&&K!==void 0?K:0}})}return null}},{key:"componentDidUpdate",value:function(U){wS([Co(U.children,Ws)],[Co(this.props.children,Ws)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var U=Co(this.props.children,Ws);if(U&&typeof U.props.shared=="boolean"){var G=U.props.shared?"axis":"item";return _.indexOf(G)>=0?G:h}return h}},{key:"getMouseInfo",value:function(U){if(!this.container)return null;var G=this.container,q=G.getBoundingClientRect(),K=Sne(q),re={chartX:Math.round(U.pageX-K.left),chartY:Math.round(U.pageY-K.top)},pe=q.width/G.offsetWidth||1,xe=this.inRange(re.chartX,re.chartY,pe);if(!xe)return null;var ge=this.state,Be=ge.xAxisMap,$e=ge.yAxisMap,Ve=this.getTooltipEventType(),be=pz(this.state,this.props.data,this.props.layout,xe);if(Ve!=="axis"&&Be&&$e){var _e=Yl(Be).scale,Me=Yl($e).scale,ke=_e&&_e.invert?_e.invert(re.chartX):null,Ce=Me&&Me.invert?Me.invert(re.chartY):null;return ut(ut({},re),{},{xValue:ke,yValue:Ce},be)}return be?ut(ut({},re),be):null}},{key:"inRange",value:function(U,G){var q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,K=this.props.layout,re=U/q,pe=G/q;if(K==="horizontal"||K==="vertical"){var xe=this.state.offset,ge=re>=xe.left&&re<=xe.left+xe.width&&pe>=xe.top&&pe<=xe.top+xe.height;return ge?{x:re,y:pe}:null}var Be=this.state,$e=Be.angleAxisMap,Ve=Be.radiusAxisMap;if($e&&Ve){var be=Yl($e);return Y3({x:re,y:pe},be)}return null}},{key:"parseEventsOfWrapper",value:function(){var U=this.props.children,G=this.getTooltipEventType(),q=Co(U,Ws),K={};q&&G==="axis"&&(q.props.trigger==="click"?K={onClick:this.handleClick}:K={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var re=b0(this.props,this.handleOuterEvent);return ut(ut({},re),K)}},{key:"addListener",value:function(){cT.on(hT,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){cT.removeListener(hT,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(U,G,q){for(var K=this.state.formattedGraphicalItems,re=0,pe=K.length;re<pe;re++){var xe=K[re];if(xe.item===U||xe.props.key===U.key||G===el(xe.item.type)&&q===xe.childIndex)return xe}return null}},{key:"renderClipPath",value:function(){var U=this.clipPathId,G=this.state.offset,q=G.left,K=G.top,re=G.height,pe=G.width;return Fe.createElement("defs",null,Fe.createElement("clipPath",{id:U},Fe.createElement("rect",{x:q,y:K,height:re,width:pe})))}},{key:"getXScales",value:function(){var U=this.state.xAxisMap;return U?Object.entries(U).reduce(function(G,q){var K=hz(q,2),re=K[0],pe=K[1];return ut(ut({},G),{},lr({},re,pe.scale))},{}):null}},{key:"getYScales",value:function(){var U=this.state.yAxisMap;return U?Object.entries(U).reduce(function(G,q){var K=hz(q,2),re=K[0],pe=K[1];return ut(ut({},G),{},lr({},re,pe.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(U){var G;return(G=this.state.xAxisMap)===null||G===void 0||(G=G[U])===null||G===void 0?void 0:G.scale}},{key:"getYScaleByAxisId",value:function(U){var G;return(G=this.state.yAxisMap)===null||G===void 0||(G=G[U])===null||G===void 0?void 0:G.scale}},{key:"getItemByXY",value:function(U){var G=this.state,q=G.formattedGraphicalItems,K=G.activeItem;if(q&&q.length)for(var re=0,pe=q.length;re<pe;re++){var xe=q[re],ge=xe.props,Be=xe.item,$e=Be.type.defaultProps!==void 0?ut(ut({},Be.type.defaultProps),Be.props):Be.props,Ve=el(Be.type);if(Ve==="Bar"){var be=(ge.data||[]).find(function(Ce){return the(U,Ce)});if(be)return{graphicalItem:xe,payload:be}}else if(Ve==="RadialBar"){var _e=(ge.data||[]).find(function(Ce){return Y3(U,Ce)});if(_e)return{graphicalItem:xe,payload:_e}}else if(v1(xe,K)||x1(xe,K)||Jg(xe,K)){var Me=ife({graphicalItem:xe,activeTooltipItem:K,itemData:$e.data}),ke=$e.activeIndex===void 0?Me:$e.activeIndex;return{graphicalItem:ut(ut({},xe),{},{childIndex:ke}),payload:Jg(xe,K)?$e.data[Me]:xe.props.data[Me]}}}return null}},{key:"render",value:function(){var U=this;if(!Uk(this))return null;var G=this.props,q=G.children,K=G.className,re=G.width,pe=G.height,xe=G.style,ge=G.compact,Be=G.title,$e=G.desc,Ve=fz(G,tge),be=Hr(Ve,!1);if(ge)return Fe.createElement(KL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Fe.createElement(SS,wf({},be,{width:re,height:pe,title:Be,desc:$e}),this.renderClipPath(),Gk(q,this.renderMap)));if(this.props.accessibilityLayer){var _e,Me;be.tabIndex=(_e=this.props.tabIndex)!==null&&_e!==void 0?_e:0,be.role=(Me=this.props.role)!==null&&Me!==void 0?Me:"application",be.onKeyDown=function(Ce){U.accessibilityManager.keyboardEvent(Ce)},be.onFocus=function(){U.accessibilityManager.focus()}}var ke=this.parseEventsOfWrapper();return Fe.createElement(KL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Fe.createElement("div",wf({className:en("recharts-wrapper",K),style:ut({position:"relative",cursor:"default",width:re,height:pe},xe)},ke,{ref:function(Oe){U.container=Oe}}),Fe.createElement(SS,wf({},be,{width:re,height:pe,title:Be,desc:$e,style:_ge}),this.renderClipPath(),Gk(q,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(De.Component);lr(j,"displayName",r),lr(j,"defaultProps",ut({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},A)),lr(j,"getDerivedStateFromProps",function(Z,$){var V=Z.dataKey,U=Z.data,G=Z.children,q=Z.width,K=Z.height,re=Z.layout,pe=Z.stackOffset,xe=Z.margin,ge=$.dataStartIndex,Be=$.dataEndIndex;if($.updateId===void 0){var $e=mz(Z);return ut(ut(ut({},$e),{},{updateId:0},L(ut(ut({props:Z},$e),{},{updateId:0}),$)),{},{prevDataKey:V,prevData:U,prevWidth:q,prevHeight:K,prevLayout:re,prevStackOffset:pe,prevMargin:xe,prevChildren:G})}if(V!==$.prevDataKey||U!==$.prevData||q!==$.prevWidth||K!==$.prevHeight||re!==$.prevLayout||pe!==$.prevStackOffset||!Lf(xe,$.prevMargin)){var Ve=mz(Z),be={chartX:$.chartX,chartY:$.chartY,isTooltipActive:$.isTooltipActive},_e=ut(ut({},pz($,U,re)),{},{updateId:$.updateId+1}),Me=ut(ut(ut({},Ve),be),_e);return ut(ut(ut({},Me),L(ut({props:Z},Me),$)),{},{prevDataKey:V,prevData:U,prevWidth:q,prevHeight:K,prevLayout:re,prevStackOffset:pe,prevMargin:xe,prevChildren:G})}if(!wS(G,$.prevChildren)){var ke,Ce,Oe,at,ft=Co(G,sd),st=ft&&(ke=(Ce=ft.props)===null||Ce===void 0?void 0:Ce.startIndex)!==null&&ke!==void 0?ke:ge,Ot=ft&&(Oe=(at=ft.props)===null||at===void 0?void 0:at.endIndex)!==null&&Oe!==void 0?Oe:Be,St=st!==ge||Ot!==Be,pr=!Qr(U),Tr=pr&&!St?$.updateId:$.updateId+1;return ut(ut({updateId:Tr},L(ut(ut({props:Z},$),{},{updateId:Tr,dataStartIndex:st,dataEndIndex:Ot}),$)),{},{prevChildren:G,dataStartIndex:st,dataEndIndex:Ot})}return null}),lr(j,"renderActiveDot",function(Z,$,V){var U;return De.isValidElement(Z)?U=De.cloneElement(Z,$):xr(Z)?U=Z($):U=Fe.createElement(X5,$),Fe.createElement(xi,{className:"recharts-active-dot",key:V},U)});var F=De.forwardRef(function($,V){return Fe.createElement(j,wf({},$,{ref:V}))});return F.displayName=j.displayName,F},qge=Mge({chartName:"BarChart",GraphicalChild:Ld,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:KP},{axisType:"yAxis",AxisComp:YP}],formatAxisMap:Cde}),FF={exports:{}};(function(e,t){var r={};(function(i,u){e.exports=u()})(Bm,function(){var i,u,h;function p(o,x){if(!i)i=x;else if(!u)u=x;else{var E="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",A={};i(A),h=x(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(h.workerUrl=window.URL.createObjectURL(new Blob([E],{type:"text/javascript"})))}}p(["exports"],function(o){var x=typeof self<"u"?self:{},E="2.15.0";let A;const O={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(A==null){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{A=r.API_URL_REGEX!=null?new RegExp(r.API_URL_REGEX):a}catch{A=a}}return A},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!O.API_URL)return null;try{const a=new URL(O.API_URL);return a.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":a.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},L={supported:!1,testSupport:function(a){!Z&&F&&($?V(a):j=a)}};let j,F,Z=!1,$=!1;function V(a){const n=a.createTexture();a.bindTexture(a.TEXTURE_2D,n);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,F),a.isContextLost())return;L.supported=!0}catch{}a.deleteTexture(n),Z=!0}x.document&&(F=x.document.createElement("img"),F.onload=function(){j&&V(j),j=null,$=!0},F.onerror=function(){Z=!0,j=null},F.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const U="01";function G(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var q=K;function K(a,n,s,c){this.cx=3*a,this.bx=3*(s-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(c-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=n,this.p2x=s,this.p2y=c}K.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,n){if(n===void 0&&(n=1e-6),a<0)return 0;if(a>1)return 1;for(var s=a,c=0;c<8;c++){var d=this.sampleCurveX(s)-a;if(Math.abs(d)<n)return s;var g=this.sampleCurveDerivativeX(s);if(Math.abs(g)<1e-6)break;s-=d/g}var v=0,w=1;for(s=a,c=0;c<20&&(d=this.sampleCurveX(s),!(Math.abs(d-a)<n));c++)a>d?v=s:w=s,s=.5*(w-v)+v;return s},solve:function(a,n){return this.sampleCurveY(this.solveCurveX(a,n))}};var re=G(q),pe=xe;function xe(a,n){this.x=a,this.y=n}xe.prototype={clone:function(){return new xe(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,n){return this.clone()._rotateAround(a,n)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var n=a.x-this.x,s=a.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,n){return Math.atan2(this.x*n-this.y*a,this.x*a+this.y*n)},_matMult:function(a){var n=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=n,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var n=Math.cos(a),s=Math.sin(a),c=s*this.x+n*this.y;return this.x=n*this.x-s*this.y,this.y=c,this},_rotateAround:function(a,n){var s=Math.cos(a),c=Math.sin(a),d=n.y+c*(this.x-n.x)+s*(this.y-n.y);return this.x=n.x+s*(this.x-n.x)-c*(this.y-n.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},xe.convert=function(a){return a instanceof xe?a:Array.isArray(a)?new xe(a[0],a[1]):a};var ge=G(pe);const Be=Math.PI/180,$e=180/Math.PI;function Ve(a){return a*Be}function be(a){return a*$e}const _e=[[0,0],[1,0],[1,1],[0,1]];function Me(a){if(a<=0)return 0;if(a>=1)return 1;const n=a*a,s=n*a;return 4*(a<.5?s:3*(a-n)+s-.75)}function ke(a,n,s,c){const d=new re(a,n,s,c);return function(g){return d.solve(g)}}const Ce=ke(.25,.1,.25,1);function Oe(a,n,s){return Math.min(s,Math.max(n,a))}function at(a,n,s){return(s=Oe((s-a)/(n-a),0,1))*s*(3-2*s)}function ft(a,n,s){const c=s-n,d=((a-n)%c+c)%c+n;return d===n?s:d}function st(a,n,s){if(!a.length)return s(null,[]);let c=a.length;const d=new Array(a.length);let g=null;a.forEach((v,w)=>{n(v,(S,P)=>{S&&(g=S),d[w]=P,--c==0&&s(g,d)})})}function Ot(a){const n=[];for(const s in a)n.push(a[s]);return n}function St(a,...n){for(const s of n)for(const c in s)a[c]=s[c];return a}let pr=1;function Tr(){return pr++}function Kr(){return function a(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function yr(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function kt(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function Xt(a,n){a.forEach(s=>{n[s]&&(n[s]=n[s].bind(n))})}function Jt(a,n){return a.indexOf(n,a.length-n.length)!==-1}function et(a,n,s){const c={};for(const d in a)c[d]=n.call(this,a[d],d,a);return c}function Or(a,n,s){const c={};for(const d in a)n.call(s||this,a[d],d,a)&&(c[d]=a[d]);return c}function Qt(a){return Array.isArray(a)?a.map(Qt):typeof a=="object"&&a?et(a,Qt):a}const Ir={};function ir(a){Ir[a]||(typeof console<"u"&&console.warn(a),Ir[a]=!0)}function kr(a,n,s){return(s.y-a.y)*(n.x-a.x)>(n.y-a.y)*(s.x-a.x)}function qn(a){let n=0;for(let s,c,d=0,g=a.length,v=g-1;d<g;v=d++)s=a[d],c=a[v],n+=(c.x-s.x)*(s.y+c.y);return n}function $n(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function tn(a){const n={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,c,d,g)=>{const v=d||g;return n[c]=!v||v.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let fi=null;function ri(a){if(fi==null){const n=a.navigator?a.navigator.userAgent:null;fi=!!a.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return fi}function ro(a){try{const n=x[a];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}function Wi(a,n){return[a[4*n],a[4*n+1],a[4*n+2],a[4*n+3]]}const no="mapbox-tiles";let fa=500,ws=50,di,jo;function Ya(){try{return x.caches}catch{}}function da(){Ya()&&!di&&(di=x.caches.open(no))}function pa(a){const n=a.indexOf("?");if(n<0)return a;const s=function(d){const g=d.indexOf("?");return g>0?d.slice(g+1).split("&"):[]}(a),c=s.filter(d=>{const g=d.split("=");return g[0]==="language"||g[0]==="worldview"});return c.length?`${a.slice(0,n)}?${c.join("&")}`:a.slice(0,n)}let Ts=1/0;const Ke={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ke);class tt extends Error{constructor(n,s,c){s===401&&Le(c)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const xt=$n()?()=>self.worker&&self.worker.referrer:()=>(x.location.protocol==="blob:"?x.parent:x).location.href,Rt=function(a,n){if(!(/^file:/.test(s=a.url)||/^file:/.test(xt())&&!/^\w+:/.test(s))){if(x.fetch&&x.Request&&x.AbortController&&x.Request.prototype.hasOwnProperty("signal"))return function(c,d){const g=new x.AbortController,v=new x.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:xt(),referrerPolicy:c.referrerPolicy,signal:g.signal});let w=!1,S=!1;const P=(I=v.url).indexOf("sku=")>0&&Le(I);var I;c.type==="json"&&v.headers.set("Accept","application/json");const D=(N,W,J)=>{if(S)return;if(N&&N.message!=="SecurityError"&&ir(N.toString()),W&&J)return z(W);const te=Date.now();x.fetch(v).then(le=>{if(le.ok){const ye=P?le.clone():null;return z(le,ye,te)}return d(new tt(le.statusText,le.status,c.url))}).catch(le=>{le.name!=="AbortError"&&d(new Error(`${le.message} ${c.url}`))})},z=(N,W,J)=>{(c.type==="arrayBuffer"?N.arrayBuffer():c.type==="json"?N.json():N.text()).then(te=>{S||(W&&J&&function(le,ye,ce){if(da(),!di)return;const me={status:ye.status,statusText:ye.statusText,headers:new x.Headers};ye.headers.forEach((Ze,Ue)=>me.headers.set(Ue,Ze));const Se=tn(ye.headers.get("Cache-Control")||"");if(Se["no-store"])return;Se["max-age"]&&me.headers.set("Expires",new Date(ce+1e3*Se["max-age"]).toUTCString());const we=me.headers.get("Expires");we&&(new Date(we).getTime()-ce<42e4||function(Ze,Ue){if(jo===void 0)try{new Response(new ReadableStream),jo=!0}catch{jo=!1}jo?Ue(Ze.body):Ze.blob().then(Ue)}(ye,Ze=>{const Ue=new x.Response(Ze,me);da(),di&&di.then(Qe=>Qe.put(pa(le.url),Ue)).catch(Qe=>ir(Qe.message))}))}(v,W,J),w=!0,d(null,te,N.headers.get("Cache-Control"),N.headers.get("Expires")))}).catch(te=>{S||d(new Error(te.message))})};return P?function(N,W){if(da(),!di)return W(null);const J=pa(N.url);di.then(te=>{te.match(J).then(le=>{const ye=function(ce){if(!ce)return!1;const me=new Date(ce.headers.get("Expires")||0),Se=tn(ce.headers.get("Cache-Control")||"");return me>Date.now()&&!Se["no-cache"]}(le);te.delete(J),ye&&te.put(J,le.clone()),W(null,le,ye)}).catch(W)}).catch(W)}(v,D):D(null,null),{cancel:()=>{S=!0,w||g.abort()}}}(a,n);if($n()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,n,void 0,!0)}var s;return function(c,d){const g=new x.XMLHttpRequest;g.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const v in c.headers)g.setRequestHeader(v,c.headers[v]);return c.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=c.credentials==="include",g.onerror=()=>{d(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let v=g.response;if(c.type==="json")try{v=JSON.parse(g.response)}catch(w){return d(w)}d(null,v,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else d(new tt(g.statusText,g.status,c.url))},g.send(c.body),{cancel:()=>g.abort()}}(a,n)},Kt=function(a,n){return Rt(St(a,{type:"arrayBuffer"}),n)};function Yt(a){const n=x.document.createElement("a");return n.href=a,n.protocol===x.document.location.protocol&&n.host===x.document.location.host}const ue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Y,Q;Y=[],Q=0;const he=function(a,n){if(L.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),Q>=O.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:a,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return Y.push(g),g}Q++;let s=!1;const c=()=>{if(!s)for(s=!0,Q--;Y.length&&Q<O.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Y.shift(),{requestParameters:v,callback:w,cancelled:S}=g;S||(g.cancel=he(v,w).cancel)}},d=Kt(a,(g,v,w,S)=>{c(),g?n(g):v&&(x.createImageBitmap?function(P,I){const D=new x.Blob([new Uint8Array(P)],{type:"image/png"});x.createImageBitmap(D).then(z=>{I(null,z)}).catch(z=>{I(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(P,I)=>n(P,I,w,S)):function(P,I){const D=new x.Image,z=x.URL;D.onload=()=>{I(null,D),z.revokeObjectURL(D.src),D.onload=null,x.requestAnimationFrame(()=>{D.src=ue})},D.onerror=()=>I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const N=new x.Blob([new Uint8Array(P)],{type:"image/png"});D.src=P.byteLength?z.createObjectURL(N):ue}(v,(P,I)=>n(P,I,w,S)))});return{cancel:()=>{d.cancel(),c()}}},ve="NO_ACCESS_TOKEN";function Te(a){return a.indexOf("mapbox:")===0}function Le(a){return O.API_URL_REGEX.test(a)}function Re(a){return O.API_CDN_URL_REGEX.test(a)}function Ie(a){return O.API_STYLE_REGEX.test(a)&&!qe(a)}function qe(a){return O.API_SPRITE_REGEX.test(a)}const yt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function wt(a){const n=a.match(yt);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function ct(a){const n=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${n}`}const Wt="mapbox.eventData";function er(a){if(!a)return null;const n=a.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(decodeURIComponent(x.atob(n[1]).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Zt{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const s=er(O.ACCESS_TOKEN);let c="";return c=s&&s.u?x.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,(d,g)=>String.fromCharCode(+("0x"+g)))):O.ACCESS_TOKEN||"",n?`${Wt}.${n}:${c}`:`${Wt}:${c}`}fetchEventData(){const n=ro("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(n)try{const d=x.localStorage.getItem(s);d&&(this.eventData=JSON.parse(d));const g=x.localStorage.getItem(c);g&&(this.anonId=g)}catch{ir("Unable to read from LocalStorage")}}saveEventData(){const n=ro("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(n)try{x.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&x.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{ir("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,s,c,d){if(!O.EVENTS_URL)return;const g=wt(O.EVENTS_URL);g.params.push(`access_token=${d||O.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(n).toISOString()},w=s?St(v,s):v,S={url:ct(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};this.pendingRequest=function(P,I){return Rt(St(P,{method:"POST"}),I)}(S,P=>{this.pendingRequest=null,c(P),this.saveEventData(),this.processRequests(d)})}queueRequest(n,s){this.queue.push(n),this.processRequests(s)}}const or=new class extends Zt{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,n){O.EVENTS_URL&&O.ACCESS_TOKEN&&Array.isArray(a)&&a.some(s=>Te(s)||Le(s))&&this.queueRequest(Date.now(),n)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=er(O.ACCESS_TOKEN),s=n?n.u:O.ACCESS_TOKEN;let c=s!==this.eventData.tokenU;kt(this.anonId)||(this.anonId=Kr(),c=!0);const d=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),v=new Date(d),w=(d-this.eventData.lastSuccess)/864e5;c=c||w>=1||w<-1||g.getDate()!==v.getDate()}else c=!0;c?this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:E,skuId:U,"enabled.telemetry":!1,userId:this.anonId},g=>{g||(this.eventData.lastSuccess=d,this.eventData.tokenU=s)},a):this.processRequests()}},ur=or.postTurnstileEvent.bind(or),qt=new class extends Zt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,n,s,c){this.skuToken=n,this.errorCb=c,O.EVENTS_URL&&(s||O.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},s):this.errorCb(new Error(ve)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),kt(this.anonId)||(this.anonId=Kr()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:E,skuId:U,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):n&&(this.success[n]=!0)},a))}},Mr=qt.postMapLoadEvent.bind(qt),un=new class extends Zt{constructor(){super("gljs.performance")}postPerformanceEvent(a,n){O.EVENTS_URL&&(a||O.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},a)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:s}=this.queue.shift(),c=function(d){const g=x.performance.getEntriesByType("resource"),v=x.performance.getEntriesByType("mark"),w=function(z){const N={};if(z){for(const W in z)if(W!=="other")for(const J of z[W]){const te=`${W}ResolveRangeMin`,le=`${W}ResolveRangeMax`,ye=`${W}RequestCount`,ce=`${W}RequestCachedCount`;N[te]=Math.min(N[te]||1/0,J.startTime),N[le]=Math.max(N[le]||-1/0,J.responseEnd);const me=Se=>{N[Se]===void 0&&(N[Se]=0),++N[Se]};J.transferSize!==void 0&&J.transferSize===0&&me(ce),me(ye)}}return N}(function(z,N){const W={};if(z)for(const J of z){const te=N(J);W[te]===void 0&&(W[te]=[]),W[te].push(J)}return W}(g,by)),S=x.devicePixelRatio,P=x.navigator.connection||x.navigator.mozConnection||x.navigator.webkitConnection,I={counters:[],metadata:[],attributes:[]},D=(z,N,W)=>{W!=null&&z.push({name:N,value:W.toString()})};for(const z in w)D(I.counters,z,w[z]);if(d.interactionRange[0]!==1/0&&d.interactionRange[1]!==-1/0&&(D(I.counters,"interactionRangeMin",d.interactionRange[0]),D(I.counters,"interactionRangeMax",d.interactionRange[1])),v)for(const z of Object.keys(Ja)){const N=Ja[z],W=v.find(J=>J.name===N);W&&D(I.counters,N,W.startTime)}return D(I.counters,"visibilityHidden",d.visibilityHidden),D(I.attributes,"style",function(z){if(z)for(const N of z){const W=N.name.split("?")[0];if(Ie(W)){const J=W.split("/").slice(-2);if(J.length===2)return`mapbox://styles/${J[0]}/${J[1]}`}}}(g)),D(I.attributes,"terrainEnabled",d.terrainEnabled?"true":"false"),D(I.attributes,"fogEnabled",d.fogEnabled?"true":"false"),D(I.attributes,"projection",d.projection),D(I.attributes,"zoom",d.zoom),D(I.metadata,"devicePixelRatio",S),D(I.metadata,"connectionEffectiveType",P?P.effectiveType:void 0),D(I.metadata,"navigatorUserAgent",x.navigator.userAgent),D(I.metadata,"screenWidth",x.screen.width),D(I.metadata,"screenHeight",x.screen.height),D(I.metadata,"windowWidth",x.innerWidth),D(I.metadata,"windowHeight",x.innerHeight),D(I.metadata,"mapWidth",d.width/S),D(I.metadata,"mapHeight",d.height/S),D(I.metadata,"webglRenderer",d.renderer),D(I.metadata,"webglVendor",d.vendor),D(I.metadata,"sdkVersion",E),D(I.metadata,"sdkIdentifier","mapbox-gl-js"),I}(s);for(const d of c.metadata);for(const d of c.counters);for(const d of c.attributes);this.postEvent(n,c,()=>{},a)}},fn=un.postPerformanceEvent.bind(un),Lr=new class extends Zt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,n,s,c){if(!O.API_URL||!O.SESSION_PATH)return;const d=wt(O.API_URL+O.SESSION_PATH);d.params.push(`sku=${n||""}`),d.params.push(`access_token=${c||O.ACCESS_TOKEN||""}`);const g={url:ct(d),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(v,w){return Rt(St(v,{method:"GET"}),w)}(g,v=>{this.pendingRequest=null,s(v),this.saveEventData(),this.processRequests(c)})}getSessionAPI(a,n,s,c){this.skuToken=n,this.errorCb=c,O.SESSION_PATH&&O.API_URL&&(s||O.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},s):this.errorCb(new Error(ve)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||this.getSession(s,this.skuToken,c=>{c?this.errorCb(c):n&&(this.success[n]=!0)},a)}},dn=Lr.getSessionAPI.bind(Lr),Zn=new Set,Ja={create:"create",load:"load",fullLoad:"fullLoad"},P1={mark(a){x.performance.mark(a)},measure(a,n,s){x.performance.measure(a,n,s)}};function by(a){const n=a.name.split("?")[0];return Re(n)&&n.includes("mapbox-gl.js")?"javascript":Re(n)&&n.includes("mapbox-gl.css")?"css":function(s){return O.API_FONTS_REGEX.test(s)}(n)?"fontRange":qe(n)?"sprite":Ie(n)?"style":function(s){return O.API_TILEJSON_REGEX.test(s)}(n)?"tilejson":"other"}const Sr=x.performance;function Rd(a){const n=a?a.url.toString():void 0;return Sr.getEntriesByName(n)}let Su,Bd,Xc,Fo;const ma={now:()=>Xc!==void 0?Xc:x.performance.now(),setNow(a){Xc=a},restoreNow(){Xc=void 0},frame(a){const n=x.requestAnimationFrame(a);return{cancel:()=>x.cancelAnimationFrame(n)}},getImageData(a,n=0){const{width:s,height:c}=a;Fo||(Fo=x.document.createElement("canvas"));const d=Fo.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return(s>Fo.width||c>Fo.height)&&(Fo.width=s,Fo.height=c),d.clearRect(-n,-n,s+2*n,c+2*n),d.drawImage(a,0,0,s,c),d.getImageData(-n,-n,s+2*n,c+2*n)},resolveURL:a=>(Su||(Su=x.document.createElement("a")),Su.href=a,Su.href),get devicePixelRatio(){return x.devicePixelRatio},get prefersReducedMotion(){return!!x.matchMedia&&(Bd==null&&(Bd=x.matchMedia("(prefers-reduced-motion: reduce)")),Bd.matches)}};function jd(a,n,s){s[a]&&s[a].indexOf(n)!==-1||(s[a]=s[a]||[],s[a].push(n))}function Fd(a,n,s){if(s&&s[a]){const c=s[a].indexOf(n);c!==-1&&s[a].splice(c,1)}}class Ss{constructor(n,s={}){St(this,s),this.type=n}}class ga extends Ss{constructor(n,s={}){super("error",St({error:n},s))}}class Eu{on(n,s){return this._listeners=this._listeners||{},jd(n,s,this._listeners),this}off(n,s){return Fd(n,s,this._listeners),Fd(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},jd(n,s,this._oneTimeListeners),this):new Promise(c=>this.once(n,c))}fire(n,s){typeof n=="string"&&(n=new Ss(n,s||{}));const c=n.type;if(this.listens(c)){n.target=this;const d=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const w of d)w.call(this,n);const g=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const w of g)Fd(c,w,this._oneTimeListeners),w.call(this,n);const v=this._eventedParent;v&&(St(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(n))}else n instanceof ga&&console.error(n.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var Je=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ya(a,...n){for(const s of n)for(const c in s)a[c]=s[c];return a}function Cn(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Hn(a){if(Array.isArray(a))return a.map(Hn);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const n={};for(const s in a)n[s]=Hn(a[s]);return n}return Cn(a)}class wy extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}var $o=wy;class $d{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[c,d]of s)this.bindings[c]=d}concat(n){return new $d(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}var Ty=$d;const pl={kind:"null"},Mt={kind:"number"},mr={kind:"string"},hr={kind:"boolean"},qi={kind:"color"},bo={kind:"object"},fr={kind:"value"},Zi={kind:"collator"},Au={kind:"formatted"},Es={kind:"resolvedImage"};function io(a,n){return{kind:"array",itemType:a,N:n}}function an(a){if(a.kind==="array"){const n=an(a.itemType);return typeof a.N=="number"?`array<${n}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${n}>`}return a.kind}const Sy=[pl,Mt,mr,hr,qi,Au,bo,io(fr),Es];function _a(a,n){if(n.kind==="error")return null;if(a.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!_a(a.itemType,n.itemType))&&(typeof a.N!="number"||a.N===n.N))return null}else{if(a.kind===n.kind)return null;if(a.kind==="value"){for(const s of Sy)if(!_a(s,n))return null}}return`Expected ${an(a)} but found ${an(n)} instead.`}function Pu(a,n){return n.some(s=>s.kind===a.kind)}function Mu(a,n){return n.some(s=>s==="null"?a===null:s==="array"?Array.isArray(a):s==="object"?a&&!Array.isArray(a)&&typeof a=="object":s===typeof a)}var Nd,Ey={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Cu(a){return(a=Math.round(a))<0?0:a>255?255:a}function Ou(a){return Cu(a[a.length-1]==="%"?parseFloat(a)/100*255:parseInt(a))}function Kc(a){return(n=a[a.length-1]==="%"?parseFloat(a)/100:parseFloat(a))<0?0:n>1?1:n;var n}function ml(a,n,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?a+(n-a)*s*6:2*s<1?n:3*s<2?a+(n-a)*(2/3-s)*6:a}try{Nd={}.parseCSSColor=function(a){var n,s=a.replace(/ /g,"").toLowerCase();if(s in Ey)return Ey[s].slice();if(s[0]==="#")return s.length===4?(n=parseInt(s.substr(1),16))>=0&&n<=4095?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:s.length===7&&(n=parseInt(s.substr(1),16))>=0&&n<=16777215?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var c=s.indexOf("("),d=s.indexOf(")");if(c!==-1&&d+1===s.length){var g=s.substr(0,c),v=s.substr(c+1,d-(c+1)).split(","),w=1;switch(g){case"rgba":if(v.length!==4)return null;w=Kc(v.pop());case"rgb":return v.length!==3?null:[Ou(v[0]),Ou(v[1]),Ou(v[2]),w];case"hsla":if(v.length!==4)return null;w=Kc(v.pop());case"hsl":if(v.length!==3)return null;var S=(parseFloat(v[0])%360+360)%360/360,P=Kc(v[1]),I=Kc(v[2]),D=I<=.5?I*(P+1):I+P-I*P,z=2*I-D;return[Cu(255*ml(z,D,S+1/3)),Cu(255*ml(z,D,S)),Cu(255*ml(z,D,S-1/3)),w];default:return null}}return null}}catch{}class Ci{constructor(n,s,c,d=1){this.r=n,this.g=s,this.b=c,this.a=d}static parse(n){if(!n)return;if(n instanceof Ci)return n;if(typeof n!="string")return;const s=Nd(n);return s?new Ci(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[n,s,c,d]=this.toArray();return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(c)},${d})`}toArray(){const{r:n,g:s,b:c,a:d}=this;return d===0?[0,0,0,0]:[255*n/d,255*s/d,255*c/d,d]}toArray01(){const{r:n,g:s,b:c,a:d}=this;return d===0?[0,0,0,0]:[n/d,s/d,c/d,d]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:c,a:d}=this;return[n,s,c,d]}}Ci.black=new Ci(0,0,0,1),Ci.white=new Ci(1,1,1,1),Ci.transparent=new Ci(0,0,0,0),Ci.red=new Ci(1,0,0,1),Ci.blue=new Ci(0,0,1,1);var Tn=Ci;class Ud{constructor(n,s,c){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vd{constructor(n,s,c,d,g){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=c,this.fontStack=d,this.textColor=g}}class Oi{constructor(n){this.sections=n}static fromString(n){return new Oi([new Vd(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Oi?n:Oi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.name]);continue}n.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toArray())),n.push(c)}return n}}class oo{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new oo({name:n,available:!1}):null}serialize(){return["image",this.name]}}function Ay(a,n,s,c){return typeof a=="number"&&a>=0&&a<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[a,n,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[a,n,s,c]:[a,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Iu(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Tn||a instanceof Ud||a instanceof Oi||a instanceof oo)return!0;if(Array.isArray(a)){for(const n of a)if(!Iu(n))return!1;return!0}if(typeof a=="object"){for(const n in a)if(!Iu(a[n]))return!1;return!0}return!1}function yn(a){if(a===null)return pl;if(typeof a=="string")return mr;if(typeof a=="boolean")return hr;if(typeof a=="number")return Mt;if(a instanceof Tn)return qi;if(a instanceof Ud)return Zi;if(a instanceof Oi)return Au;if(a instanceof oo)return Es;if(Array.isArray(a)){const n=a.length;let s;for(const c of a){const d=yn(c);if(s){if(s===d)continue;s=fr;break}s=d}return io(s||fr,n)}return bo}function ku(a){const n=typeof a;return a===null?"":n==="string"||n==="number"||n==="boolean"?String(a):a instanceof Tn||a instanceof Oi||a instanceof oo?a.toString():JSON.stringify(a)}class Gd{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Iu(n[1]))return s.error("invalid value");const c=n[1];let d=yn(c);const g=s.expectedType;return d.kind!=="array"||d.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(d=g),new Gd(d,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Tn?["rgba"].concat(this.value.toArray()):this.value instanceof Oi?this.value.serialize():this.value}}var As=Gd,ni=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const Wd={string:mr,number:Mt,boolean:hr,object:bo};class qd{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let c,d=1;const g=n[0];if(g==="array"){let w,S;if(n.length>2){const P=n[1];if(typeof P!="string"||!(P in Wd)||P==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);w=Wd[P],d++}else w=fr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);S=n[2],d++}c=io(w,S)}else c=Wd[g];const v=[];for(;d<n.length;d++){const w=s.parse(n[d],d,fr);if(!w)return null;v.push(w)}return new qd(c,v)}evaluate(n){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(n);if(!_a(this.type,yn(c)))return c;if(s===this.args.length-1)throw new ni(`Expected value to be of type ${an(this.type)}, but found ${an(yn(c))} instead.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const c=n.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){s.push(c.kind);const d=n.N;(typeof d=="number"||this.args.length>1)&&s.push(d)}}return s.concat(this.args.map(c=>c.serialize()))}}var va=qd;class Qa{constructor(n){this.type=Au,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const d=[];let g=!1;for(let v=1;v<=n.length-1;++v){const w=n[v];if(g&&typeof w=="object"&&!Array.isArray(w)){g=!1;let S=null;if(w["font-scale"]&&(S=s.parse(w["font-scale"],1,Mt),!S))return null;let P=null;if(w["text-font"]&&(P=s.parse(w["text-font"],1,io(mr)),!P))return null;let I=null;if(w["text-color"]&&(I=s.parse(w["text-color"],1,qi),!I))return null;const D=d[d.length-1];D.scale=S,D.font=P,D.textColor=I}else{const S=s.parse(n[v],1,fr);if(!S)return null;const P=S.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,d.push({content:S,scale:null,font:null,textColor:null})}}return new Qa(d)}evaluate(n){return new Oi(this.sections.map(s=>{const c=s.content.evaluate(n);return yn(c)===Es?new Vd("",c,null,null,null):new Vd(ku(c),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),n.push(c)}return n}}class Yc{constructor(n){this.type=Es,this.input=n}static parse(n,s){if(n.length!==2)return s.error("Expected two arguments.");const c=s.parse(n[1],1,mr);return c?new Yc(c):s.error("No image name provided.")}evaluate(n){const s=this.input.evaluate(n),c=oo.fromString(s);return c&&n.availableImages&&(c.available=n.availableImages.indexOf(s)>-1),c}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const M1={"to-boolean":hr,"to-color":qi,"to-number":Mt,"to-string":mr};class Zd{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[0];if((c==="to-boolean"||c==="to-string")&&n.length!==2)return s.error("Expected one argument.");const d=M1[c],g=[];for(let v=1;v<n.length;v++){const w=s.parse(n[v],v,fr);if(!w)return null;g.push(w)}return new Zd(d,g)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,c;for(const d of this.args){if(s=d.evaluate(n),c=null,s instanceof Tn)return s;if(typeof s=="string"){const g=n.parseColor(s);if(g)return g}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Ay(s[0],s[1],s[2],s[3]),!c))return new Tn(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new ni(c||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const c of this.args){if(s=c.evaluate(n),s===null)return 0;const d=Number(s);if(!isNaN(d))return d}throw new ni(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Oi.fromString(ku(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?oo.fromString(ku(this.args[0].evaluate(n))):ku(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Qa([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Yc(this.args[0]).serialize();const n=[`to-${this.type.kind}`];return this.eachChild(s=>{n.push(s.serialize())}),n}}var gl=Zd;const No=["Unknown","Point","LineString","Polygon"];var Hd=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?No[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:s,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*n-a[0])+this.featureDistanceData.bearing[1]*(c*n-a[1])}return 0}parseColor(a){let n=this._parseColorCache[a];return n||(n=this._parseColorCache[a]=Tn.parse(a)),n}};class Ps{constructor(n,s,c,d){this.name=n,this.type=s,this._evaluate=c,this.args=d}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,s){const c=n[0],d=Ps.definitions[c];if(!d)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(d)?d[0]:d.type,v=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,w=v.filter(([P])=>!Array.isArray(P)||P.length===n.length-1);let S=null;for(const[P,I]of w){S=new ep(s.registry,s.path,null,s.scope);const D=[];let z=!1;for(let N=1;N<n.length;N++){const W=n[N],J=Array.isArray(P)?P[N-1]:P.type,te=S.parse(W,1+D.length,J);if(!te){z=!0;break}D.push(te)}if(!z)if(Array.isArray(P)&&P.length!==D.length)S.error(`Expected ${P.length} arguments, but found ${D.length} instead.`);else{for(let N=0;N<D.length;N++){const W=Array.isArray(P)?P[N]:P.type,J=D[N];S.concat(N+1).checkSubtype(W,J.type)}if(S.errors.length===0)return new Ps(c,g,I,D)}}if(w.length===1)s.errors.push(...S.errors);else{const P=(w.length?w:v).map(([D])=>{return z=D,Array.isArray(z)?`(${z.map(an).join(", ")})`:`(${an(z.type)}...)`;var z}).join(" | "),I=[];for(let D=1;D<n.length;D++){const z=s.parse(n[D],1+I.length);if(!z)return null;I.push(an(z.type))}s.error(`Expected arguments of type ${P}, but found (${I.join(", ")}) instead.`)}return null}static register(n,s){Ps.definitions=s;for(const c in s)n[c]=Ps}}var xa=Ps;class Du{constructor(n,s,c){this.type=Zi,this.locale=c,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const c=n[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const d=s.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,hr);if(!d)return null;const g=s.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,hr);if(!g)return null;let v=null;return c.locale&&(v=s.parse(c.locale,1,mr),!v)?null:new Du(d,g,v)}evaluate(n){return new Ud(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}const ba=8192;function Jc(a,n){a[0]=Math.min(a[0],n[0]),a[1]=Math.min(a[1],n[1]),a[2]=Math.max(a[2],n[0]),a[3]=Math.max(a[3],n[1])}function yl(a,n){return!(a[0]<=n[0]||a[2]>=n[2]||a[1]<=n[1]||a[3]>=n[3])}function Lu(a,n){const s=(180+a[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,d=Math.pow(2,n.z);return[Math.round(s*d*ba),Math.round(c*d*ba)]}function Py(a,n,s){const c=a[0]-n[0],d=a[1]-n[1],g=a[0]-s[0],v=a[1]-s[1];return c*v-g*d==0&&c*g<=0&&d*v<=0}function Qc(a,n){let s=!1;for(let v=0,w=n.length;v<w;v++){const S=n[v];for(let P=0,I=S.length;P<I-1;P++){if(Py(a,S[P],S[P+1]))return!1;(d=S[P])[1]>(c=a)[1]!=(g=S[P+1])[1]>c[1]&&c[0]<(g[0]-d[0])*(c[1]-d[1])/(g[1]-d[1])+d[0]&&(s=!s)}}var c,d,g;return s}function Xd(a,n){for(let s=0;s<n.length;s++)if(Qc(a,n[s]))return!0;return!1}function Kd(a,n,s,c){const d=c[0]-s[0],g=c[1]-s[1],v=(a[0]-s[0])*g-d*(a[1]-s[1]),w=(n[0]-s[0])*g-d*(n[1]-s[1]);return v>0&&w<0||v<0&&w>0}function _l(a,n,s){for(const P of s)for(let I=0;I<P.length-1;++I)if((w=[(v=P[I+1])[0]-(g=P[I])[0],v[1]-g[1]])[0]*(S=[(d=n)[0]-(c=a)[0],d[1]-c[1]])[1]-w[1]*S[0]!=0&&Kd(c,d,g,v)&&Kd(g,v,c,d))return!0;var c,d,g,v,w,S;return!1}function Er(a,n){for(let s=0;s<a.length;++s)if(!Qc(a[s],n))return!1;for(let s=0;s<a.length-1;++s)if(_l(a[s],a[s+1],n))return!1;return!0}function C1(a,n){for(let s=0;s<n.length;s++)if(Er(a,n[s]))return!0;return!1}function Yd(a,n,s){const c=[];for(let d=0;d<a.length;d++){const g=[];for(let v=0;v<a[d].length;v++){const w=Lu(a[d][v],s);Jc(n,w),g.push(w)}c.push(g)}return c}function My(a,n,s){const c=[];for(let d=0;d<a.length;d++){const g=Yd(a[d],n,s);c.push(g)}return c}function Jd(a,n,s,c){if(a[0]<s[0]||a[0]>s[2]){const d=.5*c;let g=a[0]-s[0]>d?-c:s[0]-a[0]>d?c:0;g===0&&(g=a[0]-s[2]>d?-c:s[2]-a[0]>d?c:0),a[0]+=g}Jc(n,a)}function Cy(a,n,s,c){const d=Math.pow(2,c.z)*ba,g=[c.x*ba,c.y*ba],v=[];if(!a)return v;for(const w of a)for(const S of w){const P=[S.x+g[0],S.y+g[1]];Jd(P,n,s,d),v.push(P)}return v}function Qd(a,n,s,c){const d=Math.pow(2,c.z)*ba,g=[c.x*ba,c.y*ba],v=[];if(!a)return v;for(const S of a){const P=[];for(const I of S){const D=[I.x+g[0],I.y+g[1]];Jc(n,D),P.push(D)}v.push(P)}if(n[2]-n[0]<=d/2){(w=n)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const S of v)for(const P of S)Jd(P,n,s,d)}var w;return v}class vl{constructor(n,s){this.type=hr,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Iu(n[1])){const c=n[1];if(c.type==="FeatureCollection")for(let d=0;d<c.features.length;++d){const g=c.features[d].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new vl(c,c.features[d].geometry)}else if(c.type==="Feature"){const d=c.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new vl(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new vl(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,c){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(c.type==="Polygon"){const w=Yd(c.coordinates,g,v),S=Cy(s.geometry(),d,g,v);if(!yl(d,g))return!1;for(const P of S)if(!Qc(P,w))return!1}if(c.type==="MultiPolygon"){const w=My(c.coordinates,g,v),S=Cy(s.geometry(),d,g,v);if(!yl(d,g))return!1;for(const P of S)if(!Xd(P,w))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,c){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(c.type==="Polygon"){const w=Yd(c.coordinates,g,v),S=Qd(s.geometry(),d,g,v);if(!yl(d,g))return!1;for(const P of S)if(!Er(P,w))return!1}if(c.type==="MultiPolygon"){const w=My(c.coordinates,g,v),S=Qd(s.geometry(),d,g,v);if(!yl(d,g))return!1;for(const P of S)if(!C1(P,w))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var eh=vl;function xl(a){if(a instanceof xa&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof eh)return!1;let n=!0;return a.eachChild(s=>{n&&!xl(s)&&(n=!1)}),n}function wa(a){if(a instanceof xa&&a.name==="feature-state")return!1;let n=!0;return a.eachChild(s=>{n&&!wa(s)&&(n=!1)}),n}function Ms(a,n){if(a instanceof xa&&n.indexOf(a.name)>=0)return!1;let s=!0;return a.eachChild(c=>{s&&!Ms(c,n)&&(s=!1)}),s}class th{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=n[1];return s.scope.has(c)?new th(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Oy=th;class zu{constructor(n,s=[],c,d=new Ty,g=[]){this.registry=n,this.path=s,this.key=s.map(v=>`[${v}]`).join(""),this.scope=d,this.errors=g,this.expectedType=c}parse(n,s,c,d,g={}){return s?this.concat(s,c,d)._parse(n,g):this._parse(n,g)}_parse(n,s){function c(d,g,v){return v==="assert"?new va(g,[d]):v==="coerce"?new gl(g,[d]):d}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=n[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[d];if(g){let v=g.parse(n,this);if(!v)return null;if(this.expectedType){const w=this.expectedType,S=v.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||S.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(w,S))return null}else v=c(v,w,s.typeAnnotation||"coerce");else v=c(v,w,s.typeAnnotation||"assert")}if(!(v instanceof As)&&v.type.kind!=="resolvedImage"&&tp(v)){const w=new Hd;try{v=new As(v.type,v.evaluate(w))}catch(S){return this.error(S.message),null}}return v}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,c){const d=typeof n=="number"?this.path.concat(n):this.path,g=c?this.scope.concat(c):this.scope;return new zu(this.registry,d,s||null,g,this.errors)}error(n,...s){const c=`${this.key}${s.map(d=>`[${d}]`).join("")}`;this.errors.push(new $o(c,n))}checkSubtype(n,s){const c=_a(n,s);return c&&this.error(c),c}}var ep=zu;function tp(a){if(a instanceof Oy)return tp(a.boundExpression);if(a instanceof xa&&a.name==="error"||a instanceof Du||a instanceof eh)return!1;const n=a instanceof gl||a instanceof va;let s=!0;return a.eachChild(c=>{s=n?s&&tp(c):s&&c instanceof As}),!!s&&xl(a)&&Ms(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function rh(a,n){const s=a.length-1;let c,d,g=0,v=s,w=0;for(;g<=v;)if(w=Math.floor((g+v)/2),c=a[w],d=a[w+1],c<=n){if(w===s||n<d)return w;g=w+1}else{if(!(c>n))throw new ni("Input is not a number.");v=w-1}return 0}class nh{constructor(n,s,c){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[d,g]of c)this.labels.push(d),this.outputs.push(g)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(n[1],1,Mt);if(!c)return null;const d=[];let g=null;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);for(let v=1;v<n.length;v+=2){const w=v===1?-1/0:n[v],S=n[v+1],P=v,I=v+1;if(typeof w!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(d.length&&d[d.length-1][0]>=w)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const D=s.parse(S,I,g);if(!D)return null;g=g||D.type,d.push([w,D])}return new nh(g,c,d)}evaluate(n){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(n);const d=this.input.evaluate(n);if(d<=s[0])return c[0].evaluate(n);const g=s.length;return d>=s[g-1]?c[g-1].evaluate(n):c[rh(s,d)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}var rp=nh;function gr(a,n,s){return a*(1-s)+n*s}var Ru=Object.freeze({__proto__:null,array:function(a,n,s){return a.map((c,d)=>gr(c,n[d],s))},color:function(a,n,s){return new Tn(gr(a.r,n.r,s),gr(a.g,n.g,s),gr(a.b,n.b,s),gr(a.a,n.a,s))},number:gr});const Iy=.95047,np=1.08883,ky=4/29,Cs=6/29,ip=3*Cs*Cs,O1=Cs*Cs*Cs,I1=Math.PI/180,k1=180/Math.PI;function op(a){return a>O1?Math.pow(a,1/3):a/ip+ky}function ap(a){return a>Cs?a*a*a:ip*(a-ky)}function sp(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function ih(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Dy(a){const n=ih(a.r),s=ih(a.g),c=ih(a.b),d=op((.4124564*n+.3575761*s+.1804375*c)/Iy),g=op((.2126729*n+.7151522*s+.072175*c)/1);return{l:116*g-16,a:500*(d-g),b:200*(g-op((.0193339*n+.119192*s+.9503041*c)/np)),alpha:a.a}}function Ly(a){let n=(a.l+16)/116,s=isNaN(a.a)?n:n+a.a/500,c=isNaN(a.b)?n:n-a.b/200;return n=1*ap(n),s=Iy*ap(s),c=np*ap(c),new Tn(sp(3.2404542*s-1.5371385*n-.4985314*c),sp(-.969266*s+1.8760108*n+.041556*c),sp(.0556434*s-.2040259*n+1.0572252*c),a.alpha)}function D1(a,n,s){const c=n-a;return a+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const Bu={forward:Dy,reverse:Ly,interpolate:function(a,n,s){return{l:gr(a.l,n.l,s),a:gr(a.a,n.a,s),b:gr(a.b,n.b,s),alpha:gr(a.alpha,n.alpha,s)}}},bl={forward:function(a){const{l:n,a:s,b:c}=Dy(a),d=Math.atan2(c,s)*k1;return{h:d<0?d+360:d,c:Math.sqrt(s*s+c*c),l:n,alpha:a.a}},reverse:function(a){const n=a.h*I1,s=a.c;return Ly({l:a.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:a.alpha})},interpolate:function(a,n,s){return{h:D1(a.h,n.h,s),c:gr(a.c,n.c,s),l:gr(a.l,n.l,s),alpha:gr(a.alpha,n.alpha,s)}}};var lp=Object.freeze({__proto__:null,hcl:bl,lab:Bu});class ju{constructor(n,s,c,d,g){this.type=n,this.operator=s,this.interpolation=c,this.input=d,this.labels=[],this.outputs=[];for(const[v,w]of g)this.labels.push(v),this.outputs.push(w)}static interpolationFactor(n,s,c,d){let g=0;if(n.name==="exponential")g=up(s,n.base,c,d);else if(n.name==="linear")g=up(s,1,c,d);else if(n.name==="cubic-bezier"){const v=n.controlPoints;g=new re(v[0],v[1],v[2],v[3]).solve(up(s,1,c,d))}return g}static parse(n,s){let[c,d,g,...v]=n;if(!Array.isArray(d)||d.length===0)return s.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const P=d[1];if(typeof P!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:P}}else{if(d[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const P=d.slice(1);if(P.length!==4||P.some(I=>typeof I!="number"||I<0||I>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:P}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(g=s.parse(g,2,Mt),!g)return null;const w=[];let S=null;c==="interpolate-hcl"||c==="interpolate-lab"?S=qi:s.expectedType&&s.expectedType.kind!=="value"&&(S=s.expectedType);for(let P=0;P<v.length;P+=2){const I=v[P],D=v[P+1],z=P+3,N=P+4;if(typeof I!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(w.length&&w[w.length-1][0]>=I)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const W=s.parse(D,N,S);if(!W)return null;S=S||W.type,w.push([I,W])}return S.kind==="number"||S.kind==="color"||S.kind==="array"&&S.itemType.kind==="number"&&typeof S.N=="number"?new ju(S,c,d,g,w):s.error(`Type ${an(S)} is not interpolatable.`)}evaluate(n){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(n);const d=this.input.evaluate(n);if(d<=s[0])return c[0].evaluate(n);const g=s.length;if(d>=s[g-1])return c[g-1].evaluate(n);const v=rh(s,d),w=ju.interpolationFactor(this.interpolation,d,s[v],s[v+1]),S=c[v].evaluate(n),P=c[v+1].evaluate(n);return this.operator==="interpolate"?Ru[this.type.kind.toLowerCase()](S,P,w):this.operator==="interpolate-hcl"?bl.reverse(bl.interpolate(bl.forward(S),bl.forward(P),w)):Bu.reverse(Bu.interpolate(Bu.forward(S),Bu.forward(P),w))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function up(a,n,s,c){const d=c-s,g=a-s;return d===0?0:n===1?g/d:(Math.pow(n,g)-1)/(Math.pow(n,d)-1)}var Uo=ju;class oh{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let c=null;const d=s.expectedType;d&&d.kind!=="value"&&(c=d);const g=[];for(const w of n.slice(1)){const S=s.parse(w,1+g.length,c,void 0,{typeAnnotation:"omit"});if(!S)return null;c=c||S.type,g.push(S)}const v=d&&g.some(w=>_a(d,w.type));return new oh(v?fr:c,g)}evaluate(n){let s,c=null,d=0;for(const g of this.args){if(d++,c=g.evaluate(n),c&&c instanceof oo&&!c.available&&(s||(s=c),c=null,d===this.args.length))return s;if(c!==null)break}return c}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(s=>{n.push(s.serialize())}),n}}var cp=oh;class ah{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const c=[];for(let g=1;g<n.length-1;g+=2){const v=n[g];if(typeof v!="string")return s.error(`Expected string, but found ${typeof v} instead.`,g);if(/[^a-zA-Z0-9_]/.test(v))return s.error("Variable names must contain only alphanumeric characters or '_'.",g);const w=s.parse(n[g+1],g+1);if(!w)return null;c.push([v,w])}const d=s.parse(n[n.length-1],n.length-1,s.expectedType,c);return d?new ah(c,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,c]of this.bindings)n.push(s,c.serialize());return n.push(this.result.serialize()),n}}var zy=ah;class hp{constructor(n,s,c){this.type=n,this.index=s,this.input=c}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Mt),d=s.parse(n[2],2,io(s.expectedType||fr));return c&&d?new hp(d.type.itemType,c,d):null}evaluate(n){const s=this.index.evaluate(n),c=this.input.evaluate(n);if(s<0)throw new ni(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new ni(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new ni(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var L1=hp;class fp{constructor(n,s){this.type=hr,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,fr),d=s.parse(n[2],2,fr);return c&&d?Pu(c.type,[hr,mr,Mt,pl,fr])?new fp(c,d):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(c.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(c==null)return!1;if(!Mu(s,["boolean","string","number","null"]))throw new ni(`Expected first argument to be of type boolean, string, number or null, but found ${an(yn(s))} instead.`);if(!Mu(c,["string","array"]))throw new ni(`Expected second argument to be of type array or string, but found ${an(yn(c))} instead.`);return c.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var sh=fp;class Fu{constructor(n,s,c){this.type=Mt,this.needle=n,this.haystack=s,this.fromIndex=c}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,fr),d=s.parse(n[2],2,fr);if(!c||!d)return null;if(!Pu(c.type,[hr,mr,Mt,pl,fr]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(c.type)} instead`);if(n.length===4){const g=s.parse(n[3],3,Mt);return g?new Fu(c,d,g):null}return new Fu(c,d)}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!Mu(s,["boolean","string","number","null"]))throw new ni(`Expected first argument to be of type boolean, string, number or null, but found ${an(yn(s))} instead.`);if(!Mu(c,["string","array"]))throw new ni(`Expected second argument to be of type array or string, but found ${an(yn(c))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(n);return c.indexOf(s,d)}return c.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Ry=Fu;class dp{constructor(n,s,c,d,g,v){this.inputType=n,this.type=s,this.input=c,this.cases=d,this.outputs=g,this.otherwise=v}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let c,d;s.expectedType&&s.expectedType.kind!=="value"&&(d=s.expectedType);const g={},v=[];for(let P=2;P<n.length-1;P+=2){let I=n[P];const D=n[P+1];Array.isArray(I)||(I=[I]);const z=s.concat(P);if(I.length===0)return z.error("Expected at least one branch label.");for(const W of I){if(typeof W!="number"&&typeof W!="string")return z.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return z.error("Numeric branch labels must be integer values.");if(c){if(z.checkSubtype(c,yn(W)))return null}else c=yn(W);if(g[String(W)]!==void 0)return z.error("Branch labels must be unique.");g[String(W)]=v.length}const N=s.parse(D,P,d);if(!N)return null;d=d||N.type,v.push(N)}const w=s.parse(n[1],1,fr);if(!w)return null;const S=s.parse(n[n.length-1],n.length-1,d);return S?w.type.kind!=="value"&&s.concat(1).checkSubtype(c,w.type)?null:new dp(c,d,w,g,v,S):null}evaluate(n){const s=this.input.evaluate(n);return(yn(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],d={};for(const v of s){const w=d[this.cases[v]];w===void 0?(d[this.cases[v]]=c.length,c.push([this.cases[v],[v]])):c[w][1].push(v)}const g=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,w]of c)n.push(w.length===1?g(w[0]):w.map(g)),n.push(this.outputs[v].serialize());return n.push(this.otherwise.serialize()),n}}var z1=dp;class pp{constructor(n,s,c){this.type=n,this.branches=s,this.otherwise=c}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const d=[];for(let v=1;v<n.length-1;v+=2){const w=s.parse(n[v],v,hr);if(!w)return null;const S=s.parse(n[v+1],v+1,c);if(!S)return null;d.push([w,S]),c=c||S.type}const g=s.parse(n[n.length-1],n.length-1,c);return g?new pp(c,d,g):null}evaluate(n){for(const[s,c]of this.branches)if(s.evaluate(n))return c.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,c]of this.branches)n(s),n(c);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(s=>{n.push(s.serialize())}),n}}var By=pp;class $u{constructor(n,s,c,d){this.type=n,this.input=s,this.beginIndex=c,this.endIndex=d}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,fr),d=s.parse(n[2],2,Mt);if(!c||!d)return null;if(!Pu(c.type,[io(fr),mr,fr]))return s.error(`Expected first argument to be of type array or string, but found ${an(c.type)} instead`);if(n.length===4){const g=s.parse(n[3],3,Mt);return g?new $u(c.type,c,d,g):null}return new $u(c.type,c,d)}evaluate(n){const s=this.input.evaluate(n),c=this.beginIndex.evaluate(n);if(!Mu(s,["string","array"]))throw new ni(`Expected first argument to be of type array or string, but found ${an(yn(s))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(n);return s.slice(c,d)}return s.slice(c)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var jy=$u;function lh(a,n){return a==="=="||a==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Fy(a,n,s,c){return c.compare(n,s)===0}function wl(a,n,s){const c=a!=="=="&&a!=="!=";return class $F{constructor(g,v,w){this.type=hr,this.lhs=g,this.rhs=v,this.collator=w,this.hasUntypedArgument=g.type.kind==="value"||v.type.kind==="value"}static parse(g,v){if(g.length!==3&&g.length!==4)return v.error("Expected two or three arguments.");const w=g[0];let S=v.parse(g[1],1,fr);if(!S)return null;if(!lh(w,S.type))return v.concat(1).error(`"${w}" comparisons are not supported for type '${an(S.type)}'.`);let P=v.parse(g[2],2,fr);if(!P)return null;if(!lh(w,P.type))return v.concat(2).error(`"${w}" comparisons are not supported for type '${an(P.type)}'.`);if(S.type.kind!==P.type.kind&&S.type.kind!=="value"&&P.type.kind!=="value")return v.error(`Cannot compare types '${an(S.type)}' and '${an(P.type)}'.`);c&&(S.type.kind==="value"&&P.type.kind!=="value"?S=new va(P.type,[S]):S.type.kind!=="value"&&P.type.kind==="value"&&(P=new va(S.type,[P])));let I=null;if(g.length===4){if(S.type.kind!=="string"&&P.type.kind!=="string"&&S.type.kind!=="value"&&P.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(I=v.parse(g[3],3,Zi),!I)return null}return new $F(S,P,I)}evaluate(g){const v=this.lhs.evaluate(g),w=this.rhs.evaluate(g);if(c&&this.hasUntypedArgument){const S=yn(v),P=yn(w);if(S.kind!==P.kind||S.kind!=="string"&&S.kind!=="number")throw new ni(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${S.kind}, ${P.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const S=yn(v),P=yn(w);if(S.kind!=="string"||P.kind!=="string")return n(g,v,w)}return this.collator?s(g,v,w,this.collator.evaluate(g)):n(g,v,w)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[a];return this.eachChild(v=>{g.push(v.serialize())}),g}}}const R1=wl("==",function(a,n,s){return n===s},Fy),B1=wl("!=",function(a,n,s){return n!==s},function(a,n,s,c){return!Fy(0,n,s,c)}),j1=wl("<",function(a,n,s){return n<s},function(a,n,s,c){return c.compare(n,s)<0}),F1=wl(">",function(a,n,s){return n>s},function(a,n,s,c){return c.compare(n,s)>0}),$1=wl("<=",function(a,n,s){return n<=s},function(a,n,s,c){return c.compare(n,s)<=0}),$y=wl(">=",function(a,n,s){return n>=s},function(a,n,s,c){return c.compare(n,s)>=0});class uh{constructor(n,s,c,d,g,v){this.type=mr,this.number=n,this.locale=s,this.currency=c,this.unit=d,this.minFractionDigits=g,this.maxFractionDigits=v}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const c=s.parse(n[1],1,Mt);if(!c)return null;const d=n[2];if(typeof d!="object"||Array.isArray(d))return s.error("NumberFormat options argument must be an object.");let g=null;if(d.locale&&(g=s.parse(d.locale,1,mr),!g))return null;let v=null;if(d.currency&&(v=s.parse(d.currency,1,mr),!v))return null;let w=null;if(d.unit&&(w=s.parse(d.unit,1,mr),!w))return null;let S=null;if(d["min-fraction-digits"]&&(S=s.parse(d["min-fraction-digits"],1,Mt),!S))return null;let P=null;return d["max-fraction-digits"]&&(P=s.parse(d["max-fraction-digits"],1,Mt),!P)?null:new uh(c,g,v,w,S,P)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Tl{constructor(n){this.type=Mt,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const c=s.parse(n[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${an(c.type)} instead.`):new Tl(c):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new ni(`Expected value to be of type string or array, but found ${an(yn(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(s=>{n.push(s.serialize())}),n}}const Ny={"==":R1,"!=":B1,">":F1,"<":j1,">=":$y,"<=":$1,array:va,at:L1,boolean:va,case:By,coalesce:cp,collator:Du,format:Qa,image:Yc,in:sh,"index-of":Ry,interpolate:Uo,"interpolate-hcl":Uo,"interpolate-lab":Uo,length:Tl,let:zy,literal:As,match:z1,number:va,"number-format":uh,object:va,slice:jy,step:rp,string:va,"to-boolean":gl,"to-color":gl,"to-number":gl,"to-string":gl,var:Oy,within:eh};function Uy(a,[n,s,c,d]){n=n.evaluate(a),s=s.evaluate(a),c=c.evaluate(a);const g=d?d.evaluate(a):1,v=Ay(n,s,c,g);if(v)throw new ni(v);return new Tn(n/255*g,s/255*g,c/255*g,g)}function Ta(a,n){return a in n}function ch(a,n){const s=n[a];return s===void 0?null:s}function ao(a){return{type:a}}xa.register(Ny,{error:[{kind:"error"},[mr],(a,[n])=>{throw new ni(n.evaluate(a))}],typeof:[mr,[fr],(a,[n])=>an(yn(n.evaluate(a)))],"to-rgba":[io(Mt,4),[qi],(a,[n])=>n.evaluate(a).toArray()],rgb:[qi,[Mt,Mt,Mt],Uy],rgba:[qi,[Mt,Mt,Mt,Mt],Uy],has:{type:hr,overloads:[[[mr],(a,[n])=>Ta(n.evaluate(a),a.properties())],[[mr,bo],(a,[n,s])=>Ta(n.evaluate(a),s.evaluate(a))]]},get:{type:fr,overloads:[[[mr],(a,[n])=>ch(n.evaluate(a),a.properties())],[[mr,bo],(a,[n,s])=>ch(n.evaluate(a),s.evaluate(a))]]},"feature-state":[fr,[mr],(a,[n])=>ch(n.evaluate(a),a.featureState||{})],properties:[bo,[],a=>a.properties()],"geometry-type":[mr,[],a=>a.geometryType()],id:[fr,[],a=>a.id()],zoom:[Mt,[],a=>a.globals.zoom],pitch:[Mt,[],a=>a.globals.pitch||0],"distance-from-center":[Mt,[],a=>a.distanceFromCenter()],"heatmap-density":[Mt,[],a=>a.globals.heatmapDensity||0],"line-progress":[Mt,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[Mt,[],a=>a.globals.skyRadialProgress||0],accumulated:[fr,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Mt,ao(Mt),(a,n)=>{let s=0;for(const c of n)s+=c.evaluate(a);return s}],"*":[Mt,ao(Mt),(a,n)=>{let s=1;for(const c of n)s*=c.evaluate(a);return s}],"-":{type:Mt,overloads:[[[Mt,Mt],(a,[n,s])=>n.evaluate(a)-s.evaluate(a)],[[Mt],(a,[n])=>-n.evaluate(a)]]},"/":[Mt,[Mt,Mt],(a,[n,s])=>n.evaluate(a)/s.evaluate(a)],"%":[Mt,[Mt,Mt],(a,[n,s])=>n.evaluate(a)%s.evaluate(a)],ln2:[Mt,[],()=>Math.LN2],pi:[Mt,[],()=>Math.PI],e:[Mt,[],()=>Math.E],"^":[Mt,[Mt,Mt],(a,[n,s])=>Math.pow(n.evaluate(a),s.evaluate(a))],sqrt:[Mt,[Mt],(a,[n])=>Math.sqrt(n.evaluate(a))],log10:[Mt,[Mt],(a,[n])=>Math.log(n.evaluate(a))/Math.LN10],ln:[Mt,[Mt],(a,[n])=>Math.log(n.evaluate(a))],log2:[Mt,[Mt],(a,[n])=>Math.log(n.evaluate(a))/Math.LN2],sin:[Mt,[Mt],(a,[n])=>Math.sin(n.evaluate(a))],cos:[Mt,[Mt],(a,[n])=>Math.cos(n.evaluate(a))],tan:[Mt,[Mt],(a,[n])=>Math.tan(n.evaluate(a))],asin:[Mt,[Mt],(a,[n])=>Math.asin(n.evaluate(a))],acos:[Mt,[Mt],(a,[n])=>Math.acos(n.evaluate(a))],atan:[Mt,[Mt],(a,[n])=>Math.atan(n.evaluate(a))],min:[Mt,ao(Mt),(a,n)=>Math.min(...n.map(s=>s.evaluate(a)))],max:[Mt,ao(Mt),(a,n)=>Math.max(...n.map(s=>s.evaluate(a)))],abs:[Mt,[Mt],(a,[n])=>Math.abs(n.evaluate(a))],round:[Mt,[Mt],(a,[n])=>{const s=n.evaluate(a);return s<0?-Math.round(-s):Math.round(s)}],floor:[Mt,[Mt],(a,[n])=>Math.floor(n.evaluate(a))],ceil:[Mt,[Mt],(a,[n])=>Math.ceil(n.evaluate(a))],"filter-==":[hr,[mr,fr],(a,[n,s])=>a.properties()[n.value]===s.value],"filter-id-==":[hr,[fr],(a,[n])=>a.id()===n.value],"filter-type-==":[hr,[mr],(a,[n])=>a.geometryType()===n.value],"filter-<":[hr,[mr,fr],(a,[n,s])=>{const c=a.properties()[n.value],d=s.value;return typeof c==typeof d&&c<d}],"filter-id-<":[hr,[fr],(a,[n])=>{const s=a.id(),c=n.value;return typeof s==typeof c&&s<c}],"filter->":[hr,[mr,fr],(a,[n,s])=>{const c=a.properties()[n.value],d=s.value;return typeof c==typeof d&&c>d}],"filter-id->":[hr,[fr],(a,[n])=>{const s=a.id(),c=n.value;return typeof s==typeof c&&s>c}],"filter-<=":[hr,[mr,fr],(a,[n,s])=>{const c=a.properties()[n.value],d=s.value;return typeof c==typeof d&&c<=d}],"filter-id-<=":[hr,[fr],(a,[n])=>{const s=a.id(),c=n.value;return typeof s==typeof c&&s<=c}],"filter->=":[hr,[mr,fr],(a,[n,s])=>{const c=a.properties()[n.value],d=s.value;return typeof c==typeof d&&c>=d}],"filter-id->=":[hr,[fr],(a,[n])=>{const s=a.id(),c=n.value;return typeof s==typeof c&&s>=c}],"filter-has":[hr,[fr],(a,[n])=>n.value in a.properties()],"filter-has-id":[hr,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[hr,[io(mr)],(a,[n])=>n.value.indexOf(a.geometryType())>=0],"filter-id-in":[hr,[io(fr)],(a,[n])=>n.value.indexOf(a.id())>=0],"filter-in-small":[hr,[mr,io(fr)],(a,[n,s])=>s.value.indexOf(a.properties()[n.value])>=0],"filter-in-large":[hr,[mr,io(fr)],(a,[n,s])=>function(c,d,g,v){for(;g<=v;){const w=g+v>>1;if(d[w]===c)return!0;d[w]>c?v=w-1:g=w+1}return!1}(a.properties()[n.value],s.value,0,s.value.length-1)],all:{type:hr,overloads:[[[hr,hr],(a,[n,s])=>n.evaluate(a)&&s.evaluate(a)],[ao(hr),(a,n)=>{for(const s of n)if(!s.evaluate(a))return!1;return!0}]]},any:{type:hr,overloads:[[[hr,hr],(a,[n,s])=>n.evaluate(a)||s.evaluate(a)],[ao(hr),(a,n)=>{for(const s of n)if(s.evaluate(a))return!0;return!1}]]},"!":[hr,[hr],(a,[n])=>!n.evaluate(a)],"is-supported-script":[hr,[mr],(a,[n])=>{const s=a.globals&&a.globals.isSupportedScript;return!s||s(n.evaluate(a))}],upcase:[mr,[mr],(a,[n])=>n.evaluate(a).toUpperCase()],downcase:[mr,[mr],(a,[n])=>n.evaluate(a).toLowerCase()],concat:[mr,ao(fr),(a,n)=>n.map(s=>ku(s.evaluate(a))).join("")],"resolved-locale":[mr,[Zi],(a,[n])=>n.evaluate(a).resolvedLocale()]});var Nu=Ny;function Vy(a){return{result:"success",value:a}}function Os(a){return{result:"error",value:a}}function Sl(a){return a["property-type"]==="data-driven"}function hh(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function fh(a){return!!a.expression&&a.expression.interpolated}function _r(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function Uu(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function Gy(a){return a}function dh(a,n){const s=n.type==="color",c=a.stops&&typeof a.stops[0][0]=="object",d=c||!(c||a.property!==void 0),g=a.type||(fh(n)?"exponential":"interval");if(s&&((a=ya({},a)).stops&&(a.stops=a.stops.map(P=>[P[0],Tn.parse(P[1])])),a.default=Tn.parse(a.default?a.default:n.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!lp[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let v,w,S;if(g==="exponential")v=Sa;else if(g==="interval")v=ph;else if(g==="categorical"){v=Wy,w=Object.create(null);for(const P of a.stops)w[P[0]]=P[1];S=typeof a.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);v=qy}if(c){const P={},I=[];for(let N=0;N<a.stops.length;N++){const W=a.stops[N],J=W[0].zoom;P[J]===void 0&&(P[J]={zoom:J,type:a.type,property:a.property,default:a.default,stops:[]},I.push(J)),P[J].stops.push([W[0].value,W[1]])}const D=[];for(const N of I)D.push([P[N].zoom,dh(P[N],n)]);const z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:Uo.interpolationFactor.bind(void 0,z),zoomStops:D.map(N=>N[0]),evaluate:({zoom:N},W)=>Sa({stops:D,base:a.base},n,N).evaluate(N,W)}}if(d){const P=g==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:Uo.interpolationFactor.bind(void 0,P),zoomStops:a.stops.map(I=>I[0]),evaluate:({zoom:I})=>v(a,n,I,w,S)}}return{kind:"source",evaluate(P,I){const D=I&&I.properties?I.properties[a.property]:void 0;return D===void 0?El(a.default,n.default):v(a,n,D,w,S)}}}function El(a,n,s){return a!==void 0?a:n!==void 0?n:s!==void 0?s:void 0}function Wy(a,n,s,c,d){return El(typeof s===d?c[s]:void 0,a.default,n.default)}function ph(a,n,s){if(_r(s)!=="number")return El(a.default,n.default);const c=a.stops.length;if(c===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[c-1][0])return a.stops[c-1][1];const d=rh(a.stops.map(g=>g[0]),s);return a.stops[d][1]}function Sa(a,n,s){const c=a.base!==void 0?a.base:1;if(_r(s)!=="number")return El(a.default,n.default);const d=a.stops.length;if(d===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[d-1][0])return a.stops[d-1][1];const g=rh(a.stops.map(I=>I[0]),s),v=function(I,D,z,N){const W=N-z,J=I-z;return W===0?0:D===1?J/W:(Math.pow(D,J)-1)/(Math.pow(D,W)-1)}(s,c,a.stops[g][0],a.stops[g+1][0]),w=a.stops[g][1],S=a.stops[g+1][1];let P=Ru[n.type]||Gy;if(a.colorSpace&&a.colorSpace!=="rgb"){const I=lp[a.colorSpace];P=(D,z)=>I.reverse(I.interpolate(I.forward(D),I.forward(z),v))}return typeof w.evaluate=="function"?{evaluate(...I){const D=w.evaluate.apply(void 0,I),z=S.evaluate.apply(void 0,I);if(D!==void 0&&z!==void 0)return P(D,z,v)}}:P(w,S,v)}function qy(a,n,s){return n.type==="color"?s=Tn.parse(s):n.type==="formatted"?s=Oi.fromString(s.toString()):n.type==="resolvedImage"?s=oo.fromString(s.toString()):_r(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),El(s,a.default,n.default)}class mh{constructor(n,s){this.expression=n,this._warningHistory={},this._evaluator=new Hd,this._defaultValue=s?function(c){return c.type==="color"&&(Uu(c.default)||Array.isArray(c.default))?new Tn(0,0,0,0):c.type==="color"?Tn.parse(c.default)||null:c.default===void 0?null:c.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(n,s,c,d,g,v,w,S){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=d||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=S||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,c,d,g,v,w,S){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=d||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=S||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new ni(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console<"u"&&console.warn(P.message)),this._defaultValue}}}function Al(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Nu}function Pl(a,n){const s=new ep(Nu,[],n?function(d){const g={color:qi,string:mr,number:Mt,enum:mr,boolean:hr,formatted:Au,resolvedImage:Es};return d.type==="array"?io(g[d.value]||fr,d.length):g[d.type]}(n):void 0),c=s.parse(a,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?Vy(new mh(c,n)):Os(s.errors)}class mp{constructor(n,s){this.kind=n,this._styleExpression=s,this.isStateDependent=n!=="constant"&&!wa(s.expression)}evaluateWithoutErrorHandling(n,s,c,d,g,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,d,g,v)}evaluate(n,s,c,d,g,v){return this._styleExpression.evaluate(n,s,c,d,g,v)}}class Vu{constructor(n,s,c,d){this.kind=n,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!wa(s.expression),this.interpolationType=d}evaluateWithoutErrorHandling(n,s,c,d,g,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,d,g,v)}evaluate(n,s,c,d,g,v){return this._styleExpression.evaluate(n,s,c,d,g,v)}interpolationFactor(n,s,c){return this.interpolationType?Uo.interpolationFactor(this.interpolationType,n,s,c):0}}function Gu(a,n){if((a=Pl(a,n)).result==="error")return a;const s=a.value.expression,c=xl(s);if(!c&&!Sl(n))return Os([new $o("","data expressions not supported")]);const d=Ms(s,["zoom","pitch","distance-from-center"]);if(!d&&!hh(n))return Os([new $o("","zoom expressions not supported")]);const g=yh(s);return g||d?g instanceof $o?Os([g]):g instanceof Uo&&!fh(n)?Os([new $o("",'"interpolate" expressions cannot be used with this property')]):Vy(g?new Vu(c?"camera":"composite",a.value,g.labels,g instanceof Uo?g.interpolation:void 0):new mp(c?"constant":"source",a.value)):Os([new $o("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class gh{constructor(n,s){this._parameters=n,this._specification=s,ya(this,dh(this._parameters,this._specification))}static deserialize(n){return new gh(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function yh(a){let n=null;if(a instanceof zy)n=yh(a.result);else if(a instanceof cp){for(const s of a.args)if(n=yh(s),n)break}else(a instanceof rp||a instanceof Uo)&&a.input instanceof xa&&a.input.name==="zoom"&&(n=a);return n instanceof $o||a.eachChild(s=>{const c=yh(s);c instanceof $o?n=c:!n&&c?n=new $o("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&c&&n!==c&&(n=new $o("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}class Ct{constructor(n,s,c,d){this.message=(n?`${n}: `:"")+c,d&&(this.identifier=d),s!=null&&s.__line__&&(this.line=s.__line__)}}function wo(a){const n=a.key,s=a.value,c=a.valueSpec||{},d=a.objectElementValidators||{},g=a.style,v=a.styleSpec;let w=[];const S=_r(s);if(S!=="object")return[new Ct(n,s,`object expected, ${S} found`)];for(const P in s){const I=P.split(".")[0];let D;d[I]?D=d[I]:c[I]?D=pi:d["*"]?D=d["*"]:c["*"]&&(D=pi),D?w=w.concat(D({key:(n&&`${n}.`)+P,value:s[P],valueSpec:c[I]||c["*"],style:g,styleSpec:v,object:s,objectKey:P},s)):w.push(new Ct(n,s[P],`unknown property "${P}"`))}for(const P in c)d[P]||c[P].required&&c[P].default===void 0&&s[P]===void 0&&w.push(new Ct(n,s,`missing required property "${P}"`));return w}function Zy(a){const n=a.value,s=a.valueSpec,c=a.style,d=a.styleSpec,g=a.key,v=a.arrayElementValidator||pi;if(_r(n)!=="array")return[new Ct(g,n,`array expected, ${_r(n)} found`)];if(s.length&&n.length!==s.length)return[new Ct(g,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new Ct(g,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let w={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};d.$version<7&&(w.function=s.function),_r(s.value)==="object"&&(w=s.value);let S=[];for(let P=0;P<n.length;P++)S=S.concat(v({array:n,arrayIndex:P,value:n[P],valueSpec:w,style:c,styleSpec:d,key:`${g}[${P}]`}));return S}function Wu(a){const n=a.key,s=a.value,c=a.valueSpec;let d=_r(s);if(d==="number"&&s!=s&&(d="NaN"),d!=="number")return[new Ct(n,s,`number expected, ${d} found`)];if("minimum"in c){let g=c.minimum;if(_r(c.minimum)==="array"&&(g=c.minimum[a.arrayIndex]),s<g)return[new Ct(n,s,`${s} is less than the minimum value ${g}`)]}if("maximum"in c){let g=c.maximum;if(_r(c.maximum)==="array"&&(g=c.maximum[a.arrayIndex]),s>g)return[new Ct(n,s,`${s} is greater than the maximum value ${g}`)]}return[]}function qu(a){const n=a.valueSpec,s=Cn(a.value.type);let c,d,g,v={};const w=s!=="categorical"&&a.value.property===void 0,S=!w,P=_r(a.value.stops)==="array"&&_r(a.value.stops[0])==="array"&&_r(a.value.stops[0][0])==="object",I=wo({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(N){if(s==="identity")return[new Ct(N.key,N.value,'identity function may not have a "stops" property')];let W=[];const J=N.value;return W=W.concat(Zy({key:N.key,value:J,valueSpec:N.valueSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:D})),_r(J)==="array"&&J.length===0&&W.push(new Ct(N.key,J,"array must have at least one stop")),W},default:function(N){return pi({key:N.key,value:N.value,valueSpec:n,style:N.style,styleSpec:N.styleSpec})}}});return s==="identity"&&w&&I.push(new Ct(a.key,a.value,'missing required property "property"')),s==="identity"||a.value.stops||I.push(new Ct(a.key,a.value,'missing required property "stops"')),s==="exponential"&&a.valueSpec.expression&&!fh(a.valueSpec)&&I.push(new Ct(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(S&&!Sl(a.valueSpec)?I.push(new Ct(a.key,a.value,"property functions not supported")):w&&!hh(a.valueSpec)&&I.push(new Ct(a.key,a.value,"zoom functions not supported"))),s!=="categorical"&&!P||a.value.property!==void 0||I.push(new Ct(a.key,a.value,'"property" property is required')),I;function D(N){let W=[];const J=N.value,te=N.key;if(_r(J)!=="array")return[new Ct(te,J,`array expected, ${_r(J)} found`)];if(J.length!==2)return[new Ct(te,J,`array length 2 expected, length ${J.length} found`)];if(P){if(_r(J[0])!=="object")return[new Ct(te,J,`object expected, ${_r(J[0])} found`)];if(J[0].zoom===void 0)return[new Ct(te,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new Ct(te,J,"object stop key must have value")];const le=Cn(J[0].zoom);if(typeof le!="number")return[new Ct(te,J[0].zoom,"stop zoom values must be numbers")];if(g&&g>le)return[new Ct(te,J[0].zoom,"stop zoom values must appear in ascending order")];le!==g&&(g=le,d=void 0,v={}),W=W.concat(wo({key:`${te}[0]`,value:J[0],valueSpec:{zoom:{}},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{zoom:Wu,value:z}}))}else W=W.concat(z({key:`${te}[0]`,value:J[0],style:N.style,styleSpec:N.styleSpec},J));return Al(Hn(J[1]))?W.concat([new Ct(`${te}[1]`,J[1],"expressions are not allowed in function stops.")]):W.concat(pi({key:`${te}[1]`,value:J[1],valueSpec:n,style:N.style,styleSpec:N.styleSpec}))}function z(N,W){const J=_r(N.value),te=Cn(N.value),le=N.value!==null?N.value:W;if(c){if(J!==c)return[new Ct(N.key,le,`${J} stop domain type must match previous stop domain type ${c}`)]}else c=J;if(J!=="number"&&J!=="string"&&J!=="boolean"&&typeof te!="number"&&typeof te!="string"&&typeof te!="boolean")return[new Ct(N.key,le,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&s!=="categorical"){let ye=`number expected, ${J} found`;return Sl(n)&&s===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ct(N.key,le,ye)]}return s!=="categorical"||J!=="number"||typeof te=="number"&&isFinite(te)&&Math.floor(te)===te?s!=="categorical"&&J==="number"&&typeof te=="number"&&typeof d=="number"&&d!==void 0&&te<d?[new Ct(N.key,le,"stop domain values must appear in ascending order")]:(d=te,s==="categorical"&&te in v?[new Ct(N.key,le,"stop domain values must be unique")]:(v[te]=!0,[])):[new Ct(N.key,le,`integer expected, found ${String(te)}`)]}}function Xn(a){const n=(a.expressionContext==="property"?Gu:Pl)(Hn(a.value),a.valueSpec);if(n.result==="error")return n.value.map(c=>new Ct(`${a.key}${c.key}`,a.value,c.message));const s=n.value.expression||n.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!s.outputDefined())return[new Ct(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!wa(s))return[new Ct(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter")return Zu(s,a);if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Ms(s,["zoom","feature-state"]))return[new Ct(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!xl(s))return[new Ct(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Zu(a,n){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const d of n.valueSpec.expression.parameters)s.delete(d);if(s.size===0)return[];const c=[];return a instanceof xa&&s.has(a.name)?[new Ct(n.key,n.value,`["${a.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(a.eachChild(d=>{c.push(...Zu(d,n))}),c)}function _h(a){const n=a.key,s=a.value,c=a.valueSpec,d=[];return Array.isArray(c.values)?c.values.indexOf(Cn(s))===-1&&d.push(new Ct(n,s,`expected one of [${c.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(c.values).indexOf(Cn(s))===-1&&d.push(new Ct(n,s,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(s)} found`)),d}function gp(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const n of a.slice(1))if(!gp(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function vh(a,n="fill"){if(a==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};gp(a)||(a=Cl(a));const s=a;let c=!0;try{c=function(P){if(!Ml(P))return P;let I=Hn(P);return xh(I),I=Hy(I),I}(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(s,null,2)}
        `)}const d=Je[`filter_${n}`],g=Pl(c,d);let v=null;if(g.result==="error")throw new Error(g.value.map(P=>`${P.key}: ${P.message}`).join(", "));v=(P,I,D)=>g.value.evaluate(P,I,{},D);let w=null,S=null;if(c!==s){const P=Pl(s,d);if(P.result==="error")throw new Error(P.value.map(I=>`${I.key}: ${I.message}`).join(", "));w=(I,D,z,N,W)=>P.value.evaluate(I,D,{},z,void 0,void 0,N,W),S=!xl(P.value.expression)}return{filter:v,dynamicFilter:w||void 0,needGeometry:Xy(c),needFeature:!!S}}function Hy(a){if(!Array.isArray(a))return a;const n=function(s){if(yp.has(s[0])){for(let c=1;c<s.length;c++)if(Ml(s[c]))return!0}return s}(a);return n===!0?n:n.map(s=>Hy(s))}function xh(a){let n=!1;const s=[];if(a[0]==="case"){for(let c=1;c<a.length-1;c+=2)n=n||Ml(a[c]),s.push(a[c+1]);s.push(a[a.length-1])}else if(a[0]==="match"){n=n||Ml(a[1]);for(let c=2;c<a.length-1;c+=2)s.push(a[c+1]);s.push(a[a.length-1])}else if(a[0]==="step"){n=n||Ml(a[1]);for(let c=1;c<a.length-1;c+=2)s.push(a[c+1])}n&&(a.length=0,a.push("any",...s));for(let c=1;c<a.length;c++)xh(a[c])}function Ml(a){if(!Array.isArray(a))return!1;if((n=a[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<a.length;s++)if(Ml(a[s]))return!0;return!1}const yp=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function N1(a,n){return a<n?-1:a>n?1:0}function Xy(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let n=1;n<a.length;n++)if(Xy(a[n]))return!0;return!1}function Cl(a){if(!a)return!0;const n=a[0];return a.length<=1?n!=="any":n==="=="?_p(a[1],a[2],"=="):n==="!="?bh(_p(a[1],a[2],"==")):n==="<"||n===">"||n==="<="||n===">="?_p(a[1],a[2],n):n==="any"?(s=a.slice(1),["any"].concat(s.map(Cl))):n==="all"?["all"].concat(a.slice(1).map(Cl)):n==="none"?["all"].concat(a.slice(1).map(Cl).map(bh)):n==="in"?vp(a[1],a.slice(2)):n==="!in"?bh(vp(a[1],a.slice(2))):n==="has"?xp(a[1]):n==="!has"?bh(xp(a[1])):n!=="within"||a;var s}function _p(a,n,s){switch(a){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,a,n]}}function vp(a,n){if(n.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",a,["literal",n.sort(N1)]]:["filter-in-small",a,["literal",n]]}}function xp(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function bh(a){return["!",a]}function Hu(a){return gp(Hn(a.value))?Xn(ya({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):Xu(a)}function Xu(a){const n=a.value,s=a.key;if(_r(n)!=="array")return[new Ct(s,n,`array expected, ${_r(n)} found`)];const c=a.styleSpec;let d,g=[];if(n.length<1)return[new Ct(s,n,"filter array must have at least 1 element")];switch(g=g.concat(_h({key:`${s}[0]`,value:n[0],valueSpec:c.filter_operator,style:a.style,styleSpec:a.styleSpec})),Cn(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&Cn(n[1])==="$type"&&g.push(new Ct(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&g.push(new Ct(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(d=_r(n[1]),d!=="string"&&g.push(new Ct(`${s}[1]`,n[1],`string expected, ${d} found`)));for(let v=2;v<n.length;v++)d=_r(n[v]),Cn(n[1])==="$type"?g=g.concat(_h({key:`${s}[${v}]`,value:n[v],valueSpec:c.geometry_type,style:a.style,styleSpec:a.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&g.push(new Ct(`${s}[${v}]`,n[v],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let v=1;v<n.length;v++)g=g.concat(Xu({key:`${s}[${v}]`,value:n[v],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":d=_r(n[1]),n.length!==2?g.push(new Ct(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):d!=="string"&&g.push(new Ct(`${s}[1]`,n[1],`string expected, ${d} found`));break;case"within":d=_r(n[1]),n.length!==2?g.push(new Ct(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):d!=="object"&&g.push(new Ct(`${s}[1]`,n[1],`object expected, ${d} found`))}return g}function bp(a,n){const s=a.key,c=a.style,d=a.styleSpec,g=a.value,v=a.objectKey,w=d[`${n}_${a.layerType}`];if(!w)return[];const S=v.match(/^(.*)-transition$/);if(n==="paint"&&S&&w[S[1]]&&w[S[1]].transition)return pi({key:s,value:g,valueSpec:d.transition,style:c,styleSpec:d});const P=a.valueSpec||w[v];if(!P)return[new Ct(s,g,`unknown property "${v}"`)];let I;if(_r(g)==="string"&&Sl(P)&&!P.tokens&&(I=/^{([^}]+)}$/.exec(g))){const z=`\`{ "type": "identity", "property": ${I?JSON.stringify(I[1]):'"_"'} }\``;return[new Ct(s,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: ${z}.`)]}const D=[];return a.layerType==="symbol"&&(v==="text-field"&&c&&!c.glyphs&&D.push(new Ct(s,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Uu(Hn(g))&&Cn(g.type)==="identity"&&D.push(new Ct(s,g,'"text-font" does not support identity functions'))),D.concat(pi({key:a.key,value:g,valueSpec:P,style:c,styleSpec:d,expressionContext:"property",propertyType:n,propertyKey:v}))}function Ky(a){return bp(a,"paint")}function wp(a){return bp(a,"layout")}function Yy(a){let n=[];const s=a.value,c=a.key,d=a.style,g=a.styleSpec;s.type||s.ref||n.push(new Ct(c,s,'either "type" or "ref" is required'));let v=Cn(s.type);const w=Cn(s.ref);if(s.id){const S=Cn(s.id);for(let P=0;P<a.arrayIndex;P++){const I=d.layers[P];Cn(I.id)===S&&n.push(new Ct(c,s.id,`duplicate layer id "${s.id}", previously used at line ${I.id.__line__}`))}}if("ref"in s){let S;["type","source","source-layer","filter","layout"].forEach(P=>{P in s&&n.push(new Ct(c,s[P],`"${P}" is prohibited for ref layers`))}),d.layers.forEach(P=>{Cn(P.id)===w&&(S=P)}),S?S.ref?n.push(new Ct(c,s.ref,"ref cannot reference another ref layer")):v=Cn(S.type):typeof w=="string"&&n.push(new Ct(c,s.ref,`ref layer "${w}" not found`))}else if(v!=="background"&&v!=="sky")if(s.source){const S=d.sources&&d.sources[s.source],P=S&&Cn(S.type);S?P==="vector"&&v==="raster"?n.push(new Ct(c,s.source,`layer "${s.id}" requires a raster source`)):P==="raster"&&v!=="raster"?n.push(new Ct(c,s.source,`layer "${s.id}" requires a vector source`)):P!=="vector"||s["source-layer"]?P==="raster-dem"&&v!=="hillshade"?n.push(new Ct(c,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||P==="geojson"&&S.lineMetrics||n.push(new Ct(c,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Ct(c,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new Ct(c,s.source,`source "${s.source}" not found`))}else n.push(new Ct(c,s,'missing required property "source"'));return n=n.concat(wo({key:c,value:s,valueSpec:g.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>pi({key:`${c}.type`,value:s.type,valueSpec:g.layer.type,style:a.style,styleSpec:a.styleSpec,object:s,objectKey:"type"}),filter:S=>Hu(ya({layerType:v},S)),layout:S=>wo({layer:s,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":P=>wp(ya({layerType:v},P))}}),paint:S=>wo({layer:s,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":P=>Ky(ya({layerType:v},P))}})}})),n}function es(a){const n=a.value,s=a.key,c=_r(n);return c!=="string"?[new Ct(s,n,`string expected, ${c} found`)]:[]}const Jy={promoteId:function({key:a,value:n}){if(_r(n)==="string")return es({key:a,value:n});{const s=[];for(const c in n)s.push(...es({key:`${a}.${c}`,value:n[c]}));return s}}};function Qy(a){const n=a.value,s=a.key,c=a.styleSpec,d=a.style;if(!n.type)return[new Ct(s,n,'"type" is required')];const g=Cn(n.type);let v;switch(g){case"vector":case"raster":case"raster-dem":return v=wo({key:s,value:n,valueSpec:c[`source_${g.replace("-","_")}`],style:a.style,styleSpec:c,objectElementValidators:Jy}),v;case"geojson":if(v=wo({key:s,value:n,valueSpec:c.source_geojson,style:d,styleSpec:c,objectElementValidators:Jy}),n.cluster)for(const w in n.clusterProperties){const[S,P]=n.clusterProperties[w],I=typeof S=="string"?[S,["accumulated"],["get",w]]:S;v.push(...Xn({key:`${s}.${w}.map`,value:P,expressionContext:"cluster-map"})),v.push(...Xn({key:`${s}.${w}.reduce`,value:I,expressionContext:"cluster-reduce"}))}return v;case"video":return wo({key:s,value:n,valueSpec:c.source_video,style:d,styleSpec:c});case"image":return wo({key:s,value:n,valueSpec:c.source_image,style:d,styleSpec:c});case"canvas":return[new Ct(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _h({key:`${s}.type`,value:n.type,valueSpec:{values:U1(c)}})}}function U1(a){return a.source.reduce((n,s)=>{const c=a[s];return c.type.type==="enum"&&(n=n.concat(Object.keys(c.type.values))),n},[])}function e_(a){const n=a.value,s=a.styleSpec,c=s.light,d=a.style;let g=[];const v=_r(n);if(n===void 0)return g;if(v!=="object")return g=g.concat([new Ct("light",n,`object expected, ${v} found`)]),g;for(const w in n){const S=w.match(/^(.*)-transition$/);g=g.concat(S&&c[S[1]]&&c[S[1]].transition?pi({key:w,value:n[w],valueSpec:s.transition,style:d,styleSpec:s}):c[w]?pi({key:w,value:n[w],valueSpec:c[w],style:d,styleSpec:s}):[new Ct(w,n[w],`unknown property "${w}"`)])}return g}function Tp(a){const n=a.value,s=a.key,c=a.style,d=a.styleSpec,g=d.terrain;let v=[];const w=_r(n);if(n===void 0)return v;if(w!=="object")return v=v.concat([new Ct("terrain",n,`object expected, ${w} found`)]),v;for(const S in n){const P=S.match(/^(.*)-transition$/);v=v.concat(P&&g[P[1]]&&g[P[1]].transition?pi({key:S,value:n[S],valueSpec:d.transition,style:c,styleSpec:d}):g[S]?pi({key:S,value:n[S],valueSpec:g[S],style:c,styleSpec:d}):[new Ct(S,n[S],`unknown property "${S}"`)])}if(n.source){const S=c.sources&&c.sources[n.source],P=S&&Cn(S.type);S?P!=="raster-dem"&&v.push(new Ct(s,n.source,`terrain cannot be used with a source of type ${String(P)}, it only be used with a "raster-dem" source type`)):v.push(new Ct(s,n.source,`source "${n.source}" not found`))}else v.push(new Ct(s,n,'terrain is missing required property "source"'));return v}function t_(a){const n=a.value,s=a.style,c=a.styleSpec,d=c.fog;let g=[];const v=_r(n);if(n===void 0)return g;if(v!=="object")return g=g.concat([new Ct("fog",n,`object expected, ${v} found`)]),g;for(const w in n){const S=w.match(/^(.*)-transition$/);g=g.concat(S&&d[S[1]]&&d[S[1]].transition?pi({key:w,value:n[w],valueSpec:c.transition,style:s,styleSpec:c}):d[w]?pi({key:w,value:n[w],valueSpec:d[w],style:s,styleSpec:c}):[new Ct(w,n[w],`unknown property "${w}"`)])}return g}const r_={"*":()=>[],array:Zy,boolean:function(a){const n=a.value,s=a.key,c=_r(n);return c!=="boolean"?[new Ct(s,n,`boolean expected, ${c} found`)]:[]},number:Wu,color:function(a){const n=a.key,s=a.value,c=_r(s);return c!=="string"?[new Ct(n,s,`color expected, ${c} found`)]:Nd(s)===null?[new Ct(n,s,`color expected, "${s}" found`)]:[]},enum:_h,filter:Hu,function:qu,layer:Yy,object:wo,source:Qy,light:e_,terrain:Tp,fog:t_,string:es,formatted:function(a){return es(a).length===0?[]:Xn(a)},resolvedImage:function(a){return es(a).length===0?[]:Xn(a)},projection:function(a){const n=a.value,s=a.styleSpec,c=s.projection,d=a.style;let g=[];const v=_r(n);if(v==="object")for(const w in n)g=g.concat(pi({key:w,value:n[w],valueSpec:c[w],style:d,styleSpec:s}));else v!=="string"&&(g=g.concat([new Ct("projection",n,`object or string expected, ${v} found`)]));return g}};function pi(a){const n=a.value,s=a.valueSpec,c=a.styleSpec;return s.expression&&Uu(Cn(n))?qu(a):s.expression&&Al(Hn(n))?Xn(a):s.type&&r_[s.type]?r_[s.type](a):wo(ya({},a,{valueSpec:s.type?c[s.type]:s}))}function V1(a){const n=a.value,s=a.key,c=es(a);return c.length||(n.indexOf("{fontstack}")===-1&&c.push(new Ct(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&c.push(new Ct(s,n,'"glyphs" url must include a "{range}" token'))),c}function n_(a,n=Je){return so(pi({key:"",value:a,valueSpec:n.$root,styleSpec:n,style:a,objectElementValidators:{glyphs:V1,"*":()=>[]}}))}const G1=a=>so(Ky(a)),W1=a=>so(wp(a));function so(a){return a.slice().sort((n,s)=>n.line&&s.line?n.line-s.line:0)}function i_(a,n){let s=!1;if(n&&n.length)for(const c of n)a.fire(new ga(new Error(c.message))),s=!0;return s}var q1=Vo,To=3;function Vo(a,n,s){var c=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var d=new Int32Array(this.arrayBuffer);a=d[0],this.d=(n=d[1])+2*(s=d[2]);for(var g=0;g<this.d*this.d;g++){var v=d[To+g],w=d[To+g+1];c.push(v===w?null:d.subarray(v,w))}var S=d[To+c.length+1];this.keys=d.subarray(d[To+c.length],S),this.bboxes=d.subarray(S),this.insert=this._insertReadonly}else{this.d=n+2*s;for(var P=0;P<this.d*this.d;P++)c.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=a,this.padding=s,this.scale=n/a,this.uid=0;var I=s/n*a;this.min=-I,this.max=a+I}Vo.prototype.insert=function(a,n,s,c,d){this._forEachCell(n,s,c,d,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(d)},Vo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Vo.prototype._insertCell=function(a,n,s,c,d,g){this.cells[d].push(g)},Vo.prototype.query=function(a,n,s,c,d){var g=this.min,v=this.max;if(a<=g&&n<=g&&v<=s&&v<=c&&!d)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(a,n,s,c,this._queryCell,w,{},d),w},Vo.prototype._queryCell=function(a,n,s,c,d,g,v,w){var S=this.cells[d];if(S!==null)for(var P=this.keys,I=this.bboxes,D=0;D<S.length;D++){var z=S[D];if(v[z]===void 0){var N=4*z;(w?w(I[N+0],I[N+1],I[N+2],I[N+3]):a<=I[N+2]&&n<=I[N+3]&&s>=I[N+0]&&c>=I[N+1])?(v[z]=!0,g.push(P[z])):v[z]=!1}}},Vo.prototype._forEachCell=function(a,n,s,c,d,g,v,w){for(var S=this._convertToCellCoord(a),P=this._convertToCellCoord(n),I=this._convertToCellCoord(s),D=this._convertToCellCoord(c),z=S;z<=I;z++)for(var N=P;N<=D;N++){var W=this.d*N+z;if((!w||w(this._convertFromCellCoord(z),this._convertFromCellCoord(N),this._convertFromCellCoord(z+1),this._convertFromCellCoord(N+1)))&&d.call(this,a,n,s,c,W,g,v,w))return}},Vo.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Vo.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Vo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,n=To+this.cells.length+1+1,s=0,c=0;c<this.cells.length;c++)s+=this.cells[c].length;var d=new Int32Array(n+s+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var g=n,v=0;v<a.length;v++){var w=a[v];d[To+v]=g,d.set(w,g),g+=w.length}return d[To+a.length]=g,d.set(this.keys,g),d[To+a.length+1]=g+=this.keys.length,d.set(this.bboxes,g),g+=this.bboxes.length,d.buffer};var Is=G(q1);const wh={};function It(a,n,s={}){Object.defineProperty(a,"_classRegistryKey",{value:n,writeable:!1}),wh[n]={klass:a,omit:s.omit||[]}}It(Object,"Object"),Is.serialize=function(a,n){const s=a.toArrayBuffer();return n&&n.push(s),{buffer:s}},Is.deserialize=function(a){return new Is(a.buffer)},Object.defineProperty(Is,"name",{value:"Grid"}),It(Is,"Grid"),It(Tn,"Color"),It(Error,"Error"),It(tt,"AJAXError"),It(oo,"ResolvedImage"),It(gh,"StylePropertyFunction"),It(mh,"StyleExpression",{omit:["_evaluator"]}),It(Vu,"ZoomDependentExpression"),It(mp,"ZoomConstantExpression"),It(xa,"CompoundExpression",{omit:["_evaluate"]});for(const a in Nu)wh[Nu[a]._classRegistryKey]||It(Nu[a],`Expression${a}`);function Sp(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Ep(a){return x.ImageBitmap&&a instanceof x.ImageBitmap}function Ol(a,n){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Sp(a)||Ep(a))return n&&n.push(a),a;if(ArrayBuffer.isView(a)){const s=a;return n&&n.push(s.buffer),s}if(a instanceof x.ImageData)return n&&n.push(a.data.buffer),a;if(Array.isArray(a)){const s=[];for(const c of a)s.push(Ol(c,n));return s}if(typeof a=="object"){const s=a.constructor,c=s._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const d=s.serialize?s.serialize(a,n):{};if(!s.serialize){for(const g in a)a.hasOwnProperty(g)&&(wh[c].omit.indexOf(g)>=0||(d[g]=Ol(a[g],n)));a instanceof Error&&(d.message=a.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(d.$name=c),d}throw new Error("can't serialize object of type "+typeof a)}function ks(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Sp(a)||Ep(a)||ArrayBuffer.isView(a)||a instanceof x.ImageData)return a;if(Array.isArray(a))return a.map(ks);if(typeof a=="object"){const n=a.$name||"Object",{klass:s}=wh[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(a);const c=Object.create(s.prototype);for(const d of Object.keys(a))d!=="$name"&&(c[d]=ks(a[d]));return c}throw new Error("can't deserialize object of type "+typeof a)}const Pt={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Ap(a){for(const n of a)if(Pp(n.charCodeAt(0)))return!0;return!1}function Z1(a){for(const n of a)if(!o_(n.charCodeAt(0)))return!1;return!0}function o_(a){return!(Pt.Arabic(a)||Pt["Arabic Supplement"](a)||Pt["Arabic Extended-A"](a)||Pt["Arabic Presentation Forms-A"](a)||Pt["Arabic Presentation Forms-B"](a))}function Pp(a){return!(a!==746&&a!==747&&(a<4352||!(Pt["Bopomofo Extended"](a)||Pt.Bopomofo(a)||Pt["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Pt["CJK Compatibility Ideographs"](a)||Pt["CJK Compatibility"](a)||Pt["CJK Radicals Supplement"](a)||Pt["CJK Strokes"](a)||!(!Pt["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Pt["CJK Unified Ideographs Extension A"](a)||Pt["CJK Unified Ideographs"](a)||Pt["Enclosed CJK Letters and Months"](a)||Pt["Hangul Compatibility Jamo"](a)||Pt["Hangul Jamo Extended-A"](a)||Pt["Hangul Jamo Extended-B"](a)||Pt["Hangul Jamo"](a)||Pt["Hangul Syllables"](a)||Pt.Hiragana(a)||Pt["Ideographic Description Characters"](a)||Pt.Kanbun(a)||Pt["Kangxi Radicals"](a)||Pt["Katakana Phonetic Extensions"](a)||Pt.Katakana(a)&&a!==12540||!(!Pt["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Pt["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Pt["Unified Canadian Aboriginal Syllabics"](a)||Pt["Unified Canadian Aboriginal Syllabics Extended"](a)||Pt["Vertical Forms"](a)||Pt["Yijing Hexagram Symbols"](a)||Pt["Yi Syllables"](a)||Pt["Yi Radicals"](a))))}function a_(a){return!(Pp(a)||function(n){return!!(Pt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Pt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Pt["Letterlike Symbols"](n)||Pt["Number Forms"](n)||Pt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Pt["Control Pictures"](n)&&n!==9251||Pt["Optical Character Recognition"](n)||Pt["Enclosed Alphanumerics"](n)||Pt["Geometric Shapes"](n)||Pt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Pt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Pt["CJK Symbols and Punctuation"](n)||Pt.Katakana(n)||Pt["Private Use Area"](n)||Pt["CJK Compatibility Forms"](n)||Pt["Small Form Variants"](n)||Pt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(a))}function s_(a){return a>=1424&&a<=2303||Pt["Arabic Presentation Forms-A"](a)||Pt["Arabic Presentation Forms-B"](a)}function H1(a,n){return!(!n&&s_(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Pt.Khmer(a))}function X1(a){for(const n of a)if(s_(n.charCodeAt(0)))return!0;return!1}const Mp="deferred",Cp="loading",Op="loaded";let Il=null,m="unavailable",l=null;const f=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(m="error"),Il&&Il(a)};function y(){b.fire(new Ss("pluginStateChange",{pluginStatus:m,pluginURL:l}))}const b=new Eu,T=function(){return m},M=function(){if(m!==Mp||!l)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");m=Cp,y(),l&&Kt({url:l},a=>{a?f(a):(m=Op,y())})},C={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>m===Op||C.applyArabicShaping!=null,isLoading:()=>m===Cp,setState(a){m=a.pluginStatus,l=a.pluginURL},isParsed:()=>C.applyArabicShaping!=null&&C.processBidirectionalText!=null&&C.processStyledBidirectionalText!=null,getPluginURL:()=>l};class k{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(n){return function(s,c){for(const d of s)if(!H1(d.charCodeAt(0),c))return!1;return!0}(n,C.isLoaded())}}class B{constructor(n,s){this.property=n,this.value=s,this.expression=function(c,d){if(Uu(c))return new gh(c,d);if(Al(c)){const g=Gu(c,d);if(g.result==="error")throw new Error(g.value.map(v=>`${v.key}: ${v.message}`).join(", "));return g.value}{let g=c;return typeof c=="string"&&d.type==="color"&&(g=Tn.parse(c)),{kind:"constant",evaluate:()=>g}}}(s===void 0?n.specification.default:s,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,c){return this.property.possiblyEvaluate(this,n,s,c)}}class R{constructor(n){this.property=n,this.value=new B(n,void 0)}transitioned(n,s){return new ee(this.property,this.value,s,St({},n.transition,this.transition),n.now)}untransitioned(){return new ee(this.property,this.value,null,{},0)}}class H{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Qt(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new R(this._values[n].property)),this._values[n].value=new B(this._values[n].property,s===null?void 0:Qt(s))}getTransition(n){return Qt(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new R(this._values[n].property)),this._values[n].transition=Qt(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c);const d=this.getTransition(s);d!==void 0&&(n[`${s}-transition`]=d)}return n}transitioned(n,s){const c=new ie(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].transitioned(n,s._values[d]);return c}untransitioned(){const n=new ie(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class ee{constructor(n,s,c,d,g){const v=d.delay||0,w=d.duration||0;g=g||0,this.property=n,this.value=s,this.begin=g+v,this.end=this.begin+w,n.specification.transition&&(d.delay||d.duration)&&(this.prior=c)}possiblyEvaluate(n,s,c){const d=n.now||0,g=this.value.possiblyEvaluate(n,s,c),v=this.prior;if(v){if(d>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(d<this.begin)return v.possiblyEvaluate(n,s,c);{const w=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,s,c),g,Me(w))}}return g}}class ie{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,c){const d=new se(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(n,s,c);return d}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class ae{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}getValue(n){return Qt(this._values[n].value)}setValue(n,s){this._values[n]=new B(this._values[n].property,s===null?void 0:Qt(s))}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c)}return n}possiblyEvaluate(n,s,c){const d=new se(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(n,s,c);return d}}class oe{constructor(n,s,c){this.property=n,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,c,d){return this.property.evaluate(this.value,this.parameters,n,s,c,d)}}class se{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class X{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,c){const d=Ru[this.specification.type];return d?d(n,s,c):n}}class ne{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,c,d){return new oe(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},c,d)}:n.expression,s)}interpolate(n,s,c){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new oe(this,{kind:"constant",value:void 0},n.parameters);const d=Ru[this.specification.type];return d?new oe(this,{kind:"constant",value:d(n.value.value,s.value.value,c)},n.parameters):n}evaluate(n,s,c,d,g,v){return n.kind==="constant"?n.value:n.evaluate(s,c,d,g,v)}}class fe{constructor(n){this.specification=n}possiblyEvaluate(n,s,c,d){return!!n.expression.evaluate(s,null,{},c,d)}interpolate(){return!1}}class de{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new k(0,{});for(const c in n){const d=n[c];d.specification.overridable&&this.overridableProperties.push(c);const g=this.defaultPropertyValues[c]=new B(d,void 0),v=this.defaultTransitionablePropertyValues[c]=new R(d);this.defaultTransitioningPropertyValues[c]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=g.possiblyEvaluate(s)}}}function Ee(a,n){return 256*(a=Oe(Math.floor(a),0,255))+Oe(Math.floor(n),0,255)}It(ne,"DataDrivenProperty"),It(X,"DataConstantProperty"),It(fe,"ColorRampProperty");const Pe={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ae{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class je{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ze(a,n=1){let s=0,c=0;return{members:a.map(d=>{const g=Pe[d.type].BYTES_PER_ELEMENT,v=s=We(s,Math.max(n,g)),w=d.components||1;return c=Math.max(c,g),s+=g*w,{name:d.name,type:d.type,components:w,offset:v}}),size:We(s,Math.max(c,n)),alignment:n}}function We(a,n){return Math.ceil(a/n)*n}class pt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const d=2*n;return this.int16[d+0]=s,this.int16[d+1]=c,n}}pt.prototype.bytesPerElement=4,It(pt,"StructArrayLayout2i4");class Ne extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,c)}emplace(n,s,c,d){const g=3*n;return this.int16[g+0]=s,this.int16[g+1]=c,this.int16[g+2]=d,n}}Ne.prototype.bytesPerElement=6,It(Ne,"StructArrayLayout3i6");class nt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c,d)}emplace(n,s,c,d,g){const v=4*n;return this.int16[v+0]=s,this.int16[v+1]=c,this.int16[v+2]=d,this.int16[v+3]=g,n}}nt.prototype.bytesPerElement=8,It(nt,"StructArrayLayout4i8");class He extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g,v,w){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,c,d,g,v,w)}emplace(n,s,c,d,g,v,w,S){const P=6*n,I=12*n,D=3*n;return this.int16[P+0]=s,this.int16[P+1]=c,this.uint8[I+4]=d,this.uint8[I+5]=g,this.uint8[I+6]=v,this.uint8[I+7]=w,this.float32[D+2]=S,n}}He.prototype.bytesPerElement=12,It(He,"StructArrayLayout2i4ub1f12");class dt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c,d)}emplace(n,s,c,d,g){const v=4*n;return this.float32[v+0]=s,this.float32[v+1]=c,this.float32[v+2]=d,this.float32[v+3]=g,n}}dt.prototype.bytesPerElement=16,It(dt,"StructArrayLayout4f16");class Ge extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,c,d,g)}emplace(n,s,c,d,g,v){const w=6*n,S=3*n;return this.uint16[w+0]=s,this.uint16[w+1]=c,this.uint16[w+2]=d,this.uint16[w+3]=g,this.float32[S+2]=v,n}}Ge.prototype.bytesPerElement=12,It(Ge,"StructArrayLayout4ui1f12");class rt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c,d)}emplace(n,s,c,d,g){const v=4*n;return this.uint16[v+0]=s,this.uint16[v+1]=c,this.uint16[v+2]=d,this.uint16[v+3]=g,n}}rt.prototype.bytesPerElement=8,It(rt,"StructArrayLayout4ui8");class gt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,d,g,v)}emplace(n,s,c,d,g,v,w){const S=6*n;return this.int16[S+0]=s,this.int16[S+1]=c,this.int16[S+2]=d,this.int16[S+3]=g,this.int16[S+4]=v,this.int16[S+5]=w,n}}gt.prototype.bytesPerElement=12,It(gt,"StructArrayLayout6i12");class lt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g,v,w,S,P,I,D,z){const N=this.length;return this.resize(N+1),this.emplace(N,n,s,c,d,g,v,w,S,P,I,D,z)}emplace(n,s,c,d,g,v,w,S,P,I,D,z,N){const W=12*n;return this.int16[W+0]=s,this.int16[W+1]=c,this.int16[W+2]=d,this.int16[W+3]=g,this.uint16[W+4]=v,this.uint16[W+5]=w,this.uint16[W+6]=S,this.uint16[W+7]=P,this.int16[W+8]=I,this.int16[W+9]=D,this.int16[W+10]=z,this.int16[W+11]=N,n}}lt.prototype.bytesPerElement=24,It(lt,"StructArrayLayout4i4ui4i24");class _t extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,d,g,v)}emplace(n,s,c,d,g,v,w){const S=10*n,P=5*n;return this.int16[S+0]=s,this.int16[S+1]=c,this.int16[S+2]=d,this.float32[P+2]=g,this.float32[P+3]=v,this.float32[P+4]=w,n}}_t.prototype.bytesPerElement=20,It(_t,"StructArrayLayout3i3f20");class jt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}jt.prototype.bytesPerElement=4,It(jt,"StructArrayLayout1ul4");class Ht extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g,v,w,S,P,I,D,z,N){const W=this.length;return this.resize(W+1),this.emplace(W,n,s,c,d,g,v,w,S,P,I,D,z,N)}emplace(n,s,c,d,g,v,w,S,P,I,D,z,N,W){const J=20*n,te=10*n;return this.int16[J+0]=s,this.int16[J+1]=c,this.int16[J+2]=d,this.int16[J+3]=g,this.int16[J+4]=v,this.float32[te+3]=w,this.float32[te+4]=S,this.float32[te+5]=P,this.float32[te+6]=I,this.int16[J+14]=D,this.uint32[te+8]=z,this.uint16[J+18]=N,this.uint16[J+19]=W,n}}Ht.prototype.bytesPerElement=40,It(Ht,"StructArrayLayout5i4f1i1ul2ui40");class Dt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g,v,w){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,c,d,g,v,w)}emplace(n,s,c,d,g,v,w,S){const P=8*n;return this.int16[P+0]=s,this.int16[P+1]=c,this.int16[P+2]=d,this.int16[P+4]=g,this.int16[P+5]=v,this.int16[P+6]=w,this.int16[P+7]=S,n}}Dt.prototype.bytesPerElement=16,It(Dt,"StructArrayLayout3i2i2i16");class Vt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,c,d,g)}emplace(n,s,c,d,g,v){const w=4*n,S=8*n;return this.float32[w+0]=s,this.float32[w+1]=c,this.float32[w+2]=d,this.int16[S+6]=g,this.int16[S+7]=v,n}}Vt.prototype.bytesPerElement=16,It(Vt,"StructArrayLayout2f1f2i16");class dr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c,d)}emplace(n,s,c,d,g){const v=12*n,w=3*n;return this.uint8[v+0]=s,this.uint8[v+1]=c,this.float32[w+1]=d,this.float32[w+2]=g,n}}dr.prototype.bytesPerElement=12,It(dr,"StructArrayLayout2ub2f12");class cr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,c)}emplace(n,s,c,d){const g=3*n;return this.float32[g+0]=s,this.float32[g+1]=c,this.float32[g+2]=d,n}}cr.prototype.bytesPerElement=12,It(cr,"StructArrayLayout3f12");class Bt extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,n,s,c)}emplace(n,s,c,d){const g=3*n;return this.uint16[g+0]=s,this.uint16[g+1]=c,this.uint16[g+2]=d,n}}Bt.prototype.bytesPerElement=6,It(Bt,"StructArrayLayout3ui6");class Cr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g,v,w,S,P,I,D,z,N,W,J,te,le,ye,ce,me,Se){const we=this.length;return this.resize(we+1),this.emplace(we,n,s,c,d,g,v,w,S,P,I,D,z,N,W,J,te,le,ye,ce,me,Se)}emplace(n,s,c,d,g,v,w,S,P,I,D,z,N,W,J,te,le,ye,ce,me,Se,we){const Ze=30*n,Ue=15*n,Qe=60*n;return this.int16[Ze+0]=s,this.int16[Ze+1]=c,this.int16[Ze+2]=d,this.float32[Ue+2]=g,this.float32[Ue+3]=v,this.uint16[Ze+8]=w,this.uint16[Ze+9]=S,this.uint32[Ue+5]=P,this.uint32[Ue+6]=I,this.uint32[Ue+7]=D,this.uint16[Ze+16]=z,this.uint16[Ze+17]=N,this.uint16[Ze+18]=W,this.float32[Ue+10]=J,this.float32[Ue+11]=te,this.uint8[Qe+48]=le,this.uint8[Qe+49]=ye,this.uint8[Qe+50]=ce,this.uint32[Ue+13]=me,this.int16[Ze+28]=Se,this.uint8[Qe+58]=we,n}}Cr.prototype.bytesPerElement=60,It(Cr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class zr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g,v,w,S,P,I,D,z,N,W,J,te,le,ye,ce,me,Se,we,Ze,Ue,Qe,mt,Xe,it,ot,ht){const vt=this.length;return this.resize(vt+1),this.emplace(vt,n,s,c,d,g,v,w,S,P,I,D,z,N,W,J,te,le,ye,ce,me,Se,we,Ze,Ue,Qe,mt,Xe,it,ot,ht)}emplace(n,s,c,d,g,v,w,S,P,I,D,z,N,W,J,te,le,ye,ce,me,Se,we,Ze,Ue,Qe,mt,Xe,it,ot,ht,vt){const Ye=38*n,Et=19*n;return this.int16[Ye+0]=s,this.int16[Ye+1]=c,this.int16[Ye+2]=d,this.float32[Et+2]=g,this.float32[Et+3]=v,this.int16[Ye+8]=w,this.int16[Ye+9]=S,this.int16[Ye+10]=P,this.int16[Ye+11]=I,this.int16[Ye+12]=D,this.int16[Ye+13]=z,this.uint16[Ye+14]=N,this.uint16[Ye+15]=W,this.uint16[Ye+16]=J,this.uint16[Ye+17]=te,this.uint16[Ye+18]=le,this.uint16[Ye+19]=ye,this.uint16[Ye+20]=ce,this.uint16[Ye+21]=me,this.uint16[Ye+22]=Se,this.uint16[Ye+23]=we,this.uint16[Ye+24]=Ze,this.uint16[Ye+25]=Ue,this.uint16[Ye+26]=Qe,this.uint16[Ye+27]=mt,this.uint16[Ye+28]=Xe,this.uint32[Et+15]=it,this.float32[Et+16]=ot,this.float32[Et+17]=ht,this.float32[Et+18]=vt,n}}zr.prototype.bytesPerElement=76,It(zr,"StructArrayLayout3i2f6i15ui1ul3f76");class Rr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}Rr.prototype.bytesPerElement=4,It(Rr,"StructArrayLayout1f4");class Br extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,c,d,g)}emplace(n,s,c,d,g,v){const w=5*n;return this.float32[w+0]=s,this.float32[w+1]=c,this.float32[w+2]=d,this.float32[w+3]=g,this.float32[w+4]=v,n}}Br.prototype.bytesPerElement=20,It(Br,"StructArrayLayout5f20");class mi extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c,d)}emplace(n,s,c,d,g){const v=6*n;return this.uint32[3*n+0]=s,this.uint16[v+2]=c,this.uint16[v+3]=d,this.uint16[v+4]=g,n}}mi.prototype.bytesPerElement=12,It(mi,"StructArrayLayout1ul3ui12");class Kn extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const d=2*n;return this.uint16[d+0]=s,this.uint16[d+1]=c,n}}Kn.prototype.bytesPerElement=4,It(Kn,"StructArrayLayout2ui4");class lo extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}lo.prototype.bytesPerElement=2,It(lo,"StructArrayLayout1ui2");class Go extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const d=2*n;return this.float32[d+0]=s,this.float32[d+1]=c,n}}Go.prototype.bytesPerElement=8,It(Go,"StructArrayLayout2f8");class sn extends Ae{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}sn.prototype.size=40;class jr extends Ht{get(n){return new sn(this,n)}}It(jr,"CollisionBoxArray");class br extends Ae{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}br.prototype.size=60;class On extends Cr{get(n){return new br(this,n)}}It(On,"PlacedSymbolArray");class Ti extends Ae{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(n){this._structArray.uint32[this._pos4+15]=n}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ti.prototype.size=76;class rn extends zr{get(n){return new Ti(this,n)}}It(rn,"SymbolInstanceArray");class Ii extends Rr{getoffsetX(n){return this.float32[1*n+0]}}It(Ii,"GlyphOffsetArray");class Th extends pt{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}It(Th,"SymbolLineVertexArray");class Ds extends Ae{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ds.prototype.size=12;class Ku extends mi{get(n){return new Ds(this,n)}}It(Ku,"FeatureIndexArray");class Ea extends Kn{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}It(Ea,"FillExtrusionCentroidArray");const ts=ze([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ls=ze([{name:"a_dash",components:4,type:"Uint16"}]);var Sh={exports:{}},Yu={exports:{}};Yu.exports=function(a,n){var s,c,d,g,v,w,S,P;for(c=a.length-(s=3&a.length),d=n,v=3432918353,w=461845907,P=0;P<c;)S=255&a.charCodeAt(P)|(255&a.charCodeAt(++P))<<8|(255&a.charCodeAt(++P))<<16|(255&a.charCodeAt(++P))<<24,++P,d=27492+(65535&(g=5*(65535&(d=(d^=S=(65535&(S=(S=(65535&S)*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(S=0,s){case 3:S^=(255&a.charCodeAt(P+2))<<16;case 2:S^=(255&a.charCodeAt(P+1))<<8;case 1:d^=S=(65535&(S=(S=(65535&(S^=255&a.charCodeAt(P)))*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295}return d^=a.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var Ip=Yu.exports,JP={exports:{}};JP.exports=function(a,n){for(var s,c=a.length,d=n^c,g=0;c>=4;)s=1540483477*(65535&(s=255&a.charCodeAt(g)|(255&a.charCodeAt(++g))<<8|(255&a.charCodeAt(++g))<<16|(255&a.charCodeAt(++g))<<24))+((1540483477*(s>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++g;switch(c){case 3:d^=(255&a.charCodeAt(g+2))<<16;case 2:d^=(255&a.charCodeAt(g+1))<<8;case 1:d=1540483477*(65535&(d^=255&a.charCodeAt(g)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var QP=Ip,UF=JP.exports;Sh.exports=QP,Sh.exports.murmur3=QP,Sh.exports.murmur2=UF;var K1=G(Sh.exports);class l_{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,s,c,d){this.ids.push(eM(n)),this.positions.push(s,c,d)}getPositions(n){const s=eM(n);let c=0,d=this.ids.length-1;for(;c<d;){const v=c+d>>1;this.ids[v]>=s?d=v:c=v+1}const g=[];for(;this.ids[c]===s;)g.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return g}static serialize(n,s){const c=new Float64Array(n.ids),d=new Uint32Array(n.positions);return Y1(c,d,0,c.length-1),s&&s.push(c.buffer,d.buffer),{ids:c,positions:d}}static deserialize(n){const s=new l_;return s.ids=n.ids,s.positions=n.positions,s.indexed=!0,s}}function eM(a){const n=+a;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:K1(String(a))}function Y1(a,n,s,c){for(;s<c;){const d=a[s+c>>1];let g=s-1,v=c+1;for(;;){do g++;while(a[g]<d);do v--;while(a[v]>d);if(g>=v)break;u_(a,g,v),u_(n,3*g,3*v),u_(n,3*g+1,3*v+1),u_(n,3*g+2,3*v+2)}v-s<c-v?(Y1(a,n,s,v),s=v+1):(Y1(a,n,v+1,c),c=v)}}function u_(a,n,s){const c=a[n];a[n]=a[s],a[s]=c}It(l_,"FeaturePositionMap");class zs{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}}class c_ extends zs{constructor(n){super(n),this.current=0}set(n,s,c){this.fetchUniformLocation(n,s)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class tM extends zs{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,c){this.fetchUniformLocation(n,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class rM extends zs{constructor(n){super(n),this.current=Tn.transparent}set(n,s,c){this.fetchUniformLocation(n,s)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const VF=new Float32Array(16),GF=new Float32Array(9),WF=new Float32Array(4);function J1(a){return[Ee(255*a.r,255*a.g),Ee(255*a.b,255*a.a)]}class kp{constructor(n,s,c){this.value=n,this.uniformNames=s.map(d=>`u_${d}`),this.type=c}setUniform(n,s,c,d,g){s.set(n,g,d.constantOr(this.value))}getBinding(n,s){return this.type==="color"?new rM(n):new c_(n)}}class Eh{constructor(n,s){this.uniformNames=s.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,c,d,g){const v=g==="u_pattern"||g==="u_dash"?this.pattern:g==="u_pixel_ratio"?this.pixelRatio:null;v&&s.set(n,g,v)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new tM(n):new c_(n)}}class Rs{constructor(n,s,c,d){this.expression=n,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(g=>({name:`a_${g}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(n,s,c,d,g,v){const w=this.paintVertexArray.length,S=this.expression.evaluate(new k(0),s,{},g,d,v);this.paintVertexArray.resize(n),this._setPaintValue(w,n,S)}updatePaintArray(n,s,c,d,g){const v=this.expression.evaluate({zoom:0},c,d,void 0,g);this._setPaintValue(n,s,v)}_setPaintValue(n,s,c){if(this.type==="color"){const d=J1(c);for(let g=n;g<s;g++)this.paintVertexArray.emplace(g,d[0],d[1])}else{for(let d=n;d<s;d++)this.paintVertexArray.emplace(d,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Aa{constructor(n,s,c,d,g,v){this.expression=n,this.uniformNames=s.map(w=>`u_${w}_t`),this.type=c,this.useIntegerZoom=d,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=s.map(w=>({name:`a_${w}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,s,c,d,g,v){const w=this.expression.evaluate(new k(this.zoom),s,{},g,d,v),S=this.expression.evaluate(new k(this.zoom+1),s,{},g,d,v),P=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(P,n,w,S)}updatePaintArray(n,s,c,d,g){const v=this.expression.evaluate({zoom:this.zoom},c,d,void 0,g),w=this.expression.evaluate({zoom:this.zoom+1},c,d,void 0,g);this._setPaintValue(n,s,v,w)}_setPaintValue(n,s,c,d){if(this.type==="color"){const g=J1(c),v=J1(d);for(let w=n;w<s;w++)this.paintVertexArray.emplace(w,g[0],g[1],v[0],v[1])}else{for(let g=n;g<s;g++)this.paintVertexArray.emplace(g,c,d);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(d))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,c,d,g){const v=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,w=Oe(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);s.set(n,g,w)}getBinding(n,s){return new c_(n)}}class kl{constructor(n,s,c,d,g){this.expression=n,this.layerId=g,this.paintVertexAttributes=(c==="array"?Ls:ts).members;for(let v=0;v<s.length;++v);this.paintVertexArray=new d}populatePaintArray(n,s,c){const d=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(d,n,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(n,s,c,d,g,v){this._setPaintValues(n,s,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(n,s,c,d){if(!d||!c)return;const g=d[c];if(!g)return;const{tl:v,br:w,pixelRatio:S}=g;for(let P=n;P<s;P++)this.paintVertexArray.emplace(P,v[0],v[1],w[0],w[1],S)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Dl{constructor(n,s,c=()=>!0){this.binders={},this._buffers=[];const d=[];for(const g in n.paint._values){if(!c(g))continue;const v=n.paint.get(g);if(!(v instanceof oe&&Sl(v.property.specification)))continue;const w=ZF(g,n.type),S=v.value,P=v.property.specification.type,I=!!v.property.useIntegerZoom,D=g==="line-dasharray"||g.endsWith("pattern"),z=g==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(S.kind!=="constant"||z)if(S.kind==="source"||z||D){const N=nM(g,P,"source");this.binders[g]=D?new kl(S,w,P,N,n.id):new Rs(S,w,P,N),d.push(`/a_${g}`)}else{const N=nM(g,P,"composite");this.binders[g]=new Aa(S,w,P,I,s,N),d.push(`/z_${g}`)}else this.binders[g]=D?new Eh(S.value,w):new kp(S.value,w,P),d.push(`/u_${g}`)}this.cacheKey=d.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Rs||s instanceof Aa?s.maxValue:0}populatePaintArrays(n,s,c,d,g,v){for(const w in this.binders){const S=this.binders[w];(S instanceof Rs||S instanceof Aa||S instanceof kl)&&S.populatePaintArray(n,s,c,d,g,v)}}setConstantPatternPositions(n){for(const s in this.binders){const c=this.binders[s];c instanceof Eh&&c.setConstantPatternPositions(n)}}updatePaintArrays(n,s,c,d,g,v){let w=!1;for(const S in n){const P=s.getPositions(S);for(const I of P){const D=c.feature(I.index);for(const z in this.binders){const N=this.binders[z];if((N instanceof Rs||N instanceof Aa||N instanceof kl)&&N.expression.isStateDependent===!0){const W=d.paint.get(z);N.expression=W.value,N.updatePaintArray(I.start,I.end,D,n[S],g,v),w=!0}}}}return w}defines(){const n=[];for(const s in this.binders){const c=this.binders[s];(c instanceof kp||c instanceof Eh)&&n.push(...c.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Rs||c instanceof Aa||c instanceof kl)for(let d=0;d<c.paintVertexAttributes.length;d++)n.push(c.paintVertexAttributes[d].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof kp||c instanceof Eh||c instanceof Aa)for(const d of c.uniformNames)n.push(d)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof kp||d instanceof Eh||d instanceof Aa)for(const g of d.uniformNames)s.push({name:g,property:c,binding:d.getBinding(n,g)})}return s}setUniforms(n,s,c,d,g){for(const{name:v,property:w,binding:S}of c)this.binders[w].setUniform(n,S,g,d.get(w),v)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Rs||s instanceof Aa||s instanceof kl)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const c=this.binders[s];(c instanceof Rs||c instanceof Aa||c instanceof kl)&&c.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Rs||s instanceof Aa||s instanceof kl)&&s.destroy()}}}class Ju{constructor(n,s,c=()=>!0){this.programConfigurations={};for(const d of n)this.programConfigurations[d.id]=new Dl(d,s,c);this.needsUpload=!1,this._featureMap=new l_,this._bufferOffset=0}populatePaintArrays(n,s,c,d,g,v,w){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(n,s,d,g,v,w);s.id!==void 0&&this._featureMap.add(s.id,c,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,c,d,g){for(const v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(n,this._featureMap,s,v,d,g)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const qF={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function ZF(a,n){return qF[a]||[a.replace(`${n}-`,"").replace(/-/g,"_")]}const HF={"line-pattern":{source:Ge,composite:Ge},"fill-pattern":{source:Ge,composite:Ge},"fill-extrusion-pattern":{source:Ge,composite:Ge},"line-dasharray":{source:rt,composite:rt}},XF={color:{source:Go,composite:dt},number:{source:Rr,composite:Go}};function nM(a,n,s){const c=HF[a];return c&&c[s]||XF[n][s]}It(kp,"ConstantBinder"),It(Eh,"PatternConstantBinder"),It(Rs,"SourceExpressionBinder"),It(kl,"PatternCompositeBinder"),It(Aa,"CompositeExpressionBinder"),It(Dl,"ProgramConfiguration",{omit:["_buffers"]}),It(Ju,"ProgramConfigurationSet");const iM="-transition";class Pa extends Eu{constructor(n,s){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&n.type!=="sky"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),s.layout&&(this._unevaluatedLayout=new ae(s.layout)),s.paint)){this._transitionablePaint=new H(s.paint);for(const c in n.paint)this.setPaintProperty(c,n.paint[c],{validate:!1});for(const c in n.layout)this.setLayoutProperty(c,n.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new se(s.paint)}}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s,c={}){s!=null&&this._validate(W1,`layers.${this.id}.layout.${n}`,n,s,c)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,s):this.visibility=s)}getPaintProperty(n){return Jt(n,iM)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s,c={}){if(s!=null&&this._validate(G1,`layers.${this.id}.paint.${n}`,n,s,c))return!1;if(Jt(n,iM))return this._transitionablePaint.setTransition(n.slice(0,-11),s||void 0),!1;{const d=this._transitionablePaint._values[n],g=d.value.isDataDriven(),v=d.value;this._transitionablePaint.setValue(n,s),this._handleSpecialPaintPropertyUpdate(n);const w=this._transitionablePaint._values[n].value,S=w.isDataDriven(),P=Jt(n,"pattern")||n==="line-dasharray";return S||g||P||this._handleOverridablePaintPropertyUpdate(n,v,w)}}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getProgramConfiguration(n){return null}_handleOverridablePaintPropertyUpdate(n,s,c){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Or(n,(s,c)=>!(s===void 0||c==="layout"&&!Object.keys(s).length||c==="paint"&&!Object.keys(s).length))}_validate(n,s,c,d,g={}){return(!g||g.validate!==!1)&&i_(this,n.call(n_,{key:s,layerType:this.type,objectKey:c,value:d,styleSpec:Je,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof oe&&Sl(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=vh(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const KF=ze([{name:"a_pos",components:2,type:"Int16"}],4),YF=ze([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class In{constructor(n=[]){this.segments=n}prepareSegment(n,s,c,d){let g=this.segments[this.segments.length-1];return n>In.MAX_VERTEX_ARRAY_LENGTH&&ir(`Max vertices per segment is ${In.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!g||g.vertexLength+n>In.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==d)&&(g={vertexOffset:s.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},d!==void 0&&(g.sortKey=d),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,c,d){return new In([{vertexOffset:n,primitiveOffset:s,vertexLength:c,primitiveLength:d,vaos:{},sortKey:0}])}}In.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,It(In,"SegmentVector");var Ut=8192;class Ll{constructor(n,s){n&&(s?this.setSouthWest(n).setNorthEast(s):n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1]))}setNorthEast(n){return this._ne=n instanceof Fr?new Fr(n.lng,n.lat):Fr.convert(n),this}setSouthWest(n){return this._sw=n instanceof Fr?new Fr(n.lng,n.lat):Fr.convert(n),this}extend(n){const s=this._sw,c=this._ne;let d,g;if(n instanceof Fr)d=n,g=n;else{if(!(n instanceof Ll))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Ll.convert(n)):this.extend(Fr.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(Fr.convert(n)):this;if(d=n._sw,g=n._ne,!d||!g)return this}return s||c?(s.lng=Math.min(d.lng,s.lng),s.lat=Math.min(d.lat,s.lat),c.lng=Math.max(g.lng,c.lng),c.lat=Math.max(g.lat,c.lat)):(this._sw=new Fr(d.lng,d.lat),this._ne=new Fr(g.lng,g.lat)),this}getCenter(){return new Fr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Fr(this.getWest(),this.getNorth())}getSouthEast(){return new Fr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:c}=Fr.convert(n);let d=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(n){return!n||n instanceof Ll?n:new Ll(n)}}var h_=1e-6,uo=typeof Float32Array<"u"?Float32Array:Array;function oM(){var a=new uo(9);return uo!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function aM(a,n,s){var c=n[0],d=n[1],g=n[2],v=n[3],w=n[4],S=n[5],P=n[6],I=n[7],D=n[8],z=s[0],N=s[1],W=s[2],J=s[3],te=s[4],le=s[5],ye=s[6],ce=s[7],me=s[8];return a[0]=z*c+N*v+W*P,a[1]=z*d+N*w+W*I,a[2]=z*g+N*S+W*D,a[3]=J*c+te*v+le*P,a[4]=J*d+te*w+le*I,a[5]=J*g+te*S+le*D,a[6]=ye*c+ce*v+me*P,a[7]=ye*d+ce*w+me*I,a[8]=ye*g+ce*S+me*D,a}function Ma(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Q1(a,n){var s=n[0],c=n[1],d=n[2],g=n[3],v=n[4],w=n[5],S=n[6],P=n[7],I=n[8],D=n[9],z=n[10],N=n[11],W=n[12],J=n[13],te=n[14],le=n[15],ye=s*w-c*v,ce=s*S-d*v,me=s*P-g*v,Se=c*S-d*w,we=c*P-g*w,Ze=d*P-g*S,Ue=I*J-D*W,Qe=I*te-z*W,mt=I*le-N*W,Xe=D*te-z*J,it=D*le-N*J,ot=z*le-N*te,ht=ye*ot-ce*it+me*Xe+Se*mt-we*Qe+Ze*Ue;return ht?(a[0]=(w*ot-S*it+P*Xe)*(ht=1/ht),a[1]=(d*it-c*ot-g*Xe)*ht,a[2]=(J*Ze-te*we+le*Se)*ht,a[3]=(z*we-D*Ze-N*Se)*ht,a[4]=(S*mt-v*ot-P*Qe)*ht,a[5]=(s*ot-d*mt+g*Qe)*ht,a[6]=(te*me-W*Ze-le*ce)*ht,a[7]=(I*Ze-z*me+N*ce)*ht,a[8]=(v*it-w*mt+P*Ue)*ht,a[9]=(c*mt-s*it-g*Ue)*ht,a[10]=(W*we-J*me+le*ye)*ht,a[11]=(D*me-I*we-N*ye)*ht,a[12]=(w*Qe-v*Xe-S*Ue)*ht,a[13]=(s*Xe-c*Qe+d*Ue)*ht,a[14]=(J*ce-W*Se-te*ye)*ht,a[15]=(I*Se-D*ce+z*ye)*ht,a):null}function Qu(a,n,s){var c=n[0],d=n[1],g=n[2],v=n[3],w=n[4],S=n[5],P=n[6],I=n[7],D=n[8],z=n[9],N=n[10],W=n[11],J=n[12],te=n[13],le=n[14],ye=n[15],ce=s[0],me=s[1],Se=s[2],we=s[3];return a[0]=ce*c+me*w+Se*D+we*J,a[1]=ce*d+me*S+Se*z+we*te,a[2]=ce*g+me*P+Se*N+we*le,a[3]=ce*v+me*I+Se*W+we*ye,a[4]=(ce=s[4])*c+(me=s[5])*w+(Se=s[6])*D+(we=s[7])*J,a[5]=ce*d+me*S+Se*z+we*te,a[6]=ce*g+me*P+Se*N+we*le,a[7]=ce*v+me*I+Se*W+we*ye,a[8]=(ce=s[8])*c+(me=s[9])*w+(Se=s[10])*D+(we=s[11])*J,a[9]=ce*d+me*S+Se*z+we*te,a[10]=ce*g+me*P+Se*N+we*le,a[11]=ce*v+me*I+Se*W+we*ye,a[12]=(ce=s[12])*c+(me=s[13])*w+(Se=s[14])*D+(we=s[15])*J,a[13]=ce*d+me*S+Se*z+we*te,a[14]=ce*g+me*P+Se*N+we*le,a[15]=ce*v+me*I+Se*W+we*ye,a}function Dp(a,n,s){var c,d,g,v,w,S,P,I,D,z,N,W,J=s[0],te=s[1],le=s[2];return n===a?(a[12]=n[0]*J+n[4]*te+n[8]*le+n[12],a[13]=n[1]*J+n[5]*te+n[9]*le+n[13],a[14]=n[2]*J+n[6]*te+n[10]*le+n[14],a[15]=n[3]*J+n[7]*te+n[11]*le+n[15]):(d=n[1],g=n[2],v=n[3],w=n[4],S=n[5],P=n[6],I=n[7],D=n[8],z=n[9],N=n[10],W=n[11],a[0]=c=n[0],a[1]=d,a[2]=g,a[3]=v,a[4]=w,a[5]=S,a[6]=P,a[7]=I,a[8]=D,a[9]=z,a[10]=N,a[11]=W,a[12]=c*J+w*te+D*le+n[12],a[13]=d*J+S*te+z*le+n[13],a[14]=g*J+P*te+N*le+n[14],a[15]=v*J+I*te+W*le+n[15]),a}function ec(a,n,s){var c=s[0],d=s[1],g=s[2];return a[0]=n[0]*c,a[1]=n[1]*c,a[2]=n[2]*c,a[3]=n[3]*c,a[4]=n[4]*d,a[5]=n[5]*d,a[6]=n[6]*d,a[7]=n[7]*d,a[8]=n[8]*g,a[9]=n[9]*g,a[10]=n[10]*g,a[11]=n[11]*g,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a}function eb(a,n,s){var c=Math.sin(s),d=Math.cos(s),g=n[4],v=n[5],w=n[6],S=n[7],P=n[8],I=n[9],D=n[10],z=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=g*d+P*c,a[5]=v*d+I*c,a[6]=w*d+D*c,a[7]=S*d+z*c,a[8]=P*d-g*c,a[9]=I*d-v*c,a[10]=D*d-w*c,a[11]=z*d-S*c,a}function f_(a,n,s){var c=Math.sin(s),d=Math.cos(s),g=n[0],v=n[1],w=n[2],S=n[3],P=n[8],I=n[9],D=n[10],z=n[11];return n!==a&&(a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=g*d-P*c,a[1]=v*d-I*c,a[2]=w*d-D*c,a[3]=S*d-z*c,a[8]=g*c+P*d,a[9]=v*c+I*d,a[10]=w*c+D*d,a[11]=S*c+z*d,a}function sM(a,n){return a[0]=n[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=n[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function lM(a,n,s){var c,d,g,v=s[0],w=s[1],S=s[2],P=Math.hypot(v,w,S);return P<h_?null:(v*=P=1/P,w*=P,S*=P,c=Math.sin(n),d=Math.cos(n),a[0]=v*v*(g=1-d)+d,a[1]=w*v*g+S*c,a[2]=S*v*g-w*c,a[3]=0,a[4]=v*w*g-S*c,a[5]=w*w*g+d,a[6]=S*w*g+v*c,a[7]=0,a[8]=v*S*g+w*c,a[9]=w*S*g-v*c,a[10]=S*S*g+d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,n=arguments.length;n--;)a+=arguments[n]*arguments[n];return Math.sqrt(a)});var JF=Qu;function tb(){var a=new uo(3);return uo!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function uM(a){var n=new uo(3);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n}function Lp(a){return Math.hypot(a[0],a[1],a[2])}function Ah(a,n,s){var c=new uo(3);return c[0]=a,c[1]=n,c[2]=s,c}function Bs(a,n,s){return a[0]=n[0]+s[0],a[1]=n[1]+s[1],a[2]=n[2]+s[2],a}function rb(a,n,s){return a[0]=n[0]-s[0],a[1]=n[1]-s[1],a[2]=n[2]-s[2],a}function cM(a,n,s){return a[0]=n[0]*s[0],a[1]=n[1]*s[1],a[2]=n[2]*s[2],a}function zp(a,n,s){return a[0]=Math.min(n[0],s[0]),a[1]=Math.min(n[1],s[1]),a[2]=Math.min(n[2],s[2]),a}function Rp(a,n,s){return a[0]=Math.max(n[0],s[0]),a[1]=Math.max(n[1],s[1]),a[2]=Math.max(n[2],s[2]),a}function So(a,n,s){return a[0]=n[0]*s,a[1]=n[1]*s,a[2]=n[2]*s,a}function Bp(a,n,s,c){return a[0]=n[0]+s[0]*c,a[1]=n[1]+s[1]*c,a[2]=n[2]+s[2]*c,a}function ki(a,n){var s=n[0],c=n[1],d=n[2],g=s*s+c*c+d*d;return g>0&&(g=1/Math.sqrt(g)),a[0]=n[0]*g,a[1]=n[1]*g,a[2]=n[2]*g,a}function Wo(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]}function nb(a,n,s){var c=n[0],d=n[1],g=n[2],v=s[0],w=s[1],S=s[2];return a[0]=d*S-g*w,a[1]=g*v-c*S,a[2]=c*w-d*v,a}function Sn(a,n,s){var c=n[0],d=n[1],g=n[2],v=s[3]*c+s[7]*d+s[11]*g+s[15];return a[0]=(s[0]*c+s[4]*d+s[8]*g+s[12])/(v=v||1),a[1]=(s[1]*c+s[5]*d+s[9]*g+s[13])/v,a[2]=(s[2]*c+s[6]*d+s[10]*g+s[14])/v,a}function hM(a,n,s){var c=s[0],d=s[1],g=s[2],v=n[0],w=n[1],S=n[2],P=d*S-g*w,I=g*v-c*S,D=c*w-d*v,z=d*D-g*I,N=g*P-c*D,W=c*I-d*P,J=2*s[3];return I*=J,D*=J,N*=2,W*=2,a[0]=v+(P*=J)+(z*=2),a[1]=w+I+N,a[2]=S+D+W,a}var jp,Ca=rb,QF=cM,e$=Lp;function fM(a,n,s){return a[0]=n[0]*s,a[1]=n[1]*s,a[2]=n[2]*s,a[3]=n[3]*s,a}function dM(a,n){var s=n[0],c=n[1],d=n[2],g=n[3],v=s*s+c*c+d*d+g*g;return v>0&&(v=1/Math.sqrt(v)),a[0]=s*v,a[1]=c*v,a[2]=d*v,a[3]=g*v,a}function tc(a,n,s){var c=n[0],d=n[1],g=n[2],v=n[3];return a[0]=s[0]*c+s[4]*d+s[8]*g+s[12]*v,a[1]=s[1]*c+s[5]*d+s[9]*g+s[13]*v,a[2]=s[2]*c+s[6]*d+s[10]*g+s[14]*v,a[3]=s[3]*c+s[7]*d+s[11]*g+s[15]*v,a}function pM(){var a=new uo(4);return uo!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function mM(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function gM(a,n,s){s*=.5;var c=n[0],d=n[1],g=n[2],v=n[3],w=Math.sin(s),S=Math.cos(s);return a[0]=c*S+v*w,a[1]=d*S+g*w,a[2]=g*S-d*w,a[3]=v*S-c*w,a}function yM(a,n,s){s*=.5;var c=n[0],d=n[1],g=n[2],v=n[3],w=Math.sin(s),S=Math.cos(s);return a[0]=c*S-g*w,a[1]=d*S+v*w,a[2]=g*S+c*w,a[3]=v*S-d*w,a}tb(),jp=new uo(4),uo!=Float32Array&&(jp[0]=0,jp[1]=0,jp[2]=0,jp[3]=0);var t$=dM;tb(),Ah(1,0,0),Ah(0,1,0),pM(),pM(),oM();const r$=ze([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:_M}=r$,vM=ze([{name:"a_pos_3",components:3,type:"Int16"}]);var Fp=ze([{name:"a_pos",type:"Int16",components:2}]);class ib{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,c){const d=Wo(s,this.dir);if(Math.abs(d)<1e-6)return!1;const g=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/d;return c[0]=this.pos[0]+this.dir[0]*g,c[1]=this.pos[1]+this.dir[1]*g,c[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(n,s,c){if(function(N,W){var J=N[0],te=N[1],le=N[2],ye=W[0],ce=W[1],me=W[2];return Math.abs(J-ye)<=h_*Math.max(1,Math.abs(J),Math.abs(ye))&&Math.abs(te-ce)<=h_*Math.max(1,Math.abs(te),Math.abs(ce))&&Math.abs(le-me)<=h_*Math.max(1,Math.abs(le),Math.abs(me))}(this.pos,n)||s===0)return c[0]=c[1]=c[2]=0,!1;const[d,g,v]=this.dir,w=this.pos[0]-n[0],S=this.pos[1]-n[1],P=this.pos[2]-n[2],I=d*d+g*g+v*v,D=2*(w*d+S*g+P*v),z=D*D-4*I*(w*w+S*S+P*P-s*s);if(z<0){const N=Math.max(-D/2,0),W=w+d*N,J=S+g*N,te=P+v*N,le=Math.hypot(W,J,te);return c[0]=W*s/le,c[1]=J*s/le,c[2]=te*s/le,!1}{const N=(-D-Math.sqrt(z))/(2*I);if(N<0){const W=Math.hypot(w,S,P);return c[0]=w*s/W,c[1]=S*s/W,c[2]=P*s/W,!1}return c[0]=w+d*N,c[1]=S+g*N,c[2]=P+v*N,!0}}}class ob{constructor(n,s,c,d,g){this.TL=n,this.TR=s,this.BR=c,this.BL=d,this.horizon=g}static fromInvProjectionMatrix(n,s,c){const d=[-1,1,1],g=[1,1,1],v=[1,-1,1],w=[-1,-1,1],S=Sn(d,d,n),P=Sn(g,g,n),I=Sn(v,v,n),D=Sn(w,w,n);return new ob(S,P,I,D,s/c)}}class ab{constructor(n,s){this.points=n,this.planes=s}static fromInvProjectionMatrix(n,s,c,d){const g=Math.pow(2,c),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const P=tc([],S,n),I=1/P[3]/s*g;return function(D,z,N){return D[0]=z[0]*N[0],D[1]=z[1]*N[1],D[2]=z[2]*N[2],D[3]=z[3]*N[3],D}(P,P,[I,I,d?1/P[3]:I,I])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const P=ki([],nb([],Ca([],v[S[0]],v[S[1]]),Ca([],v[S[2]],v[S[1]]))),I=-Wo(P,v[S[1]]);return P.concat(I)});return new ab(v,w)}}class Di{static fromPoints(n){const s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const d of n)zp(s,s,d),Rp(c,c,d);return new Di(s,c)}static applyTransform(n,s){const c=n.getCorners();for(let d=0;d<c.length;++d)Sn(c[d],c[d],s);return Di.fromPoints(c)}constructor(n,s){this.min=n,this.max=s,this.center=So([],Bs([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],c=uM(this.min),d=uM(this.max);for(let g=0;g<s.length;g++)c[g]=s[g]?this.min[g]:this.center[g],d[g]=s[g]?this.center[g]:this.max[g];return d[2]=this.max[2],new Di(c,d)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){const s=this.getCorners();let c=!0;for(let d=0;d<n.planes.length;d++){const g=n.planes[d];let v=0;for(let w=0;w<s.length;w++)v+=Wo(g,s[w])+g[3]>=0;if(v===0)return 0;v!==s.length&&(c=!1)}if(c)return 2;for(let d=0;d<3;d++){let g=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let w=0;w<n.points.length;w++){const S=n.points[w][d]-this.min[d];g=Math.min(g,S),v=Math.max(v,S)}if(v<0||g>this.max[d]-this.min[d])return 0}return 1}}const sb=5,xM=6,rs=Ut/Math.PI/2,n$=16383,rc=64,$p=[rc,32,16],qo=-rs,Zo=rs,i$=[new Di([qo,qo,qo],[Zo,Zo,Zo]),new Di([qo,qo,qo],[0,0,Zo]),new Di([0,qo,qo],[Zo,0,Zo]),new Di([qo,0,qo],[0,Zo,Zo]),new Di([0,0,qo],[Zo,Zo,Zo])];function d_(a){return a*rs/Vp}function bM(a,n,s,c=!0){const d=So([],a._camera.position,a.worldSize),g=[n,s,1,1];tc(g,g,a.pixelMatrixInverse),fM(g,g,1/g[3]);const v=ki([],Ca([],g,d)),w=a.globeMatrix,S=[w[12],w[13],w[14]],P=Ca([],S,d),I=Lp(P),D=ki([],P),z=a.worldSize/(2*Math.PI),N=Wo(D,v),W=Math.asin(z/I);if(W<Math.acos(N)){if(!c)return null;const mt=[],Xe=[];So(mt,v,I/N),ki(Xe,Ca(Xe,mt,P)),ki(v,Bs(v,P,So(v,Xe,Math.tan(W)*I)))}const J=[];new ib(d,v).closestPointOnSphere(S,z,J);const te=ki([],Wi(w,0)),le=ki([],Wi(w,1)),ye=ki([],Wi(w,2)),ce=Wo(te,J),me=Wo(le,J),Se=Wo(ye,J),we=be(Math.asin(-me/z));let Ze=be(Math.atan2(ce,Se));Ze=a.center.lng+function(mt,Xe){const it=(Xe-mt+180)%360-180;return it<-180?it+360:it}(a.center.lng,Ze);const Ue=is(Ze),Qe=Oe(os(we),0,1);return new Oh(Ue,Qe)}class o${constructor(n,s,c){this.a=Ca([],n,c),this.b=Ca([],s,c),this.center=c;const d=ki([],this.a),g=ki([],this.b);this.angle=Math.acos(Wo(d,g))}}function lb(a,n){if(a.angle===0)return null;let s;return s=a.a[n]===0?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[n]/a.a[n]/Math.sin(a.angle)-1/Math.tan(a.angle)),s<0||s>1?null:function(c,d,g,v){const w=Math.sin(g);return c*(Math.sin((1-v)*g)/w)+d*(Math.sin(v*g)/w)}(a.a[n],a.b[n],a.angle,Oe(s,0,1))+a.center[n]}function ns(a){if(a.z<=1)return i$[a.z+2*a.y+a.x];const n=ub(p_(a));return Di.fromPoints(n)}function nc(a,n,s){return So(a,a,1-s),Bp(a,a,n,s)}function wM(a,n){const s=Ch(n.zoom);if(s===0)return ns(a);const c=p_(a),d=ub(c),g=is(c.getWest())*n.worldSize,v=is(c.getEast())*n.worldSize,w=os(c.getNorth())*n.worldSize,S=os(c.getSouth())*n.worldSize,P=[g,w,0],I=[v,w,0],D=[g,S,0],z=[v,S,0],N=Q1([],n.globeMatrix);return Sn(P,P,N),Sn(I,I,N),Sn(D,D,N),Sn(z,z,N),d[0]=nc(d[0],D,s),d[1]=nc(d[1],z,s),d[2]=nc(d[2],I,s),d[3]=nc(d[3],P,s),Di.fromPoints(d)}function TM(a,n,s){for(const c of a)Sn(c,c,n),So(c,c,s)}function a$(a,n,s){const c=n/a.worldSize,d=a.globeMatrix;if(s.z<=1){const Ue=ns(s).getCorners();return TM(Ue,d,c),Di.fromPoints(Ue)}const g=p_(s),v=ub(g);TM(v,d,c);const w=Number.MAX_VALUE,S=[-w,-w,-w],P=[w,w,w];if(g.contains(a.center)){for(const mt of v)zp(P,P,mt),Rp(S,S,mt);S[2]=0;const Ue=a.point,Qe=[Ue.x*c,Ue.y*c,0];return zp(P,P,Qe),Rp(S,S,Qe),new Di(P,S)}const I=[d[12]*c,d[13]*c,d[14]*c],D=g.getCenter(),z=Oe(a.center.lat,-yi,yi),N=Oe(D.lat,-yi,yi),W=is(a.center.lng),J=os(z);let te=W-is(D.lng);const le=J-os(N);te>.5?te-=1:te<-.5&&(te+=1);let ye=0;Math.abs(te)>Math.abs(le)?ye=te>=0?1:3:(ye=le>=0?0:2,Bp(I,I,[d[4]*c,d[5]*c,d[6]*c],-Math.sin(Ve(le>=0?g.getSouth():g.getNorth()))*rs));const ce=v[ye],me=v[(ye+1)%4],Se=new o$(ce,me,I),we=[lb(Se,0)||ce[0],lb(Se,1)||ce[1],lb(Se,2)||ce[2]],Ze=Ch(a.zoom);if(Ze>0){const Ue=function({x:mt,y:Xe,z:it},ot,ht,vt,Ye){const Et=1/(1<<it);let Lt=mt*Et,At=Lt+Et,tr=Xe*Et,bt=tr+Et,Ft=0;const rr=(Lt+At)/2-vt;return rr>.5?Ft=-1:rr<-.5&&(Ft=1),Lt=((Lt+Ft)*ot-(vt*=ot))*ht+vt,At=((At+Ft)*ot-vt)*ht+vt,tr=(tr*ot-(Ye*=ot))*ht+Ye,bt=(bt*ot-Ye)*ht+Ye,[[Lt,bt,0],[At,bt,0],[At,tr,0],[Lt,tr,0]]}(s,n,a._pixelsPerMercatorPixel,W,J);for(let mt=0;mt<v.length;mt++)nc(v[mt],Ue[mt],Ze);const Qe=Bs([],Ue[ye],Ue[(ye+1)%4]);So(Qe,Qe,.5),nc(we,Qe,Ze)}for(const Ue of v)zp(P,P,Ue),Rp(S,S,Ue);return P[2]=Math.min(ce[2],me[2]),zp(P,P,we),Rp(S,S,we),new Di(P,S)}function p_({x:a,y:n,z:s}){const c=1/(1<<s),d=new Fr(Eo(a*c),gi((n+1)*c)),g=new Fr(Eo((a+1)*c),gi(n*c));return new Ll(d,g)}function ub(a){const n=Ve(a.getNorth()),s=Ve(a.getSouth()),c=Math.cos(n),d=Math.cos(s),g=Math.sin(n),v=Math.sin(s),w=a.getWest(),S=a.getEast();return[Ph(d,v,w),Ph(d,v,S),Ph(c,g,S),Ph(c,g,w)]}function Ph(a,n,s,c=rs){return s=Ve(s),[a*Math.sin(s)*c,-n*c,a*Math.cos(s)*c]}function Mh(a,n,s){return Ph(Math.cos(Ve(a)),Math.sin(Ve(a)),n,s)}function Np(a,n,s,c){const d=1<<s.z,g=(a/Ut+s.x)/d;return Mh(gi((n/Ut+s.y)/d),Eo(g),c)}function m_({min:a,max:n}){return n$/Math.max(n[0]-a[0],n[1]-a[1],n[2]-a[2])}const SM=new Float64Array(16);function Up(a){const n=m_(a),s=sM(SM,[n,n,n]);return Dp(s,s,((c=[])[0]=-(d=a.min)[0],c[1]=-d[1],c[2]=-d[2],c));var c,d}function cb(a){const n=(c=a.min,(s=SM)[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=c[0],s[13]=c[1],s[14]=c[2],s[15]=1,s);var s,c;const d=1/m_(a);return ec(n,n,[d,d,d])}function EM(a,n,s,c,d){const g=function(S){const P=Ut/(2*Math.PI);return S/(2*Math.PI)/P}(s),v=[a,n,-s/(2*Math.PI)],w=Ma(new Float64Array(16));return Dp(w,w,v),ec(w,w,[g,g,g]),eb(w,w,Ve(-d)),f_(w,w,Ve(-c)),w}function Ch(a){return at(sb,xM,a)}function AM(a,n){const s=Mh(n.lat,n.lng),c=function(W){const J=Mh(W._center.lat,W._center.lng);let te=nb([],Ah(0,1,0),J);const le=lM([],-W.angle,J);te=Sn(te,te,le),lM(le,-W._pitch,te);const ye=ki([],J);return So(ye,ye,d_(W.cameraToCenterDistance/W.pixelsPerMeter)),Sn(ye,ye,le),Bs([],J,ye)}(a);return v=(d=rb([],c,s))[0],w=d[1],S=d[2],P=(g=s)[0],I=g[1],D=g[2],N=(z=Math.sqrt(v*v+w*w+S*S)*Math.sqrt(P*P+I*I+D*D))&&Wo(d,g)/z,Math.acos(Math.min(Math.max(N,-1),1));var d,g,v,w,S,P,I,D,z,N}function hb(a,n){return AM(a,n)>Math.PI/2*1.01}const PM=Ve(85),s$=Math.cos(PM),l$=Math.sin(PM),Vp=63710088e-1,MM=2*Math.PI*Vp;class zl{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new zl(ft(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,c=this.lat*s,d=n.lat*s,g=Math.sin(c)*Math.sin(d)+Math.cos(c)*Math.cos(d)*Math.cos((n.lng-this.lng)*s);return Vp*Math.acos(Math.min(g,1))}toBounds(n=0){const s=360*n/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new Ll(new zl(this.lng-c,this.lat-s),new zl(this.lng+c,this.lat+s))}toEcef(n){const s=d_(n);return Mh(this.lat,this.lng,rs+s)}static convert(n){if(n instanceof zl)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new zl(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new zl(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Fr=zl;function fb(a){return MM*Math.cos(a*Math.PI/180)}function is(a){return(180+a)/360}function os(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Oa(a,n){return a/fb(n)}function Eo(a){return 360*a-180}function gi(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function CM(a,n){return a*fb(gi(n))}const yi=85.051129;function OM(a){return 1/Math.cos(a*Math.PI/180)}class Oh{constructor(n,s,c=0){this.x=+n,this.y=+s,this.z=+c}static fromLngLat(n,s=0){const c=Fr.convert(n);return new Oh(is(c.lng),os(c.lat),Oa(s,c.lat))}toLngLat(){return new Fr(Eo(this.x),gi(this.y))}toAltitude(){return CM(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/MM*OM(gi(this.y))}}function db(a,n,s,c,d,g,v,w,S){const P=(n+c)/2,I=(s+d)/2,D=new ge(P,I);w(D),function(z,N,W,J,te,le){const ye=W-te,ce=J-le;return Math.abs((J-N)*ye-(W-z)*ce)/Math.hypot(ye,ce)}(D.x,D.y,g.x,g.y,v.x,v.y)>=S?(db(a,n,s,P,I,g,D,w,S),db(a,P,I,c,d,D,v,w,S)):a.push(v)}function IM(a,n,s){let c=a[0],d=c.x,g=c.y;n(c);const v=[c];for(let w=1;w<a.length;w++){const S=a[w],{x:P,y:I}=S;n(S),db(v,d,g,P,I,c,S,n,s),d=P,g=I,c=S}return v}function pb(a,n,s,c){if(c(n,s)){const d=n.add(s)._mult(.5);pb(a,n,d,c),pb(a,d,s,c)}else a.push(s)}function u$(a,n){let s=a[0];const c=[s];for(let d=1;d<a.length;d++){const g=a[d];pb(c,s,g,n),s=g}return c}const mb=Math.pow(2,14)-1,kM=-mb-1;function c$(a,n){const s=Math.round(a.x*n),c=Math.round(a.y*n);return a.x=Oe(s,kM,mb),a.y=Oe(c,kM,mb),(s<a.x||s>a.x+1||c<a.y||c>a.y+1)&&ir("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function js(a,n,s){const c=a.loadGeometry(),d=a.extent,g=Ut/d;if(n&&s&&s.projection.isReprojectedInTileSpace){const v=1<<n.z,{scale:w,x:S,y:P,projection:I}=s,D=z=>{const N=Eo((n.x+z.x/d)/v),W=gi((n.y+z.y/d)/v),J=I.project(N,W);z.x=(J.x*w-S)*d,z.y=(J.y*w-P)*d};for(let z=0;z<c.length;z++)if(a.type!==1)c[z]=IM(c[z],D,1);else{const N=[];for(const W of c[z])W.x<0||W.x>=d||W.y<0||W.y>=d||(D(W),N.push(W));c[z]=N}}for(const v of c)for(const w of v)c$(w,g);return c}function ic(a,n){return{type:a.type,id:a.id,properties:a.properties,geometry:n?js(a):[]}}function g_(a,n,s,c,d){a.emplaceBack(2*n+(c+1)/2,2*s+(d+1)/2)}function y_(a,n,s){a.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class gb{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new pt,this.indexArray=new Bt,this.segments=new In,this.programConfigurations=new Ju(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,c,d){const g=this.layers[0],v=[];let w=null;g.type==="circle"&&(w=g.layout.get("circle-sort-key"));for(const{feature:P,id:I,index:D,sourceLayerIndex:z}of n){const N=this.layers[0]._featureFilter.needGeometry,W=ic(P,N);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),W,c))continue;const J=w?w.evaluate(W,{},c):void 0,te={id:I,properties:P.properties,type:P.type,sourceLayerIndex:z,index:D,geometry:N?W.geometry:js(P,c,d),patterns:{},sortKey:J};v.push(te)}w&&v.sort((P,I)=>P.sortKey-I.sortKey);let S=null;d.projection.name==="globe"&&(this.globeExtVertexArray=new gt,S=d.projection);for(const P of v){const{geometry:I,index:D,sourceLayerIndex:z}=P,N=n[D].feature;this.addFeature(P,I,D,s.availableImages,c,S),s.featureIndex.insert(N,I,D,z,this.index)}}update(n,s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,KF.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,YF.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,c,d,g,v){for(const w of s)for(const S of w){const P=S.x,I=S.y;if(P<0||P>=Ut||I<0||I>=Ut)continue;if(v){const N=v.projectTilePoint(P,I,g),W=v.upVector(g,P,I),J=this.globeExtVertexArray;y_(J,N,W),y_(J,N,W),y_(J,N,W),y_(J,N,W)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),z=D.vertexLength;g_(this.layoutVertexArray,P,I,-1,-1),g_(this.layoutVertexArray,P,I,1,-1),g_(this.layoutVertexArray,P,I,1,1),g_(this.layoutVertexArray,P,I,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+2,z+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,{},d,g)}}function DM(a,n){for(let s=0;s<a.length;s++)if(oc(n,a[s]))return!0;for(let s=0;s<n.length;s++)if(oc(a,n[s]))return!0;return!!yb(a,n)}function h$(a,n,s){return!!oc(a,n)||!!_b(n,a,s)}function LM(a,n){if(a.length===1)return RM(n,a[0]);for(let s=0;s<n.length;s++){const c=n[s];for(let d=0;d<c.length;d++)if(oc(a,c[d]))return!0}for(let s=0;s<a.length;s++)if(RM(n,a[s]))return!0;for(let s=0;s<n.length;s++)if(yb(a,n[s]))return!0;return!1}function f$(a,n,s){if(a.length>1){if(yb(a,n))return!0;for(let c=0;c<n.length;c++)if(_b(n[c],a,s))return!0}for(let c=0;c<a.length;c++)if(_b(a[c],n,s))return!0;return!1}function yb(a,n){if(a.length===0||n.length===0)return!1;for(let s=0;s<a.length-1;s++){const c=a[s],d=a[s+1];for(let g=0;g<n.length-1;g++)if(d$(c,d,n[g],n[g+1]))return!0}return!1}function d$(a,n,s,c){return kr(a,s,c)!==kr(n,s,c)&&kr(a,n,s)!==kr(a,n,c)}function _b(a,n,s){const c=s*s;if(n.length===1)return a.distSqr(n[0])<c;for(let d=1;d<n.length;d++)if(zM(a,n[d-1],n[d])<c)return!0;return!1}function zM(a,n,s){const c=n.distSqr(s);if(c===0)return a.distSqr(n);const d=((a.x-n.x)*(s.x-n.x)+(a.y-n.y)*(s.y-n.y))/c;return a.distSqr(d<0?n:d>1?s:s.sub(n)._mult(d)._add(n))}function RM(a,n){let s,c,d,g=!1;for(let v=0;v<a.length;v++){s=a[v];for(let w=0,S=s.length-1;w<s.length;S=w++)c=s[w],d=s[S],c.y>n.y!=d.y>n.y&&n.x<(d.x-c.x)*(n.y-c.y)/(d.y-c.y)+c.x&&(g=!g)}return g}function oc(a,n){let s=!1;for(let c=0,d=a.length-1;c<a.length;d=c++){const g=a[c],v=a[d];g.y>n.y!=v.y>n.y&&n.x<(v.x-g.x)*(n.y-g.y)/(v.y-g.y)+g.x&&(s=!s)}return s}function BM(a,n,s,c,d){for(const v of a)if(n<=v.x&&s<=v.y&&c>=v.x&&d>=v.y)return!0;const g=[new ge(n,s),new ge(n,d),new ge(c,d),new ge(c,s)];if(a.length>2){for(const v of g)if(oc(a,v))return!0}for(let v=0;v<a.length-1;v++)if(p$(a[v],a[v+1],g))return!0;return!1}function p$(a,n,s){const c=s[0],d=s[2];if(a.x<c.x&&n.x<c.x||a.x>d.x&&n.x>d.x||a.y<c.y&&n.y<c.y||a.y>d.y&&n.y>d.y)return!1;const g=kr(a,n,s[0]);return g!==kr(a,n,s[1])||g!==kr(a,n,s[2])||g!==kr(a,n,s[3])}function Ih(a,n,s){const c=n.paint.get(a).value;return c.kind==="constant"?c.value:s.programConfigurations.get(n.id).getMaxValue(a)}function __(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function jM(a,n,s,c,d){if(!n[0]&&!n[1])return a;const g=ge.convert(n)._mult(d);s==="viewport"&&g._rotate(-c);const v=[];for(let w=0;w<a.length;w++)v.push(a[w].sub(g));return v}function FM(a,n,s,c){const d=ge.convert(a)._mult(c);return n==="viewport"&&d._rotate(-s),d}It(gb,"CircleBucket",{omit:["layers"]});const m$=new de({"circle-sort-key":new ne(Je.layout_circle["circle-sort-key"])});var g$={paint:new de({"circle-radius":new ne(Je.paint_circle["circle-radius"]),"circle-color":new ne(Je.paint_circle["circle-color"]),"circle-blur":new ne(Je.paint_circle["circle-blur"]),"circle-opacity":new ne(Je.paint_circle["circle-opacity"]),"circle-translate":new X(Je.paint_circle["circle-translate"]),"circle-translate-anchor":new X(Je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new X(Je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new X(Je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ne(Je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ne(Je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ne(Je.paint_circle["circle-stroke-opacity"])}),layout:m$};function $M(a,n,s,c,d,g,v,w,S){if(g&&a.queryGeometry.isAboveHorizon)return!1;g&&(S*=a.pixelToTileUnitsFactor);const P=a.tileID.canonical,I=s.projection.upVectorScale(P,s.center.lat,s.worldSize).metersToTile;for(const D of n)for(const z of D){const N=z.add(w),W=d&&s.elevation?s.elevation.exaggeration()*d.getElevationAt(N.x,N.y,!0):0,J=s.projection.projectTilePoint(N.x,N.y,P);if(W>0){const ce=s.projection.upVector(P,N.x,N.y);J.x+=ce[0]*I*W,J.y+=ce[1]*I*W,J.z+=ce[2]*I*W}const te=g?N:y$(J.x,J.y,J.z,c),le=g?a.tilespaceRays.map(ce=>v$(ce,W)):a.queryGeometry.screenGeometry,ye=tc([],[J.x,J.y,J.z,1],c);if(!v&&g?S*=ye[3]/s.cameraToCenterDistance:v&&!g&&(S*=s.cameraToCenterDistance/ye[3]),g){const ce=gi((z.y/Ut+P.y)/(1<<P.z));S/=s.projection.pixelsPerMeter(ce,1)/Oa(1,ce)}if(h$(le,te,S))return!0}return!1}function y$(a,n,s,c){const d=tc([],[a,n,s,1],c);return new ge(d[0]/d[3],d[1]/d[3])}const NM=Ah(0,0,0),_$=Ah(0,0,1);function v$(a,n){const s=tb();return NM[2]=n,a.intersectsPlane(NM,_$,s),new ge(s[0],s[1])}class UM extends gb{}function VM(a,{width:n,height:s},c,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==n*s*c)throw new RangeError("mismatched image size")}else d=new Uint8Array(n*s*c);return a.width=n,a.height=s,a.data=d,a}function GM(a,n,s){const{width:c,height:d}=n;c===a.width&&d===a.height||(vb(a,n,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,c),height:Math.min(a.height,d)},s),a.width=c,a.height=d,a.data=n.data)}function vb(a,n,s,c,d,g){if(d.width===0||d.height===0)return n;if(d.width>a.width||d.height>a.height||s.x>a.width-d.width||s.y>a.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>n.width||d.height>n.height||c.x>n.width-d.width||c.y>n.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const v=a.data,w=n.data;for(let S=0;S<d.height;S++){const P=((s.y+S)*a.width+s.x)*g,I=((c.y+S)*n.width+c.x)*g;for(let D=0;D<d.width*g;D++)w[I+D]=v[P+D]}return n}It(UM,"HeatmapBucket",{omit:["layers"]});class Fs{constructor(n,s){VM(this,n,1,s)}resize(n){GM(this,new Fs(n),1)}clone(){return new Fs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,d,g){vb(n,s,c,d,g,1)}}class co{constructor(n,s){VM(this,n,4,s)}resize(n){GM(this,new co(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new co({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,d,g){vb(n,s,c,d,g,4)}}It(Fs,"AlphaImage"),It(co,"RGBAImage");var x$={paint:new de({"heatmap-radius":new ne(Je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ne(Je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new X(Je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fe(Je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new X(Je.paint_heatmap["heatmap-opacity"])})};function xb(a){const n={},s=a.resolution||256,c=a.clips?a.clips.length:1,d=a.image||new co({width:s,height:c}),g=(v,w,S)=>{n[a.evaluationKey]=S;const P=a.expression.evaluate(n);d.data[v+w+0]=Math.floor(255*P.r/P.a),d.data[v+w+1]=Math.floor(255*P.g/P.a),d.data[v+w+2]=Math.floor(255*P.b/P.a),d.data[v+w+3]=Math.floor(255*P.a)};if(a.clips)for(let v=0,w=0;v<c;++v,w+=4*s)for(let S=0,P=0;S<s;S++,P+=4){const I=S/(s-1),{start:D,end:z}=a.clips[v];g(w,P,D*(1-I)+z*I)}else for(let v=0,w=0;v<s;v++,w+=4)g(0,w,v/(s-1));return d}var b$={paint:new de({"hillshade-illumination-direction":new X(Je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new X(Je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new X(Je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new X(Je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new X(Je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new X(Je.paint_hillshade["hillshade-accent-color"])})};const w$=ze([{name:"a_pos",components:2,type:"Int16"}],4),{members:T$}=w$;var bb={exports:{}};function v_(a,n,s){s=s||2;var c,d,g,v,w,S,P,I=n&&n.length,D=I?n[0]*s:a.length,z=WM(a,0,D,s,!0),N=[];if(!z||z.next===z.prev)return N;if(I&&(z=function(J,te,le,ye){var ce,me,Se,we=[];for(ce=0,me=te.length;ce<me;ce++)(Se=WM(J,te[ce]*ye,ce<me-1?te[ce+1]*ye:J.length,ye,!1))===Se.next&&(Se.steiner=!0),we.push(I$(Se));for(we.sort(M$),ce=0;ce<we.length;ce++)le=C$(we[ce],le);return le}(a,n,z,s)),a.length>80*s){c=g=a[0],d=v=a[1];for(var W=s;W<D;W+=s)(w=a[W])<c&&(c=w),(S=a[W+1])<d&&(d=S),w>g&&(g=w),S>v&&(v=S);P=(P=Math.max(g-c,v-d))!==0?32767/P:0}return Gp(z,N,s,c,d,P,0),N}function WM(a,n,s,c,d){var g,v;if(d===Sb(a,n,s,c)>0)for(g=n;g<s;g+=c)v=HM(g,a[g],a[g+1],v);else for(g=s-c;g>=n;g-=c)v=HM(g,a[g],a[g+1],v);return v&&x_(v,v.next)&&(qp(v),v=v.next),v}function ac(a,n){if(!a)return a;n||(n=a);var s,c=a;do if(s=!1,c.steiner||!x_(c,c.next)&&kn(c.prev,c,c.next)!==0)c=c.next;else{if(qp(c),(c=n=c.prev)===c.next)break;s=!0}while(s||c!==n);return n}function Gp(a,n,s,c,d,g,v){if(a){!v&&g&&function(I,D,z,N){var W=I;do W.z===0&&(W.z=wb(W.x,W.y,D,z,N)),W.prevZ=W.prev,W.nextZ=W.next,W=W.next;while(W!==I);W.prevZ.nextZ=null,W.prevZ=null,function(J){var te,le,ye,ce,me,Se,we,Ze,Ue=1;do{for(le=J,J=null,me=null,Se=0;le;){for(Se++,ye=le,we=0,te=0;te<Ue&&(we++,ye=ye.nextZ);te++);for(Ze=Ue;we>0||Ze>0&&ye;)we!==0&&(Ze===0||!ye||le.z<=ye.z)?(ce=le,le=le.nextZ,we--):(ce=ye,ye=ye.nextZ,Ze--),me?me.nextZ=ce:J=ce,ce.prevZ=me,me=ce;le=ye}me.nextZ=null,Ue*=2}while(Se>1)}(W)}(a,c,d,g);for(var w,S,P=a;a.prev!==a.next;)if(w=a.prev,S=a.next,g?E$(a,c,d,g):S$(a))n.push(w.i/s|0),n.push(a.i/s|0),n.push(S.i/s|0),qp(a),a=S.next,P=S.next;else if((a=S)===P){v?v===1?Gp(a=A$(ac(a),n,s),n,s,c,d,g,2):v===2&&P$(a,n,s,c,d,g):Gp(ac(a),n,s,c,d,g,1);break}}}function S$(a){var n=a.prev,s=a,c=a.next;if(kn(n,s,c)>=0)return!1;for(var d=n.x,g=s.x,v=c.x,w=n.y,S=s.y,P=c.y,I=d<g?d<v?d:v:g<v?g:v,D=w<S?w<P?w:P:S<P?S:P,z=d>g?d>v?d:v:g>v?g:v,N=w>S?w>P?w:P:S>P?S:P,W=c.next;W!==n;){if(W.x>=I&&W.x<=z&&W.y>=D&&W.y<=N&&kh(d,w,g,S,v,P,W.x,W.y)&&kn(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function E$(a,n,s,c){var d=a.prev,g=a,v=a.next;if(kn(d,g,v)>=0)return!1;for(var w=d.x,S=g.x,P=v.x,I=d.y,D=g.y,z=v.y,N=w<S?w<P?w:P:S<P?S:P,W=I<D?I<z?I:z:D<z?D:z,J=w>S?w>P?w:P:S>P?S:P,te=I>D?I>z?I:z:D>z?D:z,le=wb(N,W,n,s,c),ye=wb(J,te,n,s,c),ce=a.prevZ,me=a.nextZ;ce&&ce.z>=le&&me&&me.z<=ye;){if(ce.x>=N&&ce.x<=J&&ce.y>=W&&ce.y<=te&&ce!==d&&ce!==v&&kh(w,I,S,D,P,z,ce.x,ce.y)&&kn(ce.prev,ce,ce.next)>=0||(ce=ce.prevZ,me.x>=N&&me.x<=J&&me.y>=W&&me.y<=te&&me!==d&&me!==v&&kh(w,I,S,D,P,z,me.x,me.y)&&kn(me.prev,me,me.next)>=0))return!1;me=me.nextZ}for(;ce&&ce.z>=le;){if(ce.x>=N&&ce.x<=J&&ce.y>=W&&ce.y<=te&&ce!==d&&ce!==v&&kh(w,I,S,D,P,z,ce.x,ce.y)&&kn(ce.prev,ce,ce.next)>=0)return!1;ce=ce.prevZ}for(;me&&me.z<=ye;){if(me.x>=N&&me.x<=J&&me.y>=W&&me.y<=te&&me!==d&&me!==v&&kh(w,I,S,D,P,z,me.x,me.y)&&kn(me.prev,me,me.next)>=0)return!1;me=me.nextZ}return!0}function A$(a,n,s){var c=a;do{var d=c.prev,g=c.next.next;!x_(d,g)&&qM(d,c,c.next,g)&&Wp(d,g)&&Wp(g,d)&&(n.push(d.i/s|0),n.push(c.i/s|0),n.push(g.i/s|0),qp(c),qp(c.next),c=a=g),c=c.next}while(c!==a);return ac(c)}function P$(a,n,s,c,d,g){var v=a;do{for(var w=v.next.next;w!==v.prev;){if(v.i!==w.i&&k$(v,w)){var S=ZM(v,w);return v=ac(v,v.next),S=ac(S,S.next),Gp(v,n,s,c,d,g,0),void Gp(S,n,s,c,d,g,0)}w=w.next}v=v.next}while(v!==a)}function M$(a,n){return a.x-n.x}function C$(a,n){var s=function(d,g){var v,w=g,S=d.x,P=d.y,I=-1/0;do{if(P<=w.y&&P>=w.next.y&&w.next.y!==w.y){var D=w.x+(P-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(D<=S&&D>I&&(I=D,v=w.x<w.next.x?w:w.next,D===S))return v}w=w.next}while(w!==g);if(!v)return null;var z,N=v,W=v.x,J=v.y,te=1/0;w=v;do S>=w.x&&w.x>=W&&S!==w.x&&kh(P<J?S:I,P,W,J,P<J?I:S,P,w.x,w.y)&&(z=Math.abs(P-w.y)/(S-w.x),Wp(w,d)&&(z<te||z===te&&(w.x>v.x||w.x===v.x&&O$(v,w)))&&(v=w,te=z)),w=w.next;while(w!==N);return v}(a,n);if(!s)return n;var c=ZM(s,a);return ac(c,c.next),ac(s,s.next)}function O$(a,n){return kn(a.prev,a,n.prev)<0&&kn(n.next,a,a.next)<0}function wb(a,n,s,c,d){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-s)*d|0)|a<<8))|a<<4))|a<<2))|a<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-c)*d|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function I$(a){var n=a,s=a;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==a);return s}function kh(a,n,s,c,d,g,v,w){return(d-v)*(n-w)>=(a-v)*(g-w)&&(a-v)*(c-w)>=(s-v)*(n-w)&&(s-v)*(g-w)>=(d-v)*(c-w)}function k$(a,n){return a.next.i!==n.i&&a.prev.i!==n.i&&!function(s,c){var d=s;do{if(d.i!==s.i&&d.next.i!==s.i&&d.i!==c.i&&d.next.i!==c.i&&qM(d,d.next,s,c))return!0;d=d.next}while(d!==s);return!1}(a,n)&&(Wp(a,n)&&Wp(n,a)&&function(s,c){var d=s,g=!1,v=(s.x+c.x)/2,w=(s.y+c.y)/2;do d.y>w!=d.next.y>w&&d.next.y!==d.y&&v<(d.next.x-d.x)*(w-d.y)/(d.next.y-d.y)+d.x&&(g=!g),d=d.next;while(d!==s);return g}(a,n)&&(kn(a.prev,a,n.prev)||kn(a,n.prev,n))||x_(a,n)&&kn(a.prev,a,a.next)>0&&kn(n.prev,n,n.next)>0)}function kn(a,n,s){return(n.y-a.y)*(s.x-n.x)-(n.x-a.x)*(s.y-n.y)}function x_(a,n){return a.x===n.x&&a.y===n.y}function qM(a,n,s,c){var d=w_(kn(a,n,s)),g=w_(kn(a,n,c)),v=w_(kn(s,c,a)),w=w_(kn(s,c,n));return d!==g&&v!==w||!(d!==0||!b_(a,s,n))||!(g!==0||!b_(a,c,n))||!(v!==0||!b_(s,a,c))||!(w!==0||!b_(s,n,c))}function b_(a,n,s){return n.x<=Math.max(a.x,s.x)&&n.x>=Math.min(a.x,s.x)&&n.y<=Math.max(a.y,s.y)&&n.y>=Math.min(a.y,s.y)}function w_(a){return a>0?1:a<0?-1:0}function Wp(a,n){return kn(a.prev,a,a.next)<0?kn(a,n,a.next)>=0&&kn(a,a.prev,n)>=0:kn(a,n,a.prev)<0||kn(a,a.next,n)<0}function ZM(a,n){var s=new Tb(a.i,a.x,a.y),c=new Tb(n.i,n.x,n.y),d=a.next,g=n.prev;return a.next=n,n.prev=a,s.next=d,d.prev=s,c.next=s,s.prev=c,g.next=c,c.prev=g,c}function HM(a,n,s,c){var d=new Tb(a,n,s);return c?(d.next=c.next,d.prev=c,c.next.prev=d,c.next=d):(d.prev=d,d.next=d),d}function qp(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Tb(a,n,s){this.i=a,this.x=n,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Sb(a,n,s,c){for(var d=0,g=n,v=s-c;g<s;g+=c)d+=(a[v]-a[g])*(a[g+1]+a[v+1]),v=g;return d}bb.exports=v_,bb.exports.default=v_,v_.deviation=function(a,n,s,c){var d=n&&n.length,g=Math.abs(Sb(a,0,d?n[0]*s:a.length,s));if(d)for(var v=0,w=n.length;v<w;v++)g-=Math.abs(Sb(a,n[v]*s,v<w-1?n[v+1]*s:a.length,s));var S=0;for(v=0;v<c.length;v+=3){var P=c[v]*s,I=c[v+1]*s,D=c[v+2]*s;S+=Math.abs((a[P]-a[D])*(a[I+1]-a[P+1])-(a[P]-a[I])*(a[D+1]-a[P+1]))}return g===0&&S===0?0:Math.abs((S-g)/g)},v_.flatten=function(a){for(var n=a[0][0].length,s={vertices:[],holes:[],dimensions:n},c=0,d=0;d<a.length;d++){for(var g=0;g<a[d].length;g++)for(var v=0;v<n;v++)s.vertices.push(a[d][g][v]);d>0&&s.holes.push(c+=a[d-1].length)}return s};var Eb=G(bb.exports);function D$(a,n,s,c,d){XM(a,n,s,c||a.length-1,d||L$)}function XM(a,n,s,c,d){for(;c>s;){if(c-s>600){var g=c-s+1,v=n-s+1,w=Math.log(g),S=.5*Math.exp(2*w/3),P=.5*Math.sqrt(w*S*(g-S)/g)*(v-g/2<0?-1:1);XM(a,n,Math.max(s,Math.floor(n-v*S/g+P)),Math.min(c,Math.floor(n+(g-v)*S/g+P)),d)}var I=a[n],D=s,z=c;for(Zp(a,s,n),d(a[c],I)>0&&Zp(a,s,c);D<z;){for(Zp(a,D,z),D++,z--;d(a[D],I)<0;)D++;for(;d(a[z],I)>0;)z--}d(a[s],I)===0?Zp(a,s,z):Zp(a,++z,c),z<=n&&(s=z+1),n<=z&&(c=z-1)}}function Zp(a,n,s){var c=a[n];a[n]=a[s],a[s]=c}function L$(a,n){return a<n?-1:a>n?1:0}function Ab(a,n){const s=a.length;if(s<=1)return[a];const c=[];let d,g;for(let v=0;v<s;v++){const w=qn(a[v]);w!==0&&(a[v].area=Math.abs(w),g===void 0&&(g=w<0),g===w<0?(d&&c.push(d),d=[a[v]]):d.push(a[v]))}if(d&&c.push(d),n>1)for(let v=0;v<c.length;v++)c[v].length<=n||(D$(c[v],n,1,c[v].length-1,z$),c[v]=c[v].slice(0,n));return c}function z$(a,n){return n.area-a.area}function Pb(a,n,s){const c=s.patternDependencies;let d=!1;for(const g of n){const v=g.paint.get(`${a}-pattern`);v.isConstant()||(d=!0);const w=v.constantOr(null);w&&(d=!0,c[w]=!0)}return d}function Mb(a,n,s,c,d){const g=d.patternDependencies;for(const v of n){const w=v.paint.get(`${a}-pattern`).value;if(w.kind!=="constant"){let S=w.evaluate({zoom:c},s,{},d.availableImages);S=S&&S.name?S.name:S,g[S]=!0,s.patterns[v.id]=S}}return s}class T_{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pt,this.indexArray=new Bt,this.indexArray2=new Kn,this.programConfigurations=new Ju(n.layers,n.zoom),this.segments=new In,this.segments2=new In,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=n.projection}populate(n,s,c,d){this.hasPattern=Pb("fill",this.layers,s);const g=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:w,id:S,index:P,sourceLayerIndex:I}of n){const D=this.layers[0]._featureFilter.needGeometry,z=ic(w,D);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),z,c))continue;const N=g?g.evaluate(z,{},c,s.availableImages):void 0,W={id:S,properties:w.properties,type:w.type,sourceLayerIndex:I,index:P,geometry:D?z.geometry:js(w,c,d),patterns:{},sortKey:N};v.push(W)}g&&v.sort((w,S)=>w.sortKey-S.sortKey);for(const w of v){const{geometry:S,index:P,sourceLayerIndex:I}=w;if(this.hasPattern){const D=Mb("fill",this.layers,w,this.zoom,s);this.patternFeatures.push(D)}else this.addFeature(w,S,P,c,{},s.availableImages);s.featureIndex.insert(n[P].feature,S,P,I,this.index)}}update(n,s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,d)}addFeatures(n,s,c,d,g){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,s,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,T$),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,c,d,g,v=[]){for(const w of Ab(s,500)){let S=0;for(const W of w)S+=W.length;const P=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),I=P.vertexLength,D=[],z=[];for(const W of w){if(W.length===0)continue;W!==w[0]&&z.push(D.length/2);const J=this.segments2.prepareSegment(W.length,this.layoutVertexArray,this.indexArray2),te=J.vertexLength;this.layoutVertexArray.emplaceBack(W[0].x,W[0].y),this.indexArray2.emplaceBack(te+W.length-1,te),D.push(W[0].x),D.push(W[0].y);for(let le=1;le<W.length;le++)this.layoutVertexArray.emplaceBack(W[le].x,W[le].y),this.indexArray2.emplaceBack(te+le-1,te+le),D.push(W[le].x),D.push(W[le].y);J.vertexLength+=W.length,J.primitiveLength+=W.length}const N=Eb(D,z);for(let W=0;W<N.length;W+=3)this.indexArray.emplaceBack(I+N[W],I+N[W+1],I+N[W+2]);P.vertexLength+=S,P.primitiveLength+=N.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,g,v,d)}}It(T_,"FillBucket",{omit:["layers","patternFeatures"]});const R$=new de({"fill-sort-key":new ne(Je.layout_fill["fill-sort-key"])});var B$={paint:new de({"fill-antialias":new X(Je.paint_fill["fill-antialias"]),"fill-opacity":new ne(Je.paint_fill["fill-opacity"]),"fill-color":new ne(Je.paint_fill["fill-color"]),"fill-outline-color":new ne(Je.paint_fill["fill-outline-color"]),"fill-translate":new X(Je.paint_fill["fill-translate"]),"fill-translate-anchor":new X(Je.paint_fill["fill-translate-anchor"]),"fill-pattern":new ne(Je.paint_fill["fill-pattern"])}),layout:R$};const j$=ze([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),F$=ze([{name:"a_centroid_pos",components:2,type:"Uint16"}]),$$=ze([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:N$}=j$;var S_={},U$=pe,KM=Dh;function Dh(a,n,s,c,d){this.properties={},this.extent=s,this.type=0,this._pbf=a,this._geometry=-1,this._keys=c,this._values=d,a.readFields(V$,this,n)}function V$(a,n,s){a==1?n.id=s.readVarint():a==2?function(c,d){for(var g=c.readVarint()+c.pos;c.pos<g;){var v=d._keys[c.readVarint()],w=d._values[c.readVarint()];d.properties[v]=w}}(s,n):a==3?n.type=s.readVarint():a==4&&(n._geometry=s.pos)}function G$(a){for(var n,s,c=0,d=0,g=a.length,v=g-1;d<g;v=d++)c+=((s=a[v]).x-(n=a[d]).x)*(n.y+s.y);return c}Dh.types=["Unknown","Point","LineString","Polygon"],Dh.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var n,s=a.readVarint()+a.pos,c=1,d=0,g=0,v=0,w=[];a.pos<s;){if(d<=0){var S=a.readVarint();c=7&S,d=S>>3}if(d--,c===1||c===2)g+=a.readSVarint(),v+=a.readSVarint(),c===1&&(n&&w.push(n),n=[]),n.push(new U$(g,v));else{if(c!==7)throw new Error("unknown command "+c);n&&n.push(n[0].clone())}}return n&&w.push(n),w},Dh.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var n=a.readVarint()+a.pos,s=1,c=0,d=0,g=0,v=1/0,w=-1/0,S=1/0,P=-1/0;a.pos<n;){if(c<=0){var I=a.readVarint();s=7&I,c=I>>3}if(c--,s===1||s===2)(d+=a.readSVarint())<v&&(v=d),d>w&&(w=d),(g+=a.readSVarint())<S&&(S=g),g>P&&(P=g);else if(s!==7)throw new Error("unknown command "+s)}return[v,S,w,P]},Dh.prototype.toGeoJSON=function(a,n,s){var c,d,g=this.extent*Math.pow(2,s),v=this.extent*a,w=this.extent*n,S=this.loadGeometry(),P=Dh.types[this.type];function I(N){for(var W=0;W<N.length;W++){var J=N[W];N[W]=[360*(J.x+v)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(J.y+w)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(c=0;c<S.length;c++)D[c]=S[c][0];I(S=D);break;case 2:for(c=0;c<S.length;c++)I(S[c]);break;case 3:for(S=function(N){var W=N.length;if(W<=1)return[N];for(var J,te,le=[],ye=0;ye<W;ye++){var ce=G$(N[ye]);ce!==0&&(te===void 0&&(te=ce<0),te===ce<0?(J&&le.push(J),J=[N[ye]]):J.push(N[ye]))}return J&&le.push(J),le}(S),c=0;c<S.length;c++)for(d=0;d<S[c].length;d++)I(S[c][d])}S.length===1?S=S[0]:P="Multi"+P;var z={type:"Feature",geometry:{type:P,coordinates:S},properties:this.properties};return"id"in this&&(z.id=this.id),z};var W$=KM,YM=JM;function JM(a,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(q$,this,n),this.length=this._features.length}function q$(a,n,s){a===15?n.version=s.readVarint():a===1?n.name=s.readString():a===5?n.extent=s.readVarint():a===2?n._features.push(s.pos):a===3?n._keys.push(s.readString()):a===4&&n._values.push(function(c){for(var d=null,g=c.readVarint()+c.pos;c.pos<g;){var v=c.readVarint()>>3;d=v===1?c.readString():v===2?c.readFloat():v===3?c.readDouble():v===4?c.readVarint64():v===5?c.readVarint():v===6?c.readSVarint():v===7?c.readBoolean():null}return d}(s))}JM.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var n=this._pbf.readVarint()+this._pbf.pos;return new W$(this._pbf,n,this.extent,this._keys,this._values)};var Z$=YM;function H$(a,n,s){if(a===3){var c=new Z$(s,s.readVarint()+s.pos);c.length&&(n[c.name]=c)}}var Cb=S_.VectorTile=function(a,n){this.layers=a.readFields(H$,{},n)},E_=S_.VectorTileFeature=KM;function A_(a,n,s,c){const d=[],g=c===0?(v,w,S,P,I,D)=>{v.push(new ge(D,S+(D-w)/(P-w)*(I-S)))}:(v,w,S,P,I,D)=>{v.push(new ge(w+(D-S)/(I-S)*(P-w),D))};for(const v of a){const w=[];for(const S of v){if(S.length<=2)continue;const P=[];for(let z=0;z<S.length-1;z++){const N=S[z].x,W=S[z].y,J=S[z+1].x,te=S[z+1].y,le=c===0?N:W,ye=c===0?J:te;le<n?ye>n&&g(P,N,W,J,te,n):le>s?ye<s&&g(P,N,W,J,te,s):P.push(S[z]),ye<n&&le>=n&&g(P,N,W,J,te,n),ye>s&&le<=s&&g(P,N,W,J,te,s)}let I=S[S.length-1];const D=c===0?I.x:I.y;D>=n&&D<=s&&P.push(I),P.length&&(I=P[P.length-1],P[0].x===I.x&&P[0].y===I.y||P.push(P[0]),w.push(P))}w.length&&d.push(w)}return d}S_.VectorTileLayer=YM;const X$=E_.types,K$=Math.pow(2,13);function Hp(a,n,s,c,d,g,v,w){a.emplaceBack((n<<1)+v,(s<<1)+g,(Math.floor(c*K$)<<1)+d,Math.round(w))}function Xp(a,n,s){a.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class QM{constructor(){this.acc=new ge(0,0),this.polyCount=[]}startRing(n){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ge(n.x,n.y),this.max=new ge(n.x,n.y))}append(n,s){this.currentPolyCount.edges++,this.acc._add(n);const c=this.min,d=this.max;n.x<c.x?c.x=n.x:n.x>d.x&&(d.x=n.x),n.y<c.y?c.y=n.y:n.y>d.y&&(d.y=n.y),((n.x===0||n.x===Ut)&&n.x===s.x)!=((n.y===0||n.y===Ut)&&n.y===s.y)&&this.processBorderOverlap(n,s),s.x<0!=n.x<0&&this.addBorderIntersection(0,gr(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>Ut!=n.x>Ut&&this.addBorderIntersection(1,gr(s.y,n.y,(Ut-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,gr(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>Ut!=n.y>Ut&&this.addBorderIntersection(3,gr(s.x,n.x,(Ut-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[n];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const c=n.x===0?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,n.y)}else{const c=n.y===0?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,n.x)}}centroid(){const n=this.polyCount.reduce((s,c)=>s+c.edges,0);return n!==0?this.acc.div(n)._round():new ge(0,0)}span(){return new ge(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((n,s)=>n+ +(s[0]!==Number.MAX_VALUE),0)}}class Kp{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.layoutVertexArray=new nt,this.centroidVertexArray=new Ea,this.indexArray=new Bt,this.programConfigurations=new Ju(n.layers,n.zoom),this.segments=new In,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.enableTerrain=n.enableTerrain}populate(n,s,c,d){this.features=[],this.hasPattern=Pb("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(g){const v=Math.exp(Math.PI*(1-g.y/(1<<g.z)*2));return 80150034*v/(v*v+1)/Ut/(1<<g.z)}(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:g,id:v,index:w,sourceLayerIndex:S}of n){const P=this.layers[0]._featureFilter.needGeometry,I=ic(g,P);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),I,c))continue;const D={id:v,sourceLayerIndex:S,index:w,geometry:P?I.geometry:js(g,c,d),properties:g.properties,type:g.type,patterns:{}},z=this.layoutVertexArray.length;this.hasPattern?this.features.push(Mb("fill-extrusion",this.layers,D,this.zoom,s)):this.addFeature(D,D.geometry,w,c,{},s.availableImages,d),s.featureIndex.insert(g,D.geometry,w,S,this.index,z)}this.sortBorders()}addFeatures(n,s,c,d,g){for(const v of this.features){const{geometry:w}=v;this.addFeature(v,w,v.index,s,c,d,g)}this.sortBorders()}update(n,s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,N$),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,$$.members,!0))),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,F$.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,c,d,g,v,w){const S=[new ge(0,0),new ge(Ut,Ut)],P=w.projection,I=P.name==="globe",D=this.enableTerrain&&!I?new QM:null,z=X$[n.type]==="Polygon";I&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new gt);const N=Ab(s,500);for(let le=N.length-1;le>=0;le--){const ye=N[le];(ye.length===0||(W=ye[0]).every(ce=>ce.x<=0)||W.every(ce=>ce.x>=Ut)||W.every(ce=>ce.y<=0)||W.every(ce=>ce.y>=Ut))&&N.splice(le,1)}var W;let J;if(I)J=aC(N,S,d);else{J=[];for(const le of N)J.push({polygon:le,bounds:S})}const te=z?this.edgeRadius:0;for(const{polygon:le,bounds:ye}of J){let ce=0,me=0;for(const we of le)z&&!we[0].equals(we[we.length-1])&&we.push(we[0]),me+=z?we.length-1:we.length;const Se=this.segments.prepareSegment((z?5:4)*me,this.layoutVertexArray,this.indexArray);if(z){const we=[],Ze=[];ce=Se.vertexLength;for(const Qe of le){let mt,Xe;Qe.length&&Qe!==le[0]&&Ze.push(we.length/2),mt=Qe[1].sub(Qe[0])._perp()._unit();for(let it=1;it<Qe.length;it++){const ot=Qe[it],ht=Qe[it===Qe.length-1?1:it+1];let{x:vt,y:Ye}=ot;if(te){Xe=ht.sub(ot)._perp()._unit();const Et=mt.add(Xe)._unit(),Lt=te*Math.min(4,1/(mt.x*Et.x+mt.y*Et.y));vt+=Lt*Et.x,Ye+=Lt*Et.y,mt=Xe}Hp(this.layoutVertexArray,vt,Ye,0,0,1,1,0),Se.vertexLength++,we.push(ot.x,ot.y),I&&Xp(this.layoutVertexExtArray,P.projectTilePoint(vt,Ye,d),P.upVector(d,vt,Ye))}}const Ue=Eb(we,Ze);for(let Qe=0;Qe<Ue.length;Qe+=3)this.indexArray.emplaceBack(ce+Ue[Qe],ce+Ue[Qe+2],ce+Ue[Qe+1]),Se.primitiveLength++}for(const we of le){D&&we.length&&D.startRing(we[0]);let Ze,Ue,Qe,mt=we.length>4&&nC(we[we.length-2],we[0],we[1]),Xe=te?Y$(we[we.length-2],we[0],we[1],te):0;Ue=we[1].sub(we[0])._perp()._unit();let it=!0;for(let ot=1,ht=0;ot<we.length;ot++){let vt=we[ot-1],Ye=we[ot];const Et=we[ot===we.length-1?1:ot+1];if(D&&z&&D.currentPolyCount.top++,rC(Ye,vt,ye)){te&&(Ue=Et.sub(Ye)._perp()._unit(),it=!it);continue}D&&D.append(Ye,vt);const Lt=Ye.sub(vt)._perp(),At=Lt.x/(Math.abs(Lt.x)+Math.abs(Lt.y)),tr=Lt.y>0?1:0,bt=vt.dist(Ye);if(ht+bt>32768&&(ht=0),te){Qe=Et.sub(Ye)._perp()._unit();let nr=tC(vt,Ye,Et,eC(Ue,Qe),te);isNaN(nr)&&(nr=0);const Gt=Ye.sub(vt)._unit();vt=vt.add(Gt.mult(Xe))._round(),Ye=Ye.add(Gt.mult(-nr))._round(),Xe=nr,Ue=Qe}const Ft=Se.vertexLength,rr=we.length>4&&nC(vt,Ye,Et);let vr=iC(ht,mt,it);if(Hp(this.layoutVertexArray,vt.x,vt.y,At,tr,0,0,vr),Hp(this.layoutVertexArray,vt.x,vt.y,At,tr,0,1,vr),ht+=bt,vr=iC(ht,rr,!it),mt=rr,Hp(this.layoutVertexArray,Ye.x,Ye.y,At,tr,0,0,vr),Hp(this.layoutVertexArray,Ye.x,Ye.y,At,tr,0,1,vr),Se.vertexLength+=4,this.indexArray.emplaceBack(Ft+0,Ft+1,Ft+2),this.indexArray.emplaceBack(Ft+1,Ft+3,Ft+2),Se.primitiveLength+=2,te){const nr=ce+(ot===1?we.length-2:ot-2),Gt=ot===1?ce:nr+1;if(this.indexArray.emplaceBack(Ft+1,nr,Ft+3),this.indexArray.emplaceBack(nr,Gt,Ft+3),Se.primitiveLength+=2,Ze===void 0&&(Ze=Ft),!rC(Et,we[ot],ye)){const Yr=ot===we.length-1?Ze:Se.vertexLength;this.indexArray.emplaceBack(Ft+2,Ft+3,Yr),this.indexArray.emplaceBack(Ft+3,Yr+1,Yr),this.indexArray.emplaceBack(Ft+3,Gt,Yr+1),Se.primitiveLength+=3}it=!it}if(I){const nr=this.layoutVertexExtArray,Gt=P.projectTilePoint(vt.x,vt.y,d),Yr=P.projectTilePoint(Ye.x,Ye.y,d),ar=P.upVector(d,vt.x,vt.y),sr=P.upVector(d,Ye.x,Ye.y);Xp(nr,Gt,ar),Xp(nr,Gt,ar),Xp(nr,Yr,sr),Xp(nr,Yr,sr)}}z&&(ce+=we.length-1)}}if(D&&D.polyCount.length>0){if(D.borders){D.vertexArrayOffset=this.centroidVertexArray.length;const le=D.borders,ye=this.featuresOnBorder.push(D)-1;for(let ce=0;ce<4;ce++)le[ce][0]!==Number.MAX_VALUE&&this.borders[ce].push(ye)}this.encodeCentroid(D.borders?void 0:D.centroid(),D)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,g,v,d)}sortBorders(){for(let n=0;n<4;n++)this.borders[n].sort((s,c)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[c].borders[n][0])}encodeCentroid(n,s,c=!0){let d,g;if(n)if(n.y!==0){const w=s.span()._mult(this.tileToMeter);d=(Math.max(n.x,1)<<3)+Math.min(7,Math.round(w.x/10)),g=(Math.max(n.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else d=Math.ceil(7*(n.x+450)),g=0;else d=0,g=+c;let v=c?this.centroidVertexArray.length:s.vertexArrayOffset;for(const w of s.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let S=0;S<w.top;S++)this.centroidVertexArray.emplace(v++,d,g);for(let S=0;S<2*w.edges;S++)this.centroidVertexArray.emplace(v++,0,g),this.centroidVertexArray.emplace(v++,d,g)}}}function eC(a,n){const s=a.add(n)._unit();return a.x*s.x+a.y*s.y}function Y$(a,n,s,c){const d=n.sub(a)._perp()._unit(),g=s.sub(n)._perp()._unit();return tC(a,n,s,eC(d,g),c)}function tC(a,n,s,c,d){const g=Math.sqrt(1-c*c);return Math.min(a.dist(n)/3,n.dist(s)/3,d*g/c)}function rC(a,n,s){return a.x<s[0].x&&n.x<s[0].x||a.x>s[1].x&&n.x>s[1].x||a.y<s[0].y&&n.y<s[0].y||a.y>s[1].y&&n.y>s[1].y}function nC(a,n,s){if(a.x<0||a.x>=Ut||n.x<0||n.x>=Ut||s.x<0||s.x>=Ut)return!1;const c=s.sub(n),d=c.perp(),g=a.sub(n);return(c.x*g.x+c.y*g.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(g.x*g.x+g.y*g.y))>-.866&&d.x*g.x+d.y*g.y<0}function iC(a,n,s){const c=n?2|a:-3&a;return s?1|c:-2&c}function oC(){const a=Math.PI/32,n=Math.tan(a),s=Vp;return s*Math.sqrt(1+2*n*n)-s}function aC(a,n,s){const c=1<<s.z,d=Eo(s.x/c),g=Eo((s.x+1)/c),v=gi(s.y/c),w=gi((s.y+1)/c);return function(S,P,I,D,z=0,N){const W=[];if(!S.length||!I||!D)return W;const J=(we,Ze)=>{for(const Ue of we)W.push({polygon:Ue,bounds:Ze})},te=Math.ceil(Math.log2(I)),le=Math.ceil(Math.log2(D)),ye=te-le,ce=[];for(let we=0;we<Math.abs(ye);we++)ce.push(ye>0?0:1);for(let we=0;we<Math.min(te,le);we++)ce.push(0),ce.push(1);let me=S;if(me=A_(me,P[0].y-z,P[1].y+z,1),me=A_(me,P[0].x-z,P[1].x+z,0),!me.length)return W;const Se=[];for(ce.length?Se.push({polygons:me,bounds:P,depth:0}):J(me,P);Se.length;){const we=Se.pop(),Ze=we.depth,Ue=ce[Ze],Qe=we.bounds[0],mt=we.bounds[1],Xe=Ue===0?Qe.x:Qe.y,it=Ue===0?mt.x:mt.y,ot=N?N(Ue,Xe,it):.5*(Xe+it),ht=A_(we.polygons,Xe-z,ot+z,Ue),vt=A_(we.polygons,ot-z,it+z,Ue);if(ht.length){const Ye=[Qe,new ge(Ue===0?ot:mt.x,Ue===1?ot:mt.y)];ce.length>Ze+1?Se.push({polygons:ht,bounds:Ye,depth:Ze+1}):J(ht,Ye)}if(vt.length){const Ye=[new ge(Ue===0?ot:Qe.x,Ue===1?ot:Qe.y),mt];ce.length>Ze+1?Se.push({polygons:vt,bounds:Ye,depth:Ze+1}):J(vt,Ye)}}return W}(a,n,Math.ceil((g-d)/11.25),Math.ceil((v-w)/11.25),1,(S,P,I)=>{if(S===0)return .5*(P+I);{const D=gi((s.y+P/Ut)/c);return(os(.5*(gi((s.y+I/Ut)/c)+D))*c-s.y)*Ut}})}It(Kp,"FillExtrusionBucket",{omit:["layers","features"]}),It(QM,"PartMetadata");const J$=new de({"fill-extrusion-edge-radius":new X(Je["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Q$={paint:new de({"fill-extrusion-opacity":new X(Je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ne(Je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new X(Je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new X(Je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ne(Je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ne(Je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ne(Je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new X(Je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new X(Je["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new X(Je["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new X(Je["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:J$};function sC(a,n,s){var c=2*Math.PI*6378137/256/Math.pow(2,s);return[a*c-2*Math.PI*6378137/2,n*c-2*Math.PI*6378137/2]}class P_{constructor(n,s,c){this.z=n,this.x=s,this.y=c,this.key=Yp(0,n,n,s,c)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const c=function(g,v,w){var S=sC(256*g,256*(v=Math.pow(2,w)-v-1),w),P=sC(256*(g+1),256*(v+1),w);return S[0]+","+S[1]+","+P[0]+","+P[1]}(this.x,this.y,this.z),d=function(g,v,w){let S,P="";for(let I=g;I>0;I--)S=1<<I-1,P+=(v&S?1:0)+(w&S?2:0);return P}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class lC{constructor(n,s){this.wrap=n,this.canonical=s,this.key=Yp(n,s.z,s.z,s.x,s.y)}}class Li{constructor(n,s,c,d,g){this.overscaledZ=n,this.wrap=s,this.canonical=new P_(c,+d,+g),this.key=s===0&&n===c?this.canonical.key:Yp(s,n,c,d,g)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new Li(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Li(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return Yp(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-n;return Yp(this.wrap*+s,n,n,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new Li(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,d=2*this.canonical.y;return[new Li(s,this.wrap,s,c,d),new Li(s,this.wrap,s,c+1,d),new Li(s,this.wrap,s,c,d+1),new Li(s,this.wrap,s,c+1,d+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Li(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Li(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new lC(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Yp(a,n,s,c,d){const g=1<<Math.min(s,22);let v=g*(d%g)+c%g;return a&&s<22&&(v+=g*g*((a<0?-2*a-1:2*a)%(1<<2*(22-s)))),16*(32*v+s)+(n-s)}It(P_,"CanonicalTileID"),It(Li,"OverscaledTileID",{omit:["projMatrix"]});class Lh extends ge{constructor(n,s,c){super(n,s),this.z=c}}function Jp(a,n){return a.x*n.x+a.y*n.y}function uC(a,n){if(a.length===1){let s=0;const c=n[s++];let d;for(;!d||c.equals(d);)if(d=n[s++],!d)return 1/0;for(;s<n.length;s++){const g=n[s],v=a[0],w=d.sub(c),S=g.sub(c),P=v.sub(c),I=Jp(w,w),D=Jp(w,S),z=Jp(S,S),N=Jp(P,w),W=Jp(P,S),J=I*z-D*D,te=(z*N-D*W)/J,le=(I*W-D*N)/J,ye=c.z*(1-te-le)+d.z*te+g.z*le;if(isFinite(ye))return ye}return 1/0}{let s=1/0;for(const c of n)s=Math.min(s,c.z);return s}}function cC(a,n,s,c,d,g,v,w){const S=v*d.getElevationAt(a,n,!0,!0),P=g[0]!==0,I=P?g[1]===0?v*(g[0]/7-450):v*function(D,z,N){const W=Math.floor(z[0]/8),J=Math.floor(z[1]/8),te=10*(z[0]-8*W),le=10*(z[1]-8*J),ye=D.getElevationAt(W,J,!0,!0),ce=D.getMeterToDEM(N),me=Math.floor(.5*(te*ce-1)),Se=Math.floor(.5*(le*ce-1)),we=D.tileCoordToPixel(W,J),Ze=2*me+1,Ue=2*Se+1,Qe=function(vt,Ye,Et,Lt,At){return[vt.getElevationAtPixel(Ye,Et,!0),vt.getElevationAtPixel(Ye+At,Et,!0),vt.getElevationAtPixel(Ye,Et+At,!0),vt.getElevationAtPixel(Ye+Lt,Et+At,!0)]}(D,we.x-me,we.y-Se,Ze,Ue),mt=Math.abs(Qe[0]-Qe[1]),Xe=Math.abs(Qe[2]-Qe[3]),it=Math.abs(Qe[0]-Qe[2])+Math.abs(Qe[1]-Qe[3]),ot=Math.min(.25,.5*ce*(mt+Xe)/Ze),ht=Math.min(.25,.5*ce*it/Ue);return ye+Math.max(ot*te,ht*le)}(d,g,w):S;return{base:S+(s===0)?-1:s,top:P?Math.max(I+c,S+s+2):S+c}}const eN=ze([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:tN}=eN,rN=ze([{name:"a_packed",components:4,type:"Float32"}]),{members:nN}=rN,iN=E_.types,oN=Math.cos(Math.PI/180*37.5);class M_{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new He,this.layoutVertexArray2=new dt,this.indexArray=new Bt,this.programConfigurations=new Ju(n.layers,n.zoom),this.segments=new In,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,c,d){this.hasPattern=Pb("line",this.layers,s);const g=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:I,id:D,index:z,sourceLayerIndex:N}of n){const W=this.layers[0]._featureFilter.needGeometry,J=ic(I,W);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),J,c))continue;const te=g?g.evaluate(J,{},c):void 0,le={id:D,properties:I.properties,type:I.type,sourceLayerIndex:N,index:z,geometry:W?J.geometry:js(I,c,d),patterns:{},sortKey:te};v.push(le)}g&&v.sort((I,D)=>I.sortKey-D.sortKey);const{lineAtlas:w,featureIndex:S}=s,P=this.addConstantDashes(w);for(const I of v){const{geometry:D,index:z,sourceLayerIndex:N}=I;if(P&&this.addFeatureDashes(I,w),this.hasPattern){const W=Mb("line",this.layers,I,this.zoom,s);this.patternFeatures.push(W)}else this.addFeature(I,D,z,c,w.positions,s.availableImages);S.insert(n[z].feature,D,z,N,this.index)}}addConstantDashes(n){let s=!1;for(const c of this.layers){const d=c.paint.get("line-dasharray").value,g=c.layout.get("line-cap").value;if(d.kind!=="constant"||g.kind!=="constant")s=!0;else{const v=g.value,w=d.value;if(!w)continue;n.addDash(w,v)}}return s}addFeatureDashes(n,s){const c=this.zoom;for(const d of this.layers){const g=d.paint.get("line-dasharray").value,v=d.layout.get("line-cap").value;if(g.kind==="constant"&&v.kind==="constant")continue;let w,S;if(g.kind==="constant"){if(w=g.value,!w)continue}else w=g.evaluate({zoom:c},n);S=v.kind==="constant"?v.value:v.evaluate({zoom:c},n),s.addDash(w,S),n.patterns[d.id]=s.getKey(w,S)}}update(n,s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,d)}addFeatures(n,s,c,d,g){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,s,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,nN)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,tN),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,c,d,g,v){const w=this.layers[0].layout,S=w.get("line-join").evaluate(n,{}),P=w.get("line-cap").evaluate(n,{}),I=w.get("line-miter-limit"),D=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const z of s)this.addLine(z,n,S,P,I,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,g,v,d)}addLine(n,s,c,d,g,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<n.length-1;le++)this.totalDistance+=n[le].dist(n[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=iN[s.type]==="Polygon";let S=n.length;for(;S>=2&&n[S-1].equals(n[S-2]);)S--;let P=0;for(;P<S-1&&n[P].equals(n[P+1]);)P++;if(S<(w?3:2))return;c==="bevel"&&(g=1.05);const I=this.overscaling<=16?15*Ut/(512*this.overscaling):0,D=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let z,N,W,J,te;this.e1=this.e2=-1,w&&(z=n[S-2],te=n[P].sub(z)._unit()._perp());for(let le=P;le<S;le++){if(W=le===S-1?w?n[P+1]:void 0:n[le+1],W&&n[le].equals(W))continue;te&&(J=te),z&&(N=z),z=n[le],te=W?W.sub(z)._unit()._perp():J,J=J||te;let ye=J.add(te);ye.x===0&&ye.y===0||ye._unit();const ce=J.x*te.x+J.y*te.y,me=ye.x*te.x+ye.y*te.y,Se=me!==0?1/me:1/0,we=2*Math.sqrt(2-2*me),Ze=me<oN&&N&&W,Ue=J.x*te.y-J.y*te.x>0;if(Ze&&le>P){const Xe=z.dist(N);if(Xe>2*I){const it=z.sub(z.sub(N)._mult(I/Xe)._round());this.updateDistance(N,it),this.addCurrentVertex(it,J,0,0,D),N=it}}const Qe=N&&W;let mt=Qe?c:w?"butt":d;if(Qe&&mt==="round"&&(Se<v?mt="miter":Se<=2&&(mt="fakeround")),mt==="miter"&&Se>g&&(mt="bevel"),mt==="bevel"&&(Se>2&&(mt="flipbevel"),Se<g&&(mt="miter")),N&&this.updateDistance(N,z),mt==="miter")ye._mult(Se),this.addCurrentVertex(z,ye,0,0,D);else if(mt==="flipbevel"){if(Se>100)ye=te.mult(-1);else{const Xe=Se*J.add(te).mag()/J.sub(te).mag();ye._perp()._mult(Xe*(Ue?-1:1))}this.addCurrentVertex(z,ye,0,0,D),this.addCurrentVertex(z,ye.mult(-1),0,0,D)}else if(mt==="bevel"||mt==="fakeround"){const Xe=-Math.sqrt(Se*Se-1),it=Ue?Xe:0,ot=Ue?0:Xe;if(N&&this.addCurrentVertex(z,J,it,ot,D),mt==="fakeround"){const ht=Math.round(180*we/Math.PI/20);for(let vt=1;vt<ht;vt++){let Ye=vt/ht;if(Ye!==.5){const Lt=Ye-.5;Ye+=Ye*Lt*(Ye-1)*((1.0904+ce*(ce*(3.55645-1.43519*ce)-3.2452))*Lt*Lt+(.848013+ce*(.215638*ce-1.06021)))}const Et=te.sub(J)._mult(Ye)._add(J)._unit()._mult(Ue?-1:1);this.addHalfVertex(z,Et.x,Et.y,!1,Ue,0,D)}}W&&this.addCurrentVertex(z,te,-it,-ot,D)}else if(mt==="butt")this.addCurrentVertex(z,ye,0,0,D);else if(mt==="square"){const Xe=N?1:-1;N||this.addCurrentVertex(z,ye,Xe,Xe,D),this.addCurrentVertex(z,ye,0,0,D),N&&this.addCurrentVertex(z,ye,Xe,Xe,D)}else mt==="round"&&(N&&(this.addCurrentVertex(z,J,0,0,D),this.addCurrentVertex(z,J,1,1,D,!0)),W&&(this.addCurrentVertex(z,te,-1,-1,D,!0),this.addCurrentVertex(z,te,0,0,D)));if(Ze&&le<S-1){const Xe=z.dist(W);if(Xe>2*I){const it=z.add(W.sub(z)._mult(I/Xe)._round());this.updateDistance(z,it),this.addCurrentVertex(it,te,0,0,D),z=it}}}}addCurrentVertex(n,s,c,d,g,v=!1){const w=s.y*d-s.x,S=-s.y-s.x*d;this.addHalfVertex(n,s.x+s.y*c,s.y-s.x*c,v,!1,c,g),this.addHalfVertex(n,w,S,v,!0,-d,g)}addHalfVertex({x:n,y:s},c,d,g,v,w,S){this.layoutVertexArray.emplaceBack((n<<1)+(g?1:0),(s<<1)+(v?1:0),Math.round(63*c)+128,Math.round(63*d)+128,1+(w===0?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const P=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),S.primitiveLength++),v?this.e2=P:this.e1=P}updateScaledDistance(){if(this.lineClips){const n=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=n*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(n,s){this.distance+=n.dist(s),this.updateScaledDistance()}}It(M_,"LineBucket",{omit:["layers","patternFeatures"]});const aN=new de({"line-cap":new ne(Je.layout_line["line-cap"]),"line-join":new ne(Je.layout_line["line-join"]),"line-miter-limit":new X(Je.layout_line["line-miter-limit"]),"line-round-limit":new X(Je.layout_line["line-round-limit"]),"line-sort-key":new ne(Je.layout_line["line-sort-key"])});var hC={paint:new de({"line-opacity":new ne(Je.paint_line["line-opacity"]),"line-color":new ne(Je.paint_line["line-color"]),"line-translate":new X(Je.paint_line["line-translate"]),"line-translate-anchor":new X(Je.paint_line["line-translate-anchor"]),"line-width":new ne(Je.paint_line["line-width"]),"line-gap-width":new ne(Je.paint_line["line-gap-width"]),"line-offset":new ne(Je.paint_line["line-offset"]),"line-blur":new ne(Je.paint_line["line-blur"]),"line-dasharray":new ne(Je.paint_line["line-dasharray"]),"line-pattern":new ne(Je.paint_line["line-pattern"]),"line-gradient":new fe(Je.paint_line["line-gradient"]),"line-trim-offset":new X(Je.paint_line["line-trim-offset"])}),layout:aN};const fC=new class extends ne{possiblyEvaluate(a,n){return n=new k(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,transition:n.transition}),super.possiblyEvaluate(a,n)}evaluate(a,n,s,c){return n=St({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(a,n,s,c)}}(hC.paint.properties["line-width"].specification);function dC(a,n){return n>0?n+2*a:a}fC.useIntegerZoom=!0;const sN=ze([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),lN=ze([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),uN=ze([{name:"a_projected_pos",components:4,type:"Float32"}],4);ze([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const cN=ze([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),hN=ze([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ze([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const pC=ze([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),fN=ze([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ze([{name:"triangle",components:3,type:"Uint16"}]),ze([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ze([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ze([{type:"Float32",name:"offsetX"}]),ze([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ii=24;const Ia=128;function Ob(a,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new k(a+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:d}=s;let g=0;for(;g<c.length&&c[g]<=a;)g++;g=Math.max(0,g-1);let v=g;for(;v<c.length&&c[v]<a+1;)v++;v=Math.min(c.length-1,v);const w=c[g],S=c[v];return s.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:S,interpolationType:d}:{kind:"camera",minZoom:w,maxZoom:S,minSize:s.evaluate(new k(w)),maxSize:s.evaluate(new k(S)),interpolationType:d}}}function C_(a,{uSize:n,uSizeT:s},{lowerSize:c,upperSize:d}){return a.kind==="source"?c/Ia:a.kind==="composite"?gr(c/Ia,d/Ia,s):n}function zh(a,n){let s=0,c=0;if(a.kind==="constant")c=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:d,minZoom:g,maxZoom:v}=a,w=d?Oe(Uo.interpolationFactor(d,n,g,v),0,1):0;a.kind==="camera"?c=gr(a.minSize,a.maxSize,w):s=w}return{uSizeT:s,uSize:c}}var dN=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ia,evaluateSizeForFeature:C_,evaluateSizeForZoom:zh,getSizeData:Ob});function pN(a,n,s){return a.sections.forEach(c=>{c.text=function(d,g,v){const w=g.layout.get("text-transform").evaluate(v,{});return w==="uppercase"?d=d.toLocaleUpperCase():w==="lowercase"&&(d=d.toLocaleLowerCase()),C.applyArabicShaping&&(d=C.applyArabicShaping(d)),d}(c.text,n,s)}),a}const Qp={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function mN(a){return a==="︶"||a==="﹈"||a==="︸"||a==="﹄"||a==="﹂"||a==="︾"||a==="︼"||a==="︺"||a==="︘"||a==="﹀"||a==="︐"||a==="︓"||a==="︔"||a==="｀"||a==="￣"||a==="︑"||a==="︒"}function gN(a){return a==="︵"||a==="﹇"||a==="︷"||a==="﹃"||a==="﹁"||a==="︽"||a==="︻"||a==="︹"||a==="︗"||a==="︿"}var mC=Gr,gC=function(a,n,s,c,d){var g,v,w=8*d-c-1,S=(1<<w)-1,P=S>>1,I=-7,D=d-1,z=-1,N=a[n+D];for(D+=z,g=N&(1<<-I)-1,N>>=-I,I+=w;I>0;g=256*g+a[n+D],D+=z,I-=8);for(v=g&(1<<-I)-1,g>>=-I,I+=c;I>0;v=256*v+a[n+D],D+=z,I-=8);if(g===0)g=1-P;else{if(g===S)return v?NaN:1/0*(N?-1:1);v+=Math.pow(2,c),g-=P}return(N?-1:1)*v*Math.pow(2,g-c)},yC=function(a,n,s,c,d,g){var v,w,S,P=8*g-d-1,I=(1<<P)-1,D=I>>1,z=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=0,W=1,J=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(w=isNaN(n)?1:0,v=I):(v=Math.floor(Math.log(n)/Math.LN2),n*(S=Math.pow(2,-v))<1&&(v--,S*=2),(n+=v+D>=1?z/S:z*Math.pow(2,1-D))*S>=2&&(v++,S/=2),v+D>=I?(w=0,v=I):v+D>=1?(w=(n*S-1)*Math.pow(2,d),v+=D):(w=n*Math.pow(2,D-1)*Math.pow(2,d),v=0));d>=8;a[s+N]=255&w,N+=W,w/=256,d-=8);for(v=v<<d|w,P+=d;P>0;a[s+N]=255&v,N+=W,v/=256,P-=8);a[s+N-W]|=128*J};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Gr(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Gr.Varint=0,Gr.Fixed64=1,Gr.Bytes=2,Gr.Fixed32=5;var Ib=4294967296,_C=1/Ib,vC=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function $s(a){return a.type===Gr.Bytes?a.readVarint()+a.pos:a.pos+1}function Rh(a,n,s){return s?4294967296*n+(a>>>0):4294967296*(n>>>0)+(a>>>0)}function xC(a,n,s){var c=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));s.realloc(c);for(var d=s.pos-1;d>=a;d--)s.buf[d+c]=s.buf[d]}function yN(a,n){for(var s=0;s<a.length;s++)n.writeVarint(a[s])}function _N(a,n){for(var s=0;s<a.length;s++)n.writeSVarint(a[s])}function vN(a,n){for(var s=0;s<a.length;s++)n.writeFloat(a[s])}function xN(a,n){for(var s=0;s<a.length;s++)n.writeDouble(a[s])}function bN(a,n){for(var s=0;s<a.length;s++)n.writeBoolean(a[s])}function wN(a,n){for(var s=0;s<a.length;s++)n.writeFixed32(a[s])}function TN(a,n){for(var s=0;s<a.length;s++)n.writeSFixed32(a[s])}function SN(a,n){for(var s=0;s<a.length;s++)n.writeFixed64(a[s])}function EN(a,n){for(var s=0;s<a.length;s++)n.writeSFixed64(a[s])}function O_(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+16777216*a[n+3]}function Bh(a,n,s){a[s]=n,a[s+1]=n>>>8,a[s+2]=n>>>16,a[s+3]=n>>>24}function bC(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+(a[n+3]<<24)}Gr.prototype={destroy:function(){this.buf=null},readFields:function(a,n,s){for(s=s||this.length;this.pos<s;){var c=this.readVarint(),d=c>>3,g=this.pos;this.type=7&c,a(d,n,this),this.pos===g&&this.skip(c)}return n},readMessage:function(a,n){return this.readFields(a,n,this.readVarint()+this.pos)},readFixed32:function(){var a=O_(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=bC(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=O_(this.buf,this.pos)+O_(this.buf,this.pos+4)*Ib;return this.pos+=8,a},readSFixed64:function(){var a=O_(this.buf,this.pos)+bC(this.buf,this.pos+4)*Ib;return this.pos+=8,a},readFloat:function(){var a=gC(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=gC(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var n,s,c=this.buf;return n=127&(s=c[this.pos++]),s<128?n:(n|=(127&(s=c[this.pos++]))<<7,s<128?n:(n|=(127&(s=c[this.pos++]))<<14,s<128?n:(n|=(127&(s=c[this.pos++]))<<21,s<128?n:function(d,g,v){var w,S,P=v.buf;if(w=(112&(S=P[v.pos++]))>>4,S<128||(w|=(127&(S=P[v.pos++]))<<3,S<128)||(w|=(127&(S=P[v.pos++]))<<10,S<128)||(w|=(127&(S=P[v.pos++]))<<17,S<128)||(w|=(127&(S=P[v.pos++]))<<24,S<128)||(w|=(1&(S=P[v.pos++]))<<31,S<128))return Rh(d,w,g);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(s=c[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,n=this.pos;return this.pos=a,a-n>=12&&vC?function(s,c,d){return vC.decode(s.subarray(c,d))}(this.buf,n,a):function(s,c,d){for(var g="",v=c;v<d;){var w,S,P,I=s[v],D=null,z=I>239?4:I>223?3:I>191?2:1;if(v+z>d)break;z===1?I<128&&(D=I):z===2?(192&(w=s[v+1]))==128&&(D=(31&I)<<6|63&w)<=127&&(D=null):z===3?(S=s[v+2],(192&(w=s[v+1]))==128&&(192&S)==128&&((D=(15&I)<<12|(63&w)<<6|63&S)<=2047||D>=55296&&D<=57343)&&(D=null)):z===4&&(S=s[v+2],P=s[v+3],(192&(w=s[v+1]))==128&&(192&S)==128&&(192&P)==128&&((D=(15&I)<<18|(63&w)<<12|(63&S)<<6|63&P)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,z=1):D>65535&&(D-=65536,g+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),g+=String.fromCharCode(D),v+=z}return g}(this.buf,n,a)},readBytes:function(){var a=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,a);return this.pos=a,n},readPackedVarint:function(a,n){if(this.type!==Gr.Bytes)return a.push(this.readVarint(n));var s=$s(this);for(a=a||[];this.pos<s;)a.push(this.readVarint(n));return a},readPackedSVarint:function(a){if(this.type!==Gr.Bytes)return a.push(this.readSVarint());var n=$s(this);for(a=a||[];this.pos<n;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Gr.Bytes)return a.push(this.readBoolean());var n=$s(this);for(a=a||[];this.pos<n;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Gr.Bytes)return a.push(this.readFloat());var n=$s(this);for(a=a||[];this.pos<n;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Gr.Bytes)return a.push(this.readDouble());var n=$s(this);for(a=a||[];this.pos<n;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Gr.Bytes)return a.push(this.readFixed32());var n=$s(this);for(a=a||[];this.pos<n;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Gr.Bytes)return a.push(this.readSFixed32());var n=$s(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Gr.Bytes)return a.push(this.readFixed64());var n=$s(this);for(a=a||[];this.pos<n;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Gr.Bytes)return a.push(this.readSFixed64());var n=$s(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed64());return a},skip:function(a){var n=7&a;if(n===Gr.Varint)for(;this.buf[this.pos++]>127;);else if(n===Gr.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Gr.Fixed32)this.pos+=4;else{if(n!==Gr.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(a,n){this.writeVarint(a<<3|n)},realloc:function(a){for(var n=this.length||16;n<this.pos+a;)n*=2;if(n!==this.length){var s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Bh(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Bh(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Bh(this.buf,-1&a,this.pos),Bh(this.buf,Math.floor(a*_C),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Bh(this.buf,-1&a,this.pos),Bh(this.buf,Math.floor(a*_C),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(n,s){var c,d;if(n>=0?(c=n%4294967296|0,d=n/4294967296|0):(d=~(-n/4294967296),4294967295^(c=~(-n%4294967296))?c=c+1|0:(c=0,d=d+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(g,v,w){w.buf[w.pos++]=127&g|128,g>>>=7,w.buf[w.pos++]=127&g|128,g>>>=7,w.buf[w.pos++]=127&g|128,g>>>=7,w.buf[w.pos++]=127&g|128,w.buf[w.pos]=127&(g>>>=7)}(c,0,s),function(g,v){var w=(7&g)<<4;v.buf[v.pos++]|=w|((g>>>=3)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g)))))}(d,s)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var n=this.pos;this.pos=function(c,d,g){for(var v,w,S=0;S<d.length;S++){if((v=d.charCodeAt(S))>55295&&v<57344){if(!w){v>56319||S+1===d.length?(c[g++]=239,c[g++]=191,c[g++]=189):w=v;continue}if(v<56320){c[g++]=239,c[g++]=191,c[g++]=189,w=v;continue}v=w-55296<<10|v-56320|65536,w=null}else w&&(c[g++]=239,c[g++]=191,c[g++]=189,w=null);v<128?c[g++]=v:(v<2048?c[g++]=v>>6|192:(v<65536?c[g++]=v>>12|224:(c[g++]=v>>18|240,c[g++]=v>>12&63|128),c[g++]=v>>6&63|128),c[g++]=63&v|128)}return g}(this.buf,a,this.pos);var s=this.pos-n;s>=128&&xC(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeFloat:function(a){this.realloc(4),yC(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),yC(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var n=a.length;this.writeVarint(n),this.realloc(n);for(var s=0;s<n;s++)this.buf[this.pos++]=a[s]},writeRawMessage:function(a,n){this.pos++;var s=this.pos;a(n,this);var c=this.pos-s;c>=128&&xC(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeMessage:function(a,n,s){this.writeTag(a,Gr.Bytes),this.writeRawMessage(n,s)},writePackedVarint:function(a,n){n.length&&this.writeMessage(a,yN,n)},writePackedSVarint:function(a,n){n.length&&this.writeMessage(a,_N,n)},writePackedBoolean:function(a,n){n.length&&this.writeMessage(a,bN,n)},writePackedFloat:function(a,n){n.length&&this.writeMessage(a,vN,n)},writePackedDouble:function(a,n){n.length&&this.writeMessage(a,xN,n)},writePackedFixed32:function(a,n){n.length&&this.writeMessage(a,wN,n)},writePackedSFixed32:function(a,n){n.length&&this.writeMessage(a,TN,n)},writePackedFixed64:function(a,n){n.length&&this.writeMessage(a,SN,n)},writePackedSFixed64:function(a,n){n.length&&this.writeMessage(a,EN,n)},writeBytesField:function(a,n){this.writeTag(a,Gr.Bytes),this.writeBytes(n)},writeFixed32Field:function(a,n){this.writeTag(a,Gr.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(a,n){this.writeTag(a,Gr.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(a,n){this.writeTag(a,Gr.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(a,n){this.writeTag(a,Gr.Fixed64),this.writeSFixed64(n)},writeVarintField:function(a,n){this.writeTag(a,Gr.Varint),this.writeVarint(n)},writeSVarintField:function(a,n){this.writeTag(a,Gr.Varint),this.writeSVarint(n)},writeStringField:function(a,n){this.writeTag(a,Gr.Bytes),this.writeString(n)},writeFloatField:function(a,n){this.writeTag(a,Gr.Fixed32),this.writeFloat(n)},writeDoubleField:function(a,n){this.writeTag(a,Gr.Fixed64),this.writeDouble(n)},writeBooleanField:function(a,n){this.writeVarintField(a,!!n)}};var I_=G(mC);const kb=3;function AN(a,n,s){n.glyphs=[],a===1&&s.readMessage(PN,n)}function PN(a,n,s){if(a===3){const{id:c,bitmap:d,width:g,height:v,left:w,top:S,advance:P}=s.readMessage(MN,{});n.glyphs.push({id:c,bitmap:new Fs({width:g+2*kb,height:v+2*kb},d),metrics:{width:g,height:v,left:w,top:S,advance:P}})}else a===4?n.ascender=s.readSVarint():a===5&&(n.descender=s.readSVarint())}function MN(a,n,s){a===1?n.id=s.readVarint():a===2?n.bitmap=s.readBytes():a===3?n.width=s.readVarint():a===4?n.height=s.readVarint():a===5?n.left=s.readSVarint():a===6?n.top=s.readSVarint():a===7&&(n.advance=s.readVarint())}const wC=kb;function Db(a){let n=0,s=0;for(const v of a)n+=v.w*v.h,s=Math.max(s,v.w);a.sort((v,w)=>w.h-v.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let d=0,g=0;for(const v of a)for(let w=c.length-1;w>=0;w--){const S=c[w];if(!(v.w>S.w||v.h>S.h)){if(v.x=S.x,v.y=S.y,g=Math.max(g,v.y+v.h),d=Math.max(d,v.x+v.w),v.w===S.w&&v.h===S.h){const P=c.pop();w<c.length&&(c[w]=P)}else v.h===S.h?(S.x+=v.w,S.w-=v.w):v.w===S.w?(S.y+=v.h,S.h-=v.h):(c.push({x:S.x+v.w,y:S.y,w:S.w-v.w,h:v.h}),S.y+=v.h,S.h-=v.h);break}}return{w:d,h:g,fill:n/(d*g)||0}}const Hi=1;class Lb{constructor(n,{pixelRatio:s,version:c,stretchX:d,stretchY:g,content:v}){this.paddedRect=n,this.pixelRatio=s,this.stretchX=d,this.stretchY=g,this.content=v,this.version=c}get tl(){return[this.paddedRect.x+Hi,this.paddedRect.y+Hi]}get br(){return[this.paddedRect.x+this.paddedRect.w-Hi,this.paddedRect.y+this.paddedRect.h-Hi]}get displaySize(){return[(this.paddedRect.w-2*Hi)/this.pixelRatio,(this.paddedRect.h-2*Hi)/this.pixelRatio]}}class TC{constructor(n,s){const c={},d={};this.haveRenderCallbacks=[];const g=[];this.addImages(n,c,g),this.addImages(s,d,g);const{w:v,h:w}=Db(g),S=new co({width:v||1,height:w||1});for(const P in n){const I=n[P],D=c[P].paddedRect;co.copy(I.data,S,{x:0,y:0},{x:D.x+Hi,y:D.y+Hi},I.data)}for(const P in s){const I=s[P],D=d[P].paddedRect,z=D.x+Hi,N=D.y+Hi,W=I.data.width,J=I.data.height;co.copy(I.data,S,{x:0,y:0},{x:z,y:N},I.data),co.copy(I.data,S,{x:0,y:J-1},{x:z,y:N-1},{width:W,height:1}),co.copy(I.data,S,{x:0,y:0},{x:z,y:N+J},{width:W,height:1}),co.copy(I.data,S,{x:W-1,y:0},{x:z-1,y:N},{width:1,height:J}),co.copy(I.data,S,{x:0,y:0},{x:z+W,y:N},{width:1,height:J})}this.image=S,this.iconPositions=c,this.patternPositions=d}addImages(n,s,c){for(const d in n){const g=n[d],v={x:0,y:0,w:g.data.width+2*Hi,h:g.data.height+2*Hi};c.push(v),s[d]=new Lb(v,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(n,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>n.hasImage(c)),n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in n.updatedImages)this.patchUpdatedImage(this.iconPositions[c],n.getImage(c),s),this.patchUpdatedImage(this.patternPositions[c],n.getImage(c),s)}patchUpdatedImage(n,s,c){if(!n||!s||n.version===s.version)return;n.version=s.version;const[d,g]=n.tl;c.update(s.data,void 0,{x:d,y:g})}}It(Lb,"ImagePosition"),It(TC,"ImageAtlas");const Ao={horizontal:1,vertical:2,horizontalOnly:3},SC=-17;class em{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const c=new em;return c.scale=n||1,c.fontStack=s,c}static forImage(n){const s=new em;return s.imageName=n,s}}class jh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const c=new jh;for(let d=0;d<n.sections.length;d++){const g=n.sections[d];g.image?c.addImageSection(g):c.addTextSection(g,s)}return c}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(n){this.text=function(s,c){let d="";for(let g=0;g<s.length;g++){const v=s.charCodeAt(g+1)||null,w=s.charCodeAt(g-1)||null;d+=!c&&(v&&a_(v)&&!Qp[s[g+1]]||w&&a_(w)&&!Qp[s[g-1]])||!Qp[s[g]]?s[g]:Qp[s[g]]}return d}(this.text,n)}trim(){let n=0;for(let c=0;c<this.text.length&&k_[this.text.charCodeAt(c)];c++)n++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=n&&k_[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const c=new jh;return c.text=this.text.substring(n,s),c.sectionIndex=this.sectionIndex.slice(n,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(em.forText(n.scale,n.fontStack||s));const c=this.sections.length-1;for(let d=0;d<n.text.length;++d)this.sectionIndex.push(c)}addImageSection(n){const s=n.image?n.image.name:"";if(s.length===0)return void ir("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(em.forImage(s)),this.sectionIndex.push(this.sections.length-1)):ir("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function zb(a,n,s,c,d,g,v,w,S,P,I,D,z,N,W){const J=jh.fromFeature(a,d);D===Ao.vertical&&J.verticalizePunctuation(z);let te=[];const le=function(we,Ze,Ue,Qe,mt,Xe){if(!we)return[];const it=[],ot=function(Et,Lt,At,tr,bt,Ft){let rr=0;for(let vr=0;vr<Et.length();vr++){const nr=Et.getSection(vr);rr+=EC(Et.getCharCode(vr),nr,tr,bt,Lt,Ft)}return rr/Math.max(1,Math.ceil(rr/At))}(we,Ze,Ue,Qe,mt,Xe),ht=we.text.indexOf("​")>=0;let vt=0;for(let Et=0;Et<we.length();Et++){const Lt=we.getSection(Et),At=we.getCharCode(Et);if(k_[At]||(vt+=EC(At,Lt,Qe,mt,Ze,Xe)),Et<we.length()-1){const tr=!((Ye=At)<11904||!(Pt["Bopomofo Extended"](Ye)||Pt.Bopomofo(Ye)||Pt["CJK Compatibility Forms"](Ye)||Pt["CJK Compatibility Ideographs"](Ye)||Pt["CJK Compatibility"](Ye)||Pt["CJK Radicals Supplement"](Ye)||Pt["CJK Strokes"](Ye)||Pt["CJK Symbols and Punctuation"](Ye)||Pt["CJK Unified Ideographs Extension A"](Ye)||Pt["CJK Unified Ideographs"](Ye)||Pt["Enclosed CJK Letters and Months"](Ye)||Pt["Halfwidth and Fullwidth Forms"](Ye)||Pt.Hiragana(Ye)||Pt["Ideographic Description Characters"](Ye)||Pt["Kangxi Radicals"](Ye)||Pt["Katakana Phonetic Extensions"](Ye)||Pt.Katakana(Ye)||Pt["Vertical Forms"](Ye)||Pt["Yi Radicals"](Ye)||Pt["Yi Syllables"](Ye)));(CN[At]||tr||Lt.imageName)&&it.push(PC(Et+1,vt,ot,it,ON(At,we.getCharCode(Et+1),tr&&ht),!1))}}var Ye;return MC(PC(we.length(),vt,ot,it,0,!0))}(J,P,g,n,c,N),{processBidirectionalText:ye,processStyledBidirectionalText:ce}=C;if(ye&&J.sections.length===1){const we=ye(J.toString(),le);for(const Ze of we){const Ue=new jh;Ue.text=Ze,Ue.sections=J.sections;for(let Qe=0;Qe<Ze.length;Qe++)Ue.sectionIndex.push(0);te.push(Ue)}}else if(ce){const we=ce(J.text,J.sectionIndex,le);for(const Ze of we){const Ue=new jh;Ue.text=Ze[0],Ue.sectionIndex=Ze[1],Ue.sections=J.sections,te.push(Ue)}}else te=function(we,Ze){const Ue=[],Qe=we.text;let mt=0;for(const Xe of Ze)Ue.push(we.substring(mt,Xe)),mt=Xe;return mt<Qe.length&&Ue.push(we.substring(mt,Qe.length)),Ue}(J,le);const me=[],Se={positionedLines:me,text:J.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:D,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(we,Ze,Ue,Qe,mt,Xe,it,ot,ht,vt,Ye,Et){let Lt=0,At=0,tr=0;const bt=ot==="right"?1:ot==="left"?0:.5;let Ft=!1;for(const ar of mt){const sr=ar.getSections();for(const $r of sr){if($r.imageName)continue;const Wr=Ze[$r.fontStack];if(Wr&&(Ft=Wr.ascender!==void 0&&Wr.descender!==void 0,!Ft))break}if(!Ft)break}let rr=0;for(const ar of mt){ar.trim();const sr=ar.getMaxScale(),$r=(sr-1)*ii,Wr={positionedGlyphs:[],lineOffset:0};we.positionedLines[rr]=Wr;const qr=Wr.positionedGlyphs;let Nr=0;if(!ar.length()){At+=Xe,++rr;continue}let cn=0,_n=0;for(let Ur=0;Ur<ar.length();Ur++){const Nn=ar.getSection(Ur),Ln=ar.getSectionIndex(Ur),pn=ar.getCharCode(Ur);let wr=Nn.scale,zn=null,Zr=null,zi=null,Rn=ii,oi=0;const Yn=!(ht===Ao.horizontal||!Ye&&!Pp(pn)||Ye&&(k_[pn]||(vr=pn,Pt.Arabic(vr)||Pt["Arabic Supplement"](vr)||Pt["Arabic Extended-A"](vr)||Pt["Arabic Presentation Forms-A"](vr)||Pt["Arabic Presentation Forms-B"](vr))));if(Nn.imageName){const Ri=Qe[Nn.imageName];if(!Ri)continue;zi=Nn.imageName,we.iconsInText=we.iconsInText||!0,Zr=Ri.paddedRect;const Jn=Ri.displaySize;wr=wr*ii/Et,zn={width:Jn[0],height:Jn[1],left:Hi,top:-wC,advance:Yn?Jn[1]:Jn[0],localGlyph:!1},oi=Ft?-zn.height*wr:SC+sr*ii-Jn[1]*wr,Rn=zn.advance;const La=(Yn?Jn[0]:Jn[1])*wr-ii*sr;La>0&&La>Nr&&(Nr=La)}else{const Ri=Ue[Nn.fontStack];if(!Ri)continue;Ri[pn]&&(Zr=Ri[pn]);const Jn=Ze[Nn.fontStack];if(!Jn)continue;const La=Jn.glyphs[pn];if(!La)continue;if(zn=La.metrics,Rn=pn!==8203?ii:0,Ft){const Wh=Jn.ascender!==void 0?Math.abs(Jn.ascender):0,cm=Jn.descender!==void 0?Math.abs(Jn.descender):0,hm=(Wh+cm)*wr;cn<hm&&(cn=hm,_n=(Wh-cm)/2*wr),oi=-Wh*wr}else oi=SC+(sr-wr)*ii}Yn?(we.verticalizable=!0,qr.push({glyph:pn,imageName:zi,x:Lt,y:At+oi,vertical:Yn,scale:wr,localGlyph:zn.localGlyph,fontStack:Nn.fontStack,sectionIndex:Ln,metrics:zn,rect:Zr}),Lt+=Rn*wr+vt):(qr.push({glyph:pn,imageName:zi,x:Lt,y:At+oi,vertical:Yn,scale:wr,localGlyph:zn.localGlyph,fontStack:Nn.fontStack,sectionIndex:Ln,metrics:zn,rect:Zr}),Lt+=zn.advance*wr+vt)}qr.length!==0&&(tr=Math.max(Lt-vt,tr),Ft?CC(qr,bt,Nr,_n,Xe*sr/2):CC(qr,bt,Nr,0,Xe/2)),Lt=0;const Dn=Xe*sr+Nr;Wr.lineOffset=Math.max(Nr,$r),At+=Dn,++rr}var vr;const nr=At,{horizontalAlign:Gt,verticalAlign:Yr}=Rb(it);(function(ar,sr,$r,Wr,qr,Nr){const cn=(sr-$r)*qr,_n=-Nr*Wr;for(const Dn of ar)for(const Ur of Dn.positionedGlyphs)Ur.x+=cn,Ur.y+=_n})(we.positionedLines,bt,Gt,Yr,tr,nr),we.top+=-Yr*nr,we.bottom=we.top+nr,we.left+=-Gt*tr,we.right=we.left+tr,we.hasBaseline=Ft}(Se,n,s,c,te,v,w,S,D,P,z,W),!function(we){for(const Ze of we)if(Ze.positionedGlyphs.length!==0)return!1;return!0}(me)&&Se}const k_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},CN={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function EC(a,n,s,c,d,g){if(n.imageName){const v=c[n.imageName];return v?v.displaySize[0]*n.scale*ii/g+d:0}{const v=s[n.fontStack],w=v&&v.glyphs[a];return w?w.metrics.advance*n.scale+d:0}}function AC(a,n,s,c){const d=Math.pow(a-n,2);return c?a<n?d/2:2*d:d+Math.abs(s)*s}function ON(a,n,s){let c=0;return a===10&&(c-=1e4),s&&(c+=150),a!==40&&a!==65288||(c+=50),n!==41&&n!==65289||(c+=50),c}function PC(a,n,s,c,d,g){let v=null,w=AC(n,s,d,g);for(const S of c){const P=AC(n-S.x,s,d,g)+S.badness;P<=w&&(v=S,w=P)}return{index:a,x:n,priorBreak:v,badness:w}}function MC(a){return a?MC(a.priorBreak).concat(a.index):[]}function Rb(a){let n=.5,s=.5;switch(a){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function CC(a,n,s,c,d){if(!(n||s||c||d))return;const g=a.length-1,v=a[g],w=(v.x+v.metrics.advance*v.scale)*n;for(let S=0;S<=g;S++)a[S].x-=w,a[S].y+=s+c+d}function IN(a,n,s){const{horizontalAlign:c,verticalAlign:d}=Rb(s),g=n[0]-a.displaySize[0]*c,v=n[1]-a.displaySize[1]*d;return{image:a,top:v,bottom:v+a.displaySize[1],left:g,right:g+a.displaySize[0]}}function OC(a,n,s,c,d,g){const v=a.image;let w;if(v.content){const te=v.content,le=v.pixelRatio||1;w=[te[0]/le,te[1]/le,v.displaySize[0]-te[2]/le,v.displaySize[1]-te[3]/le]}const S=n.left*g,P=n.right*g;let I,D,z,N;s==="width"||s==="both"?(N=d[0]+S-c[3],D=d[0]+P+c[1]):(N=d[0]+(S+P-v.displaySize[0])/2,D=N+v.displaySize[0]);const W=n.top*g,J=n.bottom*g;return s==="height"||s==="both"?(I=d[1]+W-c[0],z=d[1]+J+c[2]):(I=d[1]+(W+J-v.displaySize[1])/2,z=I+v.displaySize[1]),{image:v,top:I,right:D,bottom:z,left:N,collisionPadding:w}}class Ns extends ge{constructor(n,s,c,d,g){super(n,s),this.angle=d,this.z=c,g!==void 0&&(this.segment=g)}clone(){return new Ns(this.x,this.y,this.z,this.angle,this.segment)}}function IC(a,n,s,c,d){if(n.segment===void 0)return!0;let g=n,v=n.segment+1,w=0;for(;w>-s/2;){if(v--,v<0)return!1;w-=a[v].dist(g),g=a[v]}w+=a[v].dist(a[v+1]),v++;const S=[];let P=0;for(;w<s/2;){const I=a[v],D=a[v+1];if(!D)return!1;let z=a[v-1].angleTo(I)-I.angleTo(D);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:w,angleDelta:z}),P+=z;w-S[0].distance>c;)P-=S.shift().angleDelta;if(P>d)return!1;v++,w+=I.dist(D)}return!0}function kC(a){let n=0;for(let s=0;s<a.length-1;s++)n+=a[s].dist(a[s+1]);return n}function DC(a,n,s){return a?.6*n*s:0}function LC(a,n){return Math.max(a?a.right-a.left:0,n?n.right-n.left:0)}function kN(a,n,s,c,d,g){const v=DC(s,d,g),w=LC(s,c)*g;let S=0;const P=kC(a)/2;for(let I=0;I<a.length-1;I++){const D=a[I],z=a[I+1],N=D.dist(z);if(S+N>P){const W=(P-S)/N,J=gr(D.x,z.x,W),te=gr(D.y,z.y,W),le=new Ns(J,te,0,z.angleTo(D),I);return!v||IC(a,le,w,v,n)?le:void 0}S+=N}}function DN(a,n,s,c,d,g,v,w,S){const P=DC(c,g,v),I=LC(c,d),D=I*v,z=a[0].x===0||a[0].x===S||a[0].y===0||a[0].y===S;return n-D<n/4&&(n=D+n/4),zC(a,z?n/2*w%n:(I/2+2*g)*v*w%n,n,P,s,D,z,!1,S)}function zC(a,n,s,c,d,g,v,w,S){const P=g/2,I=kC(a);let D=0,z=n-s,N=[];for(let W=0;W<a.length-1;W++){const J=a[W],te=a[W+1],le=J.dist(te),ye=te.angleTo(J);for(;z+s<D+le;){z+=s;const ce=(z-D)/le,me=gr(J.x,te.x,ce),Se=gr(J.y,te.y,ce);if(me>=0&&me<S&&Se>=0&&Se<S&&z-P>=0&&z+P<=I){const we=new Ns(me,Se,0,ye,W);we._round(),c&&!IC(a,we,g,c,d)||N.push(we)}}D+=le}return w||N.length||v||(N=zC(a,D/2,s,c,d,g,v,!0,S)),N}function RC(a,n,s,c,d){const g=[];for(let v=0;v<a.length;v++){const w=a[v];let S;for(let P=0;P<w.length-1;P++){let I=w[P],D=w[P+1];I.x<n&&D.x<n||(I.x<n?I=new ge(n,I.y+(n-I.x)/(D.x-I.x)*(D.y-I.y))._round():D.x<n&&(D=new ge(n,I.y+(n-I.x)/(D.x-I.x)*(D.y-I.y))._round()),I.y<s&&D.y<s||(I.y<s?I=new ge(I.x+(s-I.y)/(D.y-I.y)*(D.x-I.x),s)._round():D.y<s&&(D=new ge(I.x+(s-I.y)/(D.y-I.y)*(D.x-I.x),s)._round()),I.x>=c&&D.x>=c||(I.x>=c?I=new ge(c,I.y+(c-I.x)/(D.x-I.x)*(D.y-I.y))._round():D.x>=c&&(D=new ge(c,I.y+(c-I.x)/(D.x-I.x)*(D.y-I.y))._round()),I.y>=d&&D.y>=d||(I.y>=d?I=new ge(I.x+(d-I.y)/(D.y-I.y)*(D.x-I.x),d)._round():D.y>=d&&(D=new ge(I.x+(d-I.y)/(D.y-I.y)*(D.x-I.x),d)._round()),S&&I.equals(S[S.length-1])||(S=[I],g.push(S)),S.push(D)))))}}return g}It(Ns,"Anchor");const tm=1e20;function BC(a,n,s,c,d,g,v,w,S){for(let P=n;P<n+c;P++)jC(a,s*g+P,g,d,v,w,S);for(let P=s;P<s+d;P++)jC(a,P*g+n,1,c,v,w,S)}function jC(a,n,s,c,d,g,v){g[0]=0,v[0]=-tm,v[1]=tm,d[0]=a[n];for(let w=1,S=0,P=0;w<c;w++){d[w]=a[n+w*s];const I=w*w;do{const D=g[S];P=(d[w]-d[D]+I-D*D)/(w-D)/2}while(P<=v[S]&&--S>-1);S++,g[S]=w,v[S]=P,v[S+1]=tm}for(let w=0,S=0;w<c;w++){for(;v[S+1]<w;)S++;const P=g[S],I=w-P;a[n+w*s]=d[P]+I*I}}const ka=2,Bb={none:0,ideographs:1,all:2};class Fh{constructor(n,s,c){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n){this.url=n}getGlyphs(n,s){const c=[];for(const d in n)for(const g of n[d])c.push({stack:d,id:g});st(c,({stack:d,id:g},v)=>{let w=this.entries[d];w||(w=this.entries[d]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let S=w.glyphs[g];if(S!==void 0)return void v(null,{stack:d,id:g,glyph:S});if(S=this._tinySDF(w,d,g),S)return w.glyphs[g]=S,void v(null,{stack:d,id:g,glyph:S});const P=Math.floor(g/256);if(256*P>65535)return void v(new Error("glyphs > 65535 not supported"));if(w.ranges[P])return void v(null,{stack:d,id:g,glyph:S});let I=w.requests[P];I||(I=w.requests[P]=[],Fh.loadGlyphRange(d,P,this.url,this.requestManager,(D,z)=>{if(z){w.ascender=z.ascender,w.descender=z.descender;for(const N in z.glyphs)this._doesCharSupportLocalGlyph(+N)||(w.glyphs[+N]=z.glyphs[+N]);w.ranges[P]=!0}for(const N of I)N(D,z);delete w.requests[P]})),I.push((D,z)=>{D?v(D):z&&v(null,{stack:d,id:g,glyph:z.glyphs[g]||null})})},(d,g)=>{if(d)s(d);else if(g){const v={};for(const{stack:w,id:S,glyph:P}of g)v[w]===void 0&&(v[w]={}),v[w].glyphs===void 0&&(v[w].glyphs={}),v[w].glyphs[S]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},v[w].ascender=this.entries[w].ascender,v[w].descender=this.entries[w].descender;s(null,v)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==Bb.none&&(this.localGlyphMode===Bb.all?!!this.localFontFamily:!!this.localFontFamily&&(Pt["CJK Unified Ideographs"](n)||Pt["Hangul Syllables"](n)||Pt.Hiragana(n)||Pt.Katakana(n)||Pt["CJK Symbols and Punctuation"](n)))}_tinySDF(n,s,c){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let g=n.tinySDF;if(!g){let J="400";/bold/i.test(s)?J="900":/medium/i.test(s)?J="500":/light/i.test(s)&&(J="200"),g=n.tinySDF=new Fh.TinySDF({fontFamily:d,fontWeight:J,fontSize:24*ka,buffer:3*ka,radius:8*ka}),g.fontWeight=J}if(this.localGlyphs[g.fontWeight][c])return this.localGlyphs[g.fontWeight][c];const v=String.fromCharCode(c),{data:w,width:S,height:P,glyphWidth:I,glyphHeight:D,glyphLeft:z,glyphTop:N,glyphAdvance:W}=g.draw(v);return this.localGlyphs[g.fontWeight][c]={id:c,bitmap:new Fs({width:S,height:P},w),metrics:{width:I/ka,height:D/ka,left:z/ka,top:N/ka-27,advance:W/ka,localGlyph:!0}}}}Fh.loadGlyphRange=function(a,n,s,c,d){const g=256*n,v=g+255,w=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",a).replace("{range}",`${g}-${v}`),Ke.Glyphs);Kt(w,(S,P)=>{if(S)d(S);else if(P){const I={},D=function(z){return new I_(z).readFields(AN,{})}(P);for(const z of D.glyphs)I[z.id]=z;d(null,{glyphs:I,ascender:D.ascender,descender:D.descender})}})},Fh.TinySDF=class{constructor({fontSize:a=24,buffer:n=3,radius:s=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:g="normal",fontStyle:v="normal"}={}){this.buffer=n,this.cutoff=c,this.radius=s;const w=this.size=a+4*n,S=this._createCanvas(w),P=this.ctx=S.getContext("2d",{willReadFrequently:!0});P.font=`${v} ${g} ${a}px ${d}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(a){const n=document.createElement("canvas");return n.width=n.height=a,n}draw(a){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:g}=this.ctx.measureText(a),v=Math.ceil(s),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-d))),S=Math.min(this.size-this.buffer,v+Math.ceil(c)),P=w+2*this.buffer,I=S+2*this.buffer,D=Math.max(P*I,0),z=new Uint8ClampedArray(D),N={data:z,width:P,height:I,glyphWidth:w,glyphHeight:S,glyphTop:v,glyphLeft:0,glyphAdvance:n};if(w===0||S===0)return N;const{ctx:W,buffer:J,gridInner:te,gridOuter:le}=this;W.clearRect(J,J,w,S),W.fillText(a,J,J+v);const ye=W.getImageData(J,J,w,S);le.fill(tm,0,D),te.fill(0,0,D);for(let ce=0;ce<S;ce++)for(let me=0;me<w;me++){const Se=ye.data[4*(ce*w+me)+3]/255;if(Se===0)continue;const we=(ce+J)*P+me+J;if(Se===1)le[we]=0,te[we]=tm;else{const Ze=.5-Se;le[we]=Ze>0?Ze*Ze:0,te[we]=Ze<0?Ze*Ze:0}}BC(le,0,0,P,I,P,this.f,this.v,this.z),BC(te,J,J,w,S,P,this.f,this.v,this.z);for(let ce=0;ce<D;ce++){const me=Math.sqrt(le[ce])-Math.sqrt(te[ce]);z[ce]=Math.round(255-255*(me/this.radius+this.cutoff))}return N}};const $h=Hi;function FC(a,n,s,c){const d=[],g=a.image,v=g.pixelRatio,w=g.paddedRect.w-2*$h,S=g.paddedRect.h-2*$h,P=a.right-a.left,I=a.bottom-a.top,D=g.stretchX||[[0,w]],z=g.stretchY||[[0,S]],N=(Xe,it)=>Xe+it[1]-it[0],W=D.reduce(N,0),J=z.reduce(N,0),te=w-W,le=S-J;let ye=0,ce=W,me=0,Se=J,we=0,Ze=te,Ue=0,Qe=le;if(g.content&&c){const Xe=g.content;ye=D_(D,0,Xe[0]),me=D_(z,0,Xe[1]),ce=D_(D,Xe[0],Xe[2]),Se=D_(z,Xe[1],Xe[3]),we=Xe[0]-ye,Ue=Xe[1]-me,Ze=Xe[2]-Xe[0]-ce,Qe=Xe[3]-Xe[1]-Se}const mt=(Xe,it,ot,ht)=>{const vt=L_(Xe.stretch-ye,ce,P,a.left),Ye=z_(Xe.fixed-we,Ze,Xe.stretch,W),Et=L_(it.stretch-me,Se,I,a.top),Lt=z_(it.fixed-Ue,Qe,it.stretch,J),At=L_(ot.stretch-ye,ce,P,a.left),tr=z_(ot.fixed-we,Ze,ot.stretch,W),bt=L_(ht.stretch-me,Se,I,a.top),Ft=z_(ht.fixed-Ue,Qe,ht.stretch,J),rr=new ge(vt,Et),vr=new ge(At,Et),nr=new ge(At,bt),Gt=new ge(vt,bt),Yr=new ge(Ye/v,Lt/v),ar=new ge(tr/v,Ft/v),sr=n*Math.PI/180;if(sr){const qr=Math.sin(sr),Nr=Math.cos(sr),cn=[Nr,-qr,qr,Nr];rr._matMult(cn),vr._matMult(cn),Gt._matMult(cn),nr._matMult(cn)}const $r=Xe.stretch+Xe.fixed,Wr=it.stretch+it.fixed;return{tl:rr,tr:vr,bl:Gt,br:nr,tex:{x:g.paddedRect.x+$h+$r,y:g.paddedRect.y+$h+Wr,w:ot.stretch+ot.fixed-$r,h:ht.stretch+ht.fixed-Wr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yr,pixelOffsetBR:ar,minFontScaleX:Ze/v/P,minFontScaleY:Qe/v/I,isSDF:s}};if(c&&(g.stretchX||g.stretchY)){const Xe=$C(D,te,W),it=$C(z,le,J);for(let ot=0;ot<Xe.length-1;ot++){const ht=Xe[ot],vt=Xe[ot+1];for(let Ye=0;Ye<it.length-1;Ye++)d.push(mt(ht,it[Ye],vt,it[Ye+1]))}}else d.push(mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:S+1}));return d}function D_(a,n,s){let c=0;for(const d of a)c+=Math.max(n,Math.min(s,d[1]))-Math.max(n,Math.min(s,d[0]));return c}function $C(a,n,s){const c=[{fixed:-$h,stretch:0}];for(const[d,g]of a){const v=c[c.length-1];c.push({fixed:d-v.stretch,stretch:v.stretch}),c.push({fixed:d-v.stretch,stretch:v.stretch+(g-d)})}return c.push({fixed:n+$h,stretch:s}),c}function L_(a,n,s,c){return a/n*s+c}function z_(a,n,s,c){return a-n*s/c}function LN(a,n,s,c){const d=n+a.positionedLines[c].lineOffset;return c===0?s+d/2:s+(d+(n+a.positionedLines[c-1].lineOffset))/2}class zN{constructor(n=[],s=RN){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:c}=this,d=s[n];for(;n>0;){const g=n-1>>1,v=s[g];if(c(d,v)>=0)break;s[n]=v,n=g}s[n]=d}_down(n){const{data:s,compare:c}=this,d=this.length>>1,g=s[n];for(;n<d;){let v=1+(n<<1),w=s[v];const S=v+1;if(S<this.length&&c(s[S],w)<0&&(v=S,w=s[S]),c(w,g)>=0)break;s[n]=w,n=v}s[n]=g}}function RN(a,n){return a<n?-1:a>n?1:0}function BN(a,n=1,s=!1){let c=1/0,d=1/0,g=-1/0,v=-1/0;const w=a[0];for(let N=0;N<w.length;N++){const W=w[N];(!N||W.x<c)&&(c=W.x),(!N||W.y<d)&&(d=W.y),(!N||W.x>g)&&(g=W.x),(!N||W.y>v)&&(v=W.y)}const S=Math.min(g-c,v-d);let P=S/2;const I=new zN([],jN);if(S===0)return new ge(c,d);for(let N=c;N<g;N+=S)for(let W=d;W<v;W+=S)I.push(new Nh(N+P,W+P,P,a));let D=function(N){let W=0,J=0,te=0;const le=N[0];for(let ye=0,ce=le.length,me=ce-1;ye<ce;me=ye++){const Se=le[ye],we=le[me],Ze=Se.x*we.y-we.x*Se.y;J+=(Se.x+we.x)*Ze,te+=(Se.y+we.y)*Ze,W+=3*Ze}return new Nh(J/W,te/W,0,N)}(a),z=I.length;for(;I.length;){const N=I.pop();(N.d>D.d||!D.d)&&(D=N,s&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,z)),N.max-D.d<=n||(P=N.h/2,I.push(new Nh(N.p.x-P,N.p.y-P,P,a)),I.push(new Nh(N.p.x+P,N.p.y-P,P,a)),I.push(new Nh(N.p.x-P,N.p.y+P,P,a)),I.push(new Nh(N.p.x+P,N.p.y+P,P,a)),z+=4)}return s&&(console.log(`num probes: ${z}`),console.log(`best distance: ${D.d}`)),D.p}function jN(a,n){return n.max-a.max}class Nh{constructor(n,s,c,d){this.p=new ge(n,s),this.h=c,this.d=function(g,v){let w=!1,S=1/0;for(let P=0;P<v.length;P++){const I=v[P];for(let D=0,z=I.length,N=z-1;D<z;N=D++){const W=I[D],J=I[N];W.y>g.y!=J.y>g.y&&g.x<(J.x-W.x)*(g.y-W.y)/(J.y-W.y)+W.x&&(w=!w),S=Math.min(S,zM(g,W,J))}}return(w?1:-1)*Math.sqrt(S)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}}const Uh=7,jb=Number.POSITIVE_INFINITY,FN=Math.sqrt(2);function NC(a,[n,s]){let c=0,d=0;if(s===jb){n<0&&(n=0);const g=n/FN;switch(a){case"top-right":case"top-left":d=g-Uh;break;case"bottom-right":case"bottom-left":d=-g+Uh;break;case"bottom":d=-n+Uh;break;case"top":d=n-Uh}switch(a){case"top-right":case"bottom-right":c=-g;break;case"top-left":case"bottom-left":c=g;break;case"left":c=n;break;case"right":c=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),a){case"top-right":case"top-left":case"top":d=s-Uh;break;case"bottom-right":case"bottom-left":case"bottom":d=-s+Uh}switch(a){case"top-right":case"bottom-right":case"right":c=-n;break;case"top-left":case"bottom-left":case"left":c=n}}return[c,d]}function $N(a,n,s,c,d,g,v,w,S,P){a.createArrays(),a.tilePixelRatio=Ut/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const I=a.layers[0].layout,D=a.layers[0]._unevaluatedLayout._values,z={};if(a.textSizeData.kind==="composite"){const{minZoom:J,maxZoom:te}=a.textSizeData;z.compositeTextSizes=[D["text-size"].possiblyEvaluate(new k(J),w),D["text-size"].possiblyEvaluate(new k(te),w)]}if(a.iconSizeData.kind==="composite"){const{minZoom:J,maxZoom:te}=a.iconSizeData;z.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new k(J),w),D["icon-size"].possiblyEvaluate(new k(te),w)]}z.layoutTextSize=D["text-size"].possiblyEvaluate(new k(S+1),w),z.layoutIconSize=D["icon-size"].possiblyEvaluate(new k(S+1),w),z.textMaxSize=D["text-size"].possiblyEvaluate(new k(18),w);const N=I.get("text-rotation-alignment")==="map"&&I.get("symbol-placement")!=="point",W=I.get("text-size");for(const J of a.features){const te=I.get("text-font").evaluate(J,{},w).join(","),le=W.evaluate(J,{},w),ye=z.layoutTextSize.evaluate(J,{},w),ce=(z.layoutIconSize.evaluate(J,{},w),{horizontal:{},vertical:void 0}),me=J.text;let Se,we=[0,0];if(me){const Qe=me.toString(),mt=I.get("text-letter-spacing").evaluate(J,{},w)*ii,Xe=I.get("text-line-height").evaluate(J,{},w)*ii,it=Z1(Qe)?mt:0,ot=I.get("text-anchor").evaluate(J,{},w),ht=I.get("text-variable-anchor");if(!ht){const At=I.get("text-radial-offset").evaluate(J,{},w);we=At?NC(ot,[At*ii,jb]):I.get("text-offset").evaluate(J,{},w).map(tr=>tr*ii)}let vt=N?"center":I.get("text-justify").evaluate(J,{},w);const Ye=I.get("symbol-placement")==="point",Et=Ye?I.get("text-max-width").evaluate(J,{},w)*ii:1/0,Lt=At=>{a.allowVerticalPlacement&&Ap(Qe)&&(ce.vertical=zb(me,n,s,d,te,Et,Xe,ot,At,it,we,Ao.vertical,!0,ye,le))};if(!N&&ht){const At=vt==="auto"?ht.map(bt=>Fb(bt)):[vt];let tr=!1;for(let bt=0;bt<At.length;bt++){const Ft=At[bt];if(!ce.horizontal[Ft])if(tr)ce.horizontal[Ft]=ce.horizontal[0];else{const rr=zb(me,n,s,d,te,Et,Xe,"center",Ft,it,we,Ao.horizontal,!1,ye,le);rr&&(ce.horizontal[Ft]=rr,tr=rr.positionedLines.length===1)}}Lt("left")}else{if(vt==="auto"&&(vt=Fb(ot)),Ye||I.get("text-writing-mode").indexOf("horizontal")>=0||!Ap(Qe)){const At=zb(me,n,s,d,te,Et,Xe,ot,vt,it,we,Ao.horizontal,!1,ye,le);At&&(ce.horizontal[vt]=At)}Lt(Ye?"left":vt)}}let Ze=!1;if(J.icon&&J.icon.name){const Qe=c[J.icon.name];Qe&&(Se=IN(d[J.icon.name],I.get("icon-offset").evaluate(J,{},w),I.get("icon-anchor").evaluate(J,{},w)),Ze=Qe.sdf,a.sdfIcons===void 0?a.sdfIcons=Qe.sdf:a.sdfIcons!==Qe.sdf&&ir("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qe.pixelRatio!==a.pixelRatio||I.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}const Ue=VC(ce.horizontal)||ce.vertical;a.iconsInText||(a.iconsInText=!!Ue&&Ue.iconsInText),(Ue||Se)&&NN(a,J,ce,Se,c,z,ye,0,we,Ze,v,w,P)}g&&a.generateCollisionDebugBuffers(S,a.collisionBoxArray)}function Fb(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function NN(a,n,s,c,d,g,v,w,S,P,I,D,z){let N=g.textMaxSize.evaluate(n,{},D);N===void 0&&(N=v);const W=a.layers[0].layout,J=W.get("icon-offset").evaluate(n,{},D),te=VC(s.horizontal)||s.vertical,le=z.name==="globe",ye=ii,ce=v/ye,me=a.tilePixelRatio*N/ye,Se=(ot=a.overscaling,a.zoom>18&&ot>2&&(ot>>=1),Math.max(Ut/(512*ot),1)*W.get("symbol-spacing")),we=W.get("text-padding")*a.tilePixelRatio,Ze=W.get("icon-padding")*a.tilePixelRatio,Ue=Ve(W.get("text-max-angle")),Qe=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",mt=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",Xe=W.get("symbol-placement"),it=Se/2;var ot;const ht=W.get("icon-text-fit");let vt;c&&ht!=="none"&&(a.allowVerticalPlacement&&s.vertical&&(vt=OC(c,s.vertical,ht,W.get("icon-text-fit-padding"),J,ce)),te&&(c=OC(c,te,ht,W.get("icon-text-fit-padding"),J,ce)));const Ye=(Et,Lt,At)=>{if(Lt.x<0||Lt.x>=Ut||Lt.y<0||Lt.y>=Ut)return;let tr=null;if(le){const{x:bt,y:Ft,z:rr}=z.projectTilePoint(Lt.x,Lt.y,At);tr={anchor:new Ns(bt,Ft,rr,0,void 0),up:z.upVector(At,Lt.x,Lt.y)}}(function(bt,Ft,rr,vr,nr,Gt,Yr,ar,sr,$r,Wr,qr,Nr,cn,_n,Dn,Ur,Nn,Ln,pn,wr,zn,Zr,zi,Rn){const oi=bt.addToLineVertexArray(Ft,vr);let Yn,Ri,Jn,La,Wh,cm,hm,wO=0,TO=0,SO=0,EO=0,ew=-1,tw=-1;const us={};let AO=K1("");const uc=rr?rr.anchor:Ft;let rw=0,nw=0;if(sr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[rw,nw]=sr.layout.get("text-offset").evaluate(wr,{},Rn).map(ho=>ho*ii):(rw=sr.layout.get("text-radial-offset").evaluate(wr,{},Rn)*ii,nw=jb),bt.allowVerticalPlacement&&nr.vertical){const ho=nr.vertical;if(_n)cm=$b(ho),ar&&(hm=$b(ar));else{const fo=sr.layout.get("text-rotate").evaluate(wr,{},Rn)+90;Jn=R_($r,uc,Ft,Wr,qr,Nr,ho,cn,fo,Dn),ar&&(La=R_($r,uc,Ft,Wr,qr,Nr,ar,Nn,fo))}}if(Gt){const ho=sr.layout.get("icon-rotate").evaluate(wr,{},Rn),fo=sr.layout.get("icon-text-fit")!=="none",fm=FC(Gt,ho,Zr,fo),ow=ar?FC(ar,ho,Zr,fo):void 0;Ri=R_($r,uc,Ft,Wr,qr,Nr,Gt,Nn,ho),wO=4*fm.length;const PO=bt.iconSizeData;let cc=null;PO.kind==="source"?(cc=[Ia*sr.layout.get("icon-size").evaluate(wr,{},Rn)],cc[0]>Rl&&ir(`${bt.layerIds[0]}: Value for "icon-size" is >= ${rm}. Reduce your "icon-size".`)):PO.kind==="composite"&&(cc=[Ia*zn.compositeIconSizes[0].evaluate(wr,{},Rn),Ia*zn.compositeIconSizes[1].evaluate(wr,{},Rn)],(cc[0]>Rl||cc[1]>Rl)&&ir(`${bt.layerIds[0]}: Value for "icon-size" is >= ${rm}. Reduce your "icon-size".`)),bt.addSymbols(bt.icon,fm,cc,pn,Ln,wr,!1,rr,Ft,oi.lineStartIndex,oi.lineLength,-1,zi,Rn),ew=bt.icon.placedSymbolArray.length-1,ow&&(TO=4*ow.length,bt.addSymbols(bt.icon,ow,cc,pn,Ln,wr,Ao.vertical,rr,Ft,oi.lineStartIndex,oi.lineLength,-1,zi,Rn),tw=bt.icon.placedSymbolArray.length-1)}for(const ho in nr.horizontal){const fo=nr.horizontal[ho];Yn||(AO=K1(fo.text),_n?Wh=$b(fo):Yn=R_($r,uc,Ft,Wr,qr,Nr,fo,cn,sr.layout.get("text-rotate").evaluate(wr,{},Rn),Dn));const fm=fo.positionedLines.length===1;if(SO+=UC(bt,rr,Ft,fo,Yr,sr,_n,wr,Dn,oi,nr.vertical?Ao.horizontal:Ao.horizontalOnly,fm?Object.keys(nr.horizontal):[ho],us,ew,zn,zi,Rn),fm)break}nr.vertical&&(EO+=UC(bt,rr,Ft,nr.vertical,Yr,sr,_n,wr,Dn,oi,Ao.vertical,["vertical"],us,tw,zn,zi,Rn));let Ul=-1;const iw=(ho,fo)=>ho?Math.max(ho,fo):fo;Ul=iw(Wh,Ul),Ul=iw(cm,Ul),Ul=iw(hm,Ul);const mU=Ul>-1?1:0;bt.glyphOffsetArray.length>=jl.MAX_GLYPHS&&ir("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wr.sortKey!==void 0&&bt.addToSortKeyRanges(bt.symbolInstances.length,wr.sortKey),bt.symbolInstances.emplaceBack(uc.x,uc.y,uc.z,Ft.x,Ft.y,us.right>=0?us.right:-1,us.center>=0?us.center:-1,us.left>=0?us.left:-1,us.vertical>=0?us.vertical:-1,ew,tw,AO,Yn!==void 0?Yn:bt.collisionBoxArray.length,Yn!==void 0?Yn+1:bt.collisionBoxArray.length,Jn!==void 0?Jn:bt.collisionBoxArray.length,Jn!==void 0?Jn+1:bt.collisionBoxArray.length,Ri!==void 0?Ri:bt.collisionBoxArray.length,Ri!==void 0?Ri+1:bt.collisionBoxArray.length,La||bt.collisionBoxArray.length,La?La+1:bt.collisionBoxArray.length,Wr,SO,EO,wO,TO,mU,0,rw,nw,Ul)})(a,Lt,tr,Et,s,c,d,vt,a.layers[0],a.collisionBoxArray,n.index,n.sourceLayerIndex,a.index,we,Qe,S,0,Ze,mt,J,n,g,P,I,D)};if(Xe==="line")for(const Et of RC(n.geometry,0,0,Ut,Ut)){const Lt=DN(Et,Se,Ue,s.vertical||te,c,ye,me,a.overscaling,Ut);for(const At of Lt)te&&UN(a,te.text,it,At)||Ye(Et,At,D)}else if(Xe==="line-center"){for(const Et of n.geometry)if(Et.length>1){const Lt=kN(Et,Ue,s.vertical||te,c,ye,me);Lt&&Ye(Et,Lt,D)}}else if(n.type==="Polygon")for(const Et of Ab(n.geometry,0)){const Lt=BN(Et,16);Ye(Et[0],new Ns(Lt.x,Lt.y,0,0,void 0),D)}else if(n.type==="LineString")for(const Et of n.geometry)Ye(Et,new Ns(Et[0].x,Et[0].y,0,0,void 0),D);else if(n.type==="Point")for(const Et of n.geometry)for(const Lt of Et)Ye([Lt],new Ns(Lt.x,Lt.y,0,0,void 0),D)}const rm=255,Rl=rm*Ia;function UC(a,n,s,c,d,g,v,w,S,P,I,D,z,N,W,J,te){const le=function(me,Se,we,Ze,Ue,Qe,mt,Xe){const it=[];if(Se.positionedLines.length===0)return it;const ot=Ze.layout.get("text-rotate").evaluate(Qe,{})*Math.PI/180,ht=function(At){const tr=At[0],bt=At[1],Ft=tr*bt;return Ft>0?[tr,-bt]:Ft<0?[-tr,bt]:tr===0?[bt,tr]:[bt,-tr]}(we);let vt=Math.abs(Se.top-Se.bottom);for(const At of Se.positionedLines)vt-=At.lineOffset;const Ye=Se.positionedLines.length,Et=vt/Ye;let Lt=Se.top-we[1];for(let At=0;At<Ye;++At){const tr=Se.positionedLines[At];Lt=LN(Se,Et,Lt,At);for(const bt of tr.positionedGlyphs){if(!bt.rect)continue;const Ft=bt.rect||{};let rr=wC+1,vr=!0,nr=1,Gt=0;if(bt.imageName){const Zr=mt[bt.imageName];if(!Zr)continue;if(Zr.sdf){ir("SDF images are not supported in formatted text and will be ignored.");continue}vr=!1,nr=Zr.pixelRatio,rr=Hi/nr}const Yr=(Ue||Xe)&&bt.vertical,ar=bt.metrics.advance*bt.scale/2,sr=bt.metrics,$r=bt.rect;if($r===null)continue;Xe&&Se.verticalizable&&(Gt=bt.imageName?ar-bt.metrics.width*bt.scale/2:0);const Wr=Ue?[bt.x+ar,bt.y]:[0,0];let qr=[0,0],Nr=[0,0],cn=!1;Ue||(Yr?(Nr=[bt.x+ar+ht[0],bt.y+ht[1]-Gt],cn=!0):qr=[bt.x+ar+we[0],bt.y+we[1]-Gt]);const _n=$r.w*bt.scale/(nr*(bt.localGlyph?ka:1)),Dn=$r.h*bt.scale/(nr*(bt.localGlyph?ka:1));let Ur,Nn,Ln,pn;if(Yr){const Zr=bt.y-Lt,zi=new ge(-ar,ar-Zr),Rn=-Math.PI/2,oi=new ge(...Nr);Ur=new ge(-ar+qr[0],qr[1]),Ur._rotateAround(Rn,zi)._add(oi),Ur.x+=-Zr+ar,Ur.y-=(sr.left-rr)*bt.scale;const Yn=bt.imageName?sr.advance*bt.scale:ii*bt.scale,Ri=String.fromCharCode(bt.glyph);mN(Ri)?Ur.x+=(1-rr)*bt.scale:gN(Ri)?Ur.x+=Yn-sr.height*bt.scale+(-rr-1)*bt.scale:Ur.x+=bt.imageName||sr.width+2*rr===$r.w&&sr.height+2*rr===$r.h?(Yn-Dn)/2:(Yn-(sr.height+2*rr)*bt.scale)/2,Nn=new ge(Ur.x,Ur.y-_n),Ln=new ge(Ur.x+Dn,Ur.y),pn=new ge(Ur.x+Dn,Ur.y-_n)}else{const Zr=(sr.left-rr)*bt.scale-ar+qr[0],zi=(-sr.top-rr)*bt.scale+qr[1],Rn=Zr+_n,oi=zi+Dn;Ur=new ge(Zr,zi),Nn=new ge(Rn,zi),Ln=new ge(Zr,oi),pn=new ge(Rn,oi)}if(ot){let Zr;Zr=Ue?new ge(0,0):cn?new ge(ht[0],ht[1]):new ge(we[0],we[1]),Ur._rotateAround(ot,Zr),Nn._rotateAround(ot,Zr),Ln._rotateAround(ot,Zr),pn._rotateAround(ot,Zr)}const wr=new ge(0,0),zn=new ge(0,0);it.push({tl:Ur,tr:Nn,bl:Ln,br:pn,tex:Ft,writingMode:Se.writingMode,glyphOffset:Wr,sectionIndex:bt.sectionIndex,isSDF:vr,pixelOffsetTL:wr,pixelOffsetBR:zn,minFontScaleX:0,minFontScaleY:0})}}return it}(0,c,S,g,v,w,d,a.allowVerticalPlacement),ye=a.textSizeData;let ce=null;ye.kind==="source"?(ce=[Ia*g.layout.get("text-size").evaluate(w,{},te)],ce[0]>Rl&&ir(`${a.layerIds[0]}: Value for "text-size" is >= ${rm}. Reduce your "text-size".`)):ye.kind==="composite"&&(ce=[Ia*W.compositeTextSizes[0].evaluate(w,{},te),Ia*W.compositeTextSizes[1].evaluate(w,{},te)],(ce[0]>Rl||ce[1]>Rl)&&ir(`${a.layerIds[0]}: Value for "text-size" is >= ${rm}. Reduce your "text-size".`)),a.addSymbols(a.text,le,ce,S,v,w,I,n,s,P.lineStartIndex,P.lineLength,N,J,te);for(const me of D)z[me]=a.text.placedSymbolArray.length-1;return 4*le.length}function VC(a){for(const n in a)return a[n];return null}function R_(a,n,s,c,d,g,v,w,S,P){let I=v.top,D=v.bottom,z=v.left,N=v.right;const W=v.collisionPadding;if(W&&(z-=W[0],I-=W[1],N+=W[2],D+=W[3]),S){const J=new ge(z,I),te=new ge(N,I),le=new ge(z,D),ye=new ge(N,D),ce=Ve(S);let me=new ge(0,0);P&&(me=new ge(P[0],P[1])),J._rotateAround(ce,me),te._rotateAround(ce,me),le._rotateAround(ce,me),ye._rotateAround(ce,me),z=Math.min(J.x,te.x,le.x,ye.x),N=Math.max(J.x,te.x,le.x,ye.x),I=Math.min(J.y,te.y,le.y,ye.y),D=Math.max(J.y,te.y,le.y,ye.y)}return a.emplaceBack(n.x,n.y,n.z,s.x,s.y,z,I,N,D,w,c,d,g),a.length-1}function $b(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const n=a.bottom-a.top;return n>0?Math.max(10,n):null}function UN(a,n,s,c){const d=a.compareText;if(n in d){const g=d[n];for(let v=g.length-1;v>=0;v--)if(c.dist(g[v])<s)return!0}else d[n]=[];return d[n].push(c),!1}function GC(a,n){const s=a.fovAboveCenter,c=a.elevation?a.elevation.getMinElevationBelowMSL()*n:0,d=(a._camera.position[2]*a.worldSize-c)/Math.cos(a._pitch),g=Math.sin(s)*d/Math.sin(Math.max(Math.PI/2-a._pitch-s,.01)),v=Math.sin(a._pitch)*g+d;return Math.min(1.01*v,d*(1/a._horizonShift))}function sc(a,n){if(!n.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:n};const s=Math.pow(2,-a.z),c=a.x*s,d=(a.x+1)*s,g=a.y*s,v=(a.y+1)*s,w=Eo(c),S=Eo(d),P=gi(g),I=gi(v),D=n.project(w,P),z=n.project(S,P),N=n.project(S,I),W=n.project(w,I);let J=Math.min(D.x,z.x,N.x,W.x),te=Math.min(D.y,z.y,N.y,W.y),le=Math.max(D.x,z.x,N.x,W.x),ye=Math.max(D.y,z.y,N.y,W.y);const ce=s/16;function me(we,Ze,Ue,Qe,mt,Xe){const it=(Ue+mt)/2,ot=(Qe+Xe)/2,ht=n.project(Eo(it),gi(ot)),vt=Math.max(0,J-ht.x,te-ht.y,ht.x-le,ht.y-ye);J=Math.min(J,ht.x),le=Math.max(le,ht.x),te=Math.min(te,ht.y),ye=Math.max(ye,ht.y),vt>ce&&(me(we,ht,Ue,Qe,it,ot),me(ht,Ze,it,ot,mt,Xe))}me(D,z,c,g,d,g),me(z,N,d,g,d,v),me(N,W,d,v,c,v),me(W,D,c,v,c,g),J-=ce,te-=ce,le+=ce,ye+=ce;const Se=1/Math.max(le-J,ye-te);return{scale:Se,x:J*Se,y:te*Se,x2:le*Se,y2:ye*Se,projection:n}}const VN=Ma(new Float32Array(16));class Bl{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new Fr(0,0)}projectTilePoint(n,s,c){return{x:n,y:s,z:0}}locationPoint(n,s,c=!0){return n._coordinatePoint(n.locationCoordinate(s),c)}pixelsPerMeter(n,s){return Oa(1,n)*s}pixelSpaceConversion(n,s,c){return 1}farthestPixelDistance(n){return GC(n,n.pixelsPerMeter)}pointCoordinate(n,s,c,d){const g=n.horizonLineFromTop(!1),v=new ge(s,Math.max(g,c));return n.rayIntersectionCoordinate(n.pointRayIntersection(v,d))}pointCoordinate3D(n,s,c){const d=new ge(s,c);if(n.elevation)return n.elevation.pointCoordinate(d);{const g=this.pointCoordinate(n,d.x,d.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(n,s){if(n.elevation)return!this.pointCoordinate3D(n,s.x,s.y);const c=n.horizonLineFromTop();return s.y<c}createInversionMatrix(n,s){return VN}createTileMatrix(n,s,c){let d,g,v;const w=c.canonical,S=Ma(new Float64Array(16));if(this.isReprojectedInTileSpace){const P=sc(w,this);d=1,g=P.x+c.wrap*P.scale,v=P.y,ec(S,S,[d/P.scale,d/P.scale,n.pixelsPerMeter/s])}else d=s/n.zoomScale(w.z),g=(w.x+Math.pow(2,w.z)*c.wrap)*d,v=w.y*d;return Dp(S,S,[g,v,0]),ec(S,S,[d/Ut,d/Ut,1]),S}upVector(n,s,c){return[0,0,1]}upVectorScale(n,s,c){return{metersToTile:1}}}class GN extends Bl{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,c]=this.parallels=n.parallels||[29.5,45.5],d=Math.sin(Ve(s));this.n=(d+Math.sin(Ve(c)))/2,this.c=1+d*(2*this.n-d),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:c,c:d,r0:g}=this,v=Ve(n-this.center[0]),w=Ve(s),S=Math.sqrt(d-2*c*Math.sin(w))/c;return{x:S*Math.sin(v*c),y:S*Math.cos(v*c)-g,z:0}}unproject(n,s){const{n:c,c:d,r0:g}=this,v=g+s;let w=Math.atan2(n,Math.abs(v))*Math.sign(v);v*c<0&&(w-=Math.PI*Math.sign(n)*Math.sign(v));const S=Ve(this.center[0])*c;w=ft(w,-Math.PI-S,Math.PI-S);const P=Oe(be(w/c)+this.center[0],-180,180),I=Math.asin(Oe((d-(n*n+v*v)*c*c)/(2*c),-1,1)),D=Oe(be(I),-yi,yi);return new Fr(P,D)}}const nm=1.340264,im=-.081106,om=893e-6,am=.003796,B_=Math.sqrt(3)/2;class WN extends Bl{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const c=Math.asin(B_*Math.sin(s)),d=c*c,g=d*d*d;return{x:.5*(n*Math.cos(c)/(B_*(nm+3*im*d+g*(7*om+9*am*d)))/Math.PI+.5),y:1-.5*(c*(nm+im*d+g*(om+am*d))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,d=c*c,g=d*d*d;for(let I,D,z,N=0;N<12&&(D=c*(nm+im*d+g*(om+am*d))-s,z=nm+3*im*d+g*(7*om+9*am*d),I=D/z,c=Oe(c-I,-Math.PI/3,Math.PI/3),d=c*c,g=d*d*d,!(Math.abs(I)<1e-12));++N);const v=B_*n*(nm+3*im*d+g*(7*om+9*am*d))/Math.cos(c),w=Math.asin(Math.sin(c)/B_),S=Oe(180*v/Math.PI,-180,180),P=Oe(180*w/Math.PI,-yi,yi);return new Fr(S,P)}}class qN extends Bl{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const c=360*(n-.5),d=Oe(360*(.5-s),-yi,yi);return new Fr(c,d)}}const Vh=Math.PI/2;function j_(a){return Math.tan((Vh+a)/2)}class ZN extends Bl{constructor(n){super(n),this.center=n.center||[0,30];const[s,c]=this.parallels=n.parallels||[30,30];let d=Ve(s),g=Ve(c);this.southernCenter=d+g<0,this.southernCenter&&(d=-d,g=-g);const v=Math.cos(d),w=j_(d);this.n=d===g?Math.sin(d):Math.log(v/Math.cos(g))/Math.log(j_(g)/w),this.f=v*Math.pow(j_(d),this.n)/this.n}project(n,s){s=Ve(s),this.southernCenter&&(s=-s),n=Ve(n-this.center[0]);const c=1e-6,{n:d,f:g}=this;g>0?s<-Vh+c&&(s=-Vh+c):s>Vh-c&&(s=Vh-c);const v=g/Math.pow(j_(s),d);let w=v*Math.sin(d*n),S=g-v*Math.cos(d*n);return w=.5*(w/Math.PI+.5),S=.5*(S/Math.PI+.5),{x:w,y:this.southernCenter?S:1-S,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:c,f:d}=this,g=d-s,v=Math.sign(g),w=Math.sign(c)*Math.sqrt(n*n+g*g);let S=Math.atan2(n,Math.abs(g))*v;g*c<0&&(S-=Math.PI*Math.sign(n)*v);const P=Oe(be(S/c)+this.center[0],-180,180),I=Oe(be(2*Math.atan(Math.pow(d/w,1/c))-Vh),-yi,yi);return new Fr(P,this.southernCenter?-I:I)}}class WC extends Bl{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:is(n),y:os(s),z:0}}unproject(n,s){const c=Eo(n),d=gi(s);return new Fr(c,d)}}const qC=Ve(yi);class HN extends Bl{project(n,s){const c=(s=Ve(s))*s,d=c*c;return{x:.5*((n=Ve(n))*(.8707-.131979*c+d*(d*(.003971*c-.001529*d)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+d*(.028874*c-.044475-.005916*d)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,d=25,g=0,v=c*c;do{v=c*c;const P=v*v;g=(c*(1.007226+v*(.015085+P*(.028874*v-.044475-.005916*P)))-s)/(1.007226+v*(.045255+P*(.259866*v-.311325-.005916*11*P))),c=Oe(c-g,-qC,qC)}while(Math.abs(g)>1e-6&&--d>0);v=c*c;const w=Oe(be(n/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),S=be(c);return new Fr(w,S)}}const ZC=Ve(yi);class XN extends Bl{project(n,s){s=Ve(s),n=Ve(n);const c=Math.cos(s),d=2/Math.PI,g=Math.acos(c*Math.cos(n/2)),v=Math.sin(g)/g,w=.5*(n*d+2*c*Math.sin(n/2)/v)||0,S=.5*(s+Math.sin(s)/v)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(S/Math.PI+1),z:0}}unproject(n,s){let c=n=(2*n-.5)*Math.PI,d=s=(2*(1-s)-1)*Math.PI,g=25;const v=1e-6;let w=0,S=0;do{const P=Math.cos(d),I=Math.sin(d),D=2*I*P,z=I*I,N=P*P,W=Math.cos(c/2),J=Math.sin(c/2),te=2*W*J,le=J*J,ye=1-N*W*W,ce=ye?1/ye:0,me=ye?Math.acos(P*W)*Math.sqrt(1/ye):0,Se=.5*(2*me*P*J+2*c/Math.PI)-n,we=.5*(me*I+d)-s,Ze=.5*ce*(N*le+me*P*W*z)+1/Math.PI,Ue=ce*(te*D/4-me*I*J),Qe=.125*ce*(D*J-me*I*N*te),mt=.5*ce*(z*W+me*le*P)+.5,Xe=Ue*Qe-mt*Ze;w=(we*Ue-Se*mt)/Xe,S=(Se*Qe-we*Ze)/Xe,c=Oe(c-w,-Math.PI,Math.PI),d=Oe(d-S,-ZC,ZC)}while((Math.abs(w)>v||Math.abs(S)>v)&&--g>0);return new Fr(be(c),be(d))}}class HC extends Bl{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ve(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:c,cosPhi:d}=this;return{x:Ve(n)*d*c+.5,y:-Math.sin(Ve(s))/d*c+.5,z:0}}unproject(n,s){const{scale:c,cosPhi:d}=this,g=-(s-.5)/c,v=Oe(be((n-.5)/c)/d,-180,180),w=Math.asin(Oe(g*d,-1,1)),S=Oe(be(w),-yi,yi);return new Fr(v,S)}}class KN extends WC{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,c){const d=Np(n,s,c);return Sn(d,d,Up(ns(c))),{x:d[0],y:d[1],z:d[2]}}locationPoint(n,s){const c=Mh(s.lat,s.lng),d=ki([],c),g=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude;Bp(c,c,d,Oa(1,0)*Ut*g);const v=Ma(new Float64Array(16));return Qu(v,n.pixelMatrix,n.globeMatrix),Sn(c,c,v),new ge(c[0],c[1])}pixelsPerMeter(n,s){return Oa(1,0)*s}pixelSpaceConversion(n,s,c){const d=Oa(1,n)*s,g=gr(Oa(1,45)*s,d,c);return this.pixelsPerMeter(n,s)/g}createTileMatrix(n,s,c){const d=cb(ns(c.canonical));return Qu(new Float64Array(16),n.globeMatrix,d)}createInversionMatrix(n,s){const{center:c}=n,d=Up(ns(s));return f_(d,d,Ve(c.lng)),eb(d,d,Ve(c.lat)),ec(d,d,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(d)}pointCoordinate(n,s,c,d){return bM(n,s,c,!0)||new Oh(0,0)}pointCoordinate3D(n,s,c){const d=this.pointCoordinate(n,s,c,0);return[d.x,d.y,d.z]}isPointAboveHorizon(n,s){return!bM(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=function(d,g){const v=d.cameraToCenterDistance,w=d._centerAltitude*g,S=d._camera,P=d._camera.forward(),I=Bs([],So([],P,-v),[0,0,w]),D=d.worldSize/(2*Math.PI),z=[0,0,-D],N=d.width/d.height,W=Math.tan(d.fovAboveCenter),J=So([],S.up(),W),te=So([],S.right(),W*N),le=ki([],Bs([],Bs([],P,J),te)),ye=[];let ce;if(new ib(I,le).closestPointOnSphere(z,D,ye)){const me=Bs([],ye,z),Se=Ca([],me,I);ce=Math.cos(d.fovAboveCenter)*Lp(Se)}else{const me=Ca([],I,z),Se=Ca([],z,I);ki(Se,Se);const we=Lp(me)-D;ce=Math.sqrt(we*(we+2*D));const Ze=Math.acos(ce/(D+we))-Math.acos(Wo(P,Se));ce*=Math.cos(Ze)}return 1.01*ce}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),c=Ch(n.zoom);if(c>0){const d=GC(n,Oa(1,n.center.lat)*n.worldSize),g=n.worldSize/(2*Math.PI),v=Math.max(n.width,n.height)/n.worldSize*Math.PI;return gr(s,d+g*(1-Math.cos(v)),Math.pow(c,10))}return s}upVector(n,s,c){return Np(s,c,n,1)}upVectorScale(n){return{metersToTile:d_(m_(ns(n)))}}}function XC(a){const n=a.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(a.name){case"mercator":return new WC(a);case"equirectangular":return new qN(a);case"naturalEarth":return new HN(a);case"equalEarth":return new WN(a);case"winkelTripel":return new XN(a);case"albers":return s?new HC(a):new GN(a);case"lambertConformalConic":return s?new HC(a):new ZN(a);case"globe":return new KN(a)}throw new Error(`Invalid projection name: ${a.name}`)}const YN=E_.types,JN=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function F_(a,n,s,c,d,g,v,w,S,P,I,D,z){const N=w?Math.min(Rl,Math.round(w[0])):0,W=w?Math.min(Rl,Math.round(w[1])):0;a.emplaceBack(n,s,Math.round(32*c),Math.round(32*d),g,v,(N<<1)+(S?1:0),W,16*P,16*I,256*D,256*z)}function $_(a,n,s,c,d,g,v){a.emplaceBack(n,s,c,d,g,v)}function N_(a,n,s,c,d){a.emplaceBack(n,s,c,d),a.emplaceBack(n,s,c,d),a.emplaceBack(n,s,c,d),a.emplaceBack(n,s,c,d)}function QN(a){for(const n of a.sections)if(X1(n.text))return!0;return!1}class Nb{constructor(n){this.layoutVertexArray=new lt,this.indexArray=new Bt,this.programConfigurations=n,this.segments=new In,this.dynamicLayoutVertexArray=new dt,this.opacityVertexArray=new jt,this.placedSymbolArray=new On,this.globeExtVertexArray=new _t}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,s,c,d){this.isEmpty()||(c&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,sN.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,uN.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,JN,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,lN.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||d)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}It(Nb,"SymbolBuffers");class Ub{constructor(n,s,c){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new c,this.segments=new In,this.collisionVertexArray=new dr,this.collisionVertexArrayExt=new cr}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,cN.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,hN.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}It(Ub,"CollisionBuffers");class jl{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ma([]),this.placementViewportMatrix=Ma([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ob(this.zoom,s["text-size"]),this.iconSizeData=Ob(this.zoom,s["icon-size"]);const c=this.layers[0].layout,d=c.get("symbol-sort-key"),g=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&d.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(v=>Ao[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID,this.projection=n.projection}createArrays(){this.text=new Nb(new Ju(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new Nb(new Ju(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new Ii,this.lineVertexArray=new Th,this.symbolInstances=new rn}calculateGlyphDependencies(n,s,c,d,g){for(let v=0;v<n.length;v++)if(s[n.charCodeAt(v)]=!0,d&&g){const w=Qp[n.charAt(v)];w&&(s[w.charCodeAt(0)]=!0)}}populate(n,s,c,d){const g=this.layers[0],v=g.layout,w=this.projection.name==="globe",S=v.get("text-font"),P=v.get("text-field"),I=v.get("icon-image"),D=(P.value.kind!=="constant"||P.value.value instanceof Oi&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),z=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,N=v.get("symbol-sort-key");if(this.features=[],!D&&!z)return;const W=s.iconDependencies,J=s.glyphDependencies,te=s.availableImages,le=new k(this.zoom);for(const{feature:ye,id:ce,index:me,sourceLayerIndex:Se}of n){const we=g._featureFilter.needGeometry,Ze=ic(ye,we);if(!g._featureFilter.filter(le,Ze,c))continue;if(we||(Ze.geometry=js(ye,c,d)),w&&ye.type!==1&&c.z<=5){const Xe=Ze.geometry,it=.98078528056,ot=(ht,vt)=>Wo(Np(ht.x,ht.y,c,1),Np(vt.x,vt.y,c,1))<it;for(let ht=0;ht<Xe.length;ht++)Xe[ht]=u$(Xe[ht],ot)}let Ue,Qe;if(D){const Xe=g.getValueAndResolveTokens("text-field",Ze,c,te),it=Oi.factory(Xe);QN(it)&&(this.hasRTLText=!0),(!this.hasRTLText||T()==="unavailable"||this.hasRTLText&&C.isParsed())&&(Ue=pN(it,g,Ze))}if(z){const Xe=g.getValueAndResolveTokens("icon-image",Ze,c,te);Qe=Xe instanceof oo?Xe:oo.fromString(Xe)}if(!Ue&&!Qe)continue;const mt=this.sortFeaturesByKey?N.evaluate(Ze,{},c):void 0;if(this.features.push({id:ce,text:Ue,icon:Qe,index:me,sourceLayerIndex:Se,geometry:Ze.geometry,properties:ye.properties,type:YN[ye.type],sortKey:mt}),Qe&&(W[Qe.name]=!0),Ue){const Xe=S.evaluate(Ze,{},c).join(","),it=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ao.vertical)>=0;for(const ot of Ue.sections)if(ot.image)W[ot.image.name]=!0;else{const ht=Ap(Ue.toString()),vt=ot.fontStack||Xe,Ye=J[vt]=J[vt]||{};this.calculateGlyphDependencies(ot.text,Ye,it,this.allowVerticalPlacement,ht)}}}v.get("symbol-placement")==="line"&&(this.features=function(ye){const ce={},me={},Se=[];let we=0;function Ze(Xe){Se.push(ye[Xe]),we++}function Ue(Xe,it,ot){const ht=me[Xe];return delete me[Xe],me[it]=ht,Se[ht].geometry[0].pop(),Se[ht].geometry[0]=Se[ht].geometry[0].concat(ot[0]),ht}function Qe(Xe,it,ot){const ht=ce[it];return delete ce[it],ce[Xe]=ht,Se[ht].geometry[0].shift(),Se[ht].geometry[0]=ot[0].concat(Se[ht].geometry[0]),ht}function mt(Xe,it,ot){const ht=ot?it[0][it[0].length-1]:it[0][0];return`${Xe}:${ht.x}:${ht.y}`}for(let Xe=0;Xe<ye.length;Xe++){const it=ye[Xe],ot=it.geometry,ht=it.text?it.text.toString():null;if(!ht){Ze(Xe);continue}const vt=mt(ht,ot),Ye=mt(ht,ot,!0);if(vt in me&&Ye in ce&&me[vt]!==ce[Ye]){const Et=Qe(vt,Ye,ot),Lt=Ue(vt,Ye,Se[Et].geometry);delete ce[vt],delete me[Ye],me[mt(ht,Se[Lt].geometry,!0)]=Lt,Se[Et].geometry=null}else vt in me?Ue(vt,Ye,ot):Ye in ce?Qe(vt,Ye,ot):(Ze(Xe),ce[vt]=we-1,me[Ye]=we-1)}return Se.filter(Xe=>Xe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ye,ce)=>ye.sortKey-ce.sortKey)}update(n,s,c,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,s,this.layers,c,d),this.icon.programConfigurations.updatePaintArrays(n,s,this.layers,c,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=XC(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const c=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:d,y:g}of s)this.lineVertexArray.emplaceBack(d,g);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(n,s,c,d,g,v,w,S,P,I,D,z,N,W){const J=n.indexArray,te=n.layoutVertexArray,le=n.globeExtVertexArray,ye=n.segments.prepareSegment(4*s.length,te,J,this.canOverlap?v.sortKey:void 0),ce=this.glyphOffsetArray.length,me=ye.vertexLength,Se=this.allowVerticalPlacement&&w===Ao.vertical?Math.PI/2:0,we=v.text&&v.text.sections;for(let Ue=0;Ue<s.length;Ue++){const{tl:Qe,tr:mt,bl:Xe,br:it,tex:ot,pixelOffsetTL:ht,pixelOffsetBR:vt,minFontScaleX:Ye,minFontScaleY:Et,glyphOffset:Lt,isSDF:At,sectionIndex:tr}=s[Ue],bt=ye.vertexLength,Ft=Lt[1];if(F_(te,P.x,P.y,Qe.x,Ft+Qe.y,ot.x,ot.y,c,At,ht.x,ht.y,Ye,Et),F_(te,P.x,P.y,mt.x,Ft+mt.y,ot.x+ot.w,ot.y,c,At,vt.x,ht.y,Ye,Et),F_(te,P.x,P.y,Xe.x,Ft+Xe.y,ot.x,ot.y+ot.h,c,At,ht.x,vt.y,Ye,Et),F_(te,P.x,P.y,it.x,Ft+it.y,ot.x+ot.w,ot.y+ot.h,c,At,vt.x,vt.y,Ye,Et),S){const{x:rr,y:vr,z:nr}=S.anchor,[Gt,Yr,ar]=S.up;$_(le,rr,vr,nr,Gt,Yr,ar),$_(le,rr,vr,nr,Gt,Yr,ar),$_(le,rr,vr,nr,Gt,Yr,ar),$_(le,rr,vr,nr,Gt,Yr,ar),N_(n.dynamicLayoutVertexArray,rr,vr,nr,Se)}else N_(n.dynamicLayoutVertexArray,P.x,P.y,P.z,Se);J.emplaceBack(bt,bt+1,bt+2),J.emplaceBack(bt+1,bt+2,bt+3),ye.vertexLength+=4,ye.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Lt[0]),Ue!==s.length-1&&tr===s[Ue+1].sectionIndex||n.programConfigurations.populatePaintArrays(te.length,v,v.index,{},N,W,we&&we[tr])}const Ze=S?S.anchor:P;n.placedSymbolArray.emplaceBack(Ze.x,Ze.y,Ze.z,P.x,P.y,ce,this.glyphOffsetArray.length-ce,me,I,D,P.segment,c?c[0]:0,c?c[1]:0,d[0],d[1],w,0,!1,0,z,0)}_commitLayoutVertex(n,s,c,d,g,v,w){n.emplaceBack(s,c,d,g,v,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(n,s,c,d,g,v,w){const S=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),P=S.vertexLength,I=w.tileAnchorX,D=w.tileAnchorY;for(let N=0;N<4;N++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(s,-n.padding,-n.padding),c.collisionVertexArrayExt.emplaceBack(s,n.padding,-n.padding),c.collisionVertexArrayExt.emplaceBack(s,n.padding,n.padding),c.collisionVertexArrayExt.emplaceBack(s,-n.padding,n.padding),this._commitLayoutVertex(c.layoutVertexArray,d,g,v,I,D,new ge(n.x1,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,g,v,I,D,new ge(n.x2,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,g,v,I,D,new ge(n.x2,n.y2)),this._commitLayoutVertex(c.layoutVertexArray,d,g,v,I,D,new ge(n.x1,n.y2)),S.vertexLength+=4;const z=c.indexArray;z.emplaceBack(P,P+1),z.emplaceBack(P+1,P+2),z.emplaceBack(P+2,P+3),z.emplaceBack(P+3,P),S.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,c,d,g,v){for(let w=d;w<g;w++){const S=c.get(w),P=this.getSymbolInstanceTextSize(n,v,s,w);this._addCollisionDebugVertices(S,P,this.textCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(n,s,c,d,g,v){for(let w=d;w<g;w++){const S=c.get(w),P=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._addCollisionDebugVertices(S,P,this.iconCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}generateCollisionDebugBuffers(n,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ub(Dt,pC.members,Kn),this.iconCollisionBox=new Ub(Dt,pC.members,Kn);const c=zh(this.iconSizeData,n),d=zh(this.textSizeData,n);for(let g=0;g<this.symbolInstances.length;g++){const v=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(d,n,s,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(d,n,s,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,n,s,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,n,s,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(n,s,c,d){const g=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:d),v=C_(this.textSizeData,n,g)/ii;return this.tilePixelRatio*v}getSymbolInstanceIconSize(n,s,c){const d=this.icon.placedSymbolArray.get(c),g=C_(this.iconSizeData,n,d);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(n,s,c){n.emplaceBack(s,-c,-c),n.emplaceBack(s,c,-c),n.emplaceBack(s,c,c),n.emplaceBack(s,-c,c)}_updateTextDebugCollisionBoxes(n,s,c,d,g,v){for(let w=d;w<g;w++){const S=c.get(w),P=this.getSymbolInstanceTextSize(n,v,s,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,P,S.padding)}}_updateIconDebugCollisionBoxes(n,s,c,d,g,v){for(let w=d;w<g;w++){const S=c.get(w),P=this.getSymbolInstanceIconSize(n,s,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,P,S.padding)}}updateCollisionDebugBuffers(n,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=zh(this.iconSizeData,n),d=zh(this.textSizeData,n);for(let g=0;g<this.symbolInstances.length;g++){const v=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(d,n,s,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(d,n,s,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(c,n,s,v.iconBoxStartIndex,v.iconBoxEndIndex,v.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,n,s,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,c,d,g,v,w,S,P){const I={};if(s<c){const{x1:D,y1:z,x2:N,y2:W,padding:J,projectedAnchorX:te,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ce,tileAnchorY:me,featureIndex:Se}=n.get(s);I.textBox={x1:D,y1:z,x2:N,y2:W,padding:J,projectedAnchorX:te,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ce,tileAnchorY:me},I.textFeatureIndex=Se}if(d<g){const{x1:D,y1:z,x2:N,y2:W,padding:J,projectedAnchorX:te,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ce,tileAnchorY:me,featureIndex:Se}=n.get(d);I.verticalTextBox={x1:D,y1:z,x2:N,y2:W,padding:J,projectedAnchorX:te,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ce,tileAnchorY:me},I.verticalTextFeatureIndex=Se}if(v<w){const{x1:D,y1:z,x2:N,y2:W,padding:J,projectedAnchorX:te,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ce,tileAnchorY:me,featureIndex:Se}=n.get(v);I.iconBox={x1:D,y1:z,x2:N,y2:W,padding:J,projectedAnchorX:te,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ce,tileAnchorY:me},I.iconFeatureIndex=Se}if(S<P){const{x1:D,y1:z,x2:N,y2:W,padding:J,projectedAnchorX:te,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ce,tileAnchorY:me,featureIndex:Se}=n.get(S);I.verticalIconBox={x1:D,y1:z,x2:N,y2:W,padding:J,projectedAnchorX:te,projectedAnchorY:le,projectedAnchorZ:ye,tileAnchorX:ce,tileAnchorY:me},I.verticalIconFeatureIndex=Se}return I}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,s){const c=n.placedSymbolArray.get(s),d=c.vertexStartIndex+4*c.numGlyphs;for(let g=c.vertexStartIndex;g<d;g+=4)n.indexArray.emplaceBack(g,g+1,g+2),n.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),c=Math.cos(n),d=[],g=[],v=[];for(let w=0;w<this.symbolInstances.length;++w){v.push(w);const S=this.symbolInstances.get(w);d.push(0|Math.round(s*S.tileAnchorX+c*S.tileAnchorY)),g.push(S.featureIndex)}return v.sort((w,S)=>d[w]-d[S]||g[S]-g[w]),v}addToSortKeyRanges(n,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:w,placedIconSymbolIndex:S,verticalPlacedIconSymbolIndex:P}=c;d>=0&&this.addIndicesForPlacedSymbol(this.text,d),g>=0&&g!==d&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&v!==g&&v!==d&&this.addIndicesForPlacedSymbol(this.text,v),w>=0&&this.addIndicesForPlacedSymbol(this.text,w),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}It(jl,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),jl.MAX_GLYPHS=65535,jl.addDynamicAttributes=N_;const eU=new de({"symbol-placement":new X(Je.layout_symbol["symbol-placement"]),"symbol-spacing":new X(Je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new X(Je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ne(Je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new X(Je.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new X(Je.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new X(Je.layout_symbol["icon-ignore-placement"]),"icon-optional":new X(Je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new X(Je.layout_symbol["icon-rotation-alignment"]),"icon-size":new ne(Je.layout_symbol["icon-size"]),"icon-text-fit":new X(Je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new X(Je.layout_symbol["icon-text-fit-padding"]),"icon-image":new ne(Je.layout_symbol["icon-image"]),"icon-rotate":new ne(Je.layout_symbol["icon-rotate"]),"icon-padding":new X(Je.layout_symbol["icon-padding"]),"icon-keep-upright":new X(Je.layout_symbol["icon-keep-upright"]),"icon-offset":new ne(Je.layout_symbol["icon-offset"]),"icon-anchor":new ne(Je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new X(Je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new X(Je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new X(Je.layout_symbol["text-rotation-alignment"]),"text-field":new ne(Je.layout_symbol["text-field"]),"text-font":new ne(Je.layout_symbol["text-font"]),"text-size":new ne(Je.layout_symbol["text-size"]),"text-max-width":new ne(Je.layout_symbol["text-max-width"]),"text-line-height":new ne(Je.layout_symbol["text-line-height"]),"text-letter-spacing":new ne(Je.layout_symbol["text-letter-spacing"]),"text-justify":new ne(Je.layout_symbol["text-justify"]),"text-radial-offset":new ne(Je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new X(Je.layout_symbol["text-variable-anchor"]),"text-anchor":new ne(Je.layout_symbol["text-anchor"]),"text-max-angle":new X(Je.layout_symbol["text-max-angle"]),"text-writing-mode":new X(Je.layout_symbol["text-writing-mode"]),"text-rotate":new ne(Je.layout_symbol["text-rotate"]),"text-padding":new X(Je.layout_symbol["text-padding"]),"text-keep-upright":new X(Je.layout_symbol["text-keep-upright"]),"text-transform":new ne(Je.layout_symbol["text-transform"]),"text-offset":new ne(Je.layout_symbol["text-offset"]),"text-allow-overlap":new X(Je.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new X(Je.layout_symbol["text-ignore-placement"]),"text-optional":new X(Je.layout_symbol["text-optional"])});var Vb={paint:new de({"icon-opacity":new ne(Je.paint_symbol["icon-opacity"]),"icon-color":new ne(Je.paint_symbol["icon-color"]),"icon-halo-color":new ne(Je.paint_symbol["icon-halo-color"]),"icon-halo-width":new ne(Je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ne(Je.paint_symbol["icon-halo-blur"]),"icon-translate":new X(Je.paint_symbol["icon-translate"]),"icon-translate-anchor":new X(Je.paint_symbol["icon-translate-anchor"]),"text-opacity":new ne(Je.paint_symbol["text-opacity"]),"text-color":new ne(Je.paint_symbol["text-color"],{runtimeType:qi,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new ne(Je.paint_symbol["text-halo-color"]),"text-halo-width":new ne(Je.paint_symbol["text-halo-width"]),"text-halo-blur":new ne(Je.paint_symbol["text-halo-blur"]),"text-translate":new X(Je.paint_symbol["text-translate"]),"text-translate-anchor":new X(Je.paint_symbol["text-translate-anchor"])}),layout:eU};class KC{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:pl,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}It(KC,"FormatSectionOverride",{omit:["defaultValue"]});class U_ extends Pa{constructor(n){super(n,Vb)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const d=[];for(const g of c)d.indexOf(g)<0&&d.push(g);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(n,s,c,d){const g=this.layout.get(n).evaluate(s,{},c,d),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||Al(v.value)||!g?g:function(w,S){return S.replace(/{([^{}]+)}/g,(P,I)=>I in w?String(w[I]):"")}(s.properties,g)}createBucket(n){return new jl(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of Vb.paint.overridableProperties){if(!U_.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),c=new KC(s),d=new mh(c,s.property.specification);let g=null;g=s.value.kind==="constant"||s.value.kind==="source"?new mp("source",d):new Vu("composite",d,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new oe(s.property,g,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&U_.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const c=n.get("text-field"),d=Vb.paint.properties[s];let g=!1;const v=w=>{for(const S of w)if(d.overrides&&d.overrides.hasOverride(S))return void(g=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Oi)v(c.value.value.sections);else if(c.value.kind==="source"){const w=P=>{g||(P instanceof As&&yn(P.value)===Au?v(P.value.sections):P instanceof Qa?v(P.sections):P.eachChild(w))},S=c.value;S._styleExpression&&w(S._styleExpression.expression)}return g}getProgramConfiguration(n){return new Dl(this,n)}}var tU={paint:new de({"background-color":new X(Je.paint_background["background-color"]),"background-pattern":new X(Je.paint_background["background-pattern"]),"background-opacity":new X(Je.paint_background["background-opacity"])})},rU={paint:new de({"raster-opacity":new X(Je.paint_raster["raster-opacity"]),"raster-hue-rotate":new X(Je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new X(Je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new X(Je.paint_raster["raster-brightness-max"]),"raster-saturation":new X(Je.paint_raster["raster-saturation"]),"raster-contrast":new X(Je.paint_raster["raster-contrast"]),"raster-resampling":new X(Je.paint_raster["raster-resampling"]),"raster-fade-duration":new X(Je.paint_raster["raster-fade-duration"])})};class nU extends Pa{constructor(n){super(n,{}),this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}var iU={paint:new de({"sky-type":new X(Je.paint_sky["sky-type"]),"sky-atmosphere-sun":new X(Je.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new X(Je.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new X(Je.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new X(Je.paint_sky["sky-gradient-radius"]),"sky-gradient":new fe(Je.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new X(Je.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new X(Je.paint_sky["sky-atmosphere-color"]),"sky-opacity":new X(Je.paint_sky["sky-opacity"])})};function Gb(a,n,s){const c=[0,0,1],d=mM([]);return yM(d,d,s?-Ve(a)+Math.PI:Ve(a)),gM(d,d,-Ve(n)),hM(c,c,d),ki(c,c)}const oU={circle:class extends Pa{constructor(a){super(a,g$)}createBucket(a){return new gb(a)}queryRadius(a){const n=a;return Ih("circle-radius",this,n)+Ih("circle-stroke-width",this,n)+__(this.paint.get("circle-translate"))}queryIntersectsFeature(a,n,s,c,d,g,v,w){const S=FM(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),P=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return $M(a,c,g,v,w,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",S,P)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new Dl(this,a)}},heatmap:class extends Pa{createBucket(a){return new UM(a)}constructor(a){super(a,x$),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xb({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return Ih("heatmap-radius",this,a)}queryIntersectsFeature(a,n,s,c,d,g,v,w){const S=this.paint.get("heatmap-radius").evaluate(n,s);return $M(a,c,g,v,w,!0,!0,new ge(0,0),S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new Dl(this,a)}},hillshade:class extends Pa{constructor(a){super(a,b$)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Pa{constructor(a){super(a,B$)}getProgramIds(){const a=this.paint.get("fill-pattern"),n=a&&a.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getProgramConfiguration(a){return new Dl(this,a)}recalculate(a,n){super.recalculate(a,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new T_(a)}queryRadius(){return __(this.paint.get("fill-translate"))}queryIntersectsFeature(a,n,s,c,d,g){return!a.queryGeometry.isAboveHorizon&&LM(jM(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends Pa{constructor(a){super(a,Q$)}createBucket(a){return new Kp(a)}queryRadius(){return __(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new Dl(this,a)}queryIntersectsFeature(a,n,s,c,d,g,v,w,S){const P=FM(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),I=this.paint.get("fill-extrusion-height").evaluate(n,s),D=this.paint.get("fill-extrusion-base").evaluate(n,s),z=[0,0],N=w&&g.elevation,W=g.elevation?g.elevation.exaggeration():1,J=a.tile.getBucket(this);if(N&&J instanceof Kp){const me=J.centroidVertexArray,Se=S+1;Se<me.length&&(z[0]=me.geta_centroid_pos0(Se),z[1]=me.geta_centroid_pos1(Se))}if(z[0]===0&&z[1]===1)return!1;g.projection.name==="globe"&&(c=aC([c],[new ge(0,0),new ge(Ut,Ut)],a.tileID.canonical).map(me=>me.polygon).flat());const te=N?w:null,[le,ye]=function(me,Se,we,Ze,Ue,Qe,mt,Xe,it,ot,ht){return me.projection.name==="globe"?function(vt,Ye,Et,Lt,At,tr,bt,Ft,rr,vr,nr){const Gt=[],Yr=[],ar=vt.projection.upVectorScale(nr,vt.center.lat,vt.worldSize).metersToTile,sr=[0,0,0,1],$r=[0,0,0,1],Wr=(Nr,cn,_n,Dn)=>{Nr[0]=cn,Nr[1]=_n,Nr[2]=Dn,Nr[3]=1},qr=oC();Et>0&&(Et+=qr),Lt+=qr;for(const Nr of Ye){const cn=[],_n=[];for(const Dn of Nr){const Ur=Dn.x+At.x,Nn=Dn.y+At.y,Ln=vt.projection.projectTilePoint(Ur,Nn,nr),pn=vt.projection.upVector(nr,Dn.x,Dn.y);let wr=Et,zn=Lt;if(bt){const Zr=cC(Ur,Nn,Et,Lt,bt,Ft,rr,vr);wr+=Zr.base,zn+=Zr.top}Et!==0?Wr(sr,Ln.x+pn[0]*ar*wr,Ln.y+pn[1]*ar*wr,Ln.z+pn[2]*ar*wr):Wr(sr,Ln.x,Ln.y,Ln.z),Wr($r,Ln.x+pn[0]*ar*zn,Ln.y+pn[1]*ar*zn,Ln.z+pn[2]*ar*zn),Sn(sr,sr,tr),Sn($r,$r,tr),cn.push(new Lh(sr[0],sr[1],sr[2])),_n.push(new Lh($r[0],$r[1],$r[2]))}Gt.push(cn),Yr.push(_n)}return[Gt,Yr]}(me,Se,we,Ze,Ue,Qe,mt,Xe,it,ot,ht):mt?function(vt,Ye,Et,Lt,At,tr,bt,Ft,rr){const vr=[],nr=[],Gt=[0,0,0,1];for(const Yr of vt){const ar=[],sr=[];for(const $r of Yr){const Wr=$r.x+Lt.x,qr=$r.y+Lt.y,Nr=cC(Wr,qr,Ye,Et,tr,bt,Ft,rr);Gt[0]=Wr,Gt[1]=qr,Gt[2]=Nr.base,Gt[3]=1,tc(Gt,Gt,At),Gt[3]=Math.max(Gt[3],1e-5);const cn=new Lh(Gt[0]/Gt[3],Gt[1]/Gt[3],Gt[2]/Gt[3]);Gt[0]=Wr,Gt[1]=qr,Gt[2]=Nr.top,Gt[3]=1,tc(Gt,Gt,At),Gt[3]=Math.max(Gt[3],1e-5);const _n=new Lh(Gt[0]/Gt[3],Gt[1]/Gt[3],Gt[2]/Gt[3]);ar.push(cn),sr.push(_n)}vr.push(ar),nr.push(sr)}return[vr,nr]}(Se,we,Ze,Ue,Qe,mt,Xe,it,ot):function(vt,Ye,Et,Lt,At){const tr=[],bt=[],Ft=At[8]*Ye,rr=At[9]*Ye,vr=At[10]*Ye,nr=At[11]*Ye,Gt=At[8]*Et,Yr=At[9]*Et,ar=At[10]*Et,sr=At[11]*Et;for(const $r of vt){const Wr=[],qr=[];for(const Nr of $r){const cn=Nr.x+Lt.x,_n=Nr.y+Lt.y,Dn=At[0]*cn+At[4]*_n+At[12],Ur=At[1]*cn+At[5]*_n+At[13],Nn=At[2]*cn+At[6]*_n+At[14],Ln=At[3]*cn+At[7]*_n+At[15],pn=Dn+Ft,wr=Ur+rr,zn=Nn+vr,Zr=Math.max(Ln+nr,1e-5),zi=Dn+Gt,Rn=Ur+Yr,oi=Nn+ar,Yn=Math.max(Ln+sr,1e-5);Wr.push(new Lh(pn/Zr,wr/Zr,zn/Zr)),qr.push(new Lh(zi/Yn,Rn/Yn,oi/Yn))}tr.push(Wr),bt.push(qr)}return[tr,bt]}(Se,we,Ze,Ue,Qe)}(g,c,D,I,P,v,te,z,W,g.center.lat,a.tileID.canonical),ce=a.queryGeometry;return function(me,Se,we){let Ze=1/0;LM(we,Se)&&(Ze=uC(we,Se[0]));for(let Ue=0;Ue<Se.length;Ue++){const Qe=Se[Ue],mt=me[Ue];for(let Xe=0;Xe<Qe.length-1;Xe++){const it=Qe[Xe],ot=[it,Qe[Xe+1],mt[Xe+1],mt[Xe],it];DM(we,ot)&&(Ze=Math.min(Ze,uC(we,ot)))}}return Ze!==1/0&&Ze}(le,ye,ce.isPointQuery()?ce.screenBounds:ce.screenGeometry)}},line:class extends Pa{constructor(a){super(a,hC),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof rp,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,n){super.recalculate(a,n),this.paint._values["line-floorwidth"]=fC.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new M_(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new Dl(this,a)}queryRadius(a){const n=a,s=dC(Ih("line-width",this,n),Ih("line-gap-width",this,n)),c=Ih("line-offset",this,n);return s/2+Math.abs(c)+__(this.paint.get("line-translate"))}queryIntersectsFeature(a,n,s,c,d,g){if(a.queryGeometry.isAboveHorizon)return!1;const v=jM(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),w=a.pixelToTileUnitsFactor/2*dC(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),S=this.paint.get("line-offset").evaluate(n,s);return S&&(c=function(P,I){const D=[],z=new ge(0,0);for(let N=0;N<P.length;N++){const W=P[N],J=[];for(let te=0;te<W.length;te++){const le=W[te],ye=W[te+1],ce=te===0?z:le.sub(W[te-1])._unit()._perp(),me=te===W.length-1?z:ye.sub(le)._unit()._perp(),Se=ce._add(me)._unit();Se._mult(1/(Se.x*me.x+Se.y*me.y)),J.push(Se._mult(I)._add(le))}D.push(J)}return D}(c,S*a.pixelToTileUnitsFactor)),function(P,I,D){for(let z=0;z<I.length;z++){const N=I[z];if(P.length>=3){for(let W=0;W<N.length;W++)if(oc(P,N[W]))return!0}if(f$(P,N,D))return!0}return!1}(v,c,w)}isTileClipped(){return!0}},symbol:U_,background:class extends Pa{constructor(a){super(a,tU)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Pa{constructor(a){super(a,rU)}getProgramIds(){return["raster"]}},sky:class extends Pa{constructor(a){super(a,iU),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="sky-gradient"?this._updateColorRamp():a!=="sky-atmosphere-sun"&&a!=="sky-atmosphere-halo-color"&&a!=="sky-atmosphere-color"&&a!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=xb({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(a,n){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),d=!c,g=a.style.light,v=g.properties.get("position");return d&&g.properties.get("anchor")==="viewport"&&ir("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?Gb(v.azimuthal,90-v.polar,n):Gb(c[0],90-c[1],n)}const s=this.paint.get("sky-gradient-center");return Gb(s[0],90-s[1],n)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return a==="atmosphere"?["skyboxCapture","skybox"]:a==="gradient"?["skyboxGradient"]:null}}};class sm{constructor(n,s,c,d){this.context=n,this.format=c,this.texture=n.gl.createTexture(),this.update(s,d)}update(n,s,c){const{width:d,height:g}=n,{context:v}=this,{gl:w}=v,{HTMLImageElement:S,HTMLCanvasElement:P,HTMLVideoElement:I,ImageData:D,ImageBitmap:z}=x;if(w.bindTexture(w.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!s||s.premultiply!==!1)),c||this.size&&this.size[0]===d&&this.size[1]===g){const{x:N,y:W}=c||{x:0,y:0};n instanceof S||n instanceof P||n instanceof I||n instanceof D||z&&n instanceof z?w.texSubImage2D(w.TEXTURE_2D,0,N,W,w.RGBA,w.UNSIGNED_BYTE,n):w.texSubImage2D(w.TEXTURE_2D,0,N,W,d,g,w.RGBA,w.UNSIGNED_BYTE,n.data)}else this.size=[d,g],n instanceof S||n instanceof P||n instanceof I||n instanceof D||z&&n instanceof z?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,n):w.texImage2D(w.TEXTURE_2D,0,this.format,d,g,0,this.format,w.UNSIGNED_BYTE,n.data);this.useMipmap=!!(s&&s.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(n,s){const{context:c}=this,{gl:d}=c;d.bindTexture(d.TEXTURE_2D,this.texture),n!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,n),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?n===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_NEAREST:n),this.filter=n),s!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class aU{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class sU{constructor(){this.tasks={},this.taskQueue=[],Xt(["process"],this),this.invoker=new aU(this.process),this.nextId=0}add(n,s){const c=this.nextId++,d=function({type:g,isSymbolTile:v,zoom:w}){return w=w||0,g==="message"?0:g!=="maybePrepare"||v?g!=="parseTile"||v?g==="parseTile"&&v?300-w:g==="maybePrepare"&&v?400-w:500:200-w:100-w}(s);if(d===0){$n();try{n()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:n,metadata:s,priority:d,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){$n();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let n=null,s=1/0;for(let d=0;d<this.taskQueue.length;d++){const g=this.tasks[this.taskQueue[d]];g.priority<s&&(s=g.priority,n=d)}if(n===null)return null;const c=this.taskQueue[n];return this.taskQueue.splice(n,1),c}remove(){this.invoker.remove()}}class YC{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const c=n[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const lU=["tile","layer","source","sourceLayer","state"];class JC{constructor(n,s,c,d,g){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=c,this._y=d,this.properties=n.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(n.id=this.id);for(const s of lU)this[s]!==void 0&&(n[s]=this[s]);return n}}const Ho=32,as=33,Fl=new Uint16Array(8184);for(let a=0;a<2046;a++){let n=a+2,s=0,c=0,d=0,g=0,v=0,w=0;for(1&n?d=g=v=Ho:s=c=w=Ho;(n>>=1)>1;){const P=s+d>>1,I=c+g>>1;1&n?(d=s,g=c,s=v,c=w):(s=d,c=g,d=v,g=w),v=P,w=I}const S=4*a;Fl[S+0]=s,Fl[S+1]=c,Fl[S+2]=d,Fl[S+3]=g}const ss=new Uint16Array(2178),$l=new Uint8Array(1089),V_=new Uint16Array(1089);function QC(a){return a===0?-.03125:a===32?.03125:0}var eO=ze([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const tO={type:2,extent:Ut,loadGeometry:()=>[[new ge(0,0),new ge(Ut+1,0),new ge(Ut+1,Ut+1),new ge(0,Ut+1),new ge(0,0)]]};class Wb{constructor(n,s,c,d,g){this.tileID=n,this.uid=Tr(),this.uses=0,this.tileSize=s,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=g,this.expiredRequestCount=0,this.state="loading",d&&d.transform&&(this.projection=d.transform.projection)}registerFadeDuration(n){const s=n+this.timeAdded;s<ma.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=sc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,s,c){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(d,g){const v={};if(!g)return v;for(const w of d){const S=w.layerIds.map(P=>g.getLayer(P)).filter(Boolean);if(S.length!==0){w.layers=S,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(P=>S.filter(I=>I.id===P)[0]));for(const P of S)v[P.id]=w}}return v}(n.buckets,s.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const g=this.buckets[d];if(g instanceof jl){if(this.hasSymbolBuckets=!0,!c)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const g=this.buckets[d];if(g instanceof jl&&g.hasRTLText){this.hasRTLText=!0,C.isLoading()||C.isLoaded()||T()!=="deferred"||M();break}}this.queryPadding=0;for(const d in this.buckets){const g=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(d).queryRadius(g))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas)}else this.collisionBoxArray=new jr}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(n){return this.buckets[n.id]}upload(n){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(n)}const s=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new sm(n,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new sm(n,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new sm(n,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,s,c,d,g,v,w,S){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:d,pixelPosMatrix:w,transform:v,params:g,tileTransform:this.tileTransform},n,s,c):{}}querySourceFeatures(n,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),g=s?s.sourceLayer:"",v=d._geojsonTileLayer||d[g];if(!v)return;const w=vh(s&&s.filter),{z:S,x:P,y:I}=this.tileID.canonical,D={z:S,x:P,y:I};for(let z=0;z<v.length;z++){const N=v.feature(z);if(w.needGeometry){const te=ic(N,!0);if(!w.filter(new k(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!w.filter(new k(this.tileID.overscaledZ),N))continue;const W=c.getId(N,g),J=new JC(N,S,P,I,W);J.tile=D,n.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const s=this.expirationTime;if(n.cacheControl){const c=tn(n.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(s)if(this.expirationTime<s)d=!0;else{const g=this.expirationTime-s;g?this.expirationTime=c+Math.max(g,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0||!s)return;const c=this.latestFeatureIndex.loadVTLayers(),d=s.style.listImages();for(const g in this.buckets){if(!s.style.hasLayer(g))continue;const v=this.buckets[g],w=v.layers[0].sourceLayer||"_geojsonTileLayer",S=c[w],P=n[w];if(!S||!P||Object.keys(P).length===0)continue;if(v.update(P,S,d,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof M_||v instanceof T_){const D=s.style._getSourceCache(v.layers[0].source);s._terrain&&s._terrain.enabled&&D&&v.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(D.id,this.tileID)}const I=s&&s.style&&s.style.getLayer(g);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ma.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=ma.now()+n}setTexture(n,s){const c=s.context,d=c.gl;this.texture=this.texture||s.getTileTexture(n.width),this.texture?this.texture.update(n,{useMipmap:!0}):(this.texture=new sm(c,n,d.RGBA,{useMipmap:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE))}setDependencies(n,s){const c={};for(const d of s)c[d]=!0;this.dependencies[n]=c}hasDependency(n,s){for(const c of n){const d=this.dependencies[c];if(d){for(const g of s)if(d[g])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const c=js(tO,this.tileID.canonical,this.tileTransform)[0],d=new pt,g=new lo;for(let v=0;v<c.length;v++){const{x:w,y:S}=c[v];d.emplaceBack(w,S),g.emplaceBack(v)}g.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(g),this._tileDebugBuffer=n.createVertexBuffer(d,Fp.members),this._tileDebugSegments=In.simpleSegment(0,0,d.length,g.length)}_makeTileBoundsBuffers(n,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const c=js(tO,this.tileID.canonical,this.tileTransform)[0];let d,g;if(this.isRaster){const v=function(w,S){const P=sc(w,S),I=Math.pow(2,w.z);for(let te=0;te<as;te++)for(let le=0;le<as;le++){const ye=Eo((w.x+(le+QC(le))/Ho)/I),ce=gi((w.y+(te+QC(te))/Ho)/I),me=S.project(ye,ce),Se=te*as+le;ss[2*Se+0]=Math.round((me.x*P.scale-P.x)*Ut),ss[2*Se+1]=Math.round((me.y*P.scale-P.y)*Ut)}$l.fill(0),V_.fill(0);for(let te=2045;te>=0;te--){const le=4*te,ye=Fl[le+0],ce=Fl[le+1],me=Fl[le+2],Se=Fl[le+3],we=ye+me>>1,Ze=ce+Se>>1,Ue=we+Ze-ce,Qe=Ze+ye-we,mt=ce*as+ye,Xe=Se*as+me,it=Ze*as+we,ot=Math.hypot((ss[2*mt+0]+ss[2*Xe+0])/2-ss[2*it+0],(ss[2*mt+1]+ss[2*Xe+1])/2-ss[2*it+1])>=16;$l[it]=$l[it]||(ot?1:0),te<1022&&($l[it]=$l[it]||$l[(ce+Qe>>1)*as+(ye+Ue>>1)]||$l[(Se+Qe>>1)*as+(me+Ue>>1)])}const D=new nt,z=new Bt;let N=0;function W(te,le){const ye=le*as+te;return V_[ye]===0&&(D.emplaceBack(ss[2*ye+0],ss[2*ye+1],te*Ut/Ho,le*Ut/Ho),V_[ye]=++N),V_[ye]-1}function J(te,le,ye,ce,me,Se){const we=te+ye>>1,Ze=le+ce>>1;if(Math.abs(te-me)+Math.abs(le-Se)>1&&$l[Ze*as+we])J(me,Se,te,le,we,Ze),J(ye,ce,me,Se,we,Ze);else{const Ue=W(te,le),Qe=W(ye,ce),mt=W(me,Se);z.emplaceBack(Ue,Qe,mt)}}return J(0,0,Ho,Ho,Ho,0),J(Ho,Ho,0,0,0,Ho),{vertices:D,indices:z}}(this.tileID.canonical,s);d=v.vertices,g=v.indices}else{d=new nt,g=new Bt;for(const{x:w,y:S}of c)d.emplaceBack(w,S,0,0);const v=Eb(d.int16,void 0,4);for(let w=0;w<v.length;w+=3)g.emplaceBack(v[w],v[w+1],v[w+2])}this._tileBoundsBuffer=n.createVertexBuffer(d,eO.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(g),this._tileBoundsSegments=In.simpleSegment(0,0,d.length,g.length)}_makeGlobeTileDebugBuffers(n,s){const c=s.projection;if(!c||c.name!=="globe"||s.freezeTileCoverage)return;const d=this.tileID.canonical,g=Up(wM(d,s)),v=Ch(s.zoom);let w;v>0&&(w=Q1(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,d,s,g,w,v),this._makeGlobeTileDebugTextBuffer(n,d,s,g,w,v)}_globePoint(n,s,c,d,g,v,w){let S=Np(n,s,c);if(v){const P=1<<c.z,I=is(d.center.lng),D=os(d.center.lat),z=(c.x+.5)/P-I;let N=0;z>.5?N=-1:z<-.5&&(N=1);let W=(n/Ut+c.x)/P+N,J=(s/Ut+c.y)/P;W=(W-I)*d._pixelsPerMercatorPixel+I,J=(J-D)*d._pixelsPerMercatorPixel+D;const te=[W*d.worldSize,J*d.worldSize,0];Sn(te,te,v),S=nc(S,te,w)}return Sn(S,S,g)}_makeGlobeTileDebugBorderBuffer(n,s,c,d,g,v){const w=new pt,S=new lo,P=new Ne,I=(z,N,W,J,te)=>{const le=(W-z)/(te-1),ye=(J-N)/(te-1),ce=w.length;for(let me=0;me<te;me++){const Se=z+me*le,we=N+me*ye;w.emplaceBack(Se,we);const Ze=this._globePoint(Se,we,s,c,d,g,v);P.emplaceBack(Ze[0],Ze[1],Ze[2]),S.emplaceBack(ce+me)}},D=Ut;I(0,0,D,0,16),I(D,0,D,D,16),I(D,D,0,D,16),I(0,D,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(S),this._tileDebugBuffer=n.createVertexBuffer(w,Fp.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(P,vM.members),this._tileDebugSegments=In.simpleSegment(0,0,w.length,S.length)}_makeGlobeTileDebugTextBuffer(n,s,c,d,g,v){const w=Ut/4,S=new pt,P=new Bt,I=new Ne,D=25;P.reserve(32),S.reserve(D),I.reserve(D);const z=(N,W)=>D*N+W;for(let N=0;N<D;N++){const W=N*w;for(let J=0;J<D;J++){const te=J*w;S.emplaceBack(te,W);const le=this._globePoint(te,W,s,c,d,g,v);I.emplaceBack(le[0],le[1],le[2])}}for(let N=0;N<4;N++)for(let W=0;W<4;W++){const J=z(N,W),te=z(N,W+1),le=z(N+1,W),ye=z(N+1,W+1);P.emplaceBack(J,te,le),P.emplaceBack(le,te,ye)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(P),this._tileDebugTextBuffer=n.createVertexBuffer(S,Fp.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(I,vM.members),this._tileDebugTextSegments=In.simpleSegment(0,0,D,32)}}class uU{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,s,c){const d=String(s);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][d]=this.stateChanges[n][d]||{},St(this.stateChanges[n][d],c),this.deletedStates[n]===null){this.deletedStates[n]={};for(const g in this.state[n])g!==d&&(this.deletedStates[n][g]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][d]===null){this.deletedStates[n][d]={};for(const g in this.state[n][d])c[g]||(this.deletedStates[n][d][g]=null)}else for(const g in c)this.deletedStates[n]&&this.deletedStates[n][d]&&this.deletedStates[n][d][g]===null&&delete this.deletedStates[n][d][g]}removeFeatureState(n,s,c){if(this.deletedStates[n]===null)return;const d=String(s);if(this.deletedStates[n]=this.deletedStates[n]||{},c&&s!==void 0)this.deletedStates[n][d]!==null&&(this.deletedStates[n][d]=this.deletedStates[n][d]||{},this.deletedStates[n][d][c]=null);else if(s!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][d])for(c in this.deletedStates[n][d]={},this.stateChanges[n][d])this.deletedStates[n][d][c]=null;else this.deletedStates[n][d]=null;else this.deletedStates[n]=null}getState(n,s){const c=String(s),d=St({},(this.state[n]||{})[c],(this.stateChanges[n]||{})[c]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const g=this.deletedStates[n][s];if(g===null)return{};for(const v in g)delete d[v]}return d}initializeTileState(n,s){n.setFeatureState(this.state,s)}coalesceChanges(n,s){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const g={};for(const v in this.stateChanges[d])this.state[d][v]||(this.state[d][v]={}),St(this.state[d][v],this.stateChanges[d][v]),g[v]=this.state[d][v];c[d]=g}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const g={};if(this.deletedStates[d]===null)for(const v in this.state[d])g[v]={},this.state[d][v]={};else for(const v in this.deletedStates[d]){if(this.deletedStates[d][v]===null)this.state[d][v]={};else if(this.state[d][v])for(const w of Object.keys(this.deletedStates[d][v]))delete this.state[d][v][w];g[v]=this.state[d][v]}c[d]=c[d]||{},St(c[d],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const d in n)n[d].setFeatureState(c,s)}}class rO{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const c=this.toIdx(n,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function nO(a,n,s,c){let d=0,g=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(c[v])<1e-15){if(s[v]<a[v]||s[v]>n[v])return null}else{const w=1/c[v];let S=(a[v]-s[v])*w,P=(n[v]-s[v])*w;if(S>P){const I=S;S=P,P=I}if(S>d&&(d=S),P<g&&(g=P),d>g)return null}return d}function iO(a,n,s,c,d,g,v,w,S,P,I){const D=c-a,z=d-n,N=g-s,W=v-a,J=w-n,te=S-s,le=I[1]*te-I[2]*J,ye=I[2]*W-I[0]*te,ce=I[0]*J-I[1]*W,me=D*le+z*ye+N*ce;if(Math.abs(me)<1e-15)return null;const Se=1/me,we=P[0]-a,Ze=P[1]-n,Ue=P[2]-s,Qe=(we*le+Ze*ye+Ue*ce)*Se;if(Qe<0||Qe>1)return null;const mt=Ze*N-Ue*z,Xe=Ue*D-we*N,it=we*z-Ze*D,ot=(I[0]*mt+I[1]*Xe+I[2]*it)*Se;return ot<0||Qe+ot>1?null:(W*mt+J*Xe+te*it)*Se}function oO(a,n,s){return(a-n)/(s-n)}function aO(a,n,s,c,d,g,v,w,S){const P=1<<s,I=g-c,D=v-d,z=(a+1)/P*I+c,N=(n+0)/P*D+d,W=(n+1)/P*D+d;w[0]=(a+0)/P*I+c,w[1]=N,S[0]=z,S[1]=W}class sO{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(g){const v=Math.ceil(Math.log2(g.dim/8)),w=[];let S=Math.ceil(Math.pow(2,v));const P=1/S,I=(N,W,J,te,le)=>{const ye=te?1:0,ce=(N+1)*J-ye,me=W*J,Se=(W+1)*J-ye;le[0]=N*J,le[1]=me,le[2]=ce,le[3]=Se};let D=new rO(S);const z=[];for(let N=0;N<S*S;N++){I(N%S,Math.floor(N/S),P,!1,z);const W=Nl(z[0],z[1],g),J=Nl(z[2],z[1],g),te=Nl(z[2],z[3],g),le=Nl(z[0],z[3],g);D.minimums.push(Math.min(W,J,te,le)),D.maximums.push(Math.max(W,J,te,le)),D.leaves.push(1)}for(w.push(D),S/=2;S>=1;S/=2){const N=w[w.length-1];D=new rO(S);for(let W=0;W<S*S;W++){I(W%S,Math.floor(W/S),2,!0,z);const J=N.getElevation(z[0],z[1]),te=N.getElevation(z[2],z[1]),le=N.getElevation(z[2],z[3]),ye=N.getElevation(z[0],z[3]),ce=N.isLeaf(z[0],z[1]),me=N.isLeaf(z[2],z[1]),Se=N.isLeaf(z[2],z[3]),we=N.isLeaf(z[0],z[3]),Ze=Math.min(J.min,te.min,le.min,ye.min),Ue=Math.max(J.max,te.max,le.max,ye.max),Qe=ce&&me&&Se&&we;D.maximums.push(Ue),D.minimums.push(Ze),D.leaves.push(Ue-Ze<=5&&Qe?1:0)}w.push(D)}return w}(this.dem),c=s.length-1,d=s[c];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(n,s,c,d,g,v,w=1){return nO([n,s,-100],[c,d,this.maximums[0]*w],g,v)}raycast(n,s,c,d,g,v,w=1){if(!this.nodeCount)return null;const S=this.raycastRoot(n,s,c,d,g,v,w);if(S==null)return null;const P=[],I=[],D=[],z=[],N=[{idx:0,t:S,nodex:0,nodey:0,depth:0}];for(;N.length>0;){const{idx:W,t:J,nodex:te,nodey:le,depth:ye}=N.pop();if(this.leaves[W]){aO(te,le,ye,n,s,c,d,D,z);const me=1<<ye,Se=(te+0)/me,we=(te+1)/me,Ze=(le+0)/me,Ue=(le+1)/me,Qe=Nl(Se,Ze,this.dem)*w,mt=Nl(we,Ze,this.dem)*w,Xe=Nl(we,Ue,this.dem)*w,it=Nl(Se,Ue,this.dem)*w,ot=iO(D[0],D[1],Qe,z[0],D[1],mt,z[0],z[1],Xe,g,v),ht=iO(z[0],z[1],Xe,D[0],z[1],it,D[0],D[1],Qe,g,v),vt=Math.min(ot!==null?ot:Number.MAX_VALUE,ht!==null?ht:Number.MAX_VALUE);if(vt!==Number.MAX_VALUE)return vt;{const Ye=Bp([],g,v,J);if(lO(Qe,mt,it,Xe,oO(Ye[0],D[0],z[0]),oO(Ye[1],D[1],z[1]))>=Ye[2])return J}continue}let ce=0;for(let me=0;me<this._siblingOffset.length;me++){aO((te<<1)+this._siblingOffset[me][0],(le<<1)+this._siblingOffset[me][1],ye+1,n,s,c,d,D,z),D[2]=-100,z[2]=this.maximums[this.childOffsets[W]+me]*w;const Se=nO(D,z,g,v);if(Se!=null){const we=Se;P[me]=we;let Ze=!1;for(let Ue=0;Ue<ce&&!Ze;Ue++)we>=P[I[Ue]]&&(I.splice(Ue,0,me),Ze=!0);Ze||(I[ce]=me),ce++}}for(let me=0;me<ce;me++){const Se=I[me];N.push({idx:this.childOffsets[W]+Se,t:P[Se],nodex:(te<<1)+this._siblingOffset[Se][0],nodey:(le<<1)+this._siblingOffset[Se][1],depth:ye+1})}}return null}_addNode(n,s,c){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,c,d,g){if(n[d].isLeaf(s,c)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const v=d-1,w=n[v];let S=0,P=0;for(let I=0;I<this._siblingOffset.length;I++){const D=2*s+this._siblingOffset[I][0],z=2*c+this._siblingOffset[I][1],N=w.getElevation(D,z),W=w.isLeaf(D,z),J=this._addNode(N.min,N.max,W);W&&(S|=1<<I),P||(P=J)}for(let I=0;I<this._siblingOffset.length;I++)S&1<<I||this._construct(n,2*s+this._siblingOffset[I][0],2*c+this._siblingOffset[I][1],v,P+I)}}function lO(a,n,s,c,d,g){return gr(gr(a,s,g),gr(n,c,g),d)}function Nl(a,n,s){const c=s.dim,d=Oe(a*c-.5,0,c-1),g=Oe(n*c-.5,0,c-1),v=Math.floor(d),w=Math.floor(g),S=Math.min(v+1,c-1),P=Math.min(w+1,c-1);return lO(s.get(v,w),s.get(S,w),s.get(v,P),s.get(S,P),d-v,g-w)}const uO={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function cU(a,n,s){return(256*a*256+256*n+s)/10-1e4}function hU(a,n,s){return 256*a+n+s/256-32768}class G_{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,c,d=!1,g=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return ir(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const v=this.dim=s.height-2,w=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.encoding=c||"mapbox",this.borderReady=d,!d){for(let S=0;S<v;S++)w[this._idx(-1,S)]=w[this._idx(0,S)],w[this._idx(v,S)]=w[this._idx(v-1,S)],w[this._idx(S,-1)]=w[this._idx(S,0)],w[this._idx(S,v)]=w[this._idx(S,v-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(v,-1)]=w[this._idx(v-1,0)],w[this._idx(-1,v)]=w[this._idx(0,v-1)],w[this._idx(v,v)]=w[this._idx(v-1,v-1)],g&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new sO(this)}get(n,s,c=!1){c&&(n=Oe(n,-1,this.dim),s=Oe(s,-1,this.dim));const d=4*this._idx(n,s);return(this.encoding==="terrarium"?hU:cU)(this.pixels[d],this.pixels[d+1],this.pixels[d+2])}static getUnpackVector(n){return uO[n]}get unpackVector(){return uO[this.encoding]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const c=[0,0,0,0],d=G_.getUnpackVector(s);let g=Math.floor((n+d[3])/d[2]);return c[2]=g%256,g=Math.floor(g/256),c[1]=g%256,g=Math.floor(g/256),c[0]=g,c}getPixels(){return new co({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,c){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let d=s*this.dim,g=s*this.dim+this.dim,v=c*this.dim,w=c*this.dim+this.dim;switch(s){case-1:d=g-1;break;case 1:g=d+1}switch(c){case-1:v=w-1;break;case 1:w=v+1}const S=-s*this.dim,P=-c*this.dim;for(let I=v;I<w;I++)for(let D=d;D<g;D++){const z=4*this._idx(D,I),N=4*this._idx(D+S,I+P);this.pixels[z+0]=n.pixels[N+0],this.pixels[z+1]=n.pixels[N+1],this.pixels[z+2]=n.pixels[N+2],this.pixels[z+3]=n.pixels[N+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}It(G_,"DEMData"),It(sO,"DemMinMaxQuadTree",{omit:["dem"]});class fU{constructor(n,s){this.max=n,this.onRemove=s,this.reset()}reset(){for(const n in this.data)for(const s of this.data[n])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(n,s,c){const d=n.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const g={value:s,timeout:void 0};if(c!==void 0&&(g.timeout=setTimeout(()=>{this.remove(n,g)},c)),this.data[d].push(g),this.order.push(d),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value}getByKey(n){const s=this.data[n];return s?s[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,s){if(!this.has(n))return this;const c=n.wrapped().key,d=s===void 0?0:this.data[c].indexOf(s),g=this.data[c][d];return this.data[c].splice(d,1),g.timeout&&clearTimeout(g.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(g.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(n){const s=[];for(const c in this.data)for(const d of this.data[c])n(d.value)||s.push(d);for(const c of s)this.remove(c.value.tileID,c)}}class Gh{constructor(n,s,c){this.func=n,this.mask=s,this.range=c}}Gh.ReadOnly=!1,Gh.ReadWrite=!0,Gh.disabled=new Gh(519,Gh.ReadOnly,[0,1]);const qb=7680;class Zb{constructor(n,s,c,d,g,v){this.test=n,this.ref=s,this.mask=c,this.fail=d,this.depthFail=g,this.pass=v}}Zb.disabled=new Zb({func:519,mask:0},0,0,qb,qb,qb);class ls{constructor(n,s,c){this.blendFunction=n,this.blendColor=s,this.mask=c}}ls.Replace=[1,0],ls.disabled=new ls(ls.Replace,Tn.transparent,[!1,!1,!1,!1]),ls.unblended=new ls(ls.Replace,Tn.transparent,[!0,!0,!0,!0]),ls.alphaBlended=new ls([1,771],Tn.transparent,[!0,!0,!0,!0]);const Hb=1029,Xb=2305;class Da{constructor(n,s,c){this.enable=n,this.mode=s,this.frontFace=c}}Da.disabled=new Da(!1,Hb,Xb),Da.backCCW=new Da(!0,Hb,Xb),Da.backCW=new Da(!0,Hb,2304),Da.frontCW=new Da(!0,1028,2304),Da.frontCCW=new Da(!0,1028,Xb);class lc extends Eu{constructor(n,s,c){super(),this.id=n,this._onlySymbols=c,s.on("data",d=>{d.dataType==="source"&&d.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new fU(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new uU,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const s=this._tiles[n];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,s){return n.isSymbolTile=this._onlySymbols,this._source.loadTile(n,s)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n,()=>{})}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(n),c.prepare(this.map.style.imageManager)}}getIds(){return Ot(this._tiles).map(n=>n.tileID).sort(cO).map(n=>n.key)}getRenderableIds(n){const s=[];for(const c in this._tiles)this._isIdRenderable(+c,n)&&s.push(this._tiles[c]);return n?s.sort((c,d)=>{const g=c.tileID,v=d.tileID,w=new ge(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),S=new ge(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-v.overscaledZ||S.y-w.y||S.x-w.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(cO).map(c=>c.key)}hasRenderableParent(n){const s=this.findLoadedParent(n,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(n,s){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(s||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,s){const c=this._tiles[n];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,n,s)))}_tileLoaded(n,s,c,d){if(d)if(n.state="errored",d.status!==404)this._source.fire(new ga(d,{tile:n}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const g=this.map.painter.terrain;this.update(this.transform,g.getScaledDemTileSize(),!0),g.resetTileLookupCache(this.id)}else this.update(this.transform);else n.timeAdded=ma.now(),c==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(s,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new Ss("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const s=this.getRenderableIds();for(let d=0;d<s.length;d++){const g=s[d];if(n.neighboringTiles&&n.neighboringTiles[g]){const v=this.getTileByID(g);c(n,v),c(v,n)}}function c(d,g){if(!d.dem||d.dem.borderReady)return;d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0;let v=g.tileID.canonical.x-d.tileID.canonical.x;const w=g.tileID.canonical.y-d.tileID.canonical.y,S=Math.pow(2,d.tileID.canonical.z),P=g.tileID.key;v===0&&w===0||Math.abs(w)>1||(Math.abs(v)>1&&(Math.abs(v+S)===1?v+=S:Math.abs(v-S)===1&&(v-=S)),g.dem&&d.dem&&(d.dem.backfillBorder(g.dem,v,w),d.neighboringTiles&&d.neighboringTiles[P]&&(d.neighboringTiles[P].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,s,c,d){for(const g in this._tiles){let v=this._tiles[g];if(d[g]||!v.hasData()||v.tileID.overscaledZ<=s||v.tileID.overscaledZ>c)continue;let w=v.tileID;for(;v&&v.tileID.overscaledZ>s+1;){const P=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[P.key],v&&v.hasData()&&(w=P)}let S=w;for(;S.overscaledZ>s;)if(S=S.scaledTo(S.overscaledZ-1),n[S.key]){d[w.key]=w;break}}}findLoadedParent(n,s){if(n.key in this._loadedParentTiles){const c=this._loadedParentTiles[n.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=n.overscaledZ-1;c>=s;c--){const d=n.scaledTo(c),g=this._getLoadedTile(d);if(g)return g}}_getLoadedTile(n){const s=this._tiles[n.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,s){s=s||this._source.tileSize;const c=Math.ceil(n.width/s)+1,d=Math.ceil(n.height/s)+1,g=Math.floor(c*d*5),v=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,g):g,w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(w)}handleWrapJump(n){const s=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,s){const c={};for(const d in this._tiles){const g=this._tiles[d];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+s),c[g.tileID.key]=g}this._tiles=c;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(+d,this._tiles[d])}}update(n,s,c){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let d;this.updateCacheSize(n,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new Li(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(d=n.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(w=>this._source.hasTile(w)))):d=[];const g=this._updateRetainedTiles(d);if(hO(this._source.type)&&d.length!==0){const w={},S={},P=Object.keys(g);for(const D of P){const z=g[D],N=this._tiles[D];if(!N||N.fadeEndTime&&N.fadeEndTime<=ma.now())continue;const W=this.findLoadedParent(z,Math.max(z.overscaledZ-lc.maxOverzooming,this._source.minzoom));W&&(this._addTile(W.tileID),w[W.tileID.key]=W.tileID),S[D]=z}const I=d[d.length-1].overscaledZ;for(const D in this._tiles){const z=this._tiles[D];if(g[D]||!z.hasData())continue;let N=z.tileID;for(;N.overscaledZ>I;){N=N.scaledTo(N.overscaledZ-1);const W=this._tiles[N.key];if(W&&W.hasData()&&S[N.key]){g[D]=z.tileID;break}}}for(const D in w)g[D]||(this._coveredTiles[D]=!0,g[D]=w[D])}for(const w in g)this._tiles[w].clearFadeHold();const v=function(w,S){const P=[];for(const I in w)I in S||P.push(I);return P}(this._tiles,g);for(const w of v){const S=this._tiles[w];S.hasSymbolBuckets&&!S.holdingForFade()?S.setHoldDuration(this.map._fadeDuration):S.hasSymbolBuckets&&!S.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const s={};if(n.length===0)return s;const c={},d=n.reduce((P,I)=>Math.min(P,I.overscaledZ),1/0),g=n[0].overscaledZ,v=Math.max(g-lc.maxOverzooming,this._source.minzoom),w=Math.max(g+lc.maxUnderzooming,this._source.minzoom),S={};for(const P of n){const I=this._addTile(P);s[P.key]=P,I.hasData()||d<this._source.maxzoom&&(S[P.key]=P)}this._retainLoadedChildren(S,d,w,s);for(const P of n){let I=this._tiles[P.key];if(I.hasData())continue;if(P.canonical.z>=this._source.maxzoom){const z=P.children(this._source.maxzoom)[0],N=this.getTile(z);if(N&&N.hasData()){s[z.key]=z;continue}}else{const z=P.children(this._source.maxzoom);if(s[z[0].key]&&s[z[1].key]&&s[z[2].key]&&s[z[3].key])continue}let D=I.wasRequested();for(let z=P.overscaledZ-1;z>=v;--z){const N=P.scaledTo(z);if(c[N.key]||(c[N.key]=!0,I=this.getTile(N),!I&&D&&(I=this._addTile(N)),I&&(s[N.key]=N,D=I.wasRequested(),I.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const s=[];let c,d=this._tiles[n].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){c=this._loadedParentTiles[d.key];break}s.push(d.key);const g=d.scaledTo(d.overscaledZ-1);if(c=this._getLoadedTile(g),c)break;d=g}for(const g of s)this._loadedParentTiles[g]=c}}_addTile(n){let s=this._tiles[n.key];if(s)return s;s=this._cache.getAndRemove(n),s&&(this._setTileReloadTimer(n.key,s),s.tileID=n,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,s)));const c=!!s;if(!c){const d=this.map?this.map.painter:null;s=new Wb(n,this._source.tileSize*n.overscaleFactor(),this.transform.tileZoom,d,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,n.key,s.state))}return s?(s.uses++,this._tiles[n.key]=s,c||this._source.fire(new Ss("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(n,s){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const c=s.getExpiryTimeout();c&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},c))}_removeTile(n){const s=this._tiles[n];s&&(s.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,s,c){const d=[],g=this.transform;if(!g)return d;const v=g.projection.name==="globe",w=is(g.center.lng);for(const S in this._tiles){const P=this._tiles[S];if(c&&P.clearQueryDebugViz(),P.holdingForFade())continue;let I;if(v){const D=P.tileID.canonical;if(D.z===0){const z=[Math.abs(Oe(w,...lm(D,-1))-w),Math.abs(Oe(w,...lm(D,1))-w)];I=[0,2*z.indexOf(Math.min(...z))-1]}else{const z=[Math.abs(Oe(w,...lm(D,-1))-w),Math.abs(Oe(w,...lm(D,0))-w),Math.abs(Oe(w,...lm(D,1))-w)];I=[z.indexOf(Math.min(...z))-1]}}else I=[0];for(const D of I){const z=n.containsTile(P,g,s,D);z&&d.push(z)}}return d}getVisibleCoordinates(n){const s=this.getRenderableIds(n).map(c=>this._tiles[c].tileID);for(const c of s)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(hO(this._source.type))for(const n in this._tiles){const s=this._tiles[n];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=ma.now())return!0}return!1}setFeatureState(n,s,c){this._state.updateState(n=n||"_geojsonTileLayer",s,c)}removeFeatureState(n,s,c){this._state.removeFeatureState(n=n||"_geojsonTileLayer",s,c)}getFeatureState(n,s){return this._state.getState(n=n||"_geojsonTileLayer",s)}setDependencies(n,s,c){const d=this._tiles[n];d&&d.setDependencies(s,c)}reloadTilesForDependencies(n,s){for(const c in this._tiles)this._tiles[c].hasDependency(n,s)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(n,s))}_preloadTiles(n,s){if(!this._sourceLoaded){const w=()=>{this._sourceLoaded&&(this._source.off("data",w),this._preloadTiles(n,s))};return void this._source.on("data",w)}const c=new Map,d=Array.isArray(n)?n:[n],g=this.map.painter.terrain,v=this.usedForTerrain&&g?g.getScaledDemTileSize():this._source.tileSize;for(const w of d){const S=w.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const P of S)c.set(P.key,P);this.usedForTerrain&&w.updateElevation(!1)}st(Array.from(c.values()),(w,S)=>{const P=new Wb(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(P,I=>{this._source.type==="raster-dem"&&P.dem&&this._backfillDEM(P),S(I,P)})},s)}}function cO(a,n){const s=Math.abs(2*a.wrap)-+(a.wrap<0),c=Math.abs(2*n.wrap)-+(n.wrap<0);return a.overscaledZ-n.overscaledZ||c-s||n.canonical.y-a.canonical.y||n.canonical.x-a.canonical.x}function hO(a){return a==="raster"||a==="image"||a==="video"||a==="custom"}function lm(a,n){const s=1<<a.z;return[a.x/s+n,(a.x+1)/s+n]}lc.maxOverzooming=10,lc.maxUnderzooming=3;class W_{constructor(n,s,c){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(n,s,c){const d=c||n.findDEMTileFor(s);if(!d||!d.dem)return;const g=d.dem,v=d.tileID,w=1<<s.canonical.z-v.canonical.z;return new W_(d,d.tileSize/Ut/w,[(s.canonical.x/w-v.canonical.x)*g.dim,(s.canonical.y/w-v.canonical.y)*g.dim])}tileCoordToPixel(n,s){const c=s*this._scale+this._offset[1],d=Math.floor(n*this._scale+this._offset[0]),g=Math.floor(c);return new ge(d,g)}getElevationAt(n,s,c,d){const g=n*this._scale+this._offset[0],v=s*this._scale+this._offset[1],w=Math.floor(g),S=Math.floor(v),P=this._dem;return d=!!d,c?gr(gr(P.get(w,S,d),P.get(w,S+1,d),v-S),gr(P.get(w+1,S,d),P.get(w+1,S+1,d),v-S),g-w):P.get(w,S,d)}getElevationAtPixel(n,s,c){return this._dem.get(n,s,!!c)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*Oa(1,n)*this._dem.stride}}class fO{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Is(Ut,16,0),this.featureIndexArray=new Ku,this.promoteId=s}insert(n,s,c,d,g,v=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,d,g,v);const S=this.grid;for(let P=0;P<s.length;P++){const I=s[P],D=[1/0,1/0,-1/0,-1/0];for(let z=0;z<I.length;z++){const N=I[z];D[0]=Math.min(D[0],N.x),D[1]=Math.min(D[1],N.y),D[2]=Math.max(D[2],N.x),D[3]=Math.max(D[3],N.y)}D[0]<Ut&&D[1]<Ut&&D[2]>=0&&D[3]>=0&&S.insert(w,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Cb(new I_(this.rawTileData)).layers,this.sourceLayerCoder=new YC(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s,c,d){this.loadVTLayers();const g=n.params||{},v=vh(g.filter),w=n.tileResult,S=n.transform,P=w.bufferedTilespaceBounds,I=this.grid.query(P.min.x,P.min.y,P.max.x,P.max.y,(W,J,te,le)=>BM(w.bufferedTilespaceGeometry,W,J,te,le));I.sort(dU);let D=null;S.elevation&&I.length>0&&(D=W_.create(S.elevation,this.tileID));const z={};let N;for(let W=0;W<I.length;W++){const J=I[W];if(J===N)continue;N=J;const te=this.featureIndexArray.get(J);let le=null;this.loadMatchingFeature(z,te,v,g.layers,g.availableImages,s,c,d,(ye,ce,me,Se=0)=>(le||(le=js(ye,this.tileID.canonical,n.tileTransform)),ce.queryIntersectsFeature(w,ye,me,le,this.z,n.transform,n.pixelPosMatrix,D,Se)))}return z}loadMatchingFeature(n,s,c,d,g,v,w,S,P){const{featureIndex:I,bucketIndex:D,sourceLayerIndex:z,layoutVertexArrayOffset:N}=s,W=this.bucketLayerIDs[D];if(d&&!function(ye,ce){for(let me=0;me<ye.length;me++)if(ce.indexOf(ye[me])>=0)return!0;return!1}(d,W))return;const J=this.sourceLayerCoder.decode(z),te=this.vtLayers[J].feature(I);if(c.needGeometry){const ye=ic(te,!0);if(!c.filter(new k(this.tileID.overscaledZ),ye,this.tileID.canonical))return}else if(!c.filter(new k(this.tileID.overscaledZ),te))return;const le=this.getId(te,J);for(let ye=0;ye<W.length;ye++){const ce=W[ye];if(d&&d.indexOf(ce)<0)continue;const me=v[ce];if(!me)continue;let Se={};le!==void 0&&S&&(Se=S.getState(me.sourceLayer||"_geojsonTileLayer",le));const we=St({},w[ce]);we.paint=dO(we.paint,me.paint,te,Se,g),we.layout=dO(we.layout,me.layout,te,Se,g);const Ze=!P||P(te,me,Se,N);if(!Ze)continue;const Ue=new JC(te,this.z,this.x,this.y,le);Ue.layer=we;let Qe=n[ce];Qe===void 0&&(Qe=n[ce]=[]),Qe.push({featureIndex:I,feature:Ue,intersectionZ:Ze})}}lookupSymbolFeatures(n,s,c,d,g,v,w,S){const P={};this.loadVTLayers();const I=vh(g);for(const D of n)this.loadMatchingFeature(P,{bucketIndex:c,sourceLayerIndex:d,featureIndex:D,layoutVertexArrayOffset:0},I,v,w,S,s);return P}loadFeature(n){const{featureIndex:s,sourceLayerIndex:c}=n;this.loadVTLayers();const d=this.sourceLayerCoder.decode(c),g=this.vtFeatures[d];if(g[s])return g[s];const v=this.vtLayers[d].feature(s);return g[s]=v,v}hasLayer(n){for(const s of this.bucketLayerIDs)for(const c of s)if(n===c)return!0;return!1}getId(n,s){let c=n.id;if(this.promoteId){const d=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];d!=null&&(c=n.properties[d]),typeof c=="boolean"&&(c=Number(c))}return c}}function dO(a,n,s,c,d){return et(a,(g,v)=>{const w=n instanceof se?n.get(v):null;return w&&w.evaluate?w.evaluate(s,c,d):w})}function dU(a,n){return n-a}It(fO,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class pO{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new Fs({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const c=this.getKey(n,s);return this.positions[c]}trim(){const n=this.width,s=this.height=yr(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,c){const d=[];let g=n.length%2==1?-n[n.length-1]*c:0,v=n[0]*c,w=!0;d.push({left:g,right:v,isDash:w,zeroLength:n[0]===0});let S=n[0];for(let P=1;P<n.length;P++){w=!w;const I=n[P];g=S*c,S+=I,v=S*c,d.push({left:g,right:v,isDash:w,zeroLength:I===0})}return d}addRoundDash(n,s,c){const d=s/2;for(let g=-c;g<=c;g++){const v=this.width*(this.nextRow+c+g);let w=0,S=n[w];for(let P=0;P<this.width;P++){P/S.right>1&&(S=n[++w]);const I=Math.abs(P-S.left),D=Math.abs(P-S.right),z=Math.min(I,D);let N;const W=g/c*(d+1);if(S.isDash){const J=d-Math.abs(W);N=Math.sqrt(z*z+J*J)}else N=d-Math.sqrt(z*z+W*W);this.image.data[v+P]=Math.max(0,Math.min(255,N+128))}}}addRegularDash(n,s){for(let S=n.length-1;S>=0;--S){const P=n[S],I=n[S+1];P.zeroLength?n.splice(S,1):I&&I.isDash===P.isDash&&(I.left=P.left,n.splice(S,1))}const c=n[0],d=n[n.length-1];c.isDash===d.isDash&&(c.left=d.left-this.width,d.right=c.right+this.width);const g=this.width*this.nextRow;let v=0,w=n[v];for(let S=0;S<this.width;S++){S/w.right>1&&(w=n[++v]);const P=Math.abs(S-w.left),I=Math.abs(S-w.right),D=Math.min(P,I);this.image.data[g+S]=Math.max(0,Math.min(255,(w.isDash?D:-D)+s+128))}}addDash(n,s){const c=this.getKey(n,s);if(this.positions[c])return this.positions[c];const d=s==="round",g=d?7:0,v=2*g+1;if(this.nextRow+v>this.height)return ir("LineAtlas out of space"),null;n.length===0&&n.push(1);let w=0;for(let I=0;I<n.length;I++)n[I]<0&&(ir("Negative value is found in line dasharray, replacing values with 0"),n[I]=0),w+=n[I];if(w!==0){const I=this.width/w,D=this.getDashRanges(n,this.width,I);d?this.addRoundDash(D,I,g):this.addRegularDash(D,s==="square"?.5*I:0)}const S=this.nextRow+g;this.nextRow+=v;const P={tl:[S,g],br:[w,0]};return this.positions[c]=P,P}}It(pO,"LineAtlas");const mO=1*ka;class gO{constructor(n){const s={},c=[];for(const w in n){const S=n[w],P=s[w]={};for(const I in S.glyphs){const D=S.glyphs[+I];if(!D||D.bitmap.width===0||D.bitmap.height===0)continue;const z=D.metrics.localGlyph?mO:1,N={x:0,y:0,w:D.bitmap.width+2*z,h:D.bitmap.height+2*z};c.push(N),P[I]=N}}const{w:d,h:g}=Db(c),v=new Fs({width:d||1,height:g||1});for(const w in n){const S=n[w];for(const P in S.glyphs){const I=S.glyphs[+P];if(!I||I.bitmap.width===0||I.bitmap.height===0)continue;const D=s[w][P],z=I.metrics.localGlyph?mO:1;Fs.copy(I.bitmap,v,{x:0,y:0},{x:D.x+z,y:D.y+z},I.bitmap)}}this.image=v,this.positions=s}}It(gO,"GlyphAtlas");class pU{constructor(n){this.tileID=new Li(n.tileID.overscaledZ,n.tileID.wrap,n.tileID.canonical.z,n.tileID.canonical.x,n.tileID.canonical.y),this.tileZoom=n.tileZoom,this.uid=n.uid,this.zoom=n.zoom,this.canonical=n.tileID.canonical,this.pixelRatio=n.pixelRatio,this.tileSize=n.tileSize,this.source=n.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=n.showCollisionBoxes,this.collectResourceTiming=!!n.collectResourceTiming,this.returnDependencies=!!n.returnDependencies,this.promoteId=n.promoteId,this.enableTerrain=!!n.enableTerrain,this.isSymbolTile=n.isSymbolTile,this.tileTransform=sc(n.tileID.canonical,n.projection),this.projection=n.projection}parse(n,s,c,d,g){this.status="parsing",this.data=n,this.collisionBoxArray=new jr;const v=new YC(Object.keys(n.layers).sort()),w=new fO(this.tileID,this.promoteId);w.bucketLayerIDs=[];const S={},P=new pO(256,256),I={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:P,availableImages:c},D=s.familiesBySource[this.source];for(const Se in D){const we=n.layers[Se];if(!we)continue;let Ze=!1,Ue=!1;for(const Xe of D[Se])Xe[0].type==="symbol"?Ze=!0:Ue=!0;if(this.isSymbolTile===!0&&!Ze||this.isSymbolTile===!1&&!Ue)continue;we.version===1&&ir(`Vector tile source "${this.source}" layer "${Se}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Qe=v.encode(Se),mt=[];for(let Xe=0;Xe<we.length;Xe++){const it=we.feature(Xe),ot=w.getId(it,Se);mt.push({feature:it,id:ot,index:Xe,sourceLayerIndex:Qe})}for(const Xe of D[Se]){const it=Xe[0];this.isSymbolTile!==void 0&&it.type==="symbol"!==this.isSymbolTile||it.minzoom&&this.zoom<Math.floor(it.minzoom)||it.maxzoom&&this.zoom>=it.maxzoom||it.visibility!=="none"&&(Kb(Xe,this.zoom,c),(S[it.id]=it.createBucket({index:w.bucketLayerIDs.length,layers:Xe,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Qe,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(mt,I,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(Xe.map(ot=>ot.id)))}}let z,N,W,J;P.trim();const te={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},le=()=>{if(z)return g(z);if(N&&W&&J){const Se=new gO(N),we=new TC(W,J);for(const Ze in S){const Ue=S[Ze];Ue instanceof jl?(Kb(Ue.layers,this.zoom,c),$N(Ue,N,Se.positions,W,we.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):Ue.hasPattern&&(Ue instanceof M_||Ue instanceof T_||Ue instanceof Kp)&&(Kb(Ue.layers,this.zoom,c),Ue.addFeatures(I,this.tileID.canonical,we.patternPositions,c,this.tileTransform))}this.status="done",g(null,{buckets:Ot(S).filter(Ze=>!Ze.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Se.image,lineAtlas:P,imageAtlas:we,glyphMap:this.returnDependencies?N:null,iconMap:this.returnDependencies?W:null,glyphPositions:this.returnDependencies?Se.positions:null})}},ye=et(I.glyphDependencies,Se=>Object.keys(Se).map(Number));Object.keys(ye).length?d.send("getGlyphs",{uid:this.uid,stacks:ye},(Se,we)=>{z||(z=Se,N=we,le())},void 0,!1,te):N={};const ce=Object.keys(I.iconDependencies);ce.length?d.send("getImages",{icons:ce,source:this.source,tileID:this.tileID,type:"icons"},(Se,we)=>{z||(z=Se,W=we,le())},void 0,!1,te):W={};const me=Object.keys(I.patternDependencies);me.length?d.send("getImages",{icons:me,source:this.source,tileID:this.tileID,type:"patterns"},(Se,we)=>{z||(z=Se,J=we,le())},void 0,!1,te):J={},le()}}function Kb(a,n,s){const c=new k(n);for(const d of a)d.recalculate(c,s)}class yO{constructor(n){this.entries={},this.scheduler=n}request(n,s,c,d){const g=this.entries[n]=this.entries[n]||{callbacks:[]};if(g.result){const[v,w]=g.result;return this.scheduler?this.scheduler.add(()=>{d(v,w)},s):d(v,w),()=>{}}return g.callbacks.push(d),g.cancel||(g.cancel=c((v,w)=>{g.result=[v,w];for(const S of g.callbacks)this.scheduler?this.scheduler.add(()=>{S(v,w)},s):S(v,w);setTimeout(()=>delete this.entries[n],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(v=>v!==d),g.callbacks.length||(g.cancel(),delete this.entries[n]))}}}function _O(a,n,s){const c=JSON.stringify(a.request);return a.data&&(this.deduped.entries[c]={result:[null,a.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},d=>{const g=Kt(a.request,(v,w,S,P)=>{v?d(v):w&&d(null,{vectorTile:s?void 0:new Cb(new I_(w)),rawData:w,cacheControl:S,expires:P})});return()=>{g.cancel(),d()}},n)}const vO=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Yb{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,c]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=c>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const g=vO[15&c];if(!g)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[w]=new Uint32Array(n,4,1);return new Yb(w,v,g,n)}constructor(n,s=64,c=Float64Array,d){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=c,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const g=vO.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,w=n*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-w%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${c}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+S,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+w+S),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+S,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=n,this.coords[this._pos++]=s,c}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Jb(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:v,nodeSize:w}=this,S=[0,g.length-1,0],P=[];for(;S.length;){const I=S.pop()||0,D=S.pop()||0,z=S.pop()||0;if(D-z<=w){for(let te=z;te<=D;te++){const le=v[2*te],ye=v[2*te+1];le>=n&&le<=c&&ye>=s&&ye<=d&&P.push(g[te])}continue}const N=z+D>>1,W=v[2*N],J=v[2*N+1];W>=n&&W<=c&&J>=s&&J<=d&&P.push(g[N]),(I===0?n<=W:s<=J)&&(S.push(z),S.push(N-1),S.push(1-I)),(I===0?c>=W:d>=J)&&(S.push(N+1),S.push(D),S.push(1-I))}return P}within(n,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:g,nodeSize:v}=this,w=[0,d.length-1,0],S=[],P=c*c;for(;w.length;){const I=w.pop()||0,D=w.pop()||0,z=w.pop()||0;if(D-z<=v){for(let te=z;te<=D;te++)bO(g[2*te],g[2*te+1],n,s)<=P&&S.push(d[te]);continue}const N=z+D>>1,W=g[2*N],J=g[2*N+1];bO(W,J,n,s)<=P&&S.push(d[N]),(I===0?n-c<=W:s-c<=J)&&(w.push(z),w.push(N-1),w.push(1-I)),(I===0?n+c>=W:s+c>=J)&&(w.push(N+1),w.push(D),w.push(1-I))}return S}}function Jb(a,n,s,c,d,g){if(d-c<=s)return;const v=c+d>>1;xO(a,n,v,c,d,g),Jb(a,n,s,c,v-1,1-g),Jb(a,n,s,v+1,d,1-g)}function xO(a,n,s,c,d,g){for(;d>c;){if(d-c>600){const P=d-c+1,I=s-c+1,D=Math.log(P),z=.5*Math.exp(2*D/3),N=.5*Math.sqrt(D*z*(P-z)/P)*(I-P/2<0?-1:1);xO(a,n,s,Math.max(c,Math.floor(s-I*z/P+N)),Math.min(d,Math.floor(s+(P-I)*z/P+N)),g)}const v=n[2*s+g];let w=c,S=d;for(um(a,n,c,s),n[2*d+g]>v&&um(a,n,c,d);w<S;){for(um(a,n,w,S),w++,S--;n[2*w+g]<v;)w++;for(;n[2*S+g]>v;)S--}n[2*c+g]===v?um(a,n,c,S):(S++,um(a,n,S,d)),S<=s&&(c=S+1),s<=S&&(d=S-1)}}function um(a,n,s,c){Qb(a,s,c),Qb(n,2*s,2*c),Qb(n,2*s+1,2*c+1)}function Qb(a,n,s){const c=a[n];a[n]=a[s],a[s]=c}function bO(a,n,s,c){const d=a-s,g=n-c;return d*d+g*g}o.ARRAY_TYPE=uo,o.AUTH_ERR_MSG=ve,o.Aabb=Di,o.Actor=class{constructor(a,n,s){this.target=a,this.parent=n,this.mapId=s,this.callbacks={},this.cancelCallbacks={},Xt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=$n()?a:x,this.scheduler=new sU}send(a,n,s,c,d=!1,g){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=g,this.callbacks[v]=s);const w=ri(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:a,hasCallback:!!s,targetMapId:c,mustQueue:d,sourceMapId:this.mapId,data:Ol(n,w)},w),{cancel:()=>{s&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(a){const n=a.data,s=n.id;if(s&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const c=this.cancelCallbacks[s];delete this.cancelCallbacks[s],c&&c.cancel()}else if(n.mustQueue||$n()){const c=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add(()=>this.processTask(s,n),c&&c.metadata||{type:"message"})}else this.processTask(s,n)}processTask(a,n){if(n.type==="<response>"){const s=this.callbacks[a];delete this.callbacks[a],s&&(n.error?s(ks(n.error)):s(null,ks(n.data)))}else{const s=ri(this.globalScope)?void 0:[],c=n.hasCallback?(g,v)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:g?Ol(g):null,data:Ol(v,s)},s)}:g=>{},d=ks(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,d,c);else if(this.parent.getWorkerSource){const g=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,g[0],d.source)[g[1]](d,c)}else c(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=P_,o.Color=Tn,o.ColorMode=ls,o.CullFaceMode=Da,o.DEMData=G_,o.DataConstantProperty=X,o.DedupedRequest=yO,o.DepthMode=Gh,o.EXTENT=Ut,o.Elevation=class{isDataAvailableAtPoint(a){const n=this._source();if(this.isUsingMockSource()||!n||a.y<0||a.y>1)return!1;const s=n.getSource().maxzoom,c=1<<s,d=Math.floor(a.x),g=Math.floor((a.x-d)*c),v=Math.floor(a.y*c),w=this.findDEMTileFor(new Li(s,d,s,g,v));return!(!w||!w.dem)}getAtPointOrZero(a,n=0){return this.getAtPoint(a,n)||0}getAtPoint(a,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const c=this._source();if(!c||a.y<0||a.y>1)return n;const d=c.getSource().maxzoom,g=1<<d,v=Math.floor(a.x),w=a.x-v,S=new Li(d,v,d,Math.floor(w*g),Math.floor(a.y*g)),P=this.findDEMTileFor(S);if(!P||!P.dem)return n;const I=P.dem,D=1<<P.tileID.canonical.z,z=(w*D-P.tileID.canonical.x)*I.dim,N=(a.y*D-P.tileID.canonical.y)*I.dim,W=Math.floor(z),J=Math.floor(N);return(s?this.exaggeration():1)*gr(gr(I.get(W,J),I.get(W,J+1),N-J),gr(I.get(W+1,J),I.get(W+1,J+1),N-J),z-W)}getAtTileOffset(a,n,s){const c=1<<a.canonical.z;return this.getAtPointOrZero(new Oh(a.wrap+(a.canonical.x+n/Ut)/c,(a.canonical.y+s/Ut)/c))}getAtTileOffsetFunc(a,n,s,c){return d=>{const g=this.getAtTileOffset(a,d.x,d.y),v=c.upVector(a.canonical,d.x,d.y);return So(v,v,g*c.upVectorScale(a.canonical,n,s).metersToTile),v}}getForTilePoints(a,n,s,c){if(this.isUsingMockSource())return!1;const d=W_.create(this,a,c);return!!d&&(n.forEach(g=>{g[2]=this.exaggeration()*d.getElevationAt(g[0],g[1],s)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(a);if(!n||!n.dem)return null;const s=n.dem.tree,c=n.tileID,d=1<<a.canonical.z-c.canonical.z;let g=a.canonical.x/d-c.canonical.x,v=a.canonical.y/d-c.canonical.y,w=0;for(let S=0;S<a.canonical.z-c.canonical.z&&!s.leaves[w];S++){g*=2,v*=2;const P=2*Math.floor(v)+Math.floor(g);w=s.childOffsets[w]+P,g%=1,v%=1}return{min:this.exaggeration()*s.minimums[w],max:this.exaggeration()*s.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=ga,o.EvaluationParameters=k,o.Event=Ss,o.Evented=Eu,o.FillExtrusionBucket=Kp,o.Frustum=ab,o.FrustumCorners=ob,o.GLOBE_RADIUS=rs,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=xM,o.GLOBE_ZOOM_THRESHOLD_MIN=sb,o.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,n){const s=new pt,c=new Bt,d=[],g=a+1+2,v=n[0]+1,w=n[0]+1+(1+n.length),S=(P,I,D)=>{let z=P===g-1?P-2:P===0?P:P-1;return z+=D?24575:0,[z,I]};for(let P=0;P<g;++P)s.emplaceBack(...S(P,0,!0));for(let P=0;P<v;++P)for(let I=0;I<g;++I)s.emplaceBack(...S(I,P,(I===0||I===g-1)&&!0));for(let P=0;P<n.length;++P){const I=n[P];for(let D=0;D<g;++D)s.emplaceBack(...S(D,I,!0))}for(let P=0;P<n.length;++P){const I=c.length,D=n[P]+1+2,z=new Bt;for(let J=0;J<D-1;J++){const te=J===D-2,le=te?g*(w-n.length+P-J):g;for(let ye=0;ye<g-1;ye++){const ce=J*g+ye;J===0||te||ye===0||ye===g-2?(z.emplaceBack(ce+1,ce,ce+le),z.emplaceBack(ce+le,ce+le+1,ce+1)):(c.emplaceBack(ce+1,ce,ce+le),c.emplaceBack(ce+le,ce+le+1,ce+1))}}const N=In.simpleSegment(0,I,s.length,c.length-I);for(let J=0;J<z.uint16.length;J+=3)c.emplaceBack(z.uint16[J],z.uint16[J+1],z.uint16[J+2]);const W=In.simpleSegment(0,I,s.length,c.length-I);d.push({withoutSkirts:N,withSkirts:W})}return{vertices:s,indices:c,segments:d}}_createGrid(a){const n=this._fillGridMeshWithLods(rc,$p);this._gridSegments=n.segments,this._gridBuffer=a.createVertexBuffer(n.vertices,Fp.members),this._gridIndexBuffer=a.createIndexBuffer(n.indices,!0)}_createPoles(a){const n=new Bt;for(let d=0;d<=rc;d++)n.emplaceBack(0,d+1,d+2);this._poleIndexBuffer=a.createIndexBuffer(n,!0);const s=new Br,c=new Br;this._poleSegments=[];for(let d=0,g=0;d<sb;d++){const v=360/(1<<d);s.emplaceBack(0,-rs,0,.5,0),c.emplaceBack(0,-rs,0,.5,1);for(let w=0;w<=rc;w++){const S=w/rc,P=gr(0,v,S),[I,D,z]=Ph(s$,l$,P,rs);s.emplaceBack(I,D,z,S,0),c.emplaceBack(I,D,z,S,1)}this._poleSegments.push(In.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(s,_M,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(c,_M,!1)}getGridBuffers(a,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,n){if(!this._wireframeSegments){const s=new Kn,c=rc,d=c+1+2,g=1;this._wireframeSegments=[];for(let v=0,w=0;v<$p.length;v++){const S=$p[v];for(let I=g;I<S+g;I++)for(let D=g;D<c+g;D++){const z=I*d+D;s.emplaceBack(z,z+1),s.emplaceBack(z,z+d),s.emplaceBack(z,z+d+1)}const P=S*c*3;this._wireframeSegments.push(In.simpleSegment(0,w,(S+1)*d,P)),w+=P}this._wireframeIndexBuffer=a.createIndexBuffer(s)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[n]]}},o.GlyphManager=Fh,o.ImagePosition=Lb,o.KDBush=Yb,o.LivePerformanceUtils=P1,o.LngLat=Fr,o.LngLatBounds=Ll,o.LocalGlyphMode=Bb,o.MAX_MERCATOR_LATITUDE=yi,o.MercatorCoordinate=Oh,o.ONE_EM=ii,o.OverscaledTileID=Li,o.PerformanceMarkers=Ja,o.Point=ge,o.Properties=de,o.RGBAImage=co,o.Ray=ib,o.RequestManager=class{constructor(a,n,s){this._transformRequestFn=a,this._customAccessToken=n,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const a=function(){let n="";for(let s=0;s<10;s++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",U,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,n){return this._transformRequestFn&&this._transformRequestFn(a,n)||{url:a}}normalizeStyleURL(a,n){if(!Te(a))return a;const s=wt(a);return s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||n)}normalizeGlyphsURL(a,n){if(!Te(a))return a;const s=wt(a);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||n)}normalizeSourceURL(a,n,s,c){if(!Te(a))return a;const d=wt(a);return d.path=`/v4/${d.authority}.json`,d.params.push("secure"),s&&d.params.push(`language=${s}`),c&&d.params.push(`worldview=${c}`),this._makeAPIURL(d,this._customAccessToken||n)}normalizeSpriteURL(a,n,s,c){const d=wt(a);return Te(a)?(d.path=`/styles/v1${d.path}/sprite${n}${s}`,this._makeAPIURL(d,this._customAccessToken||c)):(d.path+=`${n}${s}`,ct(d))}normalizeTileURL(a,n,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!Te(a))return a;const c=wt(a);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${n||s&&c.authority!=="raster"&&s===512?"@2x":""}${L.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${O.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${O.TILE_URL_VERSION}${c.path}`);const d=this._customAccessToken||function(g){for(const v of g){const w=v.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(c.params)||O.ACCESS_TOKEN;return O.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,d)}canonicalizeTileURL(a,n){const s=wt(a);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return a;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${O.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${O.TILE_URL_VERSION}/`,"")}`;let d=s.params;return n&&(d=d.filter(g=>!g.match(/^access_token=/))),d.length&&(c+=`?${d.join("&")}`),c}canonicalizeTileset(a,n){const s=!!n&&Te(n),c=[];for(const d of a.tiles||[])Le(d)?c.push(this.canonicalizeTileURL(d,s)):c.push(d);return c}_makeAPIURL(a,n){const s="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=wt(O.API_URL);if(a.protocol=c.protocol,a.authority=c.authority,a.protocol==="http"){const d=a.params.indexOf("secure");d>=0&&a.params.splice(d,1)}if(c.path!=="/"&&(a.path=`${c.path}${a.path}`),!O.REQUIRE_ACCESS_TOKEN)return ct(a);if(n=n||O.ACCESS_TOKEN,!this._silenceAuthErrors){if(!n)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if(n[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return a.params=a.params.filter(d=>d.indexOf("access_token")===-1),a.params.push(`access_token=${n||""}`),ct(a)}},o.ResourceType=Ke,o.SegmentVector=In,o.SourceCache=lc,o.StencilMode=Zb,o.StructArrayLayout1ui2=lo,o.StructArrayLayout2f1f2i16=Vt,o.StructArrayLayout2i4=pt,o.StructArrayLayout2ui4=Kn,o.StructArrayLayout3f12=cr,o.StructArrayLayout3ui6=Bt,o.StructArrayLayout4i8=nt,o.StructArrayLayout5f20=Br,o.Texture=sm,o.Tile=Wb,o.Transitionable=H,o.Uniform1f=c_,o.Uniform1i=class extends zs{constructor(a){super(a),this.current=0}set(a,n,s){this.fetchUniformLocation(a,n)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},o.Uniform2f=class extends zs{constructor(a){super(a),this.current=[0,0]}set(a,n,s){this.fetchUniformLocation(a,n)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}},o.Uniform3f=class extends zs{constructor(a){super(a),this.current=[0,0,0]}set(a,n,s){this.fetchUniformLocation(a,n)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}},o.Uniform4f=tM,o.UniformColor=rM,o.UniformMatrix2f=class extends zs{constructor(a){super(a),this.current=WF}set(a,n,s){if(this.fetchUniformLocation(a,n)){for(let c=0;c<4;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}}},o.UniformMatrix3f=class extends zs{constructor(a){super(a),this.current=GF}set(a,n,s){if(this.fetchUniformLocation(a,n)){for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},o.UniformMatrix4f=class extends zs{constructor(a){super(a),this.current=VF}set(a,n,s){if(this.fetchUniformLocation(a,n)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let c=1;c<16;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}},o.UnwrappedTileID=lC,o.ValidationError=Ct,o.VectorTileFeature=E_,o.VectorTileWorkerSource=class extends Eu{constructor(a,n,s,c,d){super(),this.actor=a,this.layerIndex=n,this.availableImages=s,this.loadVectorData=d||_O,this.loading={},this.loaded={},this.deduped=new yO(a.scheduler),this.isSpriteLoaded=c,this.scheduler=a.scheduler}loadTile(a,n){const s=a.uid,c=a&&a.request,d=c&&c.collectResourceTiming,g=this.loading[s]=new pU(a);g.abort=this.loadVectorData(a,(v,w)=>{const S=!this.loading[s];if(delete this.loading[s],S||v||!w)return g.status="done",S||(this.loaded[s]=g),n(v);const P=w.rawData,I={};w.expires&&(I.expires=w.expires),w.cacheControl&&(I.cacheControl=w.cacheControl),g.vectorTile=w.vectorTile||new Cb(new I_(P));const D=()=>{g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,(z,N)=>{if(z||!N)return n(z);const W={};if(d){const J=Rd(c);J.length>0&&(W.resourceTiming=JSON.parse(JSON.stringify(J)))}n(null,St({rawTileData:P.slice(0)},N,I,W))})};this.isSpriteLoaded?D():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(D,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):D()}),this.loaded=this.loaded||{},this.loaded[s]=g})}reloadTile(a,n){const s=this.loaded,c=a.uid,d=this;if(s&&s[c]){const g=s[c];g.showCollisionBoxes=a.showCollisionBoxes,g.enableTerrain=!!a.enableTerrain,g.projection=a.projection,g.tileTransform=sc(a.tileID.canonical,a.projection);const v=(w,S)=>{const P=g.reloadCallback;P&&(delete g.reloadCallback,g.parse(g.vectorTile,d.layerIndex,this.availableImages,d.actor,P)),n(w,S)};g.status==="parsing"?g.reloadCallback=v:g.status==="done"&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(a,n){const s=a.uid,c=this.loading[s];c&&(c.abort&&c.abort(),delete this.loading[s]),n()}removeTile(a,n){const s=this.loaded,c=a.uid;s&&s[c]&&delete s[c],n()}},o.WritingMode=Ao,o.ZoomDependentExpression=Vu,o.add=Bs,o.addDynamicAttributes=N_,o.adjoint=function(a,n){var s=n[0],c=n[1],d=n[2],g=n[3],v=n[4],w=n[5],S=n[6],P=n[7],I=n[8];return a[0]=v*I-w*P,a[1]=d*P-c*I,a[2]=c*w-d*v,a[3]=w*S-g*I,a[4]=s*I-d*S,a[5]=d*g-s*w,a[6]=g*P-v*S,a[7]=c*S-s*P,a[8]=s*v-c*g,a},o.asyncAll=st,o.bezier=ke,o.bindAll=Xt,o.boundsAttributes=eO,o.bufferConvexPolygon=function(a,n){const s=[];for(let c=0;c<a.length;c++){const d=ft(c-1,-1,a.length-1),g=ft(c+1,-1,a.length-1),v=a[c],w=a[g],S=a[d].sub(v).unit(),P=w.sub(v).unit(),I=P.angleWithSep(S.x,S.y),D=S.add(P).unit().mult(-1*n/Math.sin(I/2));s.push(v.add(D))}return s},o.cacheEntryPossiblyAdded=function(a){Ts++,Ts>ws&&(a.getActor().send("enforceCacheSizeLimit",fa),Ts=0)},o.calculateGlobeLabelMatrix=function(a,n){const{x:s,y:c}=a.point,d=EM(s,c,a.worldSize/a._pixelsPerMercatorPixel,0,0);return Qu(d,d,cb(ns(n)))},o.calculateGlobeMatrix=function(a){const{x:n,y:s}=a.point,{lng:c,lat:d}=a._center;return EM(n,s,a.worldSize,c,d)},o.calculateGlobeMercatorMatrix=function(a){const n=a.pixelsPerMeter,s=n/Oa(1,a.center.lat),c=Ma(new Float64Array(16));return Dp(c,c,[a.point.x,a.point.y,0]),ec(c,c,[s,s,n]),Float32Array.from(c)},o.circumferenceAtLatitude=fb,o.clamp=Oe,o.clearTileCache=function(a){if(!Ya())return;const n=x.caches.delete(no);a&&n.catch(a).then(()=>a())},o.clipLine=RC,o.clone=function(a){var n=new uo(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n},o.clone$1=Qt,o.collisionCircleLayout=fN,o.config=O,o.conjugate=function(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a[3]=n[3],a},o.create=function(){var a=new uo(16);return uo!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},o.create$1=oM,o.createExpression=Pl,o.createLayout=ze,o.createStyleLayer=function(a){return a.type==="custom"?new nU(a):new oU[a.type](a)},o.cross=nb,o.degToRad=Ve,o.distance=function(a,n){return Math.hypot(n[0]-a[0],n[1]-a[1],n[2]-a[2])},o.div=function(a,n,s){return a[0]=n[0]/s[0],a[1]=n[1]/s[1],a[2]=n[2]/s[2],a},o.dot=Wo,o.earthRadius=Vp,o.ease=Ce,o.easeCubicInOut=Me,o.ecefToLatLng=function([a,n,s]){const c=Math.hypot(a,n,s),d=Math.atan2(a,s),g=.5*Math.PI-Math.acos(-n/c);return new Fr(be(d),be(g))},o.emitValidationErrors=i_,o.endsWith=Jt,o.enforceCacheSizeLimit=function(a){da(),di&&di.then(n=>{n.keys().then(s=>{for(let c=0;c<s.length-a;c++)n.delete(s[c])})})},o.evaluateSizeForFeature=C_,o.evaluateSizeForZoom=zh,o.evaluateVariableOffset=NC,o.evented=b,o.exactEquals=function(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3]===n[3]},o.exactEquals$1=function(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]},o.exported=ma,o.exported$1=L,o.extend=St,o.extend$1=ya,o.fillExtrusionHeightLift=oC,o.filterObject=Or,o.fromMat4=function(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[4],a[4]=n[5],a[5]=n[6],a[6]=n[8],a[7]=n[9],a[8]=n[10],a},o.fromQuat=function(a,n){var s=n[0],c=n[1],d=n[2],g=n[3],v=s+s,w=c+c,S=d+d,P=s*v,I=c*v,D=c*w,z=d*v,N=d*w,W=d*S,J=g*v,te=g*w,le=g*S;return a[0]=1-D-W,a[1]=I+le,a[2]=z-te,a[3]=0,a[4]=I-le,a[5]=1-P-W,a[6]=N+J,a[7]=0,a[8]=z+te,a[9]=N-J,a[10]=1-P-D,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},o.fromRotation=function(a,n){var s=Math.sin(n),c=Math.cos(n);return a[0]=c,a[1]=s,a[2]=0,a[3]=-s,a[4]=c,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},o.fromScaling=sM,o.furthestTileCorner=function(a){const n=Math.round((a+45+360)%360/90)%4;return _e[n]},o.getAABBPointSquareDist=function(a,n,s){let c=0;for(let d=0;d<2;++d){const g=s?s[d]:0;a[d]>g&&(c+=(a[d]-g)*(a[d]-g)),n[d]<g&&(c+=(g-n[d])*(g-n[d]))}return c},o.getAnchorAlignment=Rb,o.getAnchorJustification=Fb,o.getBounds=function(a){let n=1/0,s=1/0,c=-1/0,d=-1/0;for(const g of a)n=Math.min(n,g.x),s=Math.min(s,g.y),c=Math.max(c,g.x),d=Math.max(d,g.y);return{min:new ge(n,s),max:new ge(c,d)}},o.getColumn=Wi,o.getDefaultExportFromCjs=G,o.getGridMatrix=function(a,n,s,c){const d=n.getNorth(),g=n.getSouth(),v=n.getWest(),w=n.getEast(),S=1<<a.z,P=w-v,I=d-g,D=P/rc,z=-I/$p[s],N=[0,D,0,z,0,0,d,v,0];if(a.z>0){const W=180/c;aM(N,N,[W/P+1,0,0,0,W/I+1,0,-.5*W/D,.5*W/z,1])}return N[2]=S,N[5]=a.x,N[8]=a.y,N},o.getImage=he,o.getJSON=function(a,n){return Rt(St(a,{type:"json"}),n)},o.getLatitudinalLod=function(a){const n=yi-5;a=Oe(a,-n,n)/n*90;const s=Math.pow(Math.abs(Math.sin(Ve(a))),3);return Math.round(s*($p.length-1))},o.getMapSessionAPI=dn,o.getPerformanceMeasurement=Rd,o.getProjection=XC,o.getRTLTextPluginStatus=T,o.getReferrer=xt,o.getTilePoint=function(a,{x:n,y:s},c=0){return new ge(((n-c)*a.scale-a.x)*Ut,(s*a.scale-a.y)*Ut)},o.getTileVec3=function(a,n,s=0){return Ah(((n.x-s)*a.scale-a.x)*Ut,(n.y*a.scale-a.y)*Ut,CM(n.z,n.y))},o.getVideo=function(a,n){const s=x.document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let c=0;c<a.length;c++){const d=x.document.createElement("source");Yt(a[c])||(s.crossOrigin="Anonymous"),d.src=a[c],s.appendChild(d)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(a){const n=[0,0,0],s=Ma(new Float64Array(16));return Qu(s,a.pixelMatrix,a.globeMatrix),Sn(n,n,s),new ge(n[0],n[1])},o.globeDenormalizeECEF=cb,o.globeECEFOrigin=function(a,n){const s=[0,0,0];return Sn(s,s,Up(ns(n.canonical))),Sn(s,s,a),s},o.globeMetersToEcef=d_,o.globeNormalizeECEF=Up,o.globePixelsToTileUnits=function(a,n){return Ut/(512*Math.pow(2,a))*m_(ns(n))},o.globePoleMatrixForTile=function(a,n,s){const c=Ma(new Float64Array(16)),d=(n/(1<<a)-.5)*Math.PI*2;return f_(c,s.globeMatrix,d),Float32Array.from(c)},o.globeTileBounds=ns,o.globeTiltAtLngLat=AM,o.globeToMercatorTransition=Ch,o.globeUseCustomAntiAliasing=function(a,n,s){const c=Ch(s.zoom),d=a.style.map._antialias,g=!!n.extStandardDerivatives,v=n.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return c===0&&!d&&!v&&g},o.identity=Ma,o.identity$1=mM,o.invert=Q1,o.isFullscreen=function(){return!!x.document.fullscreenElement||!!x.document.webkitFullscreenElement},o.isLngLatBehindGlobe=hb,o.isMapAuthenticated=function(a){return Zn.has(a)},o.isMapboxURL=Te,o.isSafariWithAntialiasingBug=function(a){const n=a.navigator?a.navigator.userAgent:null;return!!ri(a)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=gi,o.latLngToECEF=Mh,o.len=e$,o.length=Lp,o.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},o.lngFromMercatorX=Eo,o.loadVectorTile=_O,o.makeRequest=Rt,o.mapValue=function(a,n,s,c,d){return Oe((a-n)/(s-n)*(d-c)+c,c,d)},o.mercatorScale=OM,o.mercatorXfromLng=is,o.mercatorYfromLat=os,o.mercatorZfromAltitude=Oa,o.mul=JF,o.mul$1=QF,o.multiply=Qu,o.multiply$1=aM,o.multiply$2=cM,o.nextPowerOfTwo=yr,o.normalize=ki,o.normalize$1=t$,o.normalize$2=dM,o.number=gr,o.ortho=function(a,n,s,c,d,g,v){var w=1/(n-s),S=1/(c-d),P=1/(g-v);return a[0]=-2*w,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*S,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*P,a[11]=0,a[12]=(n+s)*w,a[13]=(d+c)*S,a[14]=(v+g)*P,a[15]=1,a},o.pbf=mC,o.perspective=function(a,n,s,c,d){var g,v=1/Math.tan(n/2);return a[0]=v/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=v,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,d!=null&&d!==1/0?(a[10]=(d+c)*(g=1/(c-d)),a[14]=2*d*c*g):(a[10]=-1,a[14]=-2*c),a},o.pick=function(a,n){const s={};for(let c=0;c<n.length;c++){const d=n[c];d in a&&(s[d]=a[d])}return s},o.plugin=C,o.pointGeometry=pe,o.polesInViewport=function(a){const n=Ma(new Float64Array(16));Qu(n,a.pixelMatrix,a.globeMatrix);const s=[0,qo,0],c=[0,Zo,0];return Sn(s,s,n),Sn(c,c,n),[s[0]>0&&s[0]<=a.width&&s[1]>0&&s[1]<=a.height&&!hb(a,new Fr(a.center.lat,90)),c[0]>0&&c[0]<=a.width&&c[1]>0&&c[1]<=a.height&&!hb(a,new Fr(a.center.lat,-90))]},o.polygonContainsPoint=oc,o.polygonIntersectsBox=BM,o.polygonIntersectsPolygon=DM,o.polygonizeBounds=function(a,n,s=0,c=!0){const d=new ge(s,s),g=a.sub(d),v=n.add(d),w=[g,new ge(v.x,g.y),v,new ge(g.x,v.y)];return c&&w.push(g.clone()),w},o.posAttributes=Fp,o.postMapLoadEvent=Mr,o.postPerformanceEvent=fn,o.postTurnstileEvent=ur,o.potpack=Db,o.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},o.radToDeg=be,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(a){return a({pluginStatus:m,pluginURL:l}),b.on("pluginStateChange",a),a},o.removeAuthState=function(a){Zn.delete(a)},o.renderColorRamp=xb,o.resample=IM,o.rotateX=eb,o.rotateX$1=gM,o.rotateY=f_,o.rotateY$1=yM,o.rotateZ=function(a,n,s){var c=Math.sin(s),d=Math.cos(s),g=n[0],v=n[1],w=n[2],S=n[3],P=n[4],I=n[5],D=n[6],z=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=g*d+P*c,a[1]=v*d+I*c,a[2]=w*d+D*c,a[3]=S*d+z*c,a[4]=P*d-g*c,a[5]=I*d-v*c,a[6]=D*d-w*c,a[7]=z*d-S*c,a},o.rotateZ$1=function(a,n,s){s*=.5;var c=n[0],d=n[1],g=n[2],v=n[3],w=Math.sin(s),S=Math.cos(s);return a[0]=c*S+d*w,a[1]=d*S-c*w,a[2]=g*S+v*w,a[3]=v*S-g*w,a},o.scale=ec,o.scale$1=fM,o.scale$2=So,o.scaleAndAdd=Bp,o.set=function(a,n,s,c){return a[0]=n,a[1]=s,a[2]=c,a},o.setCacheLimits=function(a,n){fa=a,ws=n},o.setColumn=function(a,n,s){a[4*n+0]=s[0],a[4*n+1]=s[1],a[4*n+2]=s[2],a[4*n+3]=s[3]},o.setRTLTextPlugin=function(a,n,s=!1){if(m===Mp||m===Cp||m===Op)throw new Error("setRTLTextPlugin cannot be called multiple times.");l=ma.resolveURL(a),m=Mp,Il=n,y(),s||M()},o.smoothstep=at,o.spec=Je,o.squaredLength=function(a){var n=a[0],s=a[1],c=a[2];return n*n+s*s+c*c},o.storeAuthState=function(a,n){n?Zn.add(a):Zn.delete(a)},o.sub=Ca,o.subtract=rb,o.symbolSize=dN,o.tileAABB=function(a,n,s,c,d,g,v,w,S){if(S.name==="globe")return a$(a,n,new P_(s,c,d));const P=sc({z:s,x:c,y:d},S);return new Di([(g+P.x/P.scale)*n,n*(P.y/P.scale),v],[(g+P.x2/P.scale)*n,n*(P.y2/P.scale),w])},o.tileCornersToBounds=p_,o.tileTransform=sc,o.transformMat3=function(a,n,s){var c=n[0],d=n[1],g=n[2];return a[0]=c*s[0]+d*s[3]+g*s[6],a[1]=c*s[1]+d*s[4]+g*s[7],a[2]=c*s[2]+d*s[5]+g*s[8],a},o.transformMat4=Sn,o.transformMat4$1=tc,o.transformQuat=hM,o.transitionTileAABBinECEF=wM,o.translate=Dp,o.transpose=function(a,n){if(a===n){var s=n[1],c=n[2],d=n[5];a[1]=n[3],a[2]=n[6],a[3]=s,a[5]=n[7],a[6]=c,a[7]=d}else a[0]=n[0],a[1]=n[3],a[2]=n[6],a[3]=n[1],a[4]=n[4],a[5]=n[7],a[6]=n[2],a[7]=n[5],a[8]=n[8];return a},o.triggerPluginCompletionEvent=f,o.uniqueId=Tr,o.updateGlobeVertexNormal=function(a,n,s,c,d){const g=5*n+2;a.float32[g+0]=s,a.float32[g+1]=c,a.float32[g+2]=d},o.validateCustomStyleLayer=function(a){const n=[],s=a.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),a.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},o.validateFilter=a=>so(Hu(a)),o.validateFog=a=>so(t_(a)),o.validateLayer=a=>so(Yy(a)),o.validateLight=a=>so(e_(a)),o.validateSource=a=>so(Qy(a)),o.validateStyle=n_,o.validateTerrain=a=>so(Tp(a)),o.values=Ot,o.vectorTile=S_,o.version=E,o.warnOnce=ir,o.window=x,o.wrap=ft}),p(["./shared"],function(o){function x(ue){if(typeof ue=="number"||typeof ue=="boolean"||typeof ue=="string"||ue==null)return JSON.stringify(ue);if(Array.isArray(ue)){let Q="[";for(const he of ue)Q+=`${x(he)},`;return`${Q}]`}let Y="{";for(const Q of Object.keys(ue).sort())Y+=`${Q}:${x(ue[Q])},`;return`${Y}}`}function E(ue){let Y="";for(const Q of o.refProperties)Y+=`/${x(ue[Q])}`;return Y}class A{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y){this._layerConfigs={},this._layers={},this.update(Y,[])}update(Y,Q){for(const ve of Y)this._layerConfigs[ve.id]=ve,(this._layers[ve.id]=o.createStyleLayer(ve)).compileFilter(),this.keyCache[ve.id]&&delete this.keyCache[ve.id];for(const ve of Q)delete this.keyCache[ve],delete this._layerConfigs[ve],delete this._layers[ve];this.familiesBySource={};const he=function(ve,Te){const Le={};for(let Ie=0;Ie<ve.length;Ie++){const qe=Te&&Te[ve[Ie].id]||E(ve[Ie]);Te&&(Te[ve[Ie].id]=qe);let yt=Le[qe];yt||(yt=Le[qe]=[]),yt.push(ve[Ie])}const Re=[];for(const Ie in Le)Re.push(Le[Ie]);return Re}(o.values(this._layerConfigs),this.keyCache);for(const ve of he){const Te=ve.map(wt=>this._layers[wt.id]),Le=Te[0];if(Le.visibility==="none")continue;const Re=Le.source||"";let Ie=this.familiesBySource[Re];Ie||(Ie=this.familiesBySource[Re]={});const qe=Le.sourceLayer||"_geojsonTileLayer";let yt=Ie[qe];yt||(yt=Ie[qe]=[]),yt.push(Te)}}}class O{loadTile(Y,Q){const{uid:he,encoding:ve,rawImageData:Te,padding:Le,buildQuadTree:Re}=Y,Ie=o.window.ImageBitmap&&Te instanceof o.window.ImageBitmap?this.getImageData(Te,Le):Te;Q(null,new o.DEMData(he,Ie,ve,Le<1,Re))}getImageData(Y,Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const he=this.offscreenCanvasContext.getImageData(-Q,-Q,Y.width+2*Q,Y.height+2*Q);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),he}}function L(ue,Y){if(ue.length!==0){j(ue[0],Y);for(var Q=1;Q<ue.length;Q++)j(ue[Q],!Y)}}function j(ue,Y){for(var Q=0,he=0,ve=0,Te=ue.length,Le=Te-1;ve<Te;Le=ve++){var Re=(ue[ve][0]-ue[Le][0])*(ue[Le][1]+ue[ve][1]),Ie=Q+Re;he+=Math.abs(Q)>=Math.abs(Re)?Q-Ie+Re:Re-Ie+Q,Q=Ie}Q+he>=0!=!!Y&&ue.reverse()}var F=o.getDefaultExportFromCjs(function ue(Y,Q){var he,ve=Y&&Y.type;if(ve==="FeatureCollection")for(he=0;he<Y.features.length;he++)ue(Y.features[he],Q);else if(ve==="GeometryCollection")for(he=0;he<Y.geometries.length;he++)ue(Y.geometries[he],Q);else if(ve==="Feature")ue(Y.geometry,Q);else if(ve==="Polygon")L(Y.coordinates,Q);else if(ve==="MultiPolygon")for(he=0;he<Y.coordinates.length;he++)L(Y.coordinates[he],Q);return Y});const Z=o.VectorTileFeature.prototype.toGeoJSON;var $={exports:{}},V=o.pointGeometry,U=o.vectorTile.VectorTileFeature,G=q;function q(ue,Y){this.options=Y||{},this.features=ue,this.length=ue.length}function K(ue,Y){this.id=typeof ue.id=="number"?ue.id:void 0,this.type=ue.type,this.rawGeometry=ue.type===1?[ue.geometry]:ue.geometry,this.properties=ue.tags,this.extent=Y||4096}q.prototype.feature=function(ue){return new K(this.features[ue],this.options.extent)},K.prototype.loadGeometry=function(){var ue=this.rawGeometry;this.geometry=[];for(var Y=0;Y<ue.length;Y++){for(var Q=ue[Y],he=[],ve=0;ve<Q.length;ve++)he.push(new V(Q[ve][0],Q[ve][1]));this.geometry.push(he)}return this.geometry},K.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ue=this.geometry,Y=1/0,Q=-1/0,he=1/0,ve=-1/0,Te=0;Te<ue.length;Te++)for(var Le=ue[Te],Re=0;Re<Le.length;Re++){var Ie=Le[Re];Y=Math.min(Y,Ie.x),Q=Math.max(Q,Ie.x),he=Math.min(he,Ie.y),ve=Math.max(ve,Ie.y)}return[Y,he,Q,ve]},K.prototype.toGeoJSON=U.prototype.toGeoJSON;var re=o.pbf,pe=G;function xe(ue){var Y=new re;return function(Q,he){for(var ve in Q.layers)he.writeMessage(3,ge,Q.layers[ve])}(ue,Y),Y.finish()}function ge(ue,Y){var Q;Y.writeVarintField(15,ue.version||1),Y.writeStringField(1,ue.name||""),Y.writeVarintField(5,ue.extent||4096);var he={keys:[],values:[],keycache:{},valuecache:{}};for(Q=0;Q<ue.length;Q++)he.feature=ue.feature(Q),Y.writeMessage(2,Be,he);var ve=he.keys;for(Q=0;Q<ve.length;Q++)Y.writeStringField(3,ve[Q]);var Te=he.values;for(Q=0;Q<Te.length;Q++)Y.writeMessage(4,Me,Te[Q])}function Be(ue,Y){var Q=ue.feature;Q.id!==void 0&&Y.writeVarintField(1,Q.id),Y.writeMessage(2,$e,ue),Y.writeVarintField(3,Q.type),Y.writeMessage(4,_e,Q)}function $e(ue,Y){var Q=ue.feature,he=ue.keys,ve=ue.values,Te=ue.keycache,Le=ue.valuecache;for(var Re in Q.properties){var Ie=Q.properties[Re],qe=Te[Re];if(Ie!==null){qe===void 0&&(he.push(Re),Te[Re]=qe=he.length-1),Y.writeVarint(qe);var yt=typeof Ie;yt!=="string"&&yt!=="boolean"&&yt!=="number"&&(Ie=JSON.stringify(Ie));var wt=yt+":"+Ie,ct=Le[wt];ct===void 0&&(ve.push(Ie),Le[wt]=ct=ve.length-1),Y.writeVarint(ct)}}}function Ve(ue,Y){return(Y<<3)+(7&ue)}function be(ue){return ue<<1^ue>>31}function _e(ue,Y){for(var Q=ue.loadGeometry(),he=ue.type,ve=0,Te=0,Le=Q.length,Re=0;Re<Le;Re++){var Ie=Q[Re],qe=1;he===1&&(qe=Ie.length),Y.writeVarint(Ve(1,qe));for(var yt=he===3?Ie.length-1:Ie.length,wt=0;wt<yt;wt++){wt===1&&he!==1&&Y.writeVarint(Ve(2,yt-1));var ct=Ie[wt].x-ve,Wt=Ie[wt].y-Te;Y.writeVarint(be(ct)),Y.writeVarint(be(Wt)),ve+=ct,Te+=Wt}he===3&&Y.writeVarint(Ve(7,1))}}function Me(ue,Y){var Q=typeof ue;Q==="string"?Y.writeStringField(1,ue):Q==="boolean"?Y.writeBooleanField(7,ue):Q==="number"&&(ue%1!=0?Y.writeDoubleField(3,ue):ue<0?Y.writeSVarintField(6,ue):Y.writeVarintField(5,ue))}$.exports=xe,$.exports.fromVectorTileJs=xe,$.exports.fromGeojsonVt=function(ue,Y){Y=Y||{};var Q={};for(var he in ue)Q[he]=new pe(ue[he].features,Y),Q[he].name=he,Q[he].version=Y.version,Q[he].extent=Y.extent;return xe({layers:Q})},$.exports.GeoJSONWrapper=pe;var ke=o.getDefaultExportFromCjs($.exports);const Ce={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ue=>ue},Oe=Math.fround||(at=new Float32Array(1),ue=>(at[0]=+ue,at[0]));var at;const ft=3,st=5,Ot=6;class St{constructor(Y){this.options=Object.assign(Object.create(Ce),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:Q,minZoom:he,maxZoom:ve}=this.options;Q&&console.time("total time");const Te=`prepare ${Y.length} points`;Q&&console.time(Te),this.points=Y;const Le=[];for(let Ie=0;Ie<Y.length;Ie++){const qe=Y[Ie];if(!qe.geometry)continue;const[yt,wt]=qe.geometry.coordinates,ct=Oe(Kr(yt)),Wt=Oe(yr(wt));Le.push(ct,Wt,1/0,Ie,-1,1),this.options.reduce&&Le.push(0)}let Re=this.trees[ve+1]=this._createTree(Le);Q&&console.timeEnd(Te);for(let Ie=ve;Ie>=he;Ie--){const qe=+Date.now();Re=this.trees[Ie]=this._createTree(this._cluster(Re,Ie)),Q&&console.log("z%d: %d clusters in %dms",Ie,Re.numItems,+Date.now()-qe)}return Q&&console.timeEnd("total time"),this}getClusters(Y,Q){let he=((Y[0]+180)%360+360)%360-180;const ve=Math.max(-90,Math.min(90,Y[1]));let Te=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)he=-180,Te=180;else if(he>Te){const wt=this.getClusters([he,ve,180,Le],Q),ct=this.getClusters([-180,ve,Te,Le],Q);return wt.concat(ct)}const Re=this.trees[this._limitZoom(Q)],Ie=Re.range(Kr(he),yr(Le),Kr(Te),yr(ve)),qe=Re.data,yt=[];for(const wt of Ie){const ct=this.stride*wt;yt.push(qe[ct+st]>1?pr(qe,ct,this.clusterProps):this.points[qe[ct+ft]])}return yt}getChildren(Y){const Q=this._getOriginId(Y),he=this._getOriginZoom(Y),ve="No cluster with the specified id.",Te=this.trees[he];if(!Te)throw new Error(ve);const Le=Te.data;if(Q*this.stride>=Le.length)throw new Error(ve);const Re=this.options.radius/(this.options.extent*Math.pow(2,he-1)),Ie=Te.within(Le[Q*this.stride],Le[Q*this.stride+1],Re),qe=[];for(const yt of Ie){const wt=yt*this.stride;Le[wt+4]===Y&&qe.push(Le[wt+st]>1?pr(Le,wt,this.clusterProps):this.points[Le[wt+ft]])}if(qe.length===0)throw new Error(ve);return qe}getLeaves(Y,Q,he){const ve=[];return this._appendLeaves(ve,Y,Q=Q||10,he=he||0,0),ve}getTile(Y,Q,he){const ve=this.trees[this._limitZoom(Y)],Te=Math.pow(2,Y),{extent:Le,radius:Re}=this.options,Ie=Re/Le,qe=(he-Ie)/Te,yt=(he+1+Ie)/Te,wt={features:[]};return this._addTileFeatures(ve.range((Q-Ie)/Te,qe,(Q+1+Ie)/Te,yt),ve.data,Q,he,Te,wt),Q===0&&this._addTileFeatures(ve.range(1-Ie/Te,qe,1,yt),ve.data,Te,he,Te,wt),Q===Te-1&&this._addTileFeatures(ve.range(0,qe,Ie/Te,yt),ve.data,-1,he,Te,wt),wt.features.length?wt:null}getClusterExpansionZoom(Y){let Q=this._getOriginZoom(Y)-1;for(;Q<=this.options.maxZoom;){const he=this.getChildren(Y);if(Q++,he.length!==1)break;Y=he[0].properties.cluster_id}return Q}_appendLeaves(Y,Q,he,ve,Te){const Le=this.getChildren(Q);for(const Re of Le){const Ie=Re.properties;if(Ie&&Ie.cluster?Te+Ie.point_count<=ve?Te+=Ie.point_count:Te=this._appendLeaves(Y,Ie.cluster_id,he,ve,Te):Te<ve?Te++:Y.push(Re),Y.length===he)break}return Te}_createTree(Y){const Q=new o.KDBush(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let he=0;he<Y.length;he+=this.stride)Q.add(Y[he],Y[he+1]);return Q.finish(),Q.data=Y,Q}_addTileFeatures(Y,Q,he,ve,Te,Le){for(const Re of Y){const Ie=Re*this.stride,qe=Q[Ie+st]>1;let yt,wt,ct;if(qe)yt=Tr(Q,Ie,this.clusterProps),wt=Q[Ie],ct=Q[Ie+1];else{const Zt=this.points[Q[Ie+ft]];yt=Zt.properties;const[or,ur]=Zt.geometry.coordinates;wt=Kr(or),ct=yr(ur)}const Wt={type:1,geometry:[[Math.round(this.options.extent*(wt*Te-he)),Math.round(this.options.extent*(ct*Te-ve))]],tags:yt};let er;er=qe||this.options.generateId?Q[Ie+ft]:this.points[Q[Ie+ft]].id,er!==void 0&&(Wt.id=er),Le.features.push(Wt)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,Q){const{radius:he,extent:ve,reduce:Te,minPoints:Le}=this.options,Re=he/(ve*Math.pow(2,Q)),Ie=Y.data,qe=[],yt=this.stride;for(let wt=0;wt<Ie.length;wt+=yt){if(Ie[wt+2]<=Q)continue;Ie[wt+2]=Q;const ct=Ie[wt],Wt=Ie[wt+1],er=Y.within(Ie[wt],Ie[wt+1],Re),Zt=Ie[wt+st];let or=Zt;for(const ur of er){const qt=ur*yt;Ie[qt+2]>Q&&(or+=Ie[qt+st])}if(or>Zt&&or>=Le){let ur,qt=ct*Zt,Mr=Wt*Zt,un=-1;const fn=((wt/yt|0)<<5)+(Q+1)+this.points.length;for(const Lr of er){const dn=Lr*yt;if(Ie[dn+2]<=Q)continue;Ie[dn+2]=Q;const Zn=Ie[dn+st];qt+=Ie[dn]*Zn,Mr+=Ie[dn+1]*Zn,Ie[dn+4]=fn,Te&&(ur||(ur=this._map(Ie,wt,!0),un=this.clusterProps.length,this.clusterProps.push(ur)),Te(ur,this._map(Ie,dn)))}Ie[wt+4]=fn,qe.push(qt/or,Mr/or,1/0,fn,-1,or),Te&&qe.push(un)}else{for(let ur=0;ur<yt;ur++)qe.push(Ie[wt+ur]);if(or>1)for(const ur of er){const qt=ur*yt;if(!(Ie[qt+2]<=Q)){Ie[qt+2]=Q;for(let Mr=0;Mr<yt;Mr++)qe.push(Ie[qt+Mr])}}}}return qe}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,Q,he){if(Y[Q+st]>1){const Le=this.clusterProps[Y[Q+Ot]];return he?Object.assign({},Le):Le}const ve=this.points[Y[Q+ft]].properties,Te=this.options.map(ve);return he&&Te===ve?Object.assign({},Te):Te}}function pr(ue,Y,Q){return{type:"Feature",id:ue[Y+ft],properties:Tr(ue,Y,Q),geometry:{type:"Point",coordinates:[(he=ue[Y],360*(he-.5)),kt(ue[Y+1])]}};var he}function Tr(ue,Y,Q){const he=ue[Y+st],ve=he>=1e4?`${Math.round(he/1e3)}k`:he>=1e3?Math.round(he/100)/10+"k":he,Te=ue[Y+Ot],Le=Te===-1?{}:Object.assign({},Q[Te]);return Object.assign(Le,{cluster:!0,cluster_id:ue[Y+ft],point_count:he,point_count_abbreviated:ve})}function Kr(ue){return ue/360+.5}function yr(ue){const Y=Math.sin(ue*Math.PI/180),Q=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return Q<0?0:Q>1?1:Q}function kt(ue){const Y=(180-360*ue)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Xt(ue,Y,Q,he){for(var ve,Te=he,Le=Q-Y>>1,Re=Q-Y,Ie=ue[Y],qe=ue[Y+1],yt=ue[Q],wt=ue[Q+1],ct=Y+3;ct<Q;ct+=3){var Wt=Jt(ue[ct],ue[ct+1],Ie,qe,yt,wt);if(Wt>Te)ve=ct,Te=Wt;else if(Wt===Te){var er=Math.abs(ct-Le);er<Re&&(ve=ct,Re=er)}}Te>he&&(ve-Y>3&&Xt(ue,Y,ve,he),ue[ve+2]=Te,Q-ve>3&&Xt(ue,ve,Q,he))}function Jt(ue,Y,Q,he,ve,Te){var Le=ve-Q,Re=Te-he;if(Le!==0||Re!==0){var Ie=((ue-Q)*Le+(Y-he)*Re)/(Le*Le+Re*Re);Ie>1?(Q=ve,he=Te):Ie>0&&(Q+=Le*Ie,he+=Re*Ie)}return(Le=ue-Q)*Le+(Re=Y-he)*Re}function et(ue,Y,Q,he){var ve={id:ue===void 0?null:ue,type:Y,geometry:Q,tags:he,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Te){var Le=Te.geometry,Re=Te.type;if(Re==="Point"||Re==="MultiPoint"||Re==="LineString")Or(Te,Le);else if(Re==="Polygon"||Re==="MultiLineString")for(var Ie=0;Ie<Le.length;Ie++)Or(Te,Le[Ie]);else if(Re==="MultiPolygon")for(Ie=0;Ie<Le.length;Ie++)for(var qe=0;qe<Le[Ie].length;qe++)Or(Te,Le[Ie][qe])}(ve),ve}function Or(ue,Y){for(var Q=0;Q<Y.length;Q+=3)ue.minX=Math.min(ue.minX,Y[Q]),ue.minY=Math.min(ue.minY,Y[Q+1]),ue.maxX=Math.max(ue.maxX,Y[Q]),ue.maxY=Math.max(ue.maxY,Y[Q+1])}function Qt(ue,Y,Q,he){if(Y.geometry){var ve=Y.geometry.coordinates,Te=Y.geometry.type,Le=Math.pow(Q.tolerance/((1<<Q.maxZoom)*Q.extent),2),Re=[],Ie=Y.id;if(Q.promoteId?Ie=Y.properties[Q.promoteId]:Q.generateId&&(Ie=he||0),Te==="Point")Ir(ve,Re);else if(Te==="MultiPoint")for(var qe=0;qe<ve.length;qe++)Ir(ve[qe],Re);else if(Te==="LineString")ir(ve,Re,Le,!1);else if(Te==="MultiLineString"){if(Q.lineMetrics){for(qe=0;qe<ve.length;qe++)ir(ve[qe],Re=[],Le,!1),ue.push(et(Ie,"LineString",Re,Y.properties));return}kr(ve,Re,Le,!1)}else if(Te==="Polygon")kr(ve,Re,Le,!0);else{if(Te!=="MultiPolygon"){if(Te==="GeometryCollection"){for(qe=0;qe<Y.geometry.geometries.length;qe++)Qt(ue,{id:Ie,geometry:Y.geometry.geometries[qe],properties:Y.properties},Q,he);return}throw new Error("Input data is not a valid GeoJSON object.")}for(qe=0;qe<ve.length;qe++){var yt=[];kr(ve[qe],yt,Le,!0),Re.push(yt)}}ue.push(et(Ie,Te,Re,Y.properties))}}function Ir(ue,Y){Y.push(qn(ue[0])),Y.push($n(ue[1])),Y.push(0)}function ir(ue,Y,Q,he){for(var ve,Te,Le=0,Re=0;Re<ue.length;Re++){var Ie=qn(ue[Re][0]),qe=$n(ue[Re][1]);Y.push(Ie),Y.push(qe),Y.push(0),Re>0&&(Le+=he?(ve*qe-Ie*Te)/2:Math.sqrt(Math.pow(Ie-ve,2)+Math.pow(qe-Te,2))),ve=Ie,Te=qe}var yt=Y.length-3;Y[2]=1,Xt(Y,0,yt,Q),Y[yt+2]=1,Y.size=Math.abs(Le),Y.start=0,Y.end=Y.size}function kr(ue,Y,Q,he){for(var ve=0;ve<ue.length;ve++){var Te=[];ir(ue[ve],Te,Q,he),Y.push(Te)}}function qn(ue){return ue/360+.5}function $n(ue){var Y=Math.sin(ue*Math.PI/180),Q=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return Q<0?0:Q>1?1:Q}function tn(ue,Y,Q,he,ve,Te,Le,Re){if(he/=Y,Te>=(Q/=Y)&&Le<he)return ue;if(Le<Q||Te>=he)return null;for(var Ie=[],qe=0;qe<ue.length;qe++){var yt=ue[qe],wt=yt.geometry,ct=yt.type,Wt=ve===0?yt.minX:yt.minY,er=ve===0?yt.maxX:yt.maxY;if(Wt>=Q&&er<he)Ie.push(yt);else if(!(er<Q||Wt>=he)){var Zt=[];if(ct==="Point"||ct==="MultiPoint")fi(wt,Zt,Q,he,ve);else if(ct==="LineString")ri(wt,Zt,Q,he,ve,!1,Re.lineMetrics);else if(ct==="MultiLineString")Wi(wt,Zt,Q,he,ve,!1);else if(ct==="Polygon")Wi(wt,Zt,Q,he,ve,!0);else if(ct==="MultiPolygon")for(var or=0;or<wt.length;or++){var ur=[];Wi(wt[or],ur,Q,he,ve,!0),ur.length&&Zt.push(ur)}if(Zt.length){if(Re.lineMetrics&&ct==="LineString"){for(or=0;or<Zt.length;or++)Ie.push(et(yt.id,ct,Zt[or],yt.tags));continue}ct!=="LineString"&&ct!=="MultiLineString"||(Zt.length===1?(ct="LineString",Zt=Zt[0]):ct="MultiLineString"),ct!=="Point"&&ct!=="MultiPoint"||(ct=Zt.length===3?"Point":"MultiPoint"),Ie.push(et(yt.id,ct,Zt,yt.tags))}}}return Ie.length?Ie:null}function fi(ue,Y,Q,he,ve){for(var Te=0;Te<ue.length;Te+=3){var Le=ue[Te+ve];Le>=Q&&Le<=he&&(Y.push(ue[Te]),Y.push(ue[Te+1]),Y.push(ue[Te+2]))}}function ri(ue,Y,Q,he,ve,Te,Le){for(var Re,Ie,qe=ro(ue),yt=ve===0?fa:ws,wt=ue.start,ct=0;ct<ue.length-3;ct+=3){var Wt=ue[ct],er=ue[ct+1],Zt=ue[ct+2],or=ue[ct+3],ur=ue[ct+4],qt=ve===0?Wt:er,Mr=ve===0?or:ur,un=!1;Le&&(Re=Math.sqrt(Math.pow(Wt-or,2)+Math.pow(er-ur,2))),qt<Q?Mr>Q&&(Ie=yt(qe,Wt,er,or,ur,Q),Le&&(qe.start=wt+Re*Ie)):qt>he?Mr<he&&(Ie=yt(qe,Wt,er,or,ur,he),Le&&(qe.start=wt+Re*Ie)):no(qe,Wt,er,Zt),Mr<Q&&qt>=Q&&(Ie=yt(qe,Wt,er,or,ur,Q),un=!0),Mr>he&&qt<=he&&(Ie=yt(qe,Wt,er,or,ur,he),un=!0),!Te&&un&&(Le&&(qe.end=wt+Re*Ie),Y.push(qe),qe=ro(ue)),Le&&(wt+=Re)}var fn=ue.length-3;Wt=ue[fn],er=ue[fn+1],Zt=ue[fn+2],(qt=ve===0?Wt:er)>=Q&&qt<=he&&no(qe,Wt,er,Zt),fn=qe.length-3,Te&&fn>=3&&(qe[fn]!==qe[0]||qe[fn+1]!==qe[1])&&no(qe,qe[0],qe[1],qe[2]),qe.length&&Y.push(qe)}function ro(ue){var Y=[];return Y.size=ue.size,Y.start=ue.start,Y.end=ue.end,Y}function Wi(ue,Y,Q,he,ve,Te){for(var Le=0;Le<ue.length;Le++)ri(ue[Le],Y,Q,he,ve,Te,!1)}function no(ue,Y,Q,he){ue.push(Y),ue.push(Q),ue.push(he)}function fa(ue,Y,Q,he,ve,Te){var Le=(Te-Y)/(he-Y);return ue.push(Te),ue.push(Q+(ve-Q)*Le),ue.push(1),Le}function ws(ue,Y,Q,he,ve,Te){var Le=(Te-Q)/(ve-Q);return ue.push(Y+(he-Y)*Le),ue.push(Te),ue.push(1),Le}function di(ue,Y){for(var Q=[],he=0;he<ue.length;he++){var ve,Te=ue[he],Le=Te.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")ve=jo(Te.geometry,Y);else if(Le==="MultiLineString"||Le==="Polygon"){ve=[];for(var Re=0;Re<Te.geometry.length;Re++)ve.push(jo(Te.geometry[Re],Y))}else if(Le==="MultiPolygon")for(ve=[],Re=0;Re<Te.geometry.length;Re++){for(var Ie=[],qe=0;qe<Te.geometry[Re].length;qe++)Ie.push(jo(Te.geometry[Re][qe],Y));ve.push(Ie)}Q.push(et(Te.id,Le,ve,Te.tags))}return Q}function jo(ue,Y){var Q=[];Q.size=ue.size,ue.start!==void 0&&(Q.start=ue.start,Q.end=ue.end);for(var he=0;he<ue.length;he+=3)Q.push(ue[he]+Y,ue[he+1],ue[he+2]);return Q}function Ya(ue,Y){if(ue.transformed)return ue;var Q,he,ve,Te=1<<ue.z,Le=ue.x,Re=ue.y;for(Q=0;Q<ue.features.length;Q++){var Ie=ue.features[Q],qe=Ie.geometry,yt=Ie.type;if(Ie.geometry=[],yt===1)for(he=0;he<qe.length;he+=2)Ie.geometry.push(da(qe[he],qe[he+1],Y,Te,Le,Re));else for(he=0;he<qe.length;he++){var wt=[];for(ve=0;ve<qe[he].length;ve+=2)wt.push(da(qe[he][ve],qe[he][ve+1],Y,Te,Le,Re));Ie.geometry.push(wt)}}return ue.transformed=!0,ue}function da(ue,Y,Q,he,ve,Te){return[Math.round(Q*(ue*he-ve)),Math.round(Q*(Y*he-Te))]}function pa(ue,Y,Q,he,ve){for(var Te=Y===ve.maxZoom?0:ve.tolerance/((1<<Y)*ve.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Q,y:he,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Re=0;Re<ue.length;Re++){Le.numFeatures++,Ts(Le,ue[Re],Te,ve);var Ie=ue[Re].minX,qe=ue[Re].minY,yt=ue[Re].maxX,wt=ue[Re].maxY;Ie<Le.minX&&(Le.minX=Ie),qe<Le.minY&&(Le.minY=qe),yt>Le.maxX&&(Le.maxX=yt),wt>Le.maxY&&(Le.maxY=wt)}return Le}function Ts(ue,Y,Q,he){var ve=Y.geometry,Te=Y.type,Le=[];if(Te==="Point"||Te==="MultiPoint")for(var Re=0;Re<ve.length;Re+=3)Le.push(ve[Re]),Le.push(ve[Re+1]),ue.numPoints++,ue.numSimplified++;else if(Te==="LineString")Ke(Le,ve,ue,Q,!1,!1);else if(Te==="MultiLineString"||Te==="Polygon")for(Re=0;Re<ve.length;Re++)Ke(Le,ve[Re],ue,Q,Te==="Polygon",Re===0);else if(Te==="MultiPolygon")for(var Ie=0;Ie<ve.length;Ie++){var qe=ve[Ie];for(Re=0;Re<qe.length;Re++)Ke(Le,qe[Re],ue,Q,!0,Re===0)}if(Le.length){var yt=Y.tags||null;if(Te==="LineString"&&he.lineMetrics){for(var wt in yt={},Y.tags)yt[wt]=Y.tags[wt];yt.mapbox_clip_start=ve.start/ve.size,yt.mapbox_clip_end=ve.end/ve.size}var ct={geometry:Le,type:Te==="Polygon"||Te==="MultiPolygon"?3:Te==="LineString"||Te==="MultiLineString"?2:1,tags:yt};Y.id!==null&&(ct.id=Y.id),ue.features.push(ct)}}function Ke(ue,Y,Q,he,ve,Te){var Le=he*he;if(he>0&&Y.size<(ve?Le:he))Q.numPoints+=Y.length/3;else{for(var Re=[],Ie=0;Ie<Y.length;Ie+=3)(he===0||Y[Ie+2]>Le)&&(Q.numSimplified++,Re.push(Y[Ie]),Re.push(Y[Ie+1])),Q.numPoints++;ve&&function(qe,yt){for(var wt=0,ct=0,Wt=qe.length,er=Wt-2;ct<Wt;er=ct,ct+=2)wt+=(qe[ct]-qe[er])*(qe[ct+1]+qe[er+1]);if(wt>0===yt)for(ct=0,Wt=qe.length;ct<Wt/2;ct+=2){var Zt=qe[ct],or=qe[ct+1];qe[ct]=qe[Wt-2-ct],qe[ct+1]=qe[Wt-1-ct],qe[Wt-2-ct]=Zt,qe[Wt-1-ct]=or}}(Re,Te),ue.push(Re)}}function tt(ue,Y){var Q=(Y=this.options=function(ve,Te){for(var Le in Te)ve[Le]=Te[Le];return ve}(Object.create(this.options),Y)).debug;if(Q&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");var he=function(ve,Te){var Le=[];if(ve.type==="FeatureCollection")for(var Re=0;Re<ve.features.length;Re++)Qt(Le,ve.features[Re],Te,Re);else Qt(Le,ve.type==="Feature"?ve:{geometry:ve},Te);return Le}(ue,Y);this.tiles={},this.tileCoords=[],Q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(ve,Te){var Le=Te.buffer/Te.extent,Re=ve,Ie=tn(ve,1,-1-Le,Le,0,-1,2,Te),qe=tn(ve,1,1-Le,2+Le,0,-1,2,Te);return(Ie||qe)&&(Re=tn(ve,1,-Le,1+Le,0,-1,2,Te)||[],Ie&&(Re=di(Ie,1).concat(Re)),qe&&(Re=Re.concat(di(qe,-1)))),Re}(he,Y),he.length&&this.splitTile(he,0,0,0),Q&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xt(ue,Y,Q){return 32*((1<<ue)*Q+Y)+ue}function Rt(ue,Y){const Q=ue.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);const he=this._geoJSONIndex.getTile(Q.z,Q.x,Q.y);if(!he)return Y(null,null);const ve=new class{constructor(Le){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=Le.length,this._features=Le}feature(Le){return new class{constructor(Re){this._feature=Re,this.extent=o.EXTENT,this.type=Re.type,this.properties=Re.tags,"id"in Re&&!isNaN(Re.id)&&(this.id=parseInt(Re.id,10))}loadGeometry(){if(this._feature.type===1){const Re=[];for(const Ie of this._feature.geometry)Re.push([new o.Point(Ie[0],Ie[1])]);return Re}{const Re=[];for(const Ie of this._feature.geometry){const qe=[];for(const yt of Ie)qe.push(new o.Point(yt[0],yt[1]));Re.push(qe)}return Re}}toGeoJSON(Re,Ie,qe){return Z.call(this,Re,Ie,qe)}}(this._features[Le])}}(he.features);let Te=ke(ve);Te.byteOffset===0&&Te.byteLength===Te.buffer.byteLength||(Te=new Uint8Array(Te)),Y(null,{vectorTile:ve,rawData:Te.buffer})}tt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},tt.prototype.splitTile=function(ue,Y,Q,he,ve,Te,Le){for(var Re=[ue,Y,Q,he],Ie=this.options,qe=Ie.debug;Re.length;){he=Re.pop(),Q=Re.pop(),Y=Re.pop(),ue=Re.pop();var yt=1<<Y,wt=xt(Y,Q,he),ct=this.tiles[wt];if(!ct&&(qe>1&&console.time("creation"),ct=this.tiles[wt]=pa(ue,Y,Q,he,Ie),this.tileCoords.push({z:Y,x:Q,y:he}),qe)){qe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,Q,he,ct.numFeatures,ct.numPoints,ct.numSimplified),console.timeEnd("creation"));var Wt="z"+Y;this.stats[Wt]=(this.stats[Wt]||0)+1,this.total++}if(ct.source=ue,ve){if(Y===Ie.maxZoom||Y===ve)continue;var er=1<<ve-Y;if(Q!==Math.floor(Te/er)||he!==Math.floor(Le/er))continue}else if(Y===Ie.indexMaxZoom||ct.numPoints<=Ie.indexMaxPoints)continue;if(ct.source=null,ue.length!==0){qe>1&&console.time("clipping");var Zt,or,ur,qt,Mr,un,fn=.5*Ie.buffer/Ie.extent,Lr=.5-fn,dn=.5+fn,Zn=1+fn;Zt=or=ur=qt=null,Mr=tn(ue,yt,Q-fn,Q+dn,0,ct.minX,ct.maxX,Ie),un=tn(ue,yt,Q+Lr,Q+Zn,0,ct.minX,ct.maxX,Ie),ue=null,Mr&&(Zt=tn(Mr,yt,he-fn,he+dn,1,ct.minY,ct.maxY,Ie),or=tn(Mr,yt,he+Lr,he+Zn,1,ct.minY,ct.maxY,Ie),Mr=null),un&&(ur=tn(un,yt,he-fn,he+dn,1,ct.minY,ct.maxY,Ie),qt=tn(un,yt,he+Lr,he+Zn,1,ct.minY,ct.maxY,Ie),un=null),qe>1&&console.timeEnd("clipping"),Re.push(Zt||[],Y+1,2*Q,2*he),Re.push(or||[],Y+1,2*Q,2*he+1),Re.push(ur||[],Y+1,2*Q+1,2*he),Re.push(qt||[],Y+1,2*Q+1,2*he+1)}}},tt.prototype.getTile=function(ue,Y,Q){var he=this.options,ve=he.extent,Te=he.debug;if(ue<0||ue>24)return null;var Le=1<<ue,Re=xt(ue,Y=(Y%Le+Le)%Le,Q);if(this.tiles[Re])return Ya(this.tiles[Re],ve);Te>1&&console.log("drilling down to z%d-%d-%d",ue,Y,Q);for(var Ie,qe=ue,yt=Y,wt=Q;!Ie&&qe>0;)qe--,yt=Math.floor(yt/2),wt=Math.floor(wt/2),Ie=this.tiles[xt(qe,yt,wt)];return Ie&&Ie.source?(Te>1&&console.log("found parent tile z%d-%d-%d",qe,yt,wt),Te>1&&console.time("drilling down"),this.splitTile(Ie.source,qe,yt,wt,ue,Y,Q),Te>1&&console.timeEnd("drilling down"),this.tiles[Re]?Ya(this.tiles[Re],ve):null):null};class Kt extends o.VectorTileWorkerSource{constructor(Y,Q,he,ve,Te){super(Y,Q,he,ve,Rt),Te&&(this.loadGeoJSON=Te)}loadData(Y,Q){const he=Y&&Y.request,ve=he&&he.collectResourceTiming;this.loadGeoJSON(Y,(Te,Le)=>{if(Te||!Le)return Q(Te);if(typeof Le!="object")return Q(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{F(Le,!0);try{if(Y.filter){const Ie=o.createExpression(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ie.result==="error")throw new Error(Ie.value.map(yt=>`${yt.key}: ${yt.message}`).join(", "));Le={type:"FeatureCollection",features:Le.features.filter(yt=>Ie.value.evaluate({zoom:0},yt))}}this._geoJSONIndex=Y.cluster?new St(function({superclusterOptions:Ie,clusterProperties:qe}){if(!qe||!Ie)return Ie;const yt={},wt={},ct={accumulated:null,zoom:0},Wt={properties:null},er=Object.keys(qe);for(const Zt of er){const[or,ur]=qe[Zt],qt=o.createExpression(ur),Mr=o.createExpression(typeof or=="string"?[or,["accumulated"],["get",Zt]]:or);yt[Zt]=qt.value,wt[Zt]=Mr.value}return Ie.map=Zt=>{Wt.properties=Zt;const or={};for(const ur of er)or[ur]=yt[ur].evaluate(ct,Wt);return or},Ie.reduce=(Zt,or)=>{Wt.properties=or;for(const ur of er)ct.accumulated=Zt[ur],Zt[ur]=wt[ur].evaluate(ct,Wt)},Ie}(Y)).load(Le.features):function(Ie,qe){return new tt(Ie,qe)}(Le,Y.geojsonVtOptions)}catch(Ie){return Q(Ie)}this.loaded={};const Re={};if(ve){const Ie=o.getPerformanceMeasurement(he);Ie&&(Re.resourceTiming={},Re.resourceTiming[Y.source]=JSON.parse(JSON.stringify(Ie)))}Q(null,Re)}})}reloadTile(Y,Q){const he=this.loaded;return he&&he[Y.uid]?super.reloadTile(Y,Q):this.loadTile(Y,Q)}loadGeoJSON(Y,Q){if(Y.request)o.getJSON(Y.request,Q);else{if(typeof Y.data!="string")return Q(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));try{return Q(null,JSON.parse(Y.data))}catch{return Q(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Y,Q){try{Q(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(he){Q(he)}}getClusterChildren(Y,Q){try{Q(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(he){Q(he)}}getClusterLeaves(Y,Q){try{Q(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(he){Q(he)}}}class Yt{constructor(Y){this.self=Y,this.actor=new o.Actor(Y,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:Kt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Q,he)=>{if(this.workerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.workerSourceTypes[Q]=he},this.self.registerRTLTextPlugin=Q=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=Q.applyArabicShaping,o.plugin.processBidirectionalText=Q.processBidirectionalText,o.plugin.processStyledBidirectionalText=Q.processStyledBidirectionalText}}clearCaches(Y,Q,he){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y],he()}checkIfReady(Y,Q,he){he()}setReferrer(Y,Q){this.referrer=Q}spriteLoaded(Y,Q){this.isSpriteLoaded[Y]=Q;for(const he in this.workerSources[Y]){const ve=this.workerSources[Y][he];for(const Te in ve)ve[Te]instanceof o.VectorTileWorkerSource&&(ve[Te].isSpriteLoaded=Q,ve[Te].fire(new o.Event("isSpriteLoaded")))}}setImages(Y,Q,he){this.availableImages[Y]=Q;for(const ve in this.workerSources[Y]){const Te=this.workerSources[Y][ve];for(const Le in Te)Te[Le].availableImages=Q}he()}enableTerrain(Y,Q,he){this.terrain=Q,he()}setProjection(Y,Q){this.projections[Y]=o.getProjection(Q)}setLayers(Y,Q,he){this.getLayerIndex(Y).replace(Q),he()}updateLayers(Y,Q,he){this.getLayerIndex(Y).update(Q.layers,Q.removedIds),he()}loadTile(Y,Q,he){const ve=this.enableTerrain?o.extend({enableTerrain:this.terrain},Q):Q;ve.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,Q.type,Q.source).loadTile(ve,he)}loadDEMTile(Y,Q,he){const ve=this.enableTerrain?o.extend({buildQuadTree:this.terrain},Q):Q;this.getDEMWorkerSource(Y,Q.source).loadTile(ve,he)}reloadTile(Y,Q,he){const ve=this.enableTerrain?o.extend({enableTerrain:this.terrain},Q):Q;ve.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,Q.type,Q.source).reloadTile(ve,he)}abortTile(Y,Q,he){this.getWorkerSource(Y,Q.type,Q.source).abortTile(Q,he)}removeTile(Y,Q,he){this.getWorkerSource(Y,Q.type,Q.source).removeTile(Q,he)}removeSource(Y,Q,he){if(!this.workerSources[Y]||!this.workerSources[Y][Q.type]||!this.workerSources[Y][Q.type][Q.source])return;const ve=this.workerSources[Y][Q.type][Q.source];delete this.workerSources[Y][Q.type][Q.source],ve.removeSource!==void 0?ve.removeSource(Q,he):he()}loadWorkerSource(Y,Q,he){try{this.self.importScripts(Q.url),he()}catch(ve){he(ve.toString())}}syncRTLPluginState(Y,Q,he){try{o.plugin.setState(Q);const ve=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&ve!=null){this.self.importScripts(ve);const Te=o.plugin.isParsed();he(Te?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ve}`),Te)}}catch(ve){he(ve.toString())}}getAvailableImages(Y){let Q=this.availableImages[Y];return Q||(Q=[]),Q}getLayerIndex(Y){let Q=this.layerIndexes[Y];return Q||(Q=this.layerIndexes[Y]=new A),Q}getWorkerSource(Y,Q,he){if(this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][Q]||(this.workerSources[Y][Q]={}),!this.workerSources[Y][Q][he]){const ve={send:(Te,Le,Re,Ie,qe,yt)=>{this.actor.send(Te,Le,Re,Y,qe,yt)},scheduler:this.actor.scheduler};this.workerSources[Y][Q][he]=new this.workerSourceTypes[Q](ve,this.getLayerIndex(Y),this.getAvailableImages(Y),this.isSpriteLoaded[Y])}return this.workerSources[Y][Q][he]}getDEMWorkerSource(Y,Q){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][Q]||(this.demWorkerSources[Y][Q]=new O),this.demWorkerSources[Y][Q]}enforceCacheSizeLimit(Y,Q){o.enforceCacheSizeLimit(Q)}getWorkerPerformanceMetrics(Y,Q,he){he(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Yt(self)),Yt}),p(["./shared"],function(o){function x(m,l){if(Array.isArray(m)){if(!Array.isArray(l)||m.length!==l.length)return!1;for(let f=0;f<m.length;f++)if(!x(m[f],l[f]))return!1;return!0}if(typeof m=="object"&&m!==null&&l!==null){if(typeof l!="object"||Object.keys(m).length!==Object.keys(l).length)return!1;for(const f in m)if(!x(m[f],l[f]))return!1;return!0}return m===l}var E=A;function A(m){return!function(l){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,b,T=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(T);try{b=new Worker(M),y=!0}catch{y=!1}return b&&b.terminate(),URL.revokeObjectURL(M),y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var y=document.createElement("canvas");y.width=y.height=1;var b=y.getContext("2d");if(!b)return!1;var T=b.getImageData(0,0,1,1);return T&&T.width===y.width}()?(O[f=l&&l.failIfMajorPerformanceCaveat]===void 0&&(O[f]=function(y){var b,T=function(M){var C=document.createElement("canvas"),k=Object.create(A.webGLContextAttributes);return k.failIfMajorPerformanceCaveat=M,C.getContext("webgl",k)||C.getContext("experimental-webgl",k)}(y);if(!T)return!1;try{b=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!b||T.isContextLost())&&(T.shaderSource(b,"void main() {}"),T.compileShader(b),T.getShaderParameter(b,T.COMPILE_STATUS)===!0)}(f)),O[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f}(m)}var O={};function L(m,l,f){const y=o.window.document.createElement(m);return l!==void 0&&(y.className=l),f&&f.appendChild(y),y}function j(m,l,f){const y=o.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const b of Object.keys(l))y.setAttributeNS(null,b,l[b]);return f&&f.appendChild(y),y}A.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const F=o.window.document&&o.window.document.documentElement.style,Z=F&&F.userSelect!==void 0?"userSelect":"WebkitUserSelect";let $;function V(){F&&Z&&($=F[Z],F[Z]="none")}function U(){F&&Z&&(F[Z]=$)}function G(m){m.preventDefault(),m.stopPropagation(),o.window.removeEventListener("click",G,!0)}function q(){o.window.addEventListener("click",G,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",G,!0)},0)}function K(m,l){const f=m.getBoundingClientRect();return xe(m,f,l)}function re(m,l){const f=m.getBoundingClientRect(),y=[];for(let b=0;b<l.length;b++)y.push(xe(m,f,l[b]));return y}function pe(m){return o.window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function xe(m,l,f){const y=m.offsetWidth===l.width?1:m.offsetWidth/l.width;return new o.Point((f.clientX-l.left)*y,(f.clientY-l.top)*y)}function ge(m,l){var f=l[0],y=l[1],b=l[2],T=l[3],M=f*T-b*y;return M?(m[0]=T*(M=1/M),m[1]=-y*M,m[2]=-b*M,m[3]=f*M,m):null}function Be(m){const{userImage:l}=m;return!!(l&&l.render&&l.render())&&(m.data.replace(new Uint8Array(l.data.buffer)),!0)}class $e extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:f,callback:y}of this.requestors)this._notify(f,y);this.requestors=[]}}hasImage(l){return!!this.getImage(l)}getImage(l){return this.images[l]}addImage(l,f){this._validate(l,f)&&(this.images[l]=f)}_validate(l,f){let y=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),y=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),y=!1),this._validateContent(f.content,f)||(this.fire(new o.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),y=!1),y}_validateStretch(l,f){if(!l)return!0;let y=0;for(const b of l){if(b[0]<y||b[1]<b[0]||f<b[1])return!1;y=b[1]}return!0}_validateContent(l,f){return!(l&&(l.length!==4||l[0]<0||f.data.width<l[0]||l[1]<0||f.data.height<l[1]||l[2]<0||f.data.width<l[2]||l[3]<0||f.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,f){f.version=this.images[l].version+1,this.images[l]=f,this.updatedImages[l]=!0}removeImage(l){const f=this.images[l];delete this.images[l],delete this.patterns[l],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,f){let y=!0;if(!this.isLoaded())for(const b of l)this.images[b]||(y=!1);this.isLoaded()||y?this._notify(l,f):this.requestors.push({ids:l,callback:f})}_notify(l,f){const y={};for(const b of l){this.images[b]||this.fire(new o.Event("styleimagemissing",{id:b}));const T=this.images[b];T?y[b]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:!!(T.userImage&&T.userImage.render)}:o.warnOnce(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,y)}getPixelSize(){const{width:l,height:f}=this.atlasImage;return{width:l,height:f}}getPattern(l){const f=this.patterns[l],y=this.getImage(l);if(!y)return null;if(f&&f.position.version===y.version)return f.position;if(f)f.position.version=y.version;else{const b={w:y.data.width+2,h:y.data.height+2,x:0,y:0},T=new o.ImagePosition(b,y);this.patterns[l]={bin:b,position:T}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const f=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(l,this.atlasImage,f.RGBA),this.atlasTexture&&this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const T in this.patterns)l.push(this.patterns[T].bin);const{w:f,h:y}=o.potpack(l),b=this.atlasImage;b.resize({width:f||1,height:y||1});for(const T in this.patterns){const{bin:M}=this.patterns[T],C=M.x+1,k=M.y+1,B=this.images[T].data,R=B.width,H=B.height;o.RGBAImage.copy(B,b,{x:0,y:0},{x:C,y:k},{width:R,height:H}),o.RGBAImage.copy(B,b,{x:0,y:H-1},{x:C,y:k-1},{width:R,height:1}),o.RGBAImage.copy(B,b,{x:0,y:0},{x:C,y:k+H},{width:R,height:1}),o.RGBAImage.copy(B,b,{x:R-1,y:0},{x:C-1,y:k},{width:1,height:H}),o.RGBAImage.copy(B,b,{x:0,y:0},{x:C+R,y:k},{width:1,height:H})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const f of l){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const y=this.images[f];Be(y)&&this.updateImage(f,y)}}}const Ve=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(m,l){return function([f,y,b]){const T=o.degToRad(y+90),M=o.degToRad(b);return{x:f*Math.cos(T)*Math.sin(M),y:f*Math.sin(T)*Math.sin(M),z:f*Math.cos(M),azimuthal:y,polar:b}}(m.expression.evaluate(l))}interpolate(m,l,f){return{x:o.number(m.x,l.x,f),y:o.number(m.y,l.y,f),z:o.number(m.z,l.z,f),azimuthal:o.number(m.azimuthal,l.azimuthal,f),polar:o.number(m.polar,l.polar,f)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)});class be extends o.Evented{constructor(l){super(),this._transitionable=new o.Transitionable(Ve),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,f={}){if(!this._validate(o.validateLight,l,f))for(const y in l){const b=l[y];o.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),b):this._transitionable.setValue(y,b)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,y){return(!y||y.validate!==!1)&&o.emitValidationErrors(this,l.call(o.validateStyle,o.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const _e=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)});let Me=class extends o.Evented{constructor(m,l){super(),this._transitionable=new o.Transitionable(_e),this.set(m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(m){for(const l in m){const f=m[l];o.endsWith(l,"-transition")?this._transitionable.setTransition(l.slice(0,-11),f):this._transitionable.setValue(l,f)}}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}};function ke(m,l,f,y){const b=o.smoothstep(45,65,f),[T,M]=Ce(m,y),C=o.length(l);let k=1-Math.min(1,Math.exp((C-T)/(M-T)*-6));return k*=k*k,k=Math.min(1,1.00747*k),k*b*m.alpha}function Ce(m,l){const f=.5/Math.tan(.5*l);return[m.range[0]+f,m.range[1]+f]}const Oe=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])});class at extends o.Evented{constructor(l,f){super(),this._transitionable=new o.Transitionable(Oe),this.set(l),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){const l=this._transform,f=l.projection.name==="globe",y=o.globeToMercatorTransition(l.zoom),b=this.properties.get("range"),T=[.5,3];return{range:f?[o.number(T[0],b[0],y),o.number(T[1],b[1],y)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,f={}){if(!this._validate(o.validateFog,l,f)){for(const y of Object.keys(o.spec.fog))l&&l[y]===void 0&&(l[y]=o.spec.fog[y].default);for(const y in l){const b=l[y];o.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),b):this._transitionable.setValue(y,b)}}}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,l))*f.a}getOpacityAtLatLng(l,f){return this._transform.projection.supportsFog?function(y,b,T){const M=o.MercatorCoordinate.fromLngLat(b),C=T.elevation?T.elevation.getAtPointOrZero(M):0,k=[M.x,M.y,C];return o.transformMat4(k,k,T.mercatorFogMatrix),ke(y,k,T.pitch,T._fov)}(this.state,l,f):0}getFovAdjustedRange(l){return this._transform.projection.supportsFog?Ce(this.state,l):[0,1]}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,y){return(!y||y.validate!==!1)&&o.emitValidationErrors(this,l.call(o.validateStyle,o.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class ft{constructor(l,f){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const y=this.workerPool.acquire(this.id);for(let b=0;b<y.length;b++){const T=new ft.Actor(y[b],f,this.id);T.name=`Worker ${b}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(l,f,y){o.asyncAll(this.actors,(b,T)=>{b.send(l,f,T)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function st(m,l,f){return l*(o.EXTENT/(m.tileSize*Math.pow(2,f-m.tileID.overscaledZ)))}ft.Actor=o.Actor;class Ot{constructor(l,f,y,b){this.screenBounds=l,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(l,f){let y,b;if(l instanceof o.Point||typeof l[0]=="number"){const T=o.Point.convert(l);y=[T],b=f.isPointAboveHorizon(T)}else{const T=o.Point.convert(l[0]),M=o.Point.convert(l[1]);y=[T,M],b=o.polygonizeBounds(T,M).every(C=>f.isPointAboveHorizon(C))}return new Ot(y,f.getCameraPoint(),b,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(l){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],b=o.polygonizeBounds(f,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<y.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?b[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(b[3]=this.cameraPoint)),o.bufferConvexPolygon(b,l)}bufferedCameraGeometryGlobe(l){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],b=o.polygonizeBounds(f,y,l),T=this.cameraPoint.clone();switch(3*((T.y>f.y)+(T.y>y.y))+((T.x>f.x)+(T.x>y.x))){case 0:b[0]=T,b[4]=T.clone();break;case 1:b.splice(1,0,T);break;case 2:b[1]=T;break;case 3:b.splice(4,0,T);break;case 5:b.splice(2,0,T);break;case 6:b[3]=T;break;case 7:b.splice(3,0,T);break;case 8:b[2]=T}return b}containsTile(l,f,y,b=0){const T=l.queryPadding/f._pixelsPerMercatorPixel+1,M=y?this._bufferedCameraMercator(T,f):this._bufferedScreenMercator(T,f);let C=l.tileID.wrap+(M.unwrapped?b:0);const k=M.polygon.map(se=>o.getTilePoint(l.tileTransform,se,C));if(!o.polygonIntersectsBox(k,0,0,o.EXTENT,o.EXTENT))return;C=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const B=this.screenGeometryMercator.polygon.map(se=>o.getTileVec3(l.tileTransform,se,C)),R=B.map(se=>new o.Point(se[0],se[1])),H=f.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),ee=o.getTileVec3(l.tileTransform,H,C),ie=B.map(se=>{const X=o.sub(se,se,ee);return o.normalize(X,X),new o.Ray(ee,X)}),ae=st(l,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:R,tilespaceRays:ie,bufferedTilespaceGeometry:k,bufferedTilespaceBounds:(oe=o.getBounds(k),oe.min.x=o.clamp(oe.min.x,0,o.EXTENT),oe.min.y=o.clamp(oe.min.y,0,o.EXTENT),oe.max.x=o.clamp(oe.max.x,0,o.EXTENT),oe.max.y=o.clamp(oe.max.y,0,o.EXTENT),oe),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:ae};var oe}_bufferedScreenMercator(l,f){const y=Tr(l);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let b;return b=f.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(l),f):{polygon:this.bufferedScreenGeometry(l).map(T=>f.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[y]=b,b}}_bufferedCameraMercator(l,f){const y=Tr(l);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let b;return b=f.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),f):{polygon:this.bufferedCameraGeometry(l).map(T=>f.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[y]=b,b}}_projectAndResample(l,f){const y=function(T,M){const C=o.multiply([],M.pixelMatrix,M.globeMatrix),k=[0,-o.GLOBE_RADIUS,0,1],B=[0,o.GLOBE_RADIUS,0,1],R=[0,0,0,1];o.transformMat4$1(k,k,C),o.transformMat4$1(B,B,C),o.transformMat4$1(R,R,C);const H=new o.Point(k[0]/k[3],k[1]/k[3]),ee=new o.Point(B[0]/B[3],B[1]/B[3]),ie=o.polygonContainsPoint(T,H)&&k[3]<R[3],ae=o.polygonContainsPoint(T,ee)&&B[3]<R[3];if(!ie&&!ae)return null;const oe=function(Ae,je,ze){for(let We=1;We<Ae.length;We++){const pt=pr(je.pointCoordinate3D(Ae[We-1]).x),Ne=pr(je.pointCoordinate3D(Ae[We]).x);if(ze<0){if(pt<Ne)return{idx:We,t:-pt/(Ne-1-pt)}}else if(Ne<pt)return{idx:We,t:(1-pt)/(Ne+1-pt)}}return null}(T,M,ie?-1:1);if(!oe)return null;const{idx:se,t:X}=oe;let ne=se>1?St(T.slice(0,se),M):[],fe=se<T.length?St(T.slice(se),M):[];ne=ne.map(Ae=>new o.Point(pr(Ae.x),Ae.y)),fe=fe.map(Ae=>new o.Point(pr(Ae.x),Ae.y));const de=[...ne];de.length===0&&de.push(fe[fe.length-1]);const Ee=o.number(de[de.length-1].y,(fe.length===0?ne[0]:fe[0]).y,X);let Pe;return Pe=ie?[new o.Point(0,Ee),new o.Point(0,0),new o.Point(1,0),new o.Point(1,Ee)]:[new o.Point(1,Ee),new o.Point(1,1),new o.Point(0,1),new o.Point(0,Ee)],de.push(...Pe),fe.length===0?de.push(ne[0]):de.push(...fe),{polygon:de.map(Ae=>new o.MercatorCoordinate(Ae.x,Ae.y)),unwrapped:!1}}(l,f);if(y)return y;const b=function(T,M){let C=!1,k=-1/0,B=0;for(let H=0;H<T.length-1;H++)T[H].x>k&&(k=T[H].x,B=H);for(let H=0;H<T.length-1;H++){const ee=(B+H)%(T.length-1),ie=T[ee],ae=T[ee+1];Math.abs(ie.x-ae.x)>.5&&(ie.x<ae.x?(ie.x+=1,ee===0&&(T[T.length-1].x+=1)):(ae.x+=1,ee+1===T.length-1&&(T[0].x+=1)),C=!0)}const R=o.mercatorXfromLng(M.center.lng);return C&&R<Math.abs(R-1)&&T.forEach(H=>{H.x-=1}),{polygon:T,unwrapped:C}}(St(l,f).map(T=>new o.Point(pr(T.x),T.y)),f);return{polygon:b.polygon.map(T=>new o.MercatorCoordinate(T.x,T.y)),unwrapped:b.unwrapped}}}function St(m,l){return o.resample(m,f=>{const y=l.pointCoordinate3D(f);f.x=y.x,f.y=y.y},1/256)}function pr(m){return m<0?1+m%1:m%1}function Tr(m){return 100*m|0}function Kr(m,l,f,y,b){const T=function(M,C){if(M)return b(M);if(C){m.url&&C.tiles&&m.tiles&&delete m.tiles;const k=o.pick(o.extend(C,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(k.vectorLayers=C.vector_layers,k.vectorLayerIds=k.vectorLayers.map(B=>B.id)),k.tiles=l.canonicalizeTileset(k,m.url),b(null,k)}};return m.url?o.getJSON(l.transformRequest(l.normalizeSourceURL(m.url,null,f,y),o.ResourceType.Source),T):o.exported.frame(()=>T(null,m))}class yr{constructor(l,f,y){this.bounds=o.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=f||0,this.maxzoom=y||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const f=Math.pow(2,l.z),y=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*f),b=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*f),T=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*f),M=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*f);return l.x>=y&&l.x<T&&l.y>=b&&l.y<M}}class kt{constructor(l,f,y){this.context=l;const b=l.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Xt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Jt{constructor(l,f,y,b){this.length=f.length,this.attributes=y,this.itemSize=f.bytesPerElement,this.dynamicDraw=b,this.context=l;const T=l.gl;this.buffer=T.createBuffer(),l.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,f){for(let y=0;y<this.attributes.length;y++){const b=f.attributes[this.attributes[y].name];b!==void 0&&l.enableVertexAttribArray(b)}}setVertexAttribPointers(l,f,y){for(let b=0;b<this.attributes.length;b++){const T=this.attributes[b],M=f.attributes[T.name];M!==void 0&&l.vertexAttribPointer(M,T.components,l[Xt[T.type]],!1,this.itemSize,T.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class et{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Or extends et{getDefault(){return o.Color.transparent}set(l){const f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Qt extends et{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class Ir extends et{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class ir extends et{getDefault(){return[!0,!0,!0,!0]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class kr extends et{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class qn extends et{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class $n extends et{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const f=this.current;(l.func!==f.func||l.ref!==f.ref||l.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class tn extends et{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class fi extends et{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=l,this.dirty=!1}}class ri extends et{getDefault(){return[0,1]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class ro extends et{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=l,this.dirty=!1}}class Wi extends et{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class no extends et{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.BLEND):f.disable(f.BLEND),this.current=l,this.dirty=!1}}class fa extends et{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class ws extends et{getDefault(){return o.Color.transparent}set(l){const f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class di extends et{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class jo extends et{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;l?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=l,this.dirty=!1}}class Ya extends et{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class da extends et{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}let pa,Ts=class extends et{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Ke extends et{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class tt extends et{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class xt extends et{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class Rt extends et{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Kt extends et{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Yt extends et{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class ue extends et{getDefault(){return null}set(l){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Y extends et{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class Q extends et{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class he extends et{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class ve extends et{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Te extends et{constructor(l,f){super(l),this.context=l,this.parent=f}getDefault(){return null}}class Le extends Te{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Re extends Te{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Ie extends Re{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class qe{constructor(l,f,y,b){this.context=l,this.width=f,this.height=y;const T=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new Le(l,T),b&&(this.depthAttachment=new Re(l,T))}destroy(){const l=this.context.gl,f=this.colorAttachment.get();if(f&&l.deleteTexture(f),this.depthAttachment){const y=this.depthAttachment.get();y&&l.deleteRenderbuffer(y)}l.deleteFramebuffer(this.framebuffer)}}class yt{constructor(l,f=!1){if(this.gl=l,this.isWebGL2=f,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),f){const y=l;this.extVertexArrayObject={createVertexArrayOES:y.createVertexArray.bind(l),deleteVertexArrayOES:y.deleteVertexArray.bind(l),bindVertexArrayOES:y.bindVertexArray.bind(l)}}this.clearColor=new Or(this),this.clearDepth=new Qt(this),this.clearStencil=new Ir(this),this.colorMask=new ir(this),this.depthMask=new kr(this),this.stencilMask=new qn(this),this.stencilFunc=new $n(this),this.stencilOp=new tn(this),this.stencilTest=new fi(this),this.depthRange=new ri(this),this.depthTest=new ro(this),this.depthFunc=new Wi(this),this.blend=new no(this),this.blendFunc=new fa(this),this.blendColor=new ws(this),this.blendEquation=new di(this),this.cullFace=new jo(this),this.cullFaceSide=new Ya(this),this.frontFace=new da(this),this.program=new Ts(this),this.activeTexture=new Ke(this),this.viewport=new tt(this),this.bindFramebuffer=new xt(this),this.bindRenderbuffer=new Rt(this),this.bindTexture=new Kt(this),this.bindVertexBuffer=new Yt(this),this.bindElementBuffer=new ue(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Y(this),this.pixelStoreUnpack=new Q(this),this.pixelStoreUnpackPremultiplyAlpha=new he(this),this.pixelStoreUnpackFlipY=new ve(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),f||(this.extTextureHalfFloat=l.getExtension("OES_texture_half_float")),(f||this.extTextureHalfFloat&&l.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=f||l.getExtension("OES_standard_derivatives"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,f){return new kt(this,l,f)}createVertexBuffer(l,f,y){return new Jt(this,l,f,y)}createRenderbuffer(l,f,y){const b=this.gl,T=b.createRenderbuffer();return this.bindRenderbuffer.set(T),b.renderbufferStorage(b.RENDERBUFFER,l,f,y),this.bindRenderbuffer.set(null),T}createFramebuffer(l,f,y){return new qe(this,l,f,y)}clear({color:l,depth:f,stencil:y}){const b=this.gl;let T=0;l&&(T|=b.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(T|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),y!==void 0&&(T|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),b.clear(T)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){x(l.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class wt extends o.Evented{constructor(l,f,y,b){if(super(),this.id=l,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(f,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},f),this._collectResourceTiming=f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(l){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const f=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map._worldview;this._tileJSONRequest=Kr(this._options,this.map._requestManager,f,y,(b,T)=>{this._tileJSONRequest=null,this._loaded=!0,b?(f&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${f}`),y&&y.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new o.ErrorEvent(b))):T&&(o.extend(this,T),T.bounds&&(this.tileBounds=new yr(T.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(T.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(b)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}loadTile(l,f){const y=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),b={request:this.map._requestManager.transformRequest(y,o.ResourceType.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile};if(b.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=f:l.request=l.actor.send("reloadTile",b,T.bind(this));else if(l.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",b,T.bind(this),void 0,!0);else{const M=o.loadVectorTile.call({deduped:this._deduped},b,(C,k)=>{C||!k?T.call(this,C):(b.data={cacheControl:k.cacheControl,expires:k.expires,rawData:k.rawData.slice(0)},l.actor&&l.actor.send("loadTile",b,T.bind(this),void 0,!0))},!0);l.request={cancel:M}}function T(M,C){return delete l.request,l.aborted?f(null):M&&M.status!==404?f(M):(C&&C.resourceTiming&&(l.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&l.setExpiryData(C),l.loadVectorData(C,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),f(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id})}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ct extends o.Evented{constructor(l,f,y,b){super(),this.id=l,this.dispatcher=y,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},f),o.extend(this,o.pick(f,["url","scheme","tileSize"]))}load(l){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Kr(this._options,this.map._requestManager,null,null,(f,y)=>{this._tileJSONRequest=null,this._loaded=!0,f?this.fire(new o.ErrorEvent(f)):y&&(o.extend(this,y),y.bounds&&(this.tileBounds=new yr(y.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(y.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(f)})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,f){const y=o.exported.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);l.request=o.getImage(this.map._requestManager.transformRequest(b,o.ResourceType.Tile),(T,M,C,k)=>(delete l.request,l.aborted?(l.state="unloaded",f(null)):T?(l.state="errored",f(T)):M?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:C,expires:k}),l.setTexture(M,this.map.painter),l.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void f(null)):f(null)))}static loadTileData(l,f,y){l.setTexture(f,y)}static unloadTileData(l,f){l.texture&&f.saveTileTexture(l.texture)}abortTile(l,f){l.request&&(l.request.cancel(),delete l.request),f()}unloadTile(l,f){l.texture&&this.map.painter.saveTileTexture(l.texture),f()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Wt(m,l,f,y,b,T,M,C){const k=[m,f,b,l,y,T,1,1,1],B=[M,C,1],R=o.adjoint([],k),[H,ee,ie]=o.transformMat3(B,B,o.transpose(R,R));return o.multiply$1(k,[H,0,0,0,ee,0,0,0,ie],k)}class er extends o.Evented{constructor(l,f,y,b){super(),this.id=l,this.dispatcher=y,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=f,this._dirty=!1}load(l,f){this._loaded=f||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(y,b)=>{if(this._imageRequest=null,this._loaded=!0,y)this.fire(new o.ErrorEvent(y));else if(b){const{HTMLImageElement:T}=o.window;this.image=b instanceof T?o.exported.getImageData(b):b,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,l&&(this.coordinates=l),this._finishLoading()}})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this._imageRequest&&l.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=l.url,this.load(l.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(l){this.coordinates=l,this._boundsArray=void 0;const f=l.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(y){let b=1/0,T=1/0,M=-1/0,C=-1/0;for(const H of y)b=Math.min(b,H.x),T=Math.min(T,H.y),M=Math.max(M,H.x),C=Math.max(C,H.y);const k=Math.max(M-b,C-T),B=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),R=Math.pow(2,B);return new o.CanonicalTileID(B,Math.floor((b+M)/2*R),Math.floor((T+C)/2*R))}(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(l){for(const k in this.tiles){const B=this.tiles[k];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture)}if(this._boundsArray)return;const f=o.tileTransform(this.tileID,this.map.transform.projection),[y,b,T,M]=this.coordinates.map(k=>{const B=f.projection.project(k[0],k[1]);return o.getTilePoint(f,B)._round()});this.perspectiveTransform=function(k,B,R,H,ee,ie,ae,oe,se,X){const ne=Wt(0,0,k,0,0,B,k,B),fe=Wt(R,H,ee,ie,ae,oe,se,X);return o.multiply$1(fe,o.adjoint(ne,ne),fe),[fe[6]/fe[8]*k/o.EXTENT,fe[7]/fe[8]*B/o.EXTENT]}(this.width,this.height,y.x,y.y,b.x,b.y,M.x,M.y,T.x,T.y);const C=this._boundsArray=new o.StructArrayLayout4i8;C.emplaceBack(y.x,y.y,0,0),C.emplaceBack(b.x,b.y,o.EXTENT,0),C.emplaceBack(M.x,M.y,0,o.EXTENT),C.emplaceBack(T.x,T.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=l.createVertexBuffer(C,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,f=l.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new o.Texture(l,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(l)}loadTile(l,f){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},f(null)):(l.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Zt={vector:wt,raster:ct,"raster-dem":class extends ct{constructor(m,l,f,y){super(m,l,f,y),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(m,l){const f=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(b,T){b&&(m.state="errored",l(b)),T&&(m.dem=T,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",l(null))}m.request=o.getImage(this.map._requestManager.transformRequest(f,o.ResourceType.Tile),(function(b,T,M,C){if(delete m.request,m.aborted)m.state="unloaded",l(null);else if(b)m.state="errored",l(b);else if(T){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:M,expires:C});const k=o.window.ImageBitmap&&T instanceof o.window.ImageBitmap&&(pa==null&&(pa=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),pa),B=1-(T.width-o.prevPowerOfTwo(T.width))/2;B<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const R=k?T:o.exported.getImageData(T,B),H={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:R,encoding:this.encoding,padding:B};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",H,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){const l=m.canonical,f=Math.pow(2,l.z),y=(l.x-1+f)%f,b=l.x===0?m.wrap-1:m.wrap,T=(l.x+1+f)%f,M=l.x+1===f?m.wrap+1:m.wrap,C={};return C[new o.OverscaledTileID(m.overscaledZ,b,l.z,y,l.y).key]={backfilled:!1},C[new o.OverscaledTileID(m.overscaledZ,M,l.z,T,l.y).key]={backfilled:!1},l.y>0&&(C[new o.OverscaledTileID(m.overscaledZ,b,l.z,y,l.y-1).key]={backfilled:!1},C[new o.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},C[new o.OverscaledTileID(m.overscaledZ,M,l.z,T,l.y-1).key]={backfilled:!1}),l.y+1<f&&(C[new o.OverscaledTileID(m.overscaledZ,b,l.z,y,l.y+1).key]={backfilled:!1},C[new o.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},C[new o.OverscaledTileID(m.overscaledZ,M,l.z,T,l.y+1).key]={backfilled:!1}),C}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends o.Evented{constructor(m,l,f,y){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(y),this._data=l.data,this._options=o.extend({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const b=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*b,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*b,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:o.EXTENT,radius:(l.clusterRadius!==void 0?l.clusterRadius:50)*b,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},l),this}getClusterChildren(m,l){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},l),this}getClusterLeaves(m,l,f,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:l,offset:f},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=o.extend({},this.workerOptions),l=this._data;typeof l=="string"?(m.request=this.map._requestManager.transformRequest(o.exported.resolveURL(l),o.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(f,y)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new o.ErrorEvent(f));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(b.resourceTiming=y.resourceTiming[this.id]),this.fire(new o.Event("data",b)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,l){const f=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(f,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(y,b)=>(delete m.request,m.unloadVectorData(),m.aborted?l(null):y?l(y):(m.loadVectorData(b,this.map.painter,f==="reloadTile"),l(null))),void 0,f==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends er{constructor(m,l,f,y){super(m,l,f,y),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const l of m.urls)this.urls.push(this.map._requestManager.transformRequest(l,o.ResourceType.Source).url);o.getVideo(this.urls,(l,f)=>{this._loaded=!0,l?this.fire(new o.ErrorEvent(l)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const l=this.video.seekable;m<l.start(0)||m>l.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,l=m.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(m,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:er,canvas:class extends er{constructor(m,l,f,y){super(m,l,f,y),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(T=>typeof T!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(l,this.canvas,l.gl.RGBA,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends o.Evented{constructor(m,l,f,y){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=l,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new yr(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:l,y:f,z:y}=m.canonical;return this._implementation.hasTile({x:l,y:f,z:y})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,l){const{x:f,y,z:b}=m.tileID.canonical,T=new o.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:f,y,z:b},{signal:T.signal})).then((function(M){return delete m.request,m.aborted?(m.state="unloaded",l(null)):M===void 0?(m.state="errored",l(null)):M===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",l(null)):function(C){return C instanceof o.window.ImageData||C instanceof o.window.HTMLCanvasElement||C instanceof o.window.ImageBitmap||C instanceof o.window.HTMLImageElement}(M)?(this.loadTileData(m,M),m.state="loaded",void l(null)):(m.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(M=>{M.code!==20&&(m.state="errored",l(M))}),m.request.cancel=()=>T.abort()}loadTileData(m,l){ct.loadTileData(m,l,this._map.painter)}unloadTileData(m){ct.unloadTileData(m,this._map.painter)}unloadTile(m,l){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:f,y,z:b}=m.tileID.canonical;this._implementation.unloadTile({x:f,y,z:b})}l()}abortTile(m,l){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),l()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},or=function(m,l,f,y){const b=new Zt[l.type](m,l,f,y);if(b.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${b.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],b),b};function ur(m,l){const f=o.identity([]);return o.scale(f,f,[.5*m.width,.5*-m.height,1]),o.translate(f,f,[1,-1,0]),o.multiply(f,f,m.calculateProjMatrix(l.toUnwrapped())),Float32Array.from(f)}function qt(m,l,f,y,b,T,M,C=!1){const k=m.tilesIn(y,M,C);k.sort(un);const B=[];for(const H of k)B.push({wrappedTileID:H.tile.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(l,f,m._state,H,b,T,ur(m.transform,H.tile.tileID),C)});const R=function(H){const ee={},ie={};for(const ae of H){const oe=ae.queryResults,se=ae.wrappedTileID,X=ie[se]=ie[se]||{};for(const ne in oe){const fe=oe[ne],de=X[ne]=X[ne]||{},Ee=ee[ne]=ee[ne]||[];for(const Pe of fe)de[Pe.featureIndex]||(de[Pe.featureIndex]=!0,Ee.push(Pe))}}return ee}(B);for(const H in R)R[H].forEach(ee=>{const ie=ee.feature,ae=ie.layer;ae&&ae.type!=="background"&&ae.type!=="sky"&&(ie.source=ae.source,ae["source-layer"]&&(ie.sourceLayer=ae["source-layer"]),ie.state=ie.id!==void 0?m.getFeatureState(ae["source-layer"],ie.id):{})});return R}function Mr(m,l){const f=m.getRenderableIds().map(T=>m.getTileByID(T)),y=[],b={};for(let T=0;T<f.length;T++){const M=f[T],C=M.tileID.canonical.key;b[C]||(b[C]=!0,M.querySourceFeatures(y,l))}return y}function un(m,l){const f=m.tileID,y=l.tileID;return f.overscaledZ-y.overscaledZ||f.canonical.y-y.canonical.y||f.wrap-y.wrap||f.canonical.x-y.canonical.x}function fn(){return Il.workerClass!=null?new Il.workerClass:new o.window.Worker(Il.workerUrl)}const Lr="mapboxgl_preloaded_worker_pool";class dn{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<dn.workerCount;)this.workers.push(new fn);return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Lr]}numActive(){return Object.keys(this.active).length}}let Zn;function Ja(){return Zn||(Zn=new dn),Zn}function P1(m,l){const f={};for(const y in m)y!=="ref"&&(f[y]=m[y]);return o.refProperties.forEach(y=>{y in l&&(f[y]=l[y])}),f}function by(m){m=m.slice();const l=Object.create(null);for(let f=0;f<m.length;f++)l[m[f].id]=m[f];for(let f=0;f<m.length;f++)"ref"in m[f]&&(m[f]=P1(m[f],l[m[f].ref]));return m}dn.workerCount=2;const Sr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Rd(m,l,f){f.push({command:Sr.addSource,args:[m,l[m]]})}function Su(m,l,f){l.push({command:Sr.removeSource,args:[m]}),f[m]=!0}function Bd(m,l,f,y){Su(m,f,y),Rd(m,l,f)}function Xc(m,l,f){let y;for(y in m[f])if(m[f].hasOwnProperty(y)&&y!=="data"&&!x(m[f][y],l[f][y]))return!1;for(y in l[f])if(l[f].hasOwnProperty(y)&&y!=="data"&&!x(m[f][y],l[f][y]))return!1;return!0}function Fo(m,l,f,y,b,T){let M;for(M in l=l||{},m=m||{})m.hasOwnProperty(M)&&(x(m[M],l[M])||f.push({command:T,args:[y,M,l[M],b]}));for(M in l)l.hasOwnProperty(M)&&!m.hasOwnProperty(M)&&(x(m[M],l[M])||f.push({command:T,args:[y,M,l[M],b]}))}function ma(m){return m.id}function jd(m,l){return m[l.id]=l,m}class Fd{constructor(l,f){this.reset(l,f)}reset(l,f){this.points=l||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.clamp(l,0,1);let f=1,y=this._distances[f];const b=l*this.paddedLength+this.padding;for(;y<b&&f<this._distances.length;)y=this._distances[++f];const T=f-1,M=this._distances[T],C=y-M,k=C>0?(b-M)/C:0;return this.points[T].mult(1-k).add(this.points[f].mult(k))}}class Ss{constructor(l,f,y){const b=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(l/y),this.yCellCount=Math.ceil(f/y);for(let M=0;M<this.xCellCount*this.yCellCount;M++)b.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=f,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,f,y,b,T){this._forEachCell(f,y,b,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(b),this.bboxes.push(T)}insertCircle(l,f,y,b){this._forEachCell(f-b,y-b,f+b,y+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(f),this.circles.push(y),this.circles.push(b)}_insertBoxCell(l,f,y,b,T,M){this.boxCells[T].push(M)}_insertCircleCell(l,f,y,b,T,M){this.circleCells[T].push(M)}_query(l,f,y,b,T,M){if(y<0||l>this.width||b<0||f>this.height)return!T&&[];const C=[];if(l<=0&&f<=0&&this.width<=y&&this.height<=b){if(T)return!0;for(let k=0;k<this.boxKeys.length;k++)C.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const B=this.circles[3*k],R=this.circles[3*k+1],H=this.circles[3*k+2];C.push({key:this.circleKeys[k],x1:B-H,y1:R-H,x2:B+H,y2:R+H})}return M?C.filter(M):C}return this._forEachCell(l,f,y,b,this._queryCell,C,{hitTest:T,seenUids:{box:{},circle:{}}},M),T?C.length>0:C}_queryCircle(l,f,y,b,T){const M=l-y,C=l+y,k=f-y,B=f+y;if(C<0||M>this.width||B<0||k>this.height)return!b&&[];const R=[];return this._forEachCell(M,k,C,B,this._queryCellCircle,R,{hitTest:b,circle:{x:l,y:f,radius:y},seenUids:{box:{},circle:{}}},T),b?R.length>0:R}query(l,f,y,b,T){return this._query(l,f,y,b,!1,T)}hitTest(l,f,y,b,T){return this._query(l,f,y,b,!0,T)}hitTestCircle(l,f,y,b){return this._queryCircle(l,f,y,!0,b)}_queryCell(l,f,y,b,T,M,C,k){const B=C.seenUids,R=this.boxCells[T];if(R!==null){const ee=this.bboxes;for(const ie of R)if(!B.box[ie]){B.box[ie]=!0;const ae=4*ie;if(l<=ee[ae+2]&&f<=ee[ae+3]&&y>=ee[ae+0]&&b>=ee[ae+1]&&(!k||k(this.boxKeys[ie]))){if(C.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[ie],x1:ee[ae],y1:ee[ae+1],x2:ee[ae+2],y2:ee[ae+3]})}}}const H=this.circleCells[T];if(H!==null){const ee=this.circles;for(const ie of H)if(!B.circle[ie]){B.circle[ie]=!0;const ae=3*ie;if(this._circleAndRectCollide(ee[ae],ee[ae+1],ee[ae+2],l,f,y,b)&&(!k||k(this.circleKeys[ie]))){if(C.hitTest)return M.push(!0),!0;{const oe=ee[ae],se=ee[ae+1],X=ee[ae+2];M.push({key:this.circleKeys[ie],x1:oe-X,y1:se-X,x2:oe+X,y2:se+X})}}}}}_queryCellCircle(l,f,y,b,T,M,C,k){const B=C.circle,R=C.seenUids,H=this.boxCells[T];if(H!==null){const ie=this.bboxes;for(const ae of H)if(!R.box[ae]){R.box[ae]=!0;const oe=4*ae;if(this._circleAndRectCollide(B.x,B.y,B.radius,ie[oe+0],ie[oe+1],ie[oe+2],ie[oe+3])&&(!k||k(this.boxKeys[ae])))return M.push(!0),!0}}const ee=this.circleCells[T];if(ee!==null){const ie=this.circles;for(const ae of ee)if(!R.circle[ae]){R.circle[ae]=!0;const oe=3*ae;if(this._circlesCollide(ie[oe],ie[oe+1],ie[oe+2],B.x,B.y,B.radius)&&(!k||k(this.circleKeys[ae])))return M.push(!0),!0}}}_forEachCell(l,f,y,b,T,M,C,k){const B=this._convertToXCellCoord(l),R=this._convertToYCellCoord(f),H=this._convertToXCellCoord(y),ee=this._convertToYCellCoord(b);for(let ie=B;ie<=H;ie++)for(let ae=R;ae<=ee;ae++)if(T.call(this,l,f,y,b,this.xCellCount*ae+ie,M,C,k))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,f,y,b,T,M){const C=b-l,k=T-f,B=y+M;return B*B>C*C+k*k}_circleAndRectCollide(l,f,y,b,T,M,C){const k=(M-b)/2,B=Math.abs(l-(b+k));if(B>k+y)return!1;const R=(C-T)/2,H=Math.abs(f-(T+R));if(H>R+y)return!1;if(B<=k||H<=R)return!0;const ee=B-k,ie=H-R;return ee*ee+ie*ie<=y*y}}const ga={unknown:0,flipRequired:1,flipNotRequired:2},Eu=Math.tan(85*Math.PI/180);function Je(m,l,f,y,b,T,M){const C=o.create();if(f)if(T.name==="globe"){const k=o.calculateGlobeLabelMatrix(b,l);o.multiply(C,C,k)}else{const k=ge([],M);C[0]=k[0],C[1]=k[1],C[4]=k[2],C[5]=k[3],y||o.rotateZ(C,C,b.angle)}else o.multiply(C,b.labelPlaneMatrix,m);return C}function ya(m,l,f,y,b,T,M){const C=Je(m,l,f,y,b,T,M);return T.name==="globe"&&f||(C[2]=C[6]=C[10]=C[14]=0),C}function Cn(m,l,f,y,b,T,M){if(f){if(T.name==="globe"){const C=Je(m,l,f,y,b,T,M);return o.invert(C,C),o.multiply(C,m,C),C}{const C=o.clone(m),k=o.identity([]);return k[0]=M[0],k[1]=M[1],k[4]=M[2],k[5]=M[3],o.multiply(C,C,k),y||o.rotateZ(C,C,-b.angle),C}}return b.glCoordMatrix}function Hn(m,l,f,y){const b=[m,l,f,1];f?o.transformMat4$1(b,b,y):fr(b,b,y);const T=b[3];return b[0]/=T,b[1]/=T,b[2]/=T,b}function wy(m,l){return Math.min(.5+m/l*.5,1.5)}function $o(m,l){const f=m[0]/m[3],y=m[1]/m[3];return f>=-l[0]&&f<=l[0]&&y>=-l[1]&&y<=l[1]}function $d(m,l,f,y,b,T,M,C,k,B){const R=f.transform,H=y?m.textSizeData:m.iconSizeData,ee=o.evaluateSizeForZoom(H,f.transform.zoom),ie=R.projection.name==="globe",ae=[256/f.width*2+1,256/f.height*2+1],oe=y?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;oe.clear();let se=null;ie&&(se=y?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const X=m.lineVertexArray,ne=y?m.text.placedSymbolArray:m.icon.placedSymbolArray,fe=f.transform.width/f.transform.height;let de,Ee=!1;for(let Pe=0;Pe<ne.length;Pe++){const Ae=ne.get(Pe),{numGlyphs:je,writingMode:ze}=Ae;if(ze!==o.WritingMode.vertical||Ee||de===o.WritingMode.horizontal||(Ee=!0),de=ze,(Ae.hidden||ze===o.WritingMode.vertical)&&!Ee){bo(je,oe);continue}Ee=!1;const We=new o.Point(Ae.tileAnchorX,Ae.tileAnchorY);let{x:pt,y:Ne,z:nt}=R.projection.projectTilePoint(We.x,We.y,B.canonical);if(k){const[Ht,Dt,Vt]=k(We);pt+=Ht,Ne+=Dt,nt+=Vt}const He=[pt,Ne,nt,1];if(o.transformMat4$1(He,He,l),!$o(He,ae)){bo(je,oe);continue}const dt=wy(f.transform.cameraToCenterDistance,He[3]),Ge=o.evaluateSizeForFeature(H,ee,Ae),rt=M?Ge/dt:Ge*dt,gt=Hn(pt,Ne,nt,b);if(gt[3]<=0){bo(je,oe);continue}let lt={};const _t=M?null:k,jt=Mt(Ae,rt,!1,C,l,b,T,m.glyphOffsetArray,X,oe,se,gt,We,lt,fe,_t,R.projection,B,M);Ee=jt.useVertical,_t&&jt.needsFlipping&&(lt={}),(jt.notEnoughRoom||Ee||jt.needsFlipping&&Mt(Ae,rt,!0,C,l,b,T,m.glyphOffsetArray,X,oe,se,gt,We,lt,fe,_t,R.projection,B,M).notEnoughRoom)&&bo(je,oe)}y?(m.text.dynamicLayoutVertexBuffer.updateData(oe),se&&m.text.globeExtVertexBuffer.updateData(se)):(m.icon.dynamicLayoutVertexBuffer.updateData(oe),se&&m.icon.globeExtVertexBuffer.updateData(se))}function Ty(m,l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae,oe){const{lineStartIndex:se,glyphStartIndex:X,segment:ne}=C,fe=X+C.numGlyphs,de=se+C.lineLength,Ee=l.getoffsetX(X),Pe=l.getoffsetX(fe-1),Ae=qi(m*Ee,f,y,b,T,M,ne,se,de,k,B,R,H,ee,!0,ie,ae,oe);if(!Ae)return null;const je=qi(m*Pe,f,y,b,T,M,ne,se,de,k,B,R,H,ee,!0,ie,ae,oe);return je?{first:Ae,last:je}:null}function pl(m,l,f,y){return m===o.WritingMode.horizontal&&Math.abs(y)>Math.abs(f)?{useVertical:!0}:m===o.WritingMode.vertical?y>0?{needsFlipping:!0}:null:l!==ga.unknown&&function(b,T){return b===0||Math.abs(T/b)>Eu}(f,y)?l===ga.flipRequired?{needsFlipping:!0}:null:f<0?{needsFlipping:!0}:null}function Mt(m,l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae,oe,se,X,ne){const fe=l/24,de=m.lineOffsetX*fe,Ee=m.lineOffsetY*fe,{lineStartIndex:Pe,glyphStartIndex:Ae,numGlyphs:je,segment:ze,writingMode:We,flipState:pt}=m,Ne=Pe+m.lineLength,nt=He=>{if(R){const[gt,lt,_t]=He.up,jt=B.length;o.updateGlobeVertexNormal(R,jt+0,gt,lt,_t),o.updateGlobeVertexNormal(R,jt+1,gt,lt,_t),o.updateGlobeVertexNormal(R,jt+2,gt,lt,_t),o.updateGlobeVertexNormal(R,jt+3,gt,lt,_t)}const[dt,Ge,rt]=He.point;o.addDynamicAttributes(B,dt,Ge,rt,He.angle)};if(je>1){const He=Ty(fe,C,de,Ee,f,H,ee,m,k,T,ie,oe,!1,se,X,ne);if(!He)return{notEnoughRoom:!0};if(y&&!f){let[dt,Ge,rt]=He.first.point,[gt,lt,_t]=He.last.point;[dt,Ge]=Hn(dt,Ge,rt,M),[gt,lt]=Hn(gt,lt,_t,M);const jt=pl(We,pt,(gt-dt)*ae,lt-Ge);if(m.flipState=jt&&jt.needsFlipping?ga.flipRequired:ga.flipNotRequired,jt)return jt}nt(He.first);for(let dt=Ae+1;dt<Ae+je-1;dt++){const Ge=qi(fe*C.getoffsetX(dt),de,Ee,f,H,ee,ze,Pe,Ne,k,T,ie,oe,!1,!1,se,X,ne);if(!Ge)return B.length-=4*(dt-Ae),{notEnoughRoom:!0};nt(Ge)}nt(He.last)}else{if(y&&!f){const dt=Hn(ee.x,ee.y,0,b),Ge=Pe+ze+1,rt=new o.Point(k.getx(Ge),k.gety(Ge)),gt=Hn(rt.x,rt.y,0,b),lt=gt[3]>0?gt:hr(ee,rt,dt,1,b,void 0,se,X.canonical),_t=pl(We,pt,(lt[0]-dt[0])*ae,lt[1]-dt[1]);if(m.flipState=_t&&_t.needsFlipping?ga.flipRequired:ga.flipNotRequired,_t)return _t}const He=qi(fe*C.getoffsetX(Ae),de,Ee,f,H,ee,ze,Pe,Ne,k,T,ie,oe,!1,!1,se,X,ne);if(!He)return{notEnoughRoom:!0};nt(He)}return{}}function mr(m,l,f,y,b){const{x:T,y:M,z:C}=y.projectTilePoint(m.x,m.y,l);if(!b)return Hn(T,M,C,f);const[k,B,R]=b(m);return Hn(T+k,M+B,C+R,f)}function hr(m,l,f,y,b,T,M,C){const k=mr(m.sub(l)._unit()._add(m),C,b,M,T);return o.sub(k,f,k),o.normalize(k,k),o.scaleAndAdd(k,f,k,y)}function qi(m,l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae,oe,se,X){const ne=y?m-l:m+l;let fe=ne>0?1:-1,de=0;y&&(fe*=-1,de=Math.PI),fe<0&&(de+=Math.PI);let Ee=C+M+(fe>0?0:1)|0,Pe=b,Ae=b,je=0,ze=0;const We=Math.abs(ne),pt=[],Ne=[];let nt=T,He=nt;const dt=()=>hr(He,nt,Ae,We-je+1,R,ee,oe,se.canonical);for(;je+ze<=We;){if(Ee+=fe,Ee<C||Ee>=k)return null;if(Ae=Pe,He=nt,pt.push(Ae),ie&&Ne.push(He),nt=new o.Point(B.getx(Ee),B.gety(Ee)),Pe=H[Ee],!Pe){const Vt=mr(nt,se.canonical,R,oe,ee);Pe=Vt[3]>0?H[Ee]=Vt:dt()}je+=ze,ze=o.distance(Ae,Pe)}ae&&ee&&(H[Ee]&&(Pe=dt(),ze=o.distance(Ae,Pe)),H[Ee]=Pe);const Ge=(We-je)/ze,rt=nt.sub(He)._mult(Ge)._add(He),gt=o.sub([],Pe,Ae),lt=o.scaleAndAdd([],Ae,gt,Ge);let _t=[0,0,1],jt=gt[0],Ht=gt[1];if(X&&(_t=oe.upVector(se.canonical,rt.x,rt.y),_t[0]!==0||_t[1]!==0||_t[2]!==1)){const Vt=[_t[2],0,-_t[0]],dr=o.cross([],_t,Vt);o.normalize(Vt,Vt),o.normalize(dr,dr),jt=o.dot(gt,Vt),Ht=o.dot(gt,dr)}if(f){const Vt=o.cross([],_t,gt);o.normalize(Vt,Vt),o.scaleAndAdd(lt,lt,Vt,f*fe)}const Dt=de+Math.atan2(Ht,jt);return pt.push(lt),ie&&Ne.push(rt),{point:lt,angle:Dt,path:pt,tilePath:Ne,up:_t}}function bo(m,l){const f=l.length,y=f+4*m;l.resize(y),l.float32.fill(-1/0,4*f,4*y)}function fr(m,l,f){const y=l[0],b=l[1];return m[0]=f[0]*y+f[4]*b+f[12],m[1]=f[1]*y+f[5]*b+f[13],m[3]=f[3]*y+f[7]*b+f[15],m}const Zi=100;class Au{constructor(l,f,y=new Ss(l.width+200,l.height+200,25),b=new Ss(l.width+200,l.height+200,25)){this.transform=l,this.grid=y,this.ignoredGrid=b,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Zi,this.screenBottomBoundary=l.height+Zi,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=f}placeCollisionBox(l,f,y,b,T,M,C,k){let B=y.projectedAnchorX,R=y.projectedAnchorY,H=y.projectedAnchorZ;const ee=y.elevation,ie=y.tileID,ae=l.getProjection();if(ee&&ie){const[Pe,Ae,je]=ae.upVector(ie.canonical,y.tileAnchorX,y.tileAnchorY),ze=ae.upVectorScale(ie.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;B+=Pe*ee*ze,R+=Ae*ee*ze,H+=je*ee*ze}const oe=this.projectAndGetPerspectiveRatio(C,B,R,H,y.tileID,ae.name==="globe"||!!ee||this.transform.pitch>0,ae),se=M*oe.perspectiveRatio,X=(y.x1*f+b.x-y.padding)*se+oe.point.x,ne=(y.y1*f+b.y-y.padding)*se+oe.point.y,fe=(y.x2*f+b.x+y.padding)*se+oe.point.x,de=(y.y2*f+b.y+y.padding)*se+oe.point.y,Ee=oe.perspectiveRatio<=.55||oe.occluded;return!this.isInsideGrid(X,ne,fe,de)||!T&&this.grid.hitTest(X,ne,fe,de,k)||Ee?{box:[],offscreen:!1,occluded:oe.occluded}:{box:[X,ne,fe,de],offscreen:this.isOffscreen(X,ne,fe,de),occluded:!1}}placeCollisionCircles(l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae,oe){const se=[],X=this.transform.elevation,ne=l.getProjection(),fe=X?X.getAtTileOffsetFunc(oe,this.transform.center.lat,this.transform.worldSize,ne):null,de=new o.Point(y.tileAnchorX,y.tileAnchorY);let{x:Ee,y:Pe,z:Ae}=ne.projectTilePoint(de.x,de.y,oe.canonical);if(fe){const[rt,gt,lt]=fe(de);Ee+=rt,Pe+=gt,Ae+=lt}const je=ne.name==="globe",ze=this.projectAndGetPerspectiveRatio(C,Ee,Pe,Ae,oe,je||!!X||this.transform.pitch>0,ne),{perspectiveRatio:We}=ze,pt=(H?M/We:M*We)/o.ONE_EM,Ne=Hn(Ee,Pe,Ae,k),nt=ze.signedDistanceFromCamera>0?Ty(pt,T,y.lineOffsetX*pt,y.lineOffsetY*pt,!1,Ne,de,y,b,k,{},X&&!H?fe:null,H&&!!X,ne,oe,H):null;let He=!1,dt=!1,Ge=!0;if(nt&&!ze.occluded){const rt=.5*ie*We+ae,gt=new o.Point(-100,-100),lt=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),_t=new Fd,{first:jt,last:Ht}=nt,Dt=jt.path.length;let Vt=[];for(let Bt=Dt-1;Bt>=1;Bt--)Vt.push(jt.path[Bt]);for(let Bt=1;Bt<Ht.path.length;Bt++)Vt.push(Ht.path[Bt]);const dr=2.5*rt;B&&(Vt=Vt.map(([Bt,Cr,zr],Rr)=>(fe&&!je&&(zr=fe(Rr<Dt-1?jt.tilePath[Dt-1-Rr]:Ht.tilePath[Rr-Dt+2])[2]),Hn(Bt,Cr,zr,B))),Vt.some(Bt=>Bt[3]<=0)&&(Vt=[]));let cr=[];if(Vt.length>0){let Bt=1/0,Cr=-1/0,zr=1/0,Rr=-1/0;for(const Br of Vt)Bt=Math.min(Bt,Br[0]),zr=Math.min(zr,Br[1]),Cr=Math.max(Cr,Br[0]),Rr=Math.max(Rr,Br[1]);Cr>=gt.x&&Bt<=lt.x&&Rr>=gt.y&&zr<=lt.y&&(cr=[Vt.map(Br=>new o.Point(Br[0],Br[1]))],(Bt<gt.x||Cr>lt.x||zr<gt.y||Rr>lt.y)&&(cr=o.clipLine(cr,gt.x,gt.y,lt.x,lt.y)))}for(const Bt of cr){_t.reset(Bt,.25*rt);let Cr=0;Cr=_t.length<=.5*rt?1:Math.ceil(_t.paddedLength/dr)+1;for(let zr=0;zr<Cr;zr++){const Rr=zr/Math.max(Cr-1,1),Br=_t.lerp(Rr),mi=Br.x+Zi,Kn=Br.y+Zi;se.push(mi,Kn,rt,0);const lo=mi-rt,Go=Kn-rt,sn=mi+rt,jr=Kn+rt;if(Ge=Ge&&this.isOffscreen(lo,Go,sn,jr),dt=dt||this.isInsideGrid(lo,Go,sn,jr),!f&&this.grid.hitTestCircle(mi,Kn,rt,ee)&&(He=!0,!R))return{circles:[],offscreen:!1,collisionDetected:He,occluded:!1}}}}return{circles:!R&&He||!dt?[]:se,offscreen:Ge,collisionDetected:He,occluded:ze.occluded}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let y=1/0,b=1/0,T=-1/0,M=-1/0;for(const R of l){const H=new o.Point(R.x+Zi,R.y+Zi);y=Math.min(y,H.x),b=Math.min(b,H.y),T=Math.max(T,H.x),M=Math.max(M,H.y),f.push(H)}const C=this.grid.query(y,b,T,M).concat(this.ignoredGrid.query(y,b,T,M)),k={},B={};for(const R of C){const H=R.key;if(k[H.bucketInstanceId]===void 0&&(k[H.bucketInstanceId]={}),k[H.bucketInstanceId][H.featureIndex])continue;const ee=[new o.Point(R.x1,R.y1),new o.Point(R.x2,R.y1),new o.Point(R.x2,R.y2),new o.Point(R.x1,R.y2)];o.polygonIntersectsPolygon(f,ee)&&(k[H.bucketInstanceId][H.featureIndex]=!0,B[H.bucketInstanceId]===void 0&&(B[H.bucketInstanceId]=[]),B[H.bucketInstanceId].push(H.featureIndex))}return B}insertCollisionBox(l,f,y,b,T){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:b,collisionGroupID:T},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,f,y,b,T){const M=f?this.ignoredGrid:this.grid,C={bucketInstanceId:y,featureIndex:b,collisionGroupID:T};for(let k=0;k<l.length;k+=4)M.insertCircle(C,l[k],l[k+1],l[k+2])}projectAndGetPerspectiveRatio(l,f,y,b,T,M,C){const k=[f,y,b,1];let B=!1;b||this.transform.pitch>0?(o.transformMat4$1(k,k,l),this.fogState&&T&&C.name!=="globe"&&(B=function(ee,ie,ae,oe,se,X){const ne=X.calculateFogTileMatrix(se),fe=[ie,ae,oe];return o.transformMat4(fe,fe,ne),ke(ee,fe,X.pitch,X._fov)}(this.fogState,f,y,b,T.toUnwrapped(),this.transform)>.9)):fr(k,k,l);const R=k[3];return{point:new o.Point((k[0]/R+1)/2*this.transform.width+Zi,(-k[1]/R+1)/2*this.transform.height+Zi),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(C)/R*.5,1.5),signedDistanceFromCamera:R,occluded:M&&k[2]>R||B}}isOffscreen(l,f,y,b){return y<Zi||l>=this.screenRightBoundary||b<Zi||f>this.screenBottomBoundary}isInsideGrid(l,f,y,b){return y>=0&&l<this.gridRightBoundary&&b>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const l=o.identity([]);return o.translate(l,l,[-100,-100,0]),l}}function Es(m,l,f){const y=l.createTileMatrix(m,m.worldSize,f.toUnwrapped());return o.multiply(new Float32Array(16),m.projMatrix,y)}function io(m,l,f){if(l.projection.name===f.projection.name)return m.projMatrix;const y=f.clone();return y.setProjection(l.projection),Es(y,l.getProjection(),m)}function an(m,l,f){return l.name===f.projection.name?m.projMatrix:Es(f,l,m)}class Sy{constructor(l,f,y,b){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?f:-f))):b&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class _a{constructor(l,f,y,b,T,M=!1){this.text=new Sy(l?l.text:null,f,y,T),this.icon=new Sy(l?l.icon:null,f,b,T),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Pu{constructor(l,f,y,b=!1){this.text=l,this.icon=f,this.skipFade=y,this.clipped=b}}class Mu{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Nd{constructor(l,f,y,b,T){this.bucketInstanceId=l,this.featureIndex=f,this.sourceLayerIndex=y,this.bucketIndex=b,this.tileID=T}}class Ey{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const f=++this.maxGroupID;this.collisionGroups[l]={ID:f,predicate:y=>y.collisionGroupID===f}}return this.collisionGroups[l]}}function Cu(m,l,f,y,b){const{horizontalAlign:T,verticalAlign:M}=o.getAnchorAlignment(m),C=-(T-.5)*l,k=-(M-.5)*f,B=o.evaluateVariableOffset(m,y);return new o.Point(C+B[0]*b,k+B[1]*b)}function Ou(m,l,f,y,b){const T=new o.Point(m,l);return f&&T._rotate(y?b:-b),T}class Kc{constructor(l,f,y,b,T){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new Au(this.transform,T),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Ey(y),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,f,y,b){const T=y.getBucket(f),M=y.latestFeatureIndex;if(!T||!M||f.id!==T.layerIds[0])return;const C=T.layers[0].layout,k=y.collisionBoxArray,B=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),R=y.tileSize/o.EXTENT,H=y.tileID.toUnwrapped();this.transform.setProjection(T.projection);const ee=(ie=y.tileID,ae=T.getProjection(),oe=this.transform,ae.name===this.projection?oe.calculateProjMatrix(ie.toUnwrapped()):Es(oe,ae,ie));var ie,ae,oe;const se=C.get("text-pitch-alignment")==="map",X=C.get("text-rotation-alignment")==="map";f.compileFilter();const ne=f.dynamicFilter(),fe=f.dynamicFilterNeedsFeature(),de=this.transform.calculatePixelsToTileUnitsMatrix(y),Ee=ya(ee,y.tileID.canonical,se,X,this.transform,T.getProjection(),de);let Pe=null;if(se){const ze=Cn(ee,y.tileID.canonical,se,X,this.transform,T.getProjection(),de);Pe=o.multiply([],this.transform.labelPlaneMatrix,ze)}let Ae=null;ne&&y.latestFeatureIndex&&(Ae={unwrappedTileID:H,dynamicFilter:ne,dynamicFilterNeedsFeature:fe,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new Nd(T.bucketInstanceId,M,T.sourceLayerIndex,T.index,y.tileID);const je={bucket:T,layout:C,posMatrix:ee,textLabelPlaneMatrix:Ee,labelToScreenMatrix:Pe,clippingData:Ae,scale:B,textPixelRatio:R,holdingForFade:y.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(b)for(const ze of T.sortKeyRanges){const{sortKey:We,symbolInstanceStart:pt,symbolInstanceEnd:Ne}=ze;l.push({sortKey:We,symbolInstanceStart:pt,symbolInstanceEnd:Ne,parameters:je})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:je})}attemptAnchorPlacement(l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae,oe,se,X,ne){const{textOffset0:fe,textOffset1:de,crossTileID:Ee}=ee,Pe=[fe,de],Ae=Cu(l,y,b,Pe,T),je=this.collisionIndex.placeCollisionBox(ae,T,f,Ou(Ae.x,Ae.y,M,C,this.transform.angle),H,k,B,R.predicate);if(se){const ze=ae.getSymbolInstanceIconSize(ne,this.transform.zoom,ee.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ae,ze,se,Ou(Ae.x,Ae.y,M,C,this.transform.angle),H,k,B,R.predicate).box.length===0)return}if(je.box.length>0){let ze;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ee]&&this.prevPlacement.placements[Ee]&&this.prevPlacement.placements[Ee].text&&(ze=this.prevPlacement.variableOffsets[Ee].anchor),this.variableOffsets[Ee]={textOffset:Pe,width:y,height:b,anchor:l,textScale:T,prevAnchor:ze},this.markUsedJustification(ae,l,ee,oe),ae.allowVerticalPlacement&&(this.markUsedOrientation(ae,oe,ee),this.placedOrientations[Ee]=oe),{shift:Ae,placedGlyphBoxes:je}}}placeLayerBucketPart(l,f,y,b){const{bucket:T,layout:M,posMatrix:C,textLabelPlaneMatrix:k,labelToScreenMatrix:B,clippingData:R,textPixelRatio:H,holdingForFade:ee,collisionBoxArray:ie,partiallyEvaluatedTextSize:ae,partiallyEvaluatedIconSize:oe,collisionGroup:se}=l.parameters,X=M.get("text-optional"),ne=M.get("icon-optional"),fe=M.get("text-allow-overlap"),de=M.get("icon-allow-overlap"),Ee=M.get("text-rotation-alignment")==="map",Pe=M.get("text-pitch-alignment")==="map",Ae=M.get("icon-text-fit")!=="none",je=M.get("symbol-z-order")==="viewport-y";this.transform.setProjection(T.projection);let ze=fe&&(de||!T.hasIconData()||ne),We=de&&(fe||!T.hasTextData()||X);!T.collisionArrays&&ie&&T.deserializeCollisionBoxes(ie),y&&b&&T.updateCollisionDebugBuffers(this.transform.zoom,ie);const pt=(Ne,nt,He)=>{const{crossTileID:dt,numVerticalGlyphVertices:Ge}=Ne;if(R){const sn={zoom:this.transform.zoom,pitch:this.transform.pitch};let jr=null;if(R.dynamicFilterNeedsFeature){const br=this.retainedQueryData[T.bucketInstanceId];jr=R.featureIndex.loadFeature({featureIndex:Ne.featureIndex,bucketIndex:br.bucketIndex,sourceLayerIndex:br.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,R.dynamicFilter)(sn,jr,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new o.Point(Ne.tileAnchorX,Ne.tileAnchorY),this.transform.calculateDistanceTileData(R.unwrappedTileID)))return this.placements[dt]=new Pu(!1,!1,!1,!0),void f.add(dt)}if(f.has(dt))return;if(ee)return void(this.placements[dt]=new Pu(!1,!1,!1));let rt=!1,gt=!1,lt=!0,_t=!1,jt=!1,Ht=null,Dt={box:null,offscreen:null,occluded:null},Vt={box:null},dr=null,cr=null,Bt=null,Cr=0,zr=0,Rr=0;He.textFeatureIndex?Cr=He.textFeatureIndex:Ne.useRuntimeCollisionCircles&&(Cr=Ne.featureIndex),He.verticalTextFeatureIndex&&(zr=He.verticalTextFeatureIndex);const Br=sn=>{sn.tileID=this.retainedQueryData[T.bucketInstanceId].tileID;const jr=this.transform.elevation;(jr||sn.elevation)&&(sn.elevation=jr?jr.getAtTileOffset(sn.tileID,sn.tileAnchorX,sn.tileAnchorY):0)},mi=He.textBox;if(mi){Br(mi);const sn=br=>{let On=o.WritingMode.horizontal;if(T.allowVerticalPlacement&&!br&&this.prevPlacement){const Ti=this.prevPlacement.placedOrientations[dt];Ti&&(this.placedOrientations[dt]=Ti,On=Ti,this.markUsedOrientation(T,On,Ne))}return On},jr=(br,On)=>{if(T.allowVerticalPlacement&&Ge>0&&He.verticalTextBox){for(const Ti of T.writingModes)if(Ti===o.WritingMode.vertical?(Dt=On(),Vt=Dt):Dt=br(),Dt&&Dt.box&&Dt.box.length)break}else Dt=br()};if(M.get("text-variable-anchor")){let br=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[dt]){const rn=this.prevPlacement.variableOffsets[dt];br.indexOf(rn.anchor)>0&&(br=br.filter(Ii=>Ii!==rn.anchor),br.unshift(rn.anchor))}const On=(rn,Ii,Th)=>{const Ds=T.getSymbolInstanceTextSize(ae,Ne,this.transform.zoom,nt),Ku=(rn.x2-rn.x1)*Ds+2*rn.padding,Ea=(rn.y2-rn.y1)*Ds+2*rn.padding,ts=Ae&&!de?Ii:null;ts&&Br(ts);let Ls={box:[],offscreen:!1,occluded:!1};const Sh=fe?2*br.length:br.length;for(let Yu=0;Yu<Sh;++Yu){const Ip=this.attemptAnchorPlacement(br[Yu%br.length],rn,Ku,Ea,Ds,Ee,Pe,H,C,se,Yu>=br.length,Ne,nt,T,Th,ts,ae,oe);if(Ip&&(Ls=Ip.placedGlyphBoxes,Ls&&Ls.box&&Ls.box.length)){rt=!0,Ht=Ip.shift;break}}return Ls};jr(()=>On(mi,He.iconBox,o.WritingMode.horizontal),()=>{const rn=He.verticalTextBox;return rn&&Br(rn),T.allowVerticalPlacement&&!(Dt&&Dt.box&&Dt.box.length)&&Ge>0&&rn?On(rn,He.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Dt&&(rt=Dt.box,lt=Dt.offscreen,_t=Dt.occluded);const Ti=sn(!(!Dt||!Dt.box));if(!rt&&this.prevPlacement){const rn=this.prevPlacement.variableOffsets[dt];rn&&(this.variableOffsets[dt]=rn,this.markUsedJustification(T,rn.anchor,Ne,Ti))}}else{const br=(On,Ti)=>{const rn=T.getSymbolInstanceTextSize(ae,Ne,this.transform.zoom,nt),Ii=this.collisionIndex.placeCollisionBox(T,rn,On,new o.Point(0,0),fe,H,C,se.predicate);return Ii&&Ii.box&&Ii.box.length&&(this.markUsedOrientation(T,Ti,Ne),this.placedOrientations[dt]=Ti),Ii};jr(()=>br(mi,o.WritingMode.horizontal),()=>{const On=He.verticalTextBox;return T.allowVerticalPlacement&&Ge>0&&On?(Br(On),br(On,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),sn(!!(Dt&&Dt.box&&Dt.box.length))}}if(dr=Dt,rt=dr&&dr.box&&dr.box.length>0,lt=dr&&dr.offscreen,_t=dr&&dr.occluded,Ne.useRuntimeCollisionCircles){const sn=T.text.placedSymbolArray.get(Ne.centerJustifiedTextSymbolIndex>=0?Ne.centerJustifiedTextSymbolIndex:Ne.verticalPlacedTextSymbolIndex),jr=o.evaluateSizeForFeature(T.textSizeData,ae,sn),br=M.get("text-padding");cr=this.collisionIndex.placeCollisionCircles(T,fe,sn,T.lineVertexArray,T.glyphOffsetArray,jr,C,k,B,y,Pe,se.predicate,Ne.collisionCircleDiameter*jr/o.ONE_EM,br,this.retainedQueryData[T.bucketInstanceId].tileID),rt=fe||cr.circles.length>0&&!cr.collisionDetected,lt=lt&&cr.offscreen,_t=cr.occluded}if(He.iconFeatureIndex&&(Rr=He.iconFeatureIndex),He.iconBox){const sn=jr=>{Br(jr);const br=Ae&&Ht?Ou(Ht.x,Ht.y,Ee,Pe,this.transform.angle):new o.Point(0,0),On=T.getSymbolInstanceIconSize(oe,this.transform.zoom,Ne.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(T,On,jr,br,de,H,C,se.predicate)};Vt&&Vt.box&&Vt.box.length&&He.verticalIconBox?(Bt=sn(He.verticalIconBox),gt=Bt.box.length>0):(Bt=sn(He.iconBox),gt=Bt.box.length>0),lt=lt&&Bt.offscreen,jt=Bt.occluded}const Kn=X||Ne.numHorizontalGlyphVertices===0&&Ge===0,lo=ne||Ne.numIconVertices===0;if(Kn||lo?lo?Kn||(gt=gt&&rt):rt=gt&&rt:gt=rt=gt&&rt,rt&&dr&&dr.box&&this.collisionIndex.insertCollisionBox(dr.box,M.get("text-ignore-placement"),T.bucketInstanceId,Vt&&Vt.box&&zr?zr:Cr,se.ID),gt&&Bt&&this.collisionIndex.insertCollisionBox(Bt.box,M.get("icon-ignore-placement"),T.bucketInstanceId,Rr,se.ID),cr&&(rt&&this.collisionIndex.insertCollisionCircles(cr.circles,M.get("text-ignore-placement"),T.bucketInstanceId,Cr,se.ID),y)){const sn=T.bucketInstanceId;let jr=this.collisionCircleArrays[sn];jr===void 0&&(jr=this.collisionCircleArrays[sn]=new Mu);for(let br=0;br<cr.circles.length;br+=4)jr.circles.push(cr.circles[br+0]),jr.circles.push(cr.circles[br+1]),jr.circles.push(cr.circles[br+2]),jr.circles.push(cr.collisionDetected?1:0)}const Go=T.projection.name!=="globe";ze=ze&&(Go||!_t),We=We&&(Go||!jt),this.placements[dt]=new Pu(rt||ze,gt||We,lt||T.justReloaded),f.add(dt)};if(je){const Ne=T.getSortedSymbolIndexes(this.transform.angle);for(let nt=Ne.length-1;nt>=0;--nt){const He=Ne[nt];pt(T.symbolInstances.get(He),He,T.collisionArrays[He])}}else for(let Ne=l.symbolInstanceStart;Ne<l.symbolInstanceEnd;Ne++)pt(T.symbolInstances.get(Ne),Ne,T.collisionArrays[Ne]);if(y&&T.bucketInstanceId in this.collisionCircleArrays){const Ne=this.collisionCircleArrays[T.bucketInstanceId];o.invert(Ne.invProjMatrix,C),Ne.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(l,f,y,b){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:k,crossTileID:B}=y,R=o.getAnchorJustification(f),H=b===o.WritingMode.vertical?k:R==="left"?T:R==="center"?M:R==="right"?C:-1;T>=0&&(l.text.placedSymbolArray.get(T).crossTileID=H>=0&&T!==H?0:B),M>=0&&(l.text.placedSymbolArray.get(M).crossTileID=H>=0&&M!==H?0:B),C>=0&&(l.text.placedSymbolArray.get(C).crossTileID=H>=0&&C!==H?0:B),k>=0&&(l.text.placedSymbolArray.get(k).crossTileID=H>=0&&k!==H?0:B)}markUsedOrientation(l,f,y){const b=f===o.WritingMode.horizontal||f===o.WritingMode.horizontalOnly?f:0,T=f===o.WritingMode.vertical?f:0,{leftJustifiedTextSymbolIndex:M,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:B}=y,R=l.text.placedSymbolArray;M>=0&&(R.get(M).placedOrientation=b),C>=0&&(R.get(C).placedOrientation=b),k>=0&&(R.get(k).placedOrientation=b),B>=0&&(R.get(B).placedOrientation=T)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let y=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const b=f?f.symbolFadeChange(l):1,T=f?f.opacities:{},M=f?f.variableOffsets:{},C=f?f.placedOrientations:{};for(const k in this.placements){const B=this.placements[k],R=T[k];R?(this.opacities[k]=new _a(R,b,B.text,B.icon,null,B.clipped),y=y||B.text!==R.text.placed||B.icon!==R.icon.placed):(this.opacities[k]=new _a(null,b,B.text,B.icon,B.skipFade,B.clipped),y=y||B.text||B.icon)}for(const k in T){const B=T[k];if(!this.opacities[k]){const R=new _a(B,b,!1,!1);R.isHidden()||(this.opacities[k]=R,y=y||B.text.placed||B.icon.placed)}}for(const k in M)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=M[k]);for(const k in C)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=C[k]);y?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:l)}updateLayerOpacities(l,f){const y=new Set;for(const b of f){const T=b.getBucket(l);T&&b.latestFeatureIndex&&l.id===T.layerIds[0]&&this.updateBucketOpacities(T,y,b.collisionBoxArray)}}updateBucketOpacities(l,f,y){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const b=l.layers[0].layout,T=!!l.layers[0].dynamicFilter(),M=new _a(null,0,!1,!1,!0),C=b.get("text-allow-overlap"),k=b.get("icon-allow-overlap"),B=b.get("text-variable-anchor"),R=b.get("text-rotation-alignment")==="map",H=b.get("text-pitch-alignment")==="map",ee=b.get("icon-text-fit")!=="none",ie=new _a(null,0,C&&(k||!l.hasIconData()||b.get("icon-optional")),k&&(C||!l.hasTextData()||b.get("text-optional")),!0);!l.collisionArrays&&y&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(y);const ae=(se,X,ne)=>{for(let fe=0;fe<X/4;fe++)se.opacityVertexArray.emplaceBack(ne)};let oe=0;for(let se=0;se<l.symbolInstances.length;se++){const X=l.symbolInstances.get(se),{numHorizontalGlyphVertices:ne,numVerticalGlyphVertices:fe,crossTileID:de,numIconVertices:Ee}=X,Pe=f.has(de);let Ae=this.opacities[de];Pe?Ae=M:Ae||(Ae=ie,this.opacities[de]=Ae),f.add(de);const je=ne>0||fe>0,ze=Ee>0,We=this.placedOrientations[de],pt=We===o.WritingMode.vertical,Ne=We===o.WritingMode.horizontal||We===o.WritingMode.horizontalOnly;if(!je&&!ze||Ae.isHidden()||oe++,je){const nt=Iu(Ae.text);ae(l.text,ne,pt?yn:nt),ae(l.text,fe,Ne?yn:nt);const He=Ae.text.isHidden(),{leftJustifiedTextSymbolIndex:dt,centerJustifiedTextSymbolIndex:Ge,rightJustifiedTextSymbolIndex:rt,verticalPlacedTextSymbolIndex:gt}=X,lt=l.text.placedSymbolArray,_t=He||pt?1:0;dt>=0&&(lt.get(dt).hidden=_t),Ge>=0&&(lt.get(Ge).hidden=_t),rt>=0&&(lt.get(rt).hidden=_t),gt>=0&&(lt.get(gt).hidden=He||Ne?1:0);const jt=this.variableOffsets[de];jt&&this.markUsedJustification(l,jt.anchor,X,We);const Ht=this.placedOrientations[de];Ht&&(this.markUsedJustification(l,"left",X,Ht),this.markUsedOrientation(l,Ht,X))}if(ze){const nt=Iu(Ae.icon),{placedIconSymbolIndex:He,verticalPlacedIconSymbolIndex:dt}=X,Ge=l.icon.placedSymbolArray,rt=Ae.icon.isHidden()?1:0;He>=0&&(ae(l.icon,Ee,pt?yn:nt),Ge.get(He).hidden=rt),dt>=0&&(ae(l.icon,X.numVerticalIconVertices,Ne?yn:nt),Ge.get(dt).hidden=rt)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const nt=l.collisionArrays[se];if(nt){let He=new o.Point(0,0),dt=!0;if(nt.textBox||nt.verticalTextBox){if(B){const rt=this.variableOffsets[de];rt?(He=Cu(rt.anchor,rt.width,rt.height,rt.textOffset,rt.textScale),R&&He._rotate(H?this.transform.angle:-this.transform.angle)):dt=!1}T&&(dt=!Ae.clipped),nt.textBox&&ml(l.textCollisionBox.collisionVertexArray,Ae.text.placed,!dt||pt,He.x,He.y),nt.verticalTextBox&&ml(l.textCollisionBox.collisionVertexArray,Ae.text.placed,!dt||Ne,He.x,He.y)}const Ge=dt&&!!(!Ne&&nt.verticalIconBox);nt.iconBox&&ml(l.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Ge,ee?He.x:0,ee?He.y:0),nt.verticalIconBox&&ml(l.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Ge,ee?He.x:0,ee?He.y:0)}}}if(l.fullyClipped=oe===0,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const se=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=se.invProjMatrix,l.placementViewportMatrix=se.viewportMatrix,l.collisionCircleArray=se.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,f){const y=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*y>l}setStale(){this.stale=!0}}function ml(m,l,f,y,b){m.emplaceBack(l?1:0,f?1:0,y||0,b||0),m.emplaceBack(l?1:0,f?1:0,y||0,b||0),m.emplaceBack(l?1:0,f?1:0,y||0,b||0),m.emplaceBack(l?1:0,f?1:0,y||0,b||0)}const Ci=Math.pow(2,25),Tn=Math.pow(2,24),Ud=Math.pow(2,17),Vd=Math.pow(2,16),Oi=Math.pow(2,9),oo=Math.pow(2,8),Ay=Math.pow(2,1);function Iu(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const l=m.placed?1:0,f=Math.floor(127*m.opacity);return f*Ci+l*Tn+f*Ud+l*Vd+f*Oi+l*oo+f*Ay+l}const yn=0;class ku{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(l,f,y,b,T){const M=this._bucketParts;for(;this._currentTileIndex<l.length;)if(f.getBucketParts(M,b,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((C,k)=>C.sortKey-k.sortKey));this._currentPartIndex<M.length;){const C=M[this._currentPartIndex];if(f.placeLayerBucketPart(C,this._seenCrossTileIDs,y,C.symbolInstanceStart===0),this._currentPartIndex++,T())return!0}return!1}}class Gd{constructor(l,f,y,b,T,M,C,k){this.placement=new Kc(l,T,M,C,k),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(l,f,y){const b=o.exported.now(),T=()=>{const M=o.exported.now()-b;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=f[l[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=C)&&(!M.maxzoom||M.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new ku(M)),this._inProgressLayer.continuePlacement(y[M.source],this.placement,this._showCollisionBoxes,M,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const As=512/o.EXTENT/2;class ni{constructor(l,f,y){this.tileID=l,this.bucketInstanceId=y,this.index=new o.KDBush(f.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=l.canonical.x*o.EXTENT,T=l.canonical.y*o.EXTENT;for(let M=0;M<f.length;M++){const{key:C,crossTileID:k,tileAnchorX:B,tileAnchorY:R}=f.get(M),H=Math.floor((b+B)*As),ee=Math.floor((T+R)*As);this.index.add(H,ee),this.keys.push(C),this.crossTileIDs.push(k)}this.index.finish()}findMatches(l,f,y){const b=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),T=As/Math.pow(2,f.canonical.z-this.tileID.canonical.z),M=f.canonical.x*o.EXTENT,C=f.canonical.y*o.EXTENT;for(let k=0;k<l.length;k++){const B=l.get(k);if(B.crossTileID)continue;const{key:R,tileAnchorX:H,tileAnchorY:ee}=B,ie=Math.floor((M+H)*T),ae=Math.floor((C+ee)*T),oe=this.index.range(ie-b,ae-b,ie+b,ae+b);for(const se of oe){const X=this.crossTileIDs[se];if(this.keys[se]===R&&!y.has(X)){y.add(X),B.crossTileID=X;break}}}}}class Wd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class qd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const f=Math.round((l-this.lng)/360);if(f!==0)for(const y in this.indexes){const b=this.indexes[y],T={};for(const M in b){const C=b[M];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+f),T[C.tileID.key]=C}this.indexes[y]=T}this.lng=l}addBucket(l,f,y){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let T=0;T<f.symbolInstances.length;T++)f.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]=new Set);const b=this.usedCrossTileIDs[l.overscaledZ];for(const T in this.indexes){const M=this.indexes[T];if(Number(T)>l.overscaledZ)for(const C in M){const k=M[C];k.tileID.isChildOf(l)&&k.findMatches(f.symbolInstances,l,b)}else{const C=M[l.scaledTo(Number(T)).key];C&&C.findMatches(f.symbolInstances,l,b)}}for(let T=0;T<f.symbolInstances.length;T++){const M=f.symbolInstances.get(T);M.crossTileID||(M.crossTileID=y.generate(),b.add(M.crossTileID))}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new ni(l,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(l,f){for(const y of f.crossTileIDs)this.usedCrossTileIDs[l].delete(y)}removeStaleBuckets(l){let f=!1;for(const y in this.indexes){const b=this.indexes[y];for(const T in b)l[b[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,b[T]),delete b[T],f=!0)}return f}}class va{constructor(){this.layerIndexes={},this.crossTileIDs=new Wd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,f,y,b){let T=this.layerIndexes[l.id];T===void 0&&(T=this.layerIndexes[l.id]=new qd);let M=!1;const C={};b.name!=="globe"&&T.handleWrapJump(y);for(const k of f){const B=k.getBucket(l);B&&l.id===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(k.tileID,B,this.crossTileIDs)&&(M=!0),C[B.bucketInstanceId]=!0)}return T.removeStaleBuckets(C)&&(M=!0),M}pruneUnusedLayers(l){const f={};l.forEach(y=>{f[y]=!0});for(const y in this.layerIndexes)f[y]||delete this.layerIndexes[y]}}const Qa=(m,l)=>o.emitValidationErrors(m,l&&l.filter(f=>f.identifier!=="source.canvas")),Yc=o.pick(Sr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),M1=o.pick(Sr,["setCenter","setZoom","setBearing","setPitch"]),Zd={version:8,layers:[],sources:{}},gl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class No extends o.Evented{constructor(l,f={}){super(),this.map=l,this.dispatcher=new ft(Ja(),this),this.imageManager=new $e,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(l._requestManager,f.localFontFamily?o.LocalGlyphMode.all:f.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.crossTileSymbolIndex=new va,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const y=this;this._rtlTextPluginCallback=No.registerForPluginStateChange(b=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(T,M)=>{if(o.triggerPluginCompletionEvent(T),M&&M.every(C=>C))for(const C in y._sourceCaches){const k=y._sourceCaches[C],B=k.getSource().type;B!=="vector"&&B!=="geojson"||k.reload()}})}),this.on("data",b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const T=this.getSource(b.sourceId);if(T&&T.vectorLayerIds)for(const M in this._layers){const C=this._layers[M];C.source===T.id&&this._validateLayer(C)}})}loadURL(l,f={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const y=typeof f.validate=="boolean"?f.validate:!o.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,f.accessToken);const b=this.map._requestManager.transformRequest(l,o.ResourceType.Style);this._request=o.getJSON(b,(T,M)=>{this._request=null,T?this.fire(new o.ErrorEvent(T)):M&&this._load(M,y)})}loadJSON(l,f={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(l,f.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Zd,!1)}_updateLayerCount(l,f){const y=f?1:-1;l.is3D()&&(this._num3DLayers+=y),l.type==="circle"&&(this._numCircleLayers+=y),l.type==="symbol"&&(this._numSymbolLayers+=y)}_load(l,f){if(f&&Qa(this,o.validateStyle(l)))return;this._loaded=!0,this.stylesheet=o.clone$1(l),this._updateMapProjection();for(const b in l.sources)this.addSource(b,l.sources[b],{validate:!1});this._changed=!1,l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(l.glyphs);const y=by(this.stylesheet.layers);this._order=y.map(b=>b.id),this._layers={},this._serializedLayers={};for(const b of y){const T=o.createStyleLayer(b);T.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new be(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(l){this._spriteRequest=function(f,y,b){let T,M,C;const k=o.exported.devicePixelRatio>1?"@2x":"";let B=o.getJSON(y.transformRequest(y.normalizeSpriteURL(f,k,".json"),o.ResourceType.SpriteJSON),(ee,ie)=>{B=null,C||(C=ee,T=ie,H())}),R=o.getImage(y.transformRequest(y.normalizeSpriteURL(f,k,".png"),o.ResourceType.SpriteImage),(ee,ie)=>{R=null,C||(C=ee,M=ie,H())});function H(){if(C)b(C);else if(T&&M){const ee=o.exported.getImageData(M),ie={};for(const ae in T){const{width:oe,height:se,x:X,y:ne,sdf:fe,pixelRatio:de,stretchX:Ee,stretchY:Pe,content:Ae}=T[ae],je=new o.RGBAImage({width:oe,height:se});o.RGBAImage.copy(ee,je,{x:X,y:ne},{x:0,y:0},{width:oe,height:se}),ie[ae]={data:je,pixelRatio:de,sdf:fe,stretchX:Ee,stretchY:Pe,content:Ae}}b(null,ie)}}return{cancel(){B&&(B.cancel(),B=null),R&&(R.cancel(),R=null)}}}(l,this.map._requestManager,(f,y)=>{if(this._spriteRequest=null,f)this.fire(new o.ErrorEvent(f));else if(y)for(const b in y)this.imageManager.addImage(b,y[b]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(l){const f=this.getSource(l.source);if(!f)return;const y=l.sourceLayer;y&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(y)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${f.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const f=[];for(const y of l){const b=this._layers[y];b.type!=="custom"&&f.push(b.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(l){return!!this.terrain&&(typeof l.isLayerDraped=="function"?l.isLayerDraped():gl[l.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(l){if(!this._loaded)return;const f=this._changed;if(this._changed){const b=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(b.length||T.length)&&this._updateWorkerLayers(b,T);for(const M in this._updatedSources){const C=this._updatedSources[M];C==="reload"?this._reloadSource(M):C==="clear"&&this._clearSource(M)}this._updateTilesForChangedImages();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(l);this.light.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._resetUpdates()}const y={};for(const b in this._sourceCaches){const T=this._sourceCaches[b];y[b]=T.used,T.used=!1}for(const b of this._order){const T=this._layers[b];if(T.recalculate(l,this._availableImages),!T.isHidden(l.zoom)){const C=this._getLayerSourceCache(T);C&&(C.used=!0)}const M=this.map.painter;if(M){const C=T.getProgramIds();if(!C)continue;const k=T.getProgramConfiguration(l.zoom);for(const B of C)M.useProgram(B,k)}}for(const b in y){const T=this._sourceCaches[b];y[b]!==T.used&&T.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T.getSource().id}))}this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(l){if(this._checkLoaded(),Qa(this,o.validateStyle(l)))return!1;(l=o.clone$1(l)).layers=by(l.layers);const f=function(b,T){if(!b)return[{command:Sr.setStyle,args:[T]}];let M=[];try{if(!x(b.version,T.version))return[{command:Sr.setStyle,args:[T]}];x(b.center,T.center)||M.push({command:Sr.setCenter,args:[T.center]}),x(b.zoom,T.zoom)||M.push({command:Sr.setZoom,args:[T.zoom]}),x(b.bearing,T.bearing)||M.push({command:Sr.setBearing,args:[T.bearing]}),x(b.pitch,T.pitch)||M.push({command:Sr.setPitch,args:[T.pitch]}),x(b.sprite,T.sprite)||M.push({command:Sr.setSprite,args:[T.sprite]}),x(b.glyphs,T.glyphs)||M.push({command:Sr.setGlyphs,args:[T.glyphs]}),x(b.transition,T.transition)||M.push({command:Sr.setTransition,args:[T.transition]}),x(b.light,T.light)||M.push({command:Sr.setLight,args:[T.light]}),x(b.fog,T.fog)||M.push({command:Sr.setFog,args:[T.fog]}),x(b.projection,T.projection)||M.push({command:Sr.setProjection,args:[T.projection]});const C={},k=[];(function(H,ee,ie,ae){let oe;for(oe in ee=ee||{},H=H||{})H.hasOwnProperty(oe)&&(ee.hasOwnProperty(oe)||Su(oe,ie,ae));for(oe in ee){if(!ee.hasOwnProperty(oe))continue;const se=ee[oe];H.hasOwnProperty(oe)?x(H[oe],se)||(H[oe].type==="geojson"&&se.type==="geojson"&&Xc(H,ee,oe)?ie.push({command:Sr.setGeoJSONSourceData,args:[oe,se.data]}):Bd(oe,ee,ie,ae)):Rd(oe,ee,ie)}})(b.sources,T.sources,k,C);const B=[];b.layers&&b.layers.forEach(H=>{H.source&&C[H.source]?M.push({command:Sr.removeLayer,args:[H.id]}):B.push(H)});let R=b.terrain;R&&C[R.source]&&(M.push({command:Sr.setTerrain,args:[void 0]}),R=void 0),M=M.concat(k),x(R,T.terrain)||M.push({command:Sr.setTerrain,args:[T.terrain]}),function(H,ee,ie){ee=ee||[];const ae=(H=H||[]).map(ma),oe=ee.map(ma),se=H.reduce(jd,{}),X=ee.reduce(jd,{}),ne=ae.slice(),fe=Object.create(null);let de,Ee,Pe,Ae,je,ze,We;for(de=0,Ee=0;de<ae.length;de++)Pe=ae[de],X.hasOwnProperty(Pe)?Ee++:(ie.push({command:Sr.removeLayer,args:[Pe]}),ne.splice(ne.indexOf(Pe,Ee),1));for(de=0,Ee=0;de<oe.length;de++)Pe=oe[oe.length-1-de],ne[ne.length-1-de]!==Pe&&(se.hasOwnProperty(Pe)?(ie.push({command:Sr.removeLayer,args:[Pe]}),ne.splice(ne.lastIndexOf(Pe,ne.length-Ee),1)):Ee++,ze=ne[ne.length-de],ie.push({command:Sr.addLayer,args:[X[Pe],ze]}),ne.splice(ne.length-de,0,Pe),fe[Pe]=!0);for(de=0;de<oe.length;de++)if(Pe=oe[de],Ae=se[Pe],je=X[Pe],!fe[Pe]&&!x(Ae,je))if(x(Ae.source,je.source)&&x(Ae["source-layer"],je["source-layer"])&&x(Ae.type,je.type)){for(We in Fo(Ae.layout,je.layout,ie,Pe,null,Sr.setLayoutProperty),Fo(Ae.paint,je.paint,ie,Pe,null,Sr.setPaintProperty),x(Ae.filter,je.filter)||ie.push({command:Sr.setFilter,args:[Pe,je.filter]}),x(Ae.minzoom,je.minzoom)&&x(Ae.maxzoom,je.maxzoom)||ie.push({command:Sr.setLayerZoomRange,args:[Pe,je.minzoom,je.maxzoom]}),Ae)Ae.hasOwnProperty(We)&&We!=="layout"&&We!=="paint"&&We!=="filter"&&We!=="metadata"&&We!=="minzoom"&&We!=="maxzoom"&&(We.indexOf("paint.")===0?Fo(Ae[We],je[We],ie,Pe,We.slice(6),Sr.setPaintProperty):x(Ae[We],je[We])||ie.push({command:Sr.setLayerProperty,args:[Pe,We,je[We]]}));for(We in je)je.hasOwnProperty(We)&&!Ae.hasOwnProperty(We)&&We!=="layout"&&We!=="paint"&&We!=="filter"&&We!=="metadata"&&We!=="minzoom"&&We!=="maxzoom"&&(We.indexOf("paint.")===0?Fo(Ae[We],je[We],ie,Pe,We.slice(6),Sr.setPaintProperty):x(Ae[We],je[We])||ie.push({command:Sr.setLayerProperty,args:[Pe,We,je[We]]}))}else ie.push({command:Sr.removeLayer,args:[Pe]}),ze=ne[ne.lastIndexOf(Pe)+1],ie.push({command:Sr.addLayer,args:[je,ze]})}(B,T.layers,M)}catch(C){console.warn("Unable to compute style diff:",C),M=[{command:Sr.setStyle,args:[T]}]}return M}(this.serialize(),l).filter(b=>!(b.command in M1));if(f.length===0)return!1;const y=f.filter(b=>!(b.command in Yc));if(y.length>0)throw new Error(`Unimplemented: ${y.map(b=>b.command).join(", ")}.`);return f.forEach(b=>{b.command!=="setTransition"&&b.command!=="setProjection"&&this[b.command].apply(this,b.args)}),this.stylesheet=l,this._updateMapProjection(),!0}addImage(l,f){return this.getImage(l)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,f),this._afterImageUpdated(l),this)}updateImage(l,f){this.imageManager.updateImage(l,f)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l),this._afterImageUpdated(l),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(l,f,y={}){if(this._checkLoaded(),this.getSource(l)!==void 0)throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(o.validateSource,`sources.${l}`,f,null,y))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const b=or(l,f,this.dispatcher,this);b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(l),source:b.serialize(),sourceId:l}));const T=M=>{const C=(M?"symbol:":"other:")+l,k=this._sourceCaches[C]=new o.SourceCache(C,b,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[l]=k,k.style=this,k.onAdd(this.map)};T(!1),f.type!=="vector"&&f.type!=="geojson"||T(!0),b.onAdd&&b.onAdd(this.map),this._changed=!0}removeSource(l){this._checkLoaded();const f=this.getSource(l);if(!f)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===l)return this.fire(new o.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.get().source===l)return this.fire(new o.ErrorEvent(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const y=this._getSourceCaches(l);for(const b of y)delete this._sourceCaches[b.id],delete this._updatedSources[b.id],b.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles();return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(l,f){this._checkLoaded(),this.getSource(l).setData(f),this._changed=!0}getSource(l){const f=this._getSourceCache(l);return f&&f.getSource()}_getSources(){const l=[];for(const f in this._otherSourceCaches){const y=this._getSourceCache(f);y&&l.push(y.getSource())}return l}addLayer(l,f,y={}){this._checkLoaded();const b=l.id;if(this.getLayer(b))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${b}" already exists on this map`)));let T;if(l.type==="custom"){if(Qa(this,o.validateCustomStyleLayer(l)))return;T=o.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(b,l.source),l=o.clone$1(l),l=o.extend(l,{source:b})),this._validate(o.validateLayer,`layers.${b}`,l,{arrayIndex:-1},y))return;T=o.createStyleLayer(l),this._validateLayer(T),T.setEventedParent(this,{layer:{id:b}}),this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}const M=f?this._order.indexOf(f):this._order.length;if(f&&M===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(M,0,b),this._layerOrderChanged=!0,this._layers[b]=T;const C=this._getLayerSourceCache(T);if(this._removedLayers[b]&&T.source&&C&&T.type!=="custom"){const k=this._removedLayers[b];delete this._removedLayers[b],k.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",C.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(l,f){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===f)return;const y=this._order.indexOf(l);this._order.splice(y,1);const b=f?this._order.indexOf(f):this._order.length;f&&b===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(b,0,l),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(l){this._checkLoaded();const f=this._layers[l];if(!f)return void this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const y=this._order.indexOf(l);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=f,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}hasLayerType(l){for(const f in this._layers)if(this._layers[f].type===l)return!0;return!1}setLayerZoomRange(l,f,y){this._checkLoaded();const b=this.getLayer(l);b?b.minzoom===f&&b.maxzoom===y||(f!=null&&(b.minzoom=f),y!=null&&(b.maxzoom=y),this._updateLayer(b)):this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(l,f,y={}){this._checkLoaded();const b=this.getLayer(l);if(b){if(!x(b.filter,f))return f==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(o.validateFilter,`layers.${b.id}.filter`,f,{layerType:b.type},y)||(b.filter=o.clone$1(f),this._updateLayer(b)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be filtered.`)))}getFilter(l){const f=this.getLayer(l);return f&&o.clone$1(f.filter)}setLayoutProperty(l,f,y,b={}){this._checkLoaded();const T=this.getLayer(l);T?x(T.getLayoutProperty(f),y)||(T.setLayoutProperty(f,y,b),this._updateLayer(T)):this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(l,f){const y=this.getLayer(l);if(y)return y.getLayoutProperty(f);this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style.`)))}setPaintProperty(l,f,y,b={}){this._checkLoaded();const T=this.getLayer(l);T?x(T.getPaintProperty(f),y)||(T.setPaintProperty(f,y,b)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(l,f){const y=this.getLayer(l);return y&&y.getPaintProperty(f)}setFeatureState(l,f){this._checkLoaded();const y=l.source,b=l.sourceLayer,T=this.getSource(y);if(!T)return void this.fire(new o.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const M=T.type;if(M==="geojson"&&b)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(M==="vector"&&!b)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));l.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const C=this._getSourceCaches(y);for(const k of C)k.setFeatureState(b,l.id,f)}removeFeatureState(l,f){this._checkLoaded();const y=l.source,b=this.getSource(y);if(!b)return void this.fire(new o.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const T=b.type,M=T==="vector"?l.sourceLayer:void 0;if(T==="vector"&&!M)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof l.id!="string"&&typeof l.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const C=this._getSourceCaches(y);for(const k of C)k.removeFeatureState(M,l.id,f)}getFeatureState(l){this._checkLoaded();const f=l.source,y=l.sourceLayer,b=this.getSource(f);if(b){if(b.type!=="vector"||y)return l.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(y,l.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const l={};for(const f in this._sourceCaches){const y=this._sourceCaches[f].getSource();l[y.id]||(l[y.id]=y.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:l,layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0;const f=this._getLayerSourceCache(l);l.source&&!this._updatedSources[l.source]&&f&&f.getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",f.pause()),this._changed=!0,l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const f=M=>this._layers[M].type==="fill-extrusion",y={},b=[];for(let M=this._order.length-1;M>=0;M--){const C=this._order[M];if(f(C)){y[C]=M;for(const k of l){const B=k[C];if(B)for(const R of B)b.push(R)}}}b.sort((M,C)=>C.intersectionZ-M.intersectionZ);const T=[];for(let M=this._order.length-1;M>=0;M--){const C=this._order[M];if(f(C))for(let k=b.length-1;k>=0;k--){const B=b[k].feature;if(y[B.layer.id]<M)break;T.push(B),b.pop()}else for(const k of l){const B=k[C];if(B)for(const R of B)T.push(R.feature)}}return T}queryRenderedFeatures(l,f,y){f&&f.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",f.filter,null,f);const b={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const k of f.layers){const B=this._layers[k];if(!B)return this.fire(new o.ErrorEvent(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];b[B.source]=!0}}const T=[];f.availableImages=this._availableImages;const M=f&&f.layers?f.layers.some(k=>{const B=this.getLayer(k);return B&&B.is3D()}):this.has3DLayers(),C=Ot.createFromScreenPoints(l,y);for(const k in this._sourceCaches){const B=this._sourceCaches[k].getSource().id;f.layers&&!b[B]||T.push(qt(this._sourceCaches[k],this._layers,this._serializedLayers,C,f,y,M,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(k,B,R,H,ee,ie,ae){const oe={},se=ie.queryRenderedSymbols(H),X=[];for(const ne of Object.keys(se).map(Number))X.push(ae[ne]);X.sort(un);for(const ne of X){const fe=ne.featureIndex.lookupSymbolFeatures(se[ne.bucketInstanceId],B,ne.bucketIndex,ne.sourceLayerIndex,ee.filter,ee.layers,ee.availableImages,k);for(const de in fe){const Ee=oe[de]=oe[de]||[],Pe=fe[de];Pe.sort((Ae,je)=>{const ze=ne.featureSortOrder;if(ze){const We=ze.indexOf(Ae.featureIndex);return ze.indexOf(je.featureIndex)-We}return je.featureIndex-Ae.featureIndex});for(const Ae of Pe)Ee.push(Ae)}}for(const ne in oe)oe[ne].forEach(fe=>{const de=fe.feature,Ee=R(k[ne]);if(!Ee)return;const Pe=Ee.getFeatureState(de.layer["source-layer"],de.id);de.source=de.layer.source,de.layer["source-layer"]&&(de.sourceLayer=de.layer["source-layer"]),de.state=Pe});return oe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),C.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(l,f){f&&f.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",f.filter,null,f);const y=this._getSourceCaches(l);let b=[];for(const T of y)b=b.concat(Mr(T,f));return b}addSourceType(l,f,y){return No.getSourceType(l)?y(new Error(`A source type called "${l}" already exists.`)):(No.setSourceType(l,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:f.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(l,f={}){this._checkLoaded();const y=this.light.getLight();let b=!1;for(const M in l)if(!x(l[M],y[M])){b=!0;break}if(!b)return;const T=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(l,f),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(l,f=1){if(this._checkLoaded(),!l)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let y=l;if(f===1){if(typeof y.source=="object"){const b="terrain-dem-src";this.addSource(b,y.source),y=o.clone$1(y),y=o.extend(y,{source:b})}if(this._validate(o.validateTerrain,"terrain",y))return}if(!this.terrain||this.terrain&&f!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,f)}else{const b=this.terrain,T=b.get();for(const M of Object.keys(o.spec.terrain))!y.hasOwnProperty(M)&&o.spec.terrain[M].default&&(y[M]=o.spec.terrain[M].default);for(const M in y)if(!x(y[M],T[M])){b.set(y),this.stylesheet.terrain=y;const C=this._setTransitionParameters({duration:0});b.updateTransitions(C);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){const f=this.fog=new at(l,this.map.transform);this.stylesheet.fog=l;const y=this._setTransitionParameters({duration:0});f.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,y=f.get();Object.keys(l).length===0&&f.set(l);for(const b in l)if(!x(l[b],y[b])){f.set(l),this.stylesheet.fog=l;const T=this._setTransitionParameters({duration:0});f.updateTransitions(T);break}}else this._createFog(l);this._markersNeedUpdate=!0}_setTransitionParameters(l){return{now:o.exported.now(),transition:o.extend(l,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const l=this._order.filter(y=>this.isLayerDraped(this._layers[y])),f=this._order.filter(y=>!this.isLayerDraped(this._layers[y]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...f)}_createTerrain(l,f){const y=this.terrain=new Me(l,f);this.stylesheet.terrain=l,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const b=this._setTransitionParameters({duration:0});y.updateTransitions(b)}_force3DLayerUpdate(){for(const l in this._layers){const f=this._layers[l];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const l in this._layers){const f=this._layers[l];f.type==="symbol"&&this._updateLayer(f)}}_validate(l,f,y,b,T={}){return(!T||T.validate!==!1)&&Qa(this,l.call(o.validateStyle,o.extend({key:f,style:this.serialize(),value:y,styleSpec:o.spec},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this._sourceCaches)this._sourceCaches[l].clearTiles(),this._sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){const f=this._getSourceCaches(l);for(const y of f)y.clearTiles()}_reloadSource(l){const f=this._getSourceCaches(l);for(const y of f)y.resume(),y.reload()}_reloadSources(){for(const l of this._getSources())l.reload&&l.reload()}_updateSources(l){for(const f in this._sourceCaches)this._sourceCaches[f].update(l)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const f=this._sourceCaches[l];f.resume(),f.reload()}}_updatePlacement(l,f,y,b,T=!1){let M=!1,C=!1;const k={};for(const B of this._order){const R=this._layers[B];if(R.type!=="symbol")continue;if(!k[R.source]){const ee=this._getLayerSourceCache(R);if(!ee)continue;k[R.source]=ee.getRenderableIds(!0).map(ie=>ee.getTileByID(ie)).sort((ie,ae)=>ae.tileID.overscaledZ-ie.tileID.overscaledZ||(ie.tileID.isLessThan(ae.tileID)?-1:1))}const H=this.crossTileSymbolIndex.addLayer(R,k[R.source],l.center.lng,l.projection);M=M||H}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),T=T||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(T||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),l.zoom))&&(this.pauseablePlacement=new Gd(l,this._order,T,f,y,b,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),C=!0),M&&this.pauseablePlacement.placement.setStale()),C||M)for(const B of this._order){const R=this._layers[B];R.type==="symbol"&&this.placement.updateLayerOpacities(R,k[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,f,y){this.imageManager.getImages(f.icons,y),this._updateTilesForChangedImages();const b=T=>{T&&T.setDependencies(f.tileID.key,f.type,f.icons)};b(this._otherSourceCaches[f.source]),b(this._symbolSourceCaches[f.source])}getGlyphs(l,f,y){this.glyphManager.getGlyphs(f.stacks,y)}getResource(l,f,y){return o.makeRequest(f,y)}_getSourceCache(l){return this._otherSourceCaches[l]}_getLayerSourceCache(l){return l.type==="symbol"?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}_getSourceCaches(l){const f=[];return this._otherSourceCaches[l]&&f.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&f.push(this._symbolSourceCaches[l]),f}_isSourceCacheLoaded(l){const f=this._getSourceCaches(l);return f.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${l}'`))),!1):f.every(y=>y.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}No.getSourceType=function(m){return Zt[m]},No.setSourceType=function(m,l){Zt[m]=l},No.registerForPluginStateChange=o.registerForPluginStateChange;var Hd=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Ps="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",xa=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Du=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ba=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Jc={},yl={};const Lu=[];_l(Hd,Lu),_l(xa,Lu),_l(Du,Lu),_l(ba,Lu),Jc=Er("",xa),yl=Er(ba,Du);const Py=Er(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Qc=Hd,Xd=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Kd={background:Er(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Er(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Er(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Er("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Er(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Er(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Er("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Er("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Er("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Er(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Er(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Er(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Er(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Er(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Er(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Er(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Er(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Er(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Er(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Er(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Er(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Er(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ps),skyboxGradient:Er(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ps),skyboxCapture:Er(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Er(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Er(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function _l(m,l){const f=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of f)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=y.split(" ");for(const T of b)l.includes(T)||l.push(T)}}function Er(m,l){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=l.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),b={},T=[...Lu];return _l(m,T),_l(l,T),{fragmentSource:m=m.replace(f,(M,C,k,B,R)=>(b[R]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${R}
varying ${k} ${B} ${R};
#else
uniform ${k} ${B} u_${R};
#endif
`:`
#ifdef HAS_UNIFORM_u_${R}
    ${k} ${B} ${R} = u_${R};
#endif
`)),vertexSource:l=l.replace(f,(M,C,k,B,R)=>{const H=B==="float"?"vec2":"vec4",ee=R.match(/color/)?"color":H;return b[R]?C==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${k} ${H} a_${R};
varying ${k} ${B} ${R};
#else
uniform ${k} ${B} u_${R};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = a_${R};
#else
    ${k} ${B} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = unpack_mix_${ee}(a_${R}, u_${R}_t);
#else
    ${k} ${B} ${R} = u_${R};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${k} ${H} a_${R};
#else
uniform ${k} ${B} u_${R};
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${k} ${B} ${R} = a_${R};
#else
    ${k} ${B} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${k} ${B} ${R} = unpack_mix_${ee}(a_${R}, u_${R}_t);
#else
    ${k} ${B} ${R} = u_${R};
#endif
`}),staticAttributes:y,usedDefines:T}}class C1{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,f,y,b,T,M,C){this.context=l;let k=this.boundPaintVertexBuffers.length!==b.length;for(let R=0;!k&&R<b.length;R++)this.boundPaintVertexBuffers[R]!==b[R]&&(k=!0);let B=this.boundDynamicVertexBuffers.length!==C.length;for(let R=0;!B&&R<C.length;R++)this.boundDynamicVertexBuffers[R]!==C[R]&&(B=!0);if(!l.extVertexArrayObject||!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==y||k||B||this.boundIndexBuffer!==T||this.boundVertexOffset!==M)this.freshBind(f,y,b,T,M,C);else{l.bindVertexArrayOES.set(this.vao);for(const R of C)R&&R.bind();T&&T.dynamicDraw&&T.bind()}}freshBind(l,f,y,b,T,M){let C;const k=l.numAttributes,B=this.context,R=B.gl;if(B.extVertexArrayObject)this.vao&&this.destroy(),this.vao=B.extVertexArrayObject.createVertexArrayOES(),B.bindVertexArrayOES.set(this.vao),C=0,this.boundProgram=l,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=b,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=M;else{C=B.currentNumAttributes||0;for(let H=k;H<C;H++)R.disableVertexAttribArray(H)}f.enableAttributes(R,l),f.bind(),f.setVertexAttribPointers(R,l,T);for(const H of y)H.enableAttributes(R,l),H.bind(),H.setVertexAttribPointers(R,l,T);for(const H of M)H&&(H.enableAttributes(R,l),H.bind(),H.setVertexAttribPointers(R,l,T));b&&b.bind(),B.currentNumAttributes=k}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Yd(m,l){const f=Math.pow(2,l.canonical.z),y=l.canonical.y;return[new o.MercatorCoordinate(0,y/f).toLngLat().lat,new o.MercatorCoordinate(0,(y+1)/f).toLngLat().lat]}function My(m,l,f,y,b,T,M){const C=m.context,k=C.gl,B=f.fbo;if(!B)return;m.prepareDrawTile();const R=m.useProgram("hillshade");C.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,B.colorAttachment.get());const H=((oe,se,X,ne)=>{const fe=X.paint.get("hillshade-shadow-color"),de=X.paint.get("hillshade-highlight-color"),Ee=X.paint.get("hillshade-accent-color");let Pe=X.paint.get("hillshade-illumination-direction")*(Math.PI/180);X.paint.get("hillshade-illumination-anchor")==="viewport"&&(Pe-=oe.transform.angle);const Ae=!oe.options.moving;return{u_matrix:ne||oe.transform.calculateProjMatrix(se.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:Yd(0,se.tileID),u_light:[X.paint.get("hillshade-exaggeration"),Pe],u_shadow:fe,u_highlight:de,u_accent:Ee}})(m,f,y,m.terrain?l.projMatrix:null);m.prepareDrawProgram(C,R,l.toUnwrapped());const{tileBoundsBuffer:ee,tileBoundsIndexBuffer:ie,tileBoundsSegments:ae}=m.getTileBoundsBuffers(f);R.draw(C,k.TRIANGLES,b,T,M,o.CullFaceMode.disabled,H,y.id,ee,ie,ae)}function Jd(m,l,f){if(!l.needsDEMTextureUpload)return;const y=m.context,b=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||m.getTileTexture(f.stride);const T=f.getPixels();l.demTexture?l.demTexture.update(T,{premultiply:!1}):l.demTexture=new o.Texture(y,T,b.RGBA,{premultiply:!1}),l.needsDEMTextureUpload=!1}function Cy(m,l,f,y,b,T){const M=m.context,C=M.gl;if(!l.dem)return;const k=l.dem;if(M.activeTexture.set(C.TEXTURE1),Jd(m,l,k),!l.demTexture)return;l.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);const B=k.dim;M.activeTexture.set(C.TEXTURE0);let R=l.fbo;if(!R){const ae=new o.Texture(M,{width:B,height:B,data:null},C.RGBA);ae.bind(C.LINEAR,C.CLAMP_TO_EDGE),R=l.fbo=M.createFramebuffer(B,B,!0),R.colorAttachment.set(ae.texture)}M.bindFramebuffer.set(R.framebuffer),M.viewport.set([0,0,B,B]);const{tileBoundsBuffer:H,tileBoundsIndexBuffer:ee,tileBoundsSegments:ie}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(M,C.TRIANGLES,y,b,T,o.CullFaceMode.disabled,((ae,oe)=>{const se=oe.stride,X=o.create();return o.ortho(X,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(X,X,[0,-o.EXTENT,0]),{u_matrix:X,u_image:1,u_dimension:[se,se],u_zoom:ae.overscaledZ,u_unpack:oe.unpackVector}})(l.tileID,k),f.id,H,ee,ie),l.needsHillshadePrepare=!1}const Qd=m=>({u_matrix:new o.UniformMatrix4f(m),u_image0:new o.Uniform1i(m),u_skirt_height:new o.Uniform1f(m)}),vl=(m,l)=>({u_matrix:m,u_image0:0,u_skirt_height:l}),eh=(m,l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:f,u_zoom_transition:b,u_merc_center:T,u_image0:0,u_frustum_tl:M,u_frustum_tr:C,u_frustum_br:k,u_frustum_bl:B,u_globe_pos:R,u_globe_radius:H,u_viewport:ee,u_grid_matrix:ae?Float32Array.from(ae):new Float32Array(9),u_skirt_height:ie});function xl(m,l){return m!=null&&l!=null&&!(!m.hasData()||!l.hasData())&&m.demTexture!=null&&l.demTexture!=null&&m.tileID.key!==l.tileID.key}const wa=new class{constructor(){this.operations={}}newMorphing(m,l,f,y,b){if(m in this.operations){const T=this.operations[m];T.to.tileID.key!==f.tileID.key&&(T.queued=f)}else this.operations[m]={startTime:y,phase:0,duration:b,from:l,to:f,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const l=this.operations[m];return{from:l.from,to:l.to,phase:l.phase}}update(m){for(const l in this.operations){const f=this.operations[l];for(f.phase=(m-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,m)){delete this.operations[l];break}}}_nextOp(m,l){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=l,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},Ms={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function th(m){return 6*Math.pow(1.5,22-m)}function Oy(m,l){const f=1<<m.z;return!l&&(m.x===0||m.x===f-1)||m.y===0||m.y===f-1}const zu=m=>({u_matrix:m});function ep(m,l,f,y,b){if(b>0){const T=o.exported.now(),M=(T-m.timeAdded)/b,C=l?(T-l.timeAdded)/b:-1,k=f.getSource(),B=y.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),R=!l||Math.abs(l.tileID.overscaledZ-B)>Math.abs(m.tileID.overscaledZ-B),H=R&&m.refreshedUponExpiration?1:o.clamp(R?M:1-C,0,1);return m.refreshedUponExpiration&&M>=1&&(m.refreshedUponExpiration=!1),l?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}class tp extends o.SourceCache{constructor(l){const f={type:"raster-dem",maxzoom:l.transform.maxZoom},y=new ft(Ja(),null),b=or("mock-dem",f,y,l.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,f){l.state="loaded",f(null)}}class rh extends o.SourceCache{constructor(l){const f=or("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new ft(Ja(),null),l.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,f,y){if(l.freezeTileCoverage)return;this.transform=l;const b=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,M)=>{if(T[M.key]="",!this._tiles[M.key]){const C=new o.Tile(M,this._source.tileSize*M.overscaleFactor(),l.tileZoom);C.state="loaded",this._tiles[M.key]=C}return T},{});for(const T in this._tiles)T in b||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(l){const f=this.proxyCachedFBO[l];if(f!==void 0){const y=Object.values(f);this.renderCachePool.push(...y),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class nh extends o.OverscaledTileID{constructor(l,f,y){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=f,this.projMatrix=y}}class rp extends o.Elevation{constructor(l,f){super(),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,b,T]=function(k){const B=new o.StructArrayLayout2i4,R=new o.StructArrayLayout3ui6,H=131;B.reserve(17161),R.reserve(33800);const ee=o.EXTENT/128,ie=o.EXTENT+ee/2,ae=ie+ee;for(let se=-ee;se<ae;se+=ee)for(let X=-ee;X<ae;X+=ee){const ne=X<0||X>ie||se<0||se>ie?24575:0,fe=o.clamp(Math.round(X),0,o.EXTENT),de=o.clamp(Math.round(se),0,o.EXTENT);B.emplaceBack(fe+ne,de)}const oe=(se,X)=>{const ne=X*H+se;R.emplaceBack(ne+1,ne,ne+H),R.emplaceBack(ne+H,ne+H+1,ne+1)};for(let se=1;se<129;se++)for(let X=1;X<129;X++)oe(X,se);return[0,129].forEach(se=>{for(let X=0;X<130;X++)oe(X,se),oe(se,X)}),[B,R,32768]}(),M=l.context;this.gridBuffer=M.createVertexBuffer(y,o.posAttributes.members),this.gridIndexBuffer=M.createIndexBuffer(b),this.gridSegments=o.SegmentVector.simpleSegment(0,0,y.length,b.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,y.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new rh(f.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.EXTENT,0,o.EXTENT,0,1);const C=M.gl;this._overlapStencilMode=new o.StencilMode({func:C.GEQUAL,mask:255},0,255,C.KEEP,C.KEEP,C.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new tp(f.map)}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),l.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=l,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(l,f,y){if(l&&l.terrain){this._style!==l&&(this.style=l),this.enabled=!0;const b=l.terrain.properties;this.sourceCache=l.terrain.drapeRenderMode===0?this._mockSourceCache:l._getSourceCache(b.get("source")),this._exaggeration=b.get("exaggeration");const T=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const M=this.getScaledDemTileSize();this.sourceCache.update(f,M,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),f.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const l=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||l.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${l.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${l.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(l){l.coord&&l.dataType==="source"?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):l.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._sourceCaches)this._style._sourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=f.getIds().map(k=>{const B=f.getTileByID(k).tileID;return B.projMatrix=y.calculateProjMatrix(B.toUnwrapped()),B});(function(k,B){const R=B.transform.pointCoordinate(B.transform.getCameraPoint()),H=new o.Point(R.x,R.y);k.sort((ee,ie)=>{if(ie.overscaledZ-ee.overscaledZ)return ie.overscaledZ-ee.overscaledZ;const ae=new o.Point(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),oe=new o.Point(ie.canonical.x+(1<<ie.canonical.z)*ie.wrap,ie.canonical.y),se=H.mult(1<<ee.canonical.z);return se.x-=.5,se.y-=.5,se.distSqr(ae)-se.distSqr(oe)})})(b,this.painter),this._previousZoom=y.zoom;const T=this.proxyToSource||{};this.proxyToSource={},b.forEach(k=>{this.proxyToSource[k.key]={}}),this.terrainTileForTile={};const M=this._style._sourceCaches;for(const k in M){const B=M[k];if(!B.used||(B!==this.sourceCache&&this.resetTileLookupCache(B.id),this._setupProxiedCoordsForOrtho(B,l[k],T),B.usedForTerrain))continue;const R=l[k];B.getSource().reparseOverscaled&&this._assignTerrainTiles(R)}this.proxiedCoords[f.id]=b.map(k=>new nh(k,k.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const C={};this._visibleDemTiles=[];for(const k of this.proxyCoords){const B=this.terrainTileForTile[k.key];if(!B)continue;const R=B.tileID.key;R in C||(this._visibleDemTiles.push(B),C[R]=R)}}_assignTerrainTiles(l){this._initializing||l.forEach(f=>{if(this.terrainTileForTile[f.key])return;const y=this._findTileCoveringTileID(f,this.sourceCache);y&&(this.terrainTileForTile[f.key]=y)})}_prepareDEMTextures(){const l=this.painter.context,f=l.gl;for(const y in this.terrainTileForTile){const b=this.terrainTileForTile[y],T=b.dem;!T||b.demTexture&&!b.needsDEMTextureUpload||(l.activeTexture.set(f.TEXTURE1),Jd(this.painter,b,T))}}_prepareDemTileUniforms(l,f,y,b){if(!f||f.demTexture==null)return!1;const T=l.tileID.canonical,M=Math.pow(2,f.tileID.canonical.z-T.z),C=b||"";return y[`u_dem_tl${C}`]=[T.x*M%1,T.y*M%1],y[`u_dem_scale${C}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const l=this.painter.context,f=l.gl;if(!this._emptyDepthBufferTexture){const y=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(l,y,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let l=0;const f=this._visibleDemTiles.reduce((y,b)=>{if(!b.dem)return y;const T=b.dem.tree.minimums[0];return T>0&&l++,y+T},0);return l?f/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,f=l.gl;l.activeTexture.set(f.TEXTURE2);const y=this._getLoadedAreaMinimum(),b=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(y,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(b,{premultiply:!1}):T=this._emptyDEMTexture=new o.Texture(l,b,f.RGBA,{premultiply:!1}),T}setupElevationDraw(l,f,y){const b=this.painter.context,T=b.gl,M=(C=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(C),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var C;M.u_dem_size=this.sourceCache.getSource().tileSize,M.u_exaggeration=this.exaggeration();let k=null,B=null,R=1;if(y&&y.morphing&&this._useVertexMorphing){const H=y.morphing.srcDemTile,ee=y.morphing.dstDemTile;R=y.morphing.phase,H&&ee&&(this._prepareDemTileUniforms(l,H,M,"_prev")&&(B=H),this._prepareDemTileUniforms(l,ee,M)&&(k=ee))}if(B&&k?(b.activeTexture.set(T.TEXTURE2),k.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),b.activeTexture.set(T.TEXTURE4),B.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),M.u_dem_lerp=R):(k=this.terrainTileForTile[l.tileID.key],b.activeTexture.set(T.TEXTURE2),(this._prepareDemTileUniforms(l,k,M)?k.demTexture:this.emptyDEMTexture).bind(T.NEAREST,T.CLAMP_TO_EDGE)),b.activeTexture.set(T.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),this._depthFBO&&(M.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),M.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&k){const H=(1<<k.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=H}if(y&&y.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),f.setTerrainUniformValues(b,M),this.painter.transform.projection.name==="globe"){const H=this.globeUniformValues(this.painter.transform,l.tileID.canonical,y&&y.useDenormalizedUpVectorScale);f.setGlobeUniformValues(b,H)}}globeUniformValues(l,f,y){const b=l.projection;return{u_tile_tl_up:b.upVector(f,0,0),u_tile_tr_up:b.upVector(f,o.EXTENT,0),u_tile_br_up:b.upVector(f,o.EXTENT,o.EXTENT),u_tile_bl_up:b.upVector(f,0,o.EXTENT),u_tile_up_scale:y?o.globeMetersToEcef(1):b.upVectorScale(f,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){const f=this.painter,y=this.painter.context;l.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,T,M,C,k){if(b.transform.projection.name==="globe")(function(B,R,H,ee,ie){const ae=B.context,oe=ae.gl;let se,X;const ne=B.options.showTerrainWireframe?2:0,fe=B.transform,de=o.globeUseCustomAntiAliasing(B,ae,fe),Ee=(dt,Ge)=>{if(X===dt)return;const rt=[Ms[dt],"PROJECTION_GLOBE_VIEW"];de&&rt.push("CUSTOM_ANTIALIASING"),Ge&&rt.push(Ms[ne]),se=B.useProgram("globeRaster",null,rt),X=dt},Pe=B.colorModeForRenderPass(),Ae=new o.DepthMode(oe.LEQUAL,o.DepthMode.ReadWrite,B.depthRangeFor3D);wa.update(ie);const je=o.calculateGlobeMercatorMatrix(fe),ze=[o.mercatorXfromLng(fe.center.lng),o.mercatorYfromLat(fe.center.lat)],We=ne?[!1,!0]:[!1],pt=B.globeSharedBuffers,Ne=[fe.width*o.exported.devicePixelRatio,fe.height*o.exported.devicePixelRatio],nt=Float32Array.from(fe.globeMatrix),He={useDenormalizedUpVectorScale:!0};if(We.forEach(dt=>{const Ge=B.transform,rt=th(Ge.zoom)*R.exaggeration();X=-1;const gt=dt?oe.LINES:oe.TRIANGLES;for(const lt of ee){const _t=H.getTile(lt),jt=o.StencilMode.disabled,Ht=R.prevTerrainTileForTile[lt.key],Dt=R.terrainTileForTile[lt.key];xl(Ht,Dt)&&wa.newMorphing(lt.key,Ht,Dt,ie,250),ae.activeTexture.set(oe.TEXTURE0),_t.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const Vt=wa.getMorphValuesForProxy(lt.key),dr=Vt?1:0;Vt&&o.extend$1(He,{morphing:{srcDemTile:Vt.from,dstDemTile:Vt.to,phase:o.easeCubicInOut(Vt.phase)}});const cr=o.tileCornersToBounds(lt.canonical),Bt=o.getLatitudinalLod(cr.getCenter().lat),Cr=o.getGridMatrix(lt.canonical,cr,Bt,Ge.worldSize/Ge._pixelsPerMercatorPixel),zr=o.globeNormalizeECEF(o.globeTileBounds(lt.canonical)),Rr=eh(Ge.projMatrix,nt,je,zr,o.globeToMercatorTransition(Ge.zoom),ze,Ge.frustumCorners.TL,Ge.frustumCorners.TR,Ge.frustumCorners.BR,Ge.frustumCorners.BL,Ge.globeCenterInViewSpace,Ge.globeRadius,Ne,rt,Cr);if(Ee(dr,dt),R.setupElevationDraw(_t,se,He),B.prepareDrawProgram(ae,se,lt.toUnwrapped()),pt){const[Br,mi,Kn]=dt?pt.getWirefameBuffers(B.context,Bt):pt.getGridBuffers(Bt,rt!==0);se.draw(ae,gt,Ae,jt,Pe,o.CullFaceMode.backCCW,Rr,"globe_raster",Br,mi,Kn)}}}),pt){const dt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];de&&dt.push("CUSTOM_ANTIALIASING"),se=B.useProgram("globeRaster",null,dt);for(const Ge of ee){const{x:rt,y:gt,z:lt}=Ge.canonical,_t=gt===0,jt=gt===(1<<lt)-1,[Ht,Dt,Vt,dr]=pt.getPoleBuffers(lt);if(dr&&(_t||jt)){const cr=H.getTile(Ge);ae.activeTexture.set(oe.TEXTURE0),cr.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);let Bt=o.globePoleMatrixForTile(lt,rt,fe);const Cr=o.globeNormalizeECEF(o.globeTileBounds(Ge.canonical)),zr=(Rr,Br)=>Rr.draw(ae,oe.TRIANGLES,Ae,o.StencilMode.disabled,Pe,o.CullFaceMode.disabled,eh(fe.projMatrix,Bt,Bt,Cr,0,ze,fe.frustumCorners.TL,fe.frustumCorners.TR,fe.frustumCorners.BR,fe.frustumCorners.BL,fe.globeCenterInViewSpace,fe.globeRadius,Ne,0),"globe_pole_raster",Br,Vt,dr);R.setupElevationDraw(cr,se,He),B.prepareDrawProgram(ae,se,Ge.toUnwrapped()),_t&&zr(se,Ht),jt&&(Bt=o.scale(o.create(),Bt,[1,-1,1]),zr(se,Dt))}}}})(b,T,M,C,k);else{const B=b.context,R=B.gl;let H,ee;const ie=b.options.showTerrainWireframe?2:0,ae=(fe,de)=>{if(ee===fe)return;const Ee=[Ms[fe]];de&&Ee.push(Ms[ie]),H=b.useProgram("terrainRaster",null,Ee),ee=fe},oe=b.colorModeForRenderPass(),se=new o.DepthMode(R.LEQUAL,o.DepthMode.ReadWrite,b.depthRangeFor3D);wa.update(k);const X=b.transform,ne=th(X.zoom)*T.exaggeration();(ie?[!1,!0]:[!1]).forEach(fe=>{ee=-1;const de=fe?R.LINES:R.TRIANGLES,[Ee,Pe]=fe?T.getWirefameBuffer():[T.gridIndexBuffer,T.gridSegments];for(const Ae of C){const je=M.getTile(Ae),ze=o.StencilMode.disabled,We=T.prevTerrainTileForTile[Ae.key],pt=T.terrainTileForTile[Ae.key];xl(We,pt)&&wa.newMorphing(Ae.key,We,pt,k,250),B.activeTexture.set(R.TEXTURE0),je.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);const Ne=wa.getMorphValuesForProxy(Ae.key),nt=Ne?1:0;let He;Ne&&(He={morphing:{srcDemTile:Ne.from,dstDemTile:Ne.to,phase:o.easeCubicInOut(Ne.phase)}});const dt=vl(Ae.projMatrix,Oy(Ae.canonical,X.renderWorldCopies)?ne/10:ne);ae(nt,fe),T.setupElevationDraw(je,H,He),b.prepareDrawProgram(B,H,Ae.toUnwrapped()),H.draw(B,de,se,ze,oe,o.CullFaceMode.backCCW,dt,"terrain_raster",T.gridBuffer,Ee,Pe)}})}}(f,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(this._drapedRenderBatches.length===0)return l+1;this.renderingToTexture=!0;const f=this.painter,y=this.painter.context,b=this.proxySourceCache,T=this.proxiedCoords[b.id],M=this._drapedRenderBatches.shift(),C=[],k=f.style.order;let B=0;for(const R of T){const H=b.getTileByID(R.proxyTileKey),ee=b.proxyCachedFBO[R.key]?b.proxyCachedFBO[R.key][l]:void 0,ie=ee!==void 0?b.renderCache[ee]:this.pool[B++],ae=ee!==void 0;if(H.texture=ie.tex,ae&&!ie.dirty){C.push(H.tileID);continue}let oe;y.bindFramebuffer.set(ie.fb.framebuffer),this.renderedToTile=!1,ie.dirty&&(y.clear({color:o.Color.transparent,stencil:0}),ie.dirty=!1);for(let se=M.start;se<=M.end;++se){const X=f.style._layers[k[se]];if(X.isHidden(f.transform.zoom))continue;const ne=f.style._getLayerSourceCache(X),fe=ne?this.proxyToSource[R.key][ne.id]:[R];if(!fe)continue;const de=fe;y.viewport.set([0,0,ie.fb.width,ie.fb.height]),oe!==(ne?ne.id:null)&&(this._setupStencil(ie,fe,X,ne),oe=ne?ne.id:null),f.renderLayer(f,ne,X,de)}this.renderedToTile?(ie.dirty=!0,C.push(H.tileID)):ae||--B,B===5&&(B=0,this.renderToBackBuffer(C))}return this.renderToBackBuffer(C),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),M.end+1}postRender(){}renderCacheEfficiency(l){const f=l.order.length;if(f===0)return{efficiency:100};let y,b=0,T=0,M=!1;for(let C=0;C<f;++C){const k=l._layers[l.order[C]];this._style.isLayerDraped(k)?(M&&++b,++T):M||(M=!0,y=k.id)}return T===0?{efficiency:100}:{efficiency:100*(1-b/T),firstUndrapedLayer:y}}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{l=Math.min(l,f.dem.tree.minimums[0])}),l===0?l:(l-30)*this._exaggeration}raycast(l,f,y){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const M=T.tileID,C=1<<M.overscaledZ,{x:k,y:B}=M.canonical,R=k/C,H=(k+1)/C,ee=B/C,ie=(B+1)/C;return{minx:R,miny:ee,maxx:H,maxy:ie,t:T.dem.tree.raycastRoot(R,ee,H,ie,l,f,y),tile:T}});b.sort((T,M)=>(T.t!==null?T.t:Number.MAX_VALUE)-(M.t!==null?M.t:Number.MAX_VALUE));for(const T of b){if(T.t==null)return null;const M=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,l,f,y);if(M!=null)return M}return null}_createFBO(){const l=this.painter.context,f=l.gl,y=this.drapeBufferSize;l.activeTexture.set(f.TEXTURE0);const b=new o.Texture(l,{width:y[0],height:y[1],data:null},f.RGBA);b.bind(f.LINEAR,f.CLAMP_TO_EDGE);const T=l.createFramebuffer(y[0],y[1],!1);return T.colorAttachment.set(b.texture),T.depthAttachment=new Ie(l,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&!l.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:T,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{const f=this._style._layers[l],y=f.isHidden(this.painter.transform.zoom);return f.type==="custom"?!y&&f.shouldRedrape():!y&&f.hasTransition()})}_clearLineLayersFromRenderCache(){let l=!1;for(const y of this._style._getSources())if(y instanceof wt){l=!0;break}if(!l)return;const f={};for(let y=0;y<this._style.order.length;++y){const b=this._style._layers[this._style.order[y]],T=this._style._getLayerSourceCache(b);if(T&&!f[T.id]&&!b.isHidden(this.painter.transform.zoom)&&b.type==="line"&&b.widthExpression()instanceof o.ZoomDependentExpression){f[T.id]=!0;for(const M of this.proxyCoords){const C=this.proxyToSource[M.key][T.id];if(C)for(const k of C)this._clearRenderCacheForTile(T.id,k)}}}}_clearRasterLayersFromRenderCache(){let l=!1;for(const y in this._style._sourceCaches)if(this._style._sourceCaches[y]._source instanceof ct){l=!0;break}if(!l)return;const f={};for(let y=0;y<this._style.order.length;++y){const b=this._style._layers[this._style.order[y]],T=this._style._getLayerSourceCache(b);if(!T||f[T.id]||b.isHidden(this.painter.transform.zoom)||b.type!=="raster")continue;const M=b.paint.get("raster-fade-duration");for(const C of this.proxyCoords){const k=this.proxyToSource[C.key][T.id];if(k)for(const B of k){const R=ep(T.getTile(B),T.findLoadedParent(B,0),T,this.painter.transform,M);(R.opacity!==1||R.mix!==0)&&this._clearRenderCacheForTile(T.id,B)}}}}_setupDrapedRenderBatches(){const l=this._style.order,f=l.length;if(f===0)return;const y=[];let b,T=0,M=this._style._layers[l[T]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++T<f;)M=this._style._layers[l[T]];for(;T<f;++T){const C=this._style._layers[l[T]];C.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(C)?b===void 0&&(b=T):b!==void 0&&(y.push({start:b,end:T-1}),b=void 0))}b!==void 0&&y.push({start:b,end:T-1}),this._drapedRenderBatches=y}_setupRenderCache(l){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const M=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let C=0;C<M.length;++C){const k=Object.values(M[C]);f.renderCachePool.push(...k)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,b=this._tilesDirty;for(let M=y.length-1;M>=0;M--){const C=y[M];if(f.getTileByID(C.key),f.proxyCachedFBO[C.key]!==void 0){const k=l[C.key],B=this.proxyToSource[C.key];let R=0;for(const H in B){const ee=B[H],ie=k[H];if(!ie||ie.length!==ee.length||ee.some((ae,oe)=>ae!==ie[oe]||b[H]&&b[H].hasOwnProperty(ae.key))){R=-1;break}++R}for(const H in f.proxyCachedFBO[C.key])f.renderCache[f.proxyCachedFBO[C.key][H]].dirty=R<0||R!==Object.values(k).length}}const T=[...this._drapedRenderBatches];T.sort((M,C)=>C.end-C.start-(M.end-M.start));for(const M of T)for(const C of y){if(f.proxyCachedFBO[C.key])continue;let k=f.renderCachePool.pop();k===void 0&&f.renderCache.length<50&&(k=f.renderCache.length,f.renderCache.push(this._createFBO())),k!==void 0&&(f.proxyCachedFBO[C.key]={},f.proxyCachedFBO[C.key][M.start]=k,f.renderCache[k].dirty=!0)}this._tilesDirty={}}_setupStencil(l,f,y,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,M=T.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let C;if(y.isTileClipped())C=f.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);C=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+C>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=C,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(l,f){const y=this.painter,b=this.painter.context,T=b.gl;y._tileClippingMaskIDs={},b.setColorMode(o.ColorMode.disabled),b.setDepthMode(o.DepthMode.disabled);const M=y.useProgram("clippingMask");for(const C of l){const k=y._tileClippingMaskIDs[C.key]=--f;M.draw(b,T.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:T.ALWAYS,mask:0},k,255,T.KEEP,T.KEEP,T.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,zu(C.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(l){const f=this.painter.transform;if(l.x<0||l.x>f.width||l.y<0||l.y>f.height)return null;const y=[l.x,l.y,1,1];o.transformMat4$1(y,y,f.pixelMatrixInverse),o.scale$1(y,y,1/y[3]),y[0]/=f.worldSize,y[1]/=f.worldSize;const b=f._camera.position,T=o.mercatorZfromAltitude(1,f.center.lat),M=[b[0],b[1],b[2]/T,0],C=o.subtract([],y.slice(0,3),M);o.normalize(C,C);const k=this.raycast(M,C,this._exaggeration);return k!==null&&k?(o.scaleAndAdd(M,M,C,k),M[3]=M[2],M[2]*=T,M):null}drawDepth(){const l=this.painter,f=l.context,y=this.proxySourceCache,b=Math.ceil(l.width),T=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===b&&this._depthFBO.height===T||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const M=f.gl,C=f.createFramebuffer(b,T,!0);f.activeTexture.set(M.TEXTURE0);const k=new o.Texture(f,{width:b,height:T,data:null},M.RGBA);k.bind(M.NEAREST,M.CLAMP_TO_EDGE),C.colorAttachment.set(k.texture);const B=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,b,T);C.depthAttachment.set(B),this._depthFBO=C,this._depthTexture=k}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,b,T]),function(M,C,k,B){if(M.transform.projection.name==="globe")return;const R=M.context,H=R.gl;R.clear({depth:1});const ee=M.useProgram("terrainDepth"),ie=new o.DepthMode(H.LESS,o.DepthMode.ReadWrite,M.depthRangeFor3D);for(const ae of B){const oe=k.getTile(ae),se=vl(ae.projMatrix,0);C.setupElevationDraw(oe,ee),ee.draw(R,H.TRIANGLES,ie,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,se,"terrain_depth",C.gridBuffer,C.gridIndexBuffer,C.gridNoSkirtSegments)}}(l,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,f,y){if(l.getSource()instanceof er)return this._setupProxiedCoordsForImageSource(l,f,y);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const b=this.proxiedCoords[l.id]=[],T=this.proxyCoords;for(let C=0;C<T.length;C++){const k=T[C],B=this._findTileCoveringTileID(k,l);if(B){const R=this._createProxiedId(k,B,y[k.key]&&y[k.key][l.id]);b.push(R),this.proxyToSource[k.key][l.id]=[R]}}let M=!1;for(let C=0;C<f.length;C++){const k=l.getTile(f[C]);if(!k||!k.hasData())continue;const B=this._findTileCoveringTileID(k.tileID,this.proxySourceCache);if(B&&B.tileID.canonical.z!==k.tileID.canonical.z){const R=this.proxyToSource[B.tileID.key][l.id],H=this._createProxiedId(B.tileID,k,y[B.tileID.key]&&y[B.tileID.key][l.id]);R?R.splice(R.length-1,0,H):this.proxyToSource[B.tileID.key][l.id]=[H],b.push(H),M=!0}}this._sourceTilesOverlap[l.id]=M}_setupProxiedCoordsForImageSource(l,f,y){if(!l.getSource().loaded())return;const b=this.proxiedCoords[l.id]=[],T=this.proxyCoords,M=l.getSource(),C=new o.Point(M.tileID.x,M.tileID.y)._div(1<<M.tileID.z),k=M.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((R,H)=>(R.min.x=Math.min(R.min.x,H.x-C.x),R.min.y=Math.min(R.min.y,H.y-C.y),R.max.x=Math.max(R.max.x,H.x-C.x),R.max.y=Math.max(R.max.y,H.y-C.y),R),{min:new o.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),B=(R,H)=>{const ee=R.wrap+R.canonical.x/(1<<R.canonical.z),ie=R.canonical.y/(1<<R.canonical.z),ae=o.EXTENT/(1<<R.canonical.z),oe=H.wrap+H.canonical.x/(1<<H.canonical.z),se=H.canonical.y/(1<<H.canonical.z);return ee+ae<oe+k.min.x||ee>oe+k.max.x||ie+ae<se+k.min.y||ie>se+k.max.y};for(let R=0;R<T.length;R++){const H=T[R];for(let ee=0;ee<f.length;ee++){const ie=l.getTile(f[ee]);if(!ie||!ie.hasData()||B(H,ie.tileID))continue;const ae=this._createProxiedId(H,ie,y[H.key]&&y[H.key][l.id]),oe=this.proxyToSource[H.key][l.id];oe?oe.push(ae):this.proxyToSource[H.key][l.id]=[ae],b.push(ae)}}}_createProxiedId(l,f,y){let b=this.orthoMatrix;if(y){const T=y.find(M=>M.key===f.tileID.key);if(T)return T}if(f.tileID.key!==l.key){const T=l.canonical.z-f.tileID.canonical.z;let M,C,k;b=o.create();const B=f.tileID.wrap-l.wrap<<l.overscaledZ;T>0?(M=o.EXTENT>>T,C=M*((f.tileID.canonical.x<<T)-l.canonical.x+B),k=M*((f.tileID.canonical.y<<T)-l.canonical.y)):(M=o.EXTENT<<-T,C=o.EXTENT*(f.tileID.canonical.x-(l.canonical.x+B<<-T)),k=o.EXTENT*(f.tileID.canonical.y-(l.canonical.y<<-T))),o.ortho(b,0,M,0,M,0,1),o.translate(b,b,[C,k,0])}return new nh(f.tileID,l.key,b)}_findTileCoveringTileID(l,f){let y=f.getTile(l);if(y&&y.hasData())return y;const b=this._findCoveringTileCache[f.id],T=b[l.key];if(y=T?f.getTileByID(T):null,y&&y.hasData()||T===null)return y;let M=y?y.tileID:l,C=M.overscaledZ;const k=f.getSource().minzoom,B=[];if(!T){const H=f.getSource().maxzoom;if(l.canonical.z>=H){const ee=l.canonical.z-H;f.getSource().reparseOverscaled?(C=Math.max(l.canonical.z+2,f.transform.tileZoom),M=new o.OverscaledTileID(C,l.wrap,H,l.canonical.x>>ee,l.canonical.y>>ee)):ee!==0&&(C=H,M=new o.OverscaledTileID(C,l.wrap,H,l.canonical.x>>ee,l.canonical.y>>ee))}M.key!==l.key&&(B.push(M.key),y=f.getTile(M))}const R=H=>{B.forEach(ee=>{b[ee]=H}),B.length=0};for(C-=1;C>=k&&(!y||!y.hasData());C--){y&&R(y.tileID.key);const H=M.calculateScaledKey(C);if(y=f.getTileByID(H),y&&y.hasData())break;const ee=b[H];if(ee===null)break;ee===void 0?B.push(H):y=f.getTileByID(ee)}return R(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,f){let y=this._tilesDirty[l];y||(y=this._tilesDirty[l]={}),y[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const l=function(f){let y=0;const b=new o.StructArrayLayout2ui4,T=131;for(let M=1;M<129;M++){for(let C=1;C<129;C++)y=M*T+C,b.emplaceBack(y,y+1),b.emplaceBack(y,y+T),b.emplaceBack(y+1,y+T),M===128&&b.emplaceBack(y+T,y+T+1);b.emplaceBack(y+1,y+1+T)}return b}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(l),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,l.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class gr{static cacheKey(l,f,y,b){let T=`${f}${b?b.cacheKey:""}`;for(const M of y)l.usedDefines.includes(M)&&(T+=`/${M}`);return T}constructor(l,f,y,b,T,M){const C=l.gl;this.program=C.createProgram();const k=function(X){const ne=[];for(let fe=0;fe<X.length;fe++){if(X[fe]===null)continue;const de=X[fe].split(" ");ne.push(de.pop())}return ne}(y.staticAttributes),B=b?b.getBinderAttributes():[],R=k.concat(B);let H=b?b.defines():[];H=H.concat(M.map(X=>`#define ${X}`));const ee=l.isWebGL2?`#version 300 es
`:"",ie=ee+H.concat(l.extStandardDerivatives&&ee.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Xd):Xd,Xd,Qc,Py.fragmentSource,yl.fragmentSource,y.fragmentSource).join(`
`),ae=ee+H.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Qc,Py.vertexSource,yl.vertexSource,Jc.vertexSource,y.vertexSource).join(`
`),oe=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(oe,ie),C.compileShader(oe),C.attachShader(this.program,oe);const se=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(se,ae),C.compileShader(se),C.attachShader(this.program,se),this.attributes={},this.numAttributes=R.length;for(let X=0;X<this.numAttributes;X++)R[X]&&(C.bindAttribLocation(this.program,X,R[X]),this.attributes[R[X]]=X);C.linkProgram(this.program),C.deleteShader(se),C.deleteShader(oe),this.fixedUniforms=T(l),this.binderUniforms=b?b.getUniforms(l):[],M.includes("TERRAIN")&&(this.terrainUniforms=(X=>({u_dem:new o.Uniform1i(X),u_dem_prev:new o.Uniform1i(X),u_dem_unpack:new o.Uniform4f(X),u_dem_tl:new o.Uniform2f(X),u_dem_scale:new o.Uniform1f(X),u_dem_tl_prev:new o.Uniform2f(X),u_dem_scale_prev:new o.Uniform1f(X),u_dem_size:new o.Uniform1f(X),u_dem_lerp:new o.Uniform1f(X),u_exaggeration:new o.Uniform1f(X),u_depth:new o.Uniform1i(X),u_depth_size_inv:new o.Uniform2f(X),u_meter_to_dem:new o.Uniform1f(X),u_label_plane_matrix_inv:new o.UniformMatrix4f(X)}))(l)),M.includes("GLOBE")&&(this.globeUniforms=(X=>({u_tile_tl_up:new o.Uniform3f(X),u_tile_tr_up:new o.Uniform3f(X),u_tile_br_up:new o.Uniform3f(X),u_tile_bl_up:new o.Uniform3f(X),u_tile_up_scale:new o.Uniform1f(X)}))(l)),M.includes("FOG")&&(this.fogUniforms=(X=>({u_fog_matrix:new o.UniformMatrix4f(X),u_fog_range:new o.Uniform2f(X),u_fog_color:new o.Uniform4f(X),u_fog_horizon_blend:new o.Uniform1f(X),u_fog_temporal_offset:new o.Uniform1f(X),u_frustum_tl:new o.Uniform3f(X),u_frustum_tr:new o.Uniform3f(X),u_frustum_br:new o.Uniform3f(X),u_frustum_bl:new o.Uniform3f(X),u_globe_pos:new o.Uniform3f(X),u_globe_radius:new o.Uniform1f(X),u_globe_transition:new o.Uniform1f(X),u_is_globe:new o.Uniform1i(X),u_viewport:new o.Uniform2f(X)}))(l))}}setTerrainUniformValues(l,f){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const b in f)y[b]&&y[b].set(this.program,b,f[b])}}setGlobeUniformValues(l,f){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const b in f)y[b]&&y[b].set(this.program,b,f[b])}}setFogUniformValues(l,f){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const b in f)y[b].set(this.program,b,f[b])}}draw(l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae,oe){const se=l.gl;if(this.failedToCreate)return;l.program.set(this.program),l.setDepthMode(y),l.setStencilMode(b),l.setColorMode(T),l.setCullFace(M);for(const ne of Object.keys(this.fixedUniforms))this.fixedUniforms[ne].set(this.program,ne,C[ne]);ae&&ae.setUniforms(this.program,l,this.binderUniforms,ee,{zoom:ie});const X={[se.LINES]:2,[se.TRIANGLES]:3,[se.LINE_STRIP]:1}[f];for(const ne of H.get()){const fe=ne.vaos||(ne.vaos={});(fe[k]||(fe[k]=new C1)).bind(l,this,B,ae?ae.getPaintVertexBuffers():[],R,ne.vertexOffset,oe||[]),se.drawElements(f,ne.primitiveLength*X,se.UNSIGNED_SHORT,ne.primitiveOffset*X*2)}}}function Ru(m,l){const f=Math.pow(2,l.tileID.overscaledZ),y=l.tileSize*Math.pow(2,m.transform.tileZoom)/f,b=y*(l.tileID.canonical.x+l.tileID.wrap*f),T=y*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_tile_units_to_pixels:1/st(l,1,m.transform.tileZoom),u_pixel_coord_upper:[b>>16,T>>16],u_pixel_coord_lower:[65535&b,65535&T]}}const Iy=o.create(),np=(m,l,f,y,b,T,M,C,k,B,R)=>{const H=l.style.light,ee=H.properties.get("position"),ie=[ee.x,ee.y,ee.z],ae=o.create$1();H.properties.get("anchor")==="viewport"&&(o.fromRotation(ae,-l.transform.angle),o.transformMat3(ie,ie,ae));const oe=H.properties.get("color"),se=l.transform,X={u_matrix:m,u_lightpos:ie,u_lightintensity:H.properties.get("intensity"),u_lightcolor:[oe.r,oe.g,oe.b],u_vertical_gradient:+f,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Iy,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:b,u_edge_radius:T};return se.projection.name==="globe"&&(X.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],X.u_zoom_transition=k,X.u_inv_rot_matrix=R,X.u_merc_center=B,X.u_up_dir=se.projection.upVector(new o.CanonicalTileID(0,0,0),B[0]*o.EXTENT,B[1]*o.EXTENT),X.u_height_lift=C),X},ky=(m,l,f,y,b,T,M,C,k,B,R,H)=>{const ee=np(m,l,f,y,b,T,M,k,B,R,H),ie={u_height_factor:-Math.pow(2,M.overscaledZ)/C.tileSize/8};return o.extend(ee,Ru(l,C),ie)},Cs=m=>({u_matrix:m}),ip=(m,l,f)=>o.extend(Cs(m),Ru(l,f)),O1=(m,l)=>({u_matrix:m,u_world:l}),I1=(m,l,f,y)=>o.extend(ip(m,l,f),{u_world:y}),k1=o.create(),op=(m,l,f,y,b,T)=>{const M=m.transform,C=M.projection.name==="globe";let k;if(T.paint.get("circle-pitch-alignment")==="map")if(C){const R=o.globePixelsToTileUnits(M.zoom,l.canonical)*M._pixelsPerMercatorPixel;k=Float32Array.from([R,0,0,R])}else k=M.calculatePixelsToTileUnitsMatrix(f);else k=new Float32Array([M.pixelsToGLUnits[0],0,0,M.pixelsToGLUnits[1]]);const B={u_camera_to_center_distance:M.cameraToCenterDistance,u_matrix:m.translatePosMatrix(l.projMatrix,f,T.paint.get("circle-translate"),T.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:k1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(C){B.u_inv_rot_matrix=y,B.u_merc_center=b,B.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],B.u_zoom_transition=o.globeToMercatorTransition(M.zoom);const R=b[0]*o.EXTENT,H=b[1]*o.EXTENT;B.u_up_dir=M.projection.upVector(new o.CanonicalTileID(0,0,0),R,H)}return B},ap=m=>{const l=[];return m.paint.get("circle-pitch-alignment")==="map"&&l.push("PITCH_WITH_MAP"),m.paint.get("circle-pitch-scale")==="map"&&l.push("SCALE_WITH_MAP"),l},sp=(m,l,f,y)=>{const b=o.EXTENT/f.tileSize;return{u_matrix:m,u_camera_to_center_distance:l.getCameraToCenterDistance(y),u_extrude_scale:[l.pixelsToGLUnits[0]/b,l.pixelsToGLUnits[1]/b]}},ih=(m,l,f=1)=>({u_matrix:m,u_color:l,u_overlay:0,u_overlay_scale:f}),Dy=o.create(),Ly=(m,l,f,y,b,T,M)=>{const C=m.transform,k=C.projection.name==="globe",B=k?o.globePixelsToTileUnits(C.zoom,l.canonical)*C._pixelsPerMercatorPixel:st(f,1,T),R={u_matrix:l.projMatrix,u_extrude_scale:B,u_intensity:M,u_inv_rot_matrix:Dy,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){R.u_inv_rot_matrix=y,R.u_merc_center=b,R.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],R.u_zoom_transition=o.globeToMercatorTransition(C.zoom);const H=b[0]*o.EXTENT,ee=b[1]*o.EXTENT;R.u_up_dir=C.projection.upVector(new o.CanonicalTileID(0,0,0),H,ee)}return R},D1=(m,l,f,y,b,T,M)=>{const C=m.transform,k=C.calculatePixelsToTileUnitsMatrix(l);return{u_matrix:lp(m,l,f,y),u_pixels_to_tile_units:k,u_device_pixel_ratio:T,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:b,u_texsize:ju(f)?l.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:bl(l,m.transform),u_alpha_discard_threshold:0,u_trim_offset:M}},Bu=(m,l,f,y,b)=>{const T=m.transform;return{u_matrix:lp(m,l,f,y),u_texsize:l.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(l),u_device_pixel_ratio:b,u_image:0,u_tile_units_to_pixels:bl(l,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function bl(m,l){return 1/st(m,1,l.tileZoom)}function lp(m,l,f,y){return m.translatePosMatrix(y||l.tileID.projMatrix,l,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}function ju(m){const l=m.paint.get("line-dasharray").value;return l.value||l.kind!=="constant"}const up=(m,l,f,y,b,T)=>{return{u_matrix:m,u_tl_parent:l,u_scale_parent:f,u_fade_t:y.mix,u_opacity:y.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(C=b.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(M=b.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:Uo(b.paint.get("raster-hue-rotate")),u_perspective_transform:T};var M,C};function Uo(m){m*=Math.PI/180;const l=Math.sin(m),f=Math.cos(m);return[(2*f+1)/3,(-Math.sqrt(3)*l-f+1)/3,(Math.sqrt(3)*l-f+1)/3]}const oh=o.create(),cp=(m,l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae,oe)=>{const se=b.transform,X={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:se.cameraToCenterDistance,u_rotate_symbol:+f,u_aspect_ratio:se.width/se.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:M,u_coord_matrix:C,u_is_text:+k,u_pitch_with_map:+y,u_texsize:B,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:oh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:oh,u_up_vector:[0,-1,0]};return oe.name==="globe"&&(X.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],X.u_zoom_transition=H,X.u_inv_rot_matrix=ie,X.u_merc_center=ee,X.u_camera_forward=se._camera.forward(),X.u_ecef_origin=o.globeECEFOrigin(se.globeMatrix,R.toUnwrapped()),X.u_tile_matrix=Float32Array.from(se.globeMatrix),X.u_up_vector=ae),X},ah=(m,l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae,oe,se)=>o.extend(cp(m,l,f,y,b,T,M,C,k,B,H,ee,ie,ae,oe,se),{u_gamma_scale:y?b.transform.cameraToCenterDistance*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:1}),zy=(m,l,f,y,b,T,M,C,k,B,R,H,ee,ie,ae,oe)=>o.extend(ah(m,l,f,y,b,T,M,C,!0,k,!0,R,H,ee,ie,ae,oe),{u_texsize_icon:B,u_texture_icon:1}),hp=(m,l,f)=>({u_matrix:m,u_opacity:l,u_color:f}),L1=(m,l,f,y,b)=>o.extend(function(T,M,C){const k=M.imageManager.getPattern(T.toString()),{width:B,height:R}=M.imageManager.getPixelSize(),H=Math.pow(2,C.tileID.overscaledZ),ee=C.tileSize*Math.pow(2,M.transform.tileZoom)/H,ie=ee*(C.tileID.canonical.x+C.tileID.wrap*H),ae=ee*C.tileID.canonical.y;return{u_image:0,u_pattern_tl:k.tl,u_pattern_br:k.br,u_texsize:[B,R],u_pattern_size:k.displaySize,u_tile_units_to_pixels:1/st(C,1,M.transform.tileZoom),u_pixel_coord_upper:[ie>>16,ae>>16],u_pixel_coord_lower:[65535&ie,65535&ae]}}(y,f,b),{u_matrix:m,u_opacity:l}),fp={fillExtrusion:m=>({u_matrix:new o.UniformMatrix4f(m),u_lightpos:new o.Uniform3f(m),u_lightintensity:new o.Uniform1f(m),u_lightcolor:new o.Uniform3f(m),u_vertical_gradient:new o.Uniform1f(m),u_opacity:new o.Uniform1f(m),u_edge_radius:new o.Uniform1f(m),u_ao:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_up_dir:new o.Uniform3f(m),u_height_lift:new o.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_lightpos:new o.Uniform3f(m),u_lightintensity:new o.Uniform1f(m),u_lightcolor:new o.Uniform3f(m),u_vertical_gradient:new o.Uniform1f(m),u_height_factor:new o.Uniform1f(m),u_edge_radius:new o.Uniform1f(m),u_ao:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_up_dir:new o.Uniform3f(m),u_height_lift:new o.Uniform1f(m),u_image:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_pixel_coord_upper:new o.Uniform2f(m),u_pixel_coord_lower:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m),u_opacity:new o.Uniform1f(m)}),fill:m=>({u_matrix:new o.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_image:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_pixel_coord_upper:new o.Uniform2f(m),u_pixel_coord_lower:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m)}),fillOutline:m=>({u_matrix:new o.UniformMatrix4f(m),u_world:new o.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_world:new o.Uniform2f(m),u_image:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_pixel_coord_upper:new o.Uniform2f(m),u_pixel_coord_lower:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new o.Uniform1f(m),u_extrude_scale:new o.UniformMatrix2f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_up_dir:new o.Uniform3f(m)}),collisionBox:m=>({u_matrix:new o.UniformMatrix4f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_extrude_scale:new o.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new o.UniformMatrix4f(m),u_inv_matrix:new o.UniformMatrix4f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_viewport_size:new o.Uniform2f(m)}),debug:m=>({u_color:new o.UniformColor(m),u_matrix:new o.UniformMatrix4f(m),u_overlay:new o.Uniform1i(m),u_overlay_scale:new o.Uniform1f(m)}),clippingMask:m=>({u_matrix:new o.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new o.Uniform1f(m),u_intensity:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_up_dir:new o.Uniform3f(m)}),heatmapTexture:m=>({u_image:new o.Uniform1i(m),u_color_ramp:new o.Uniform1i(m),u_opacity:new o.Uniform1f(m)}),hillshade:m=>({u_matrix:new o.UniformMatrix4f(m),u_image:new o.Uniform1i(m),u_latrange:new o.Uniform2f(m),u_light:new o.Uniform2f(m),u_shadow:new o.UniformColor(m),u_highlight:new o.UniformColor(m),u_accent:new o.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new o.UniformMatrix4f(m),u_image:new o.Uniform1i(m),u_dimension:new o.Uniform2f(m),u_zoom:new o.Uniform1f(m),u_unpack:new o.Uniform4f(m)}),line:m=>({u_matrix:new o.UniformMatrix4f(m),u_pixels_to_tile_units:new o.UniformMatrix2f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_units_to_pixels:new o.Uniform2f(m),u_dash_image:new o.Uniform1i(m),u_gradient_image:new o.Uniform1i(m),u_image_height:new o.Uniform1f(m),u_texsize:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m),u_alpha_discard_threshold:new o.Uniform1f(m),u_trim_offset:new o.Uniform2f(m)}),linePattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_texsize:new o.Uniform2f(m),u_pixels_to_tile_units:new o.UniformMatrix2f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_image:new o.Uniform1i(m),u_units_to_pixels:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m),u_alpha_discard_threshold:new o.Uniform1f(m)}),raster:m=>({u_matrix:new o.UniformMatrix4f(m),u_tl_parent:new o.Uniform2f(m),u_scale_parent:new o.Uniform1f(m),u_fade_t:new o.Uniform1f(m),u_opacity:new o.Uniform1f(m),u_image0:new o.Uniform1i(m),u_image1:new o.Uniform1i(m),u_brightness_low:new o.Uniform1f(m),u_brightness_high:new o.Uniform1f(m),u_saturation_factor:new o.Uniform1f(m),u_contrast_factor:new o.Uniform1f(m),u_spin_weights:new o.Uniform3f(m),u_perspective_transform:new o.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new o.Uniform1i(m),u_is_size_feature_constant:new o.Uniform1i(m),u_size_t:new o.Uniform1f(m),u_size:new o.Uniform1f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_rotate_symbol:new o.Uniform1i(m),u_aspect_ratio:new o.Uniform1f(m),u_fade_change:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_label_plane_matrix:new o.UniformMatrix4f(m),u_coord_matrix:new o.UniformMatrix4f(m),u_is_text:new o.Uniform1i(m),u_pitch_with_map:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_camera_forward:new o.Uniform3f(m),u_tile_matrix:new o.UniformMatrix4f(m),u_up_vector:new o.Uniform3f(m),u_ecef_origin:new o.Uniform3f(m),u_texture:new o.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new o.Uniform1i(m),u_is_size_feature_constant:new o.Uniform1i(m),u_size_t:new o.Uniform1f(m),u_size:new o.Uniform1f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_rotate_symbol:new o.Uniform1i(m),u_aspect_ratio:new o.Uniform1f(m),u_fade_change:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_label_plane_matrix:new o.UniformMatrix4f(m),u_coord_matrix:new o.UniformMatrix4f(m),u_is_text:new o.Uniform1i(m),u_pitch_with_map:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_texture:new o.Uniform1i(m),u_gamma_scale:new o.Uniform1f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_camera_forward:new o.Uniform3f(m),u_tile_matrix:new o.UniformMatrix4f(m),u_up_vector:new o.Uniform3f(m),u_ecef_origin:new o.Uniform3f(m),u_is_halo:new o.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new o.Uniform1i(m),u_is_size_feature_constant:new o.Uniform1i(m),u_size_t:new o.Uniform1f(m),u_size:new o.Uniform1f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_rotate_symbol:new o.Uniform1i(m),u_aspect_ratio:new o.Uniform1f(m),u_fade_change:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_label_plane_matrix:new o.UniformMatrix4f(m),u_coord_matrix:new o.UniformMatrix4f(m),u_is_text:new o.Uniform1i(m),u_pitch_with_map:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_texsize_icon:new o.Uniform2f(m),u_texture:new o.Uniform1i(m),u_texture_icon:new o.Uniform1i(m),u_gamma_scale:new o.Uniform1f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_is_halo:new o.Uniform1i(m)}),background:m=>({u_matrix:new o.UniformMatrix4f(m),u_opacity:new o.Uniform1f(m),u_color:new o.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_opacity:new o.Uniform1f(m),u_image:new o.Uniform1i(m),u_pattern_tl:new o.Uniform2f(m),u_pattern_br:new o.Uniform2f(m),u_texsize:new o.Uniform2f(m),u_pattern_size:new o.Uniform2f(m),u_pixel_coord_upper:new o.Uniform2f(m),u_pixel_coord_lower:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m)}),terrainRaster:Qd,terrainDepth:Qd,skybox:m=>({u_matrix:new o.UniformMatrix4f(m),u_sun_direction:new o.Uniform3f(m),u_cubemap:new o.Uniform1i(m),u_opacity:new o.Uniform1f(m),u_temporal_offset:new o.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new o.UniformMatrix4f(m),u_color_ramp:new o.Uniform1i(m),u_center_direction:new o.Uniform3f(m),u_radius:new o.Uniform1f(m),u_opacity:new o.Uniform1f(m),u_temporal_offset:new o.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new o.UniformMatrix3f(m),u_sun_direction:new o.Uniform3f(m),u_sun_intensity:new o.Uniform1f(m),u_color_tint_r:new o.Uniform4f(m),u_color_tint_m:new o.Uniform4f(m),u_luminance:new o.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new o.UniformMatrix4f(m),u_globe_matrix:new o.UniformMatrix4f(m),u_normalize_matrix:new o.UniformMatrix4f(m),u_merc_matrix:new o.UniformMatrix4f(m),u_zoom_transition:new o.Uniform1f(m),u_merc_center:new o.Uniform2f(m),u_image0:new o.Uniform1i(m),u_grid_matrix:new o.UniformMatrix3f(m),u_skirt_height:new o.Uniform1f(m),u_frustum_tl:new o.Uniform3f(m),u_frustum_tr:new o.Uniform3f(m),u_frustum_br:new o.Uniform3f(m),u_frustum_bl:new o.Uniform3f(m),u_globe_pos:new o.Uniform3f(m),u_globe_radius:new o.Uniform1f(m),u_viewport:new o.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new o.Uniform3f(m),u_frustum_tr:new o.Uniform3f(m),u_frustum_br:new o.Uniform3f(m),u_frustum_bl:new o.Uniform3f(m),u_horizon:new o.Uniform1f(m),u_transition:new o.Uniform1f(m),u_fadeout_range:new o.Uniform1f(m),u_color:new o.Uniform4f(m),u_high_color:new o.Uniform4f(m),u_space_color:new o.Uniform4f(m),u_star_intensity:new o.Uniform1f(m),u_star_density:new o.Uniform1f(m),u_star_size:new o.Uniform1f(m),u_temporal_offset:new o.Uniform1f(m),u_horizon_angle:new o.Uniform1f(m),u_rotation_matrix:new o.UniformMatrix4f(m)})};let sh;function Fu(m,l,f,y,b,T,M){const C=m.context,k=C.gl,B=m.transform,R=m.useProgram("collisionBox"),H=[];let ee=0,ie=0;for(let de=0;de<y.length;de++){const Ee=y[de],Pe=l.getTile(Ee),Ae=Pe.getBucket(f);if(!Ae)continue;const je=io(Ee,Ae,B);let ze=je;b[0]===0&&b[1]===0||(ze=m.translatePosMatrix(je,Pe,b,T));const We=M?Ae.textCollisionBox:Ae.iconCollisionBox,pt=Ae.collisionCircleArray;if(pt.length>0){const Ne=o.create(),nt=ze;o.mul(Ne,Ae.placementInvProjMatrix,B.glCoordMatrix),o.mul(Ne,Ne,Ae.placementViewportMatrix),H.push({circleArray:pt,circleOffset:ie,transform:nt,invTransform:Ne,projection:Ae.getProjection()}),ee+=pt.length/4,ie=ee}We&&(m.terrain&&m.terrain.setupElevationDraw(Pe,R),R.draw(C,k.LINES,o.DepthMode.disabled,o.StencilMode.disabled,m.colorModeForRenderPass(),o.CullFaceMode.disabled,sp(ze,B,Pe,Ae.getProjection()),f.id,We.layoutVertexBuffer,We.indexBuffer,We.segments,null,B.zoom,null,[We.collisionVertexBuffer,We.collisionVertexBufferExt]))}if(!M||!H.length)return;const ae=m.useProgram("collisionCircle"),oe=new o.StructArrayLayout2f1f2i16;oe.resize(4*ee),oe._trim();let se=0;for(const de of H)for(let Ee=0;Ee<de.circleArray.length/4;Ee++){const Pe=4*Ee,Ae=de.circleArray[Pe+0],je=de.circleArray[Pe+1],ze=de.circleArray[Pe+2],We=de.circleArray[Pe+3];oe.emplace(se++,Ae,je,ze,We,0),oe.emplace(se++,Ae,je,ze,We,1),oe.emplace(se++,Ae,je,ze,We,2),oe.emplace(se++,Ae,je,ze,We,3)}(!sh||sh.length<2*ee)&&(sh=function(de){const Ee=2*de,Pe=new o.StructArrayLayout3ui6;Pe.resize(Ee),Pe._trim();for(let Ae=0;Ae<Ee;Ae++){const je=6*Ae;Pe.uint16[je+0]=4*Ae+0,Pe.uint16[je+1]=4*Ae+1,Pe.uint16[je+2]=4*Ae+2,Pe.uint16[je+3]=4*Ae+2,Pe.uint16[je+4]=4*Ae+3,Pe.uint16[je+5]=4*Ae+0}return Pe}(ee));const X=C.createIndexBuffer(sh,!0),ne=C.createVertexBuffer(oe,o.collisionCircleLayout.members,!0);for(const de of H){const Ee={u_matrix:de.transform,u_inv_matrix:de.invTransform,u_camera_to_center_distance:(fe=B).getCameraToCenterDistance(de.projection),u_viewport_size:[fe.width,fe.height]};ae.draw(C,k.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,m.colorModeForRenderPass(),o.CullFaceMode.disabled,Ee,f.id,ne,X,o.SegmentVector.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,B.zoom)}var fe;ne.destroy(),X.destroy()}const Ry=o.create();function dp({width:m,height:l,anchor:f,textOffset:y,textScale:b},T){const{horizontalAlign:M,verticalAlign:C}=o.getAnchorAlignment(f),k=-(M-.5)*m,B=-(C-.5)*l,R=o.evaluateVariableOffset(f,y);return new o.Point((k/b+R[0])*T,(B/b+R[1])*T)}function z1(m,l,f,y,b,T,M,C,k,B,R){const H=m.text.placedSymbolArray,ee=m.text.dynamicLayoutVertexArray,ie=m.icon.dynamicLayoutVertexArray,ae={},oe=m.getProjection(),se=an(C,oe,T),X=T.elevation,ne=oe.upVectorScale(C.canonical,T.center.lat,T.worldSize).metersToTile;ee.clear();for(let fe=0;fe<H.length;fe++){const de=H.get(fe),{tileAnchorX:Ee,tileAnchorY:Pe,numGlyphs:Ae}=de,je=de.hidden||!de.crossTileID||m.allowVerticalPlacement&&!de.placedOrientation?null:y[de.crossTileID];if(je){let ze=0,We=0,pt=0;if(X){const _t=X?X.getAtTileOffset(C,Ee,Pe):0,[jt,Ht,Dt]=oe.upVector(C.canonical,Ee,Pe);ze=_t*jt*ne,We=_t*Ht*ne,pt=_t*Dt*ne}let[Ne,nt,He,dt]=Hn(de.projectedAnchorX+ze,de.projectedAnchorY+We,de.projectedAnchorZ+pt,f?se:M);const Ge=wy(T.getCameraToCenterDistance(oe),dt);let rt=b.evaluateSizeForFeature(m.textSizeData,B,de)*Ge/o.ONE_EM;f&&(rt*=m.tilePixelRatio/k);const gt=dp(je,rt);f?({x:Ne,y:nt,z:He}=oe.projectTilePoint(Ee+gt.x,Pe+gt.y,C.canonical),[Ne,nt,He]=Hn(Ne+ze,nt+We,He+pt,M)):(l&&gt._rotate(-T.angle),Ne+=gt.x,nt+=gt.y,He=0);const lt=m.allowVerticalPlacement&&de.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let _t=0;_t<Ae;_t++)o.addDynamicAttributes(ee,Ne,nt,He,lt);R&&de.associatedIconIndex>=0&&(ae[de.associatedIconIndex]={x:Ne,y:nt,z:He,angle:lt})}else bo(Ae,ee)}if(R){ie.clear();const fe=m.icon.placedSymbolArray;for(let de=0;de<fe.length;de++){const Ee=fe.get(de),{numGlyphs:Pe}=Ee,Ae=ae[de];if(Ee.hidden||!Ae)bo(Pe,ie);else{const{x:je,y:ze,z:We,angle:pt}=Ae;for(let Ne=0;Ne<Pe;Ne++)o.addDynamicAttributes(ie,je,ze,We,pt)}}m.icon.dynamicLayoutVertexBuffer.updateData(ie)}m.text.dynamicLayoutVertexBuffer.updateData(ee)}function pp(m,l,f){return f.iconsInText&&l?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function By(m,l,f,y,b,T,M,C,k,B,R,H){const ee=m.context,ie=ee.gl,ae=m.transform,oe=C==="map",se=k==="map",X=oe&&f.layout.get("symbol-placement")!=="point",ne=oe&&!se&&!X,fe=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let de=!1;const Ee=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),Pe=[o.mercatorXfromLng(ae.center.lng),o.mercatorYfromLat(ae.center.lat)],Ae=f.layout.get("text-variable-anchor"),je=ae.projection.name==="globe",ze=[],We=[0,-1,0];let pt=We;!je&&!ae.mercatorFromTransition||oe||(pt=function(Ne){const nt=Ne._camera.getWorldToCamera(Ne.worldSize,1),He=o.multiply([],nt,Ne.globeMatrix);o.invert(He,He);const dt=[0,0,0],Ge=[0,1,0,0];return o.transformMat4$1(Ge,Ge,He),dt[0]=Ge[0],dt[1]=Ge[1],dt[2]=Ge[2],o.normalize(dt,dt),dt}(ae));for(const Ne of y){const nt=l.getTile(Ne),He=nt.getBucket(f);if(!He||He.projection.name==="mercator"&&je)continue;const dt=b?He.text:He.icon;if(!dt||He.fullyClipped||!dt.segments.get().length)continue;const Ge=dt.programConfigurations.get(f.id),rt=b||He.sdfIcons,gt=b?He.textSizeData:He.iconSizeData,lt=se||ae.pitch!==0,_t=o.evaluateSizeForZoom(gt,ae.zoom);let jt,Ht,Dt,Vt,dr=[0,0],cr=null;if(b)Ht=nt.glyphAtlasTexture,Dt=ie.LINEAR,jt=nt.glyphAtlasTexture.size,He.iconsInText&&(dr=nt.imageAtlasTexture.size,cr=nt.imageAtlasTexture,Vt=lt||m.options.rotating||m.options.zooming||gt.kind==="composite"||gt.kind==="camera"?ie.LINEAR:ie.NEAREST);else{const Ea=f.layout.get("icon-size").constantOr(0)!==1||He.iconsNeedLinear;Ht=nt.imageAtlasTexture,Dt=rt||m.options.rotating||m.options.zooming||Ea||lt?ie.LINEAR:ie.NEAREST,jt=nt.imageAtlasTexture.size}const Bt=He.projection.name==="globe",Cr=Bt?pt:We,zr=Bt?o.globeToMercatorTransition(ae.zoom):0,Rr=an(Ne,He.getProjection(),ae),Br=ae.calculatePixelsToTileUnitsMatrix(nt),mi=Je(Rr,nt.tileID.canonical,se,oe,ae,He.getProjection(),Br),Kn=m.terrain&&se&&X?o.invert(o.create(),mi):Ry,lo=Cn(Rr,nt.tileID.canonical,se,oe,ae,He.getProjection(),Br),Go=Ae&&He.hasTextData(),sn=f.layout.get("icon-text-fit")!=="none"&&Go&&He.hasIconData();if(X){const Ea=ae.elevation,ts=Ea?Ea.getAtTileOffsetFunc(Ne,ae.center.lat,ae.worldSize,He.getProjection()):null,Ls=ya(Rr,nt.tileID.canonical,se,oe,ae,He.getProjection(),Br);$d(He,Rr,m,b,Ls,lo,se,B,ts,Ne)}const jr=X||b&&Ae||sn,br=m.translatePosMatrix(Rr,nt,T,M),On=jr?Ry:mi,Ti=m.translatePosMatrix(lo,nt,T,M,!0),rn=He.getProjection().createInversionMatrix(ae,Ne.canonical),Ii=[];m.terrainRenderModeElevated()&&se&&Ii.push("PITCH_WITH_MAP_TERRAIN"),Bt&&Ii.push("PROJECTION_GLOBE_VIEW"),jr&&Ii.push("PROJECTED_POS_ON_VIEWPORT");const Th=rt&&f.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ds;Ds=rt?He.iconsInText?zy(gt.kind,_t,ne,se,m,br,On,Ti,jt,dr,Ne,zr,Pe,rn,Cr,He.getProjection()):ah(gt.kind,_t,ne,se,m,br,On,Ti,b,jt,!0,Ne,zr,Pe,rn,Cr,He.getProjection()):cp(gt.kind,_t,ne,se,m,br,On,Ti,b,jt,Ne,zr,Pe,rn,Cr,He.getProjection());const Ku={program:m.useProgram(pp(rt,b,He),Ge,Ii),buffers:dt,uniformValues:Ds,atlasTexture:Ht,atlasTextureIcon:cr,atlasInterpolation:Dt,atlasInterpolationIcon:Vt,isSDF:rt,hasHalo:Th,tile:nt,labelPlaneMatrixInv:Kn};if(fe&&He.canOverlap){de=!0;const Ea=dt.segments.get();for(const ts of Ea)ze.push({segments:new o.SegmentVector([ts]),sortKey:ts.sortKey,state:Ku})}else ze.push({segments:dt.segments,sortKey:0,state:Ku})}de&&ze.sort((Ne,nt)=>Ne.sortKey-nt.sortKey);for(const Ne of ze){const nt=Ne.state;if(m.terrain&&m.terrain.setupElevationDraw(nt.tile,nt.program,{useDepthForOcclusion:!je,labelPlaneMatrixInv:nt.labelPlaneMatrixInv}),ee.activeTexture.set(ie.TEXTURE0),nt.atlasTexture.bind(nt.atlasInterpolation,ie.CLAMP_TO_EDGE),nt.atlasTextureIcon&&(ee.activeTexture.set(ie.TEXTURE1),nt.atlasTextureIcon&&nt.atlasTextureIcon.bind(nt.atlasInterpolationIcon,ie.CLAMP_TO_EDGE)),nt.isSDF){const He=nt.uniformValues;nt.hasHalo&&(He.u_is_halo=1,$u(nt.buffers,Ne.segments,f,m,nt.program,Ee,R,H,He)),He.u_is_halo=0}$u(nt.buffers,Ne.segments,f,m,nt.program,Ee,R,H,nt.uniformValues)}}function $u(m,l,f,y,b,T,M,C,k){const B=y.context,R=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];b.draw(B,B.gl.TRIANGLES,T,M,C,o.CullFaceMode.disabled,k,f.id,m.layoutVertexBuffer,m.indexBuffer,l,f.paint,y.transform.zoom,m.programConfigurations.get(f.id),R)}function jy(m,l,f,y,b,T,M){const C=m.context.gl,k=f.paint.get("fill-pattern"),B=k&&k.constantOr(1);let R,H,ee,ie,ae;M?(H=B&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=C.LINES):(H=B?"fillPattern":"fill",R=C.TRIANGLES);for(const oe of y){const se=l.getTile(oe);if(B&&!se.patternsLoaded())continue;const X=se.getBucket(f);if(!X)continue;m.prepareDrawTile();const ne=X.programConfigurations.get(f.id),fe=m.useProgram(H,ne);B&&(m.context.activeTexture.set(C.TEXTURE0),se.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),ne.updatePaintBuffers());const de=k.constantOr(null);if(de&&se.imageAtlas){const Pe=se.imageAtlas.patternPositions[de.toString()];Pe&&ne.setConstantPatternPositions(Pe)}const Ee=m.translatePosMatrix(oe.projMatrix,se,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(M){ie=X.indexBuffer2,ae=X.segments2;const Pe=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[C.drawingBufferWidth,C.drawingBufferHeight];ee=H==="fillOutlinePattern"&&B?I1(Ee,m,se,Pe):O1(Ee,Pe)}else ie=X.indexBuffer,ae=X.segments,ee=B?ip(Ee,m,se):Cs(Ee);m.prepareDrawProgram(m.context,fe,oe.toUnwrapped()),fe.draw(m.context,R,b,m.stencilModeForClipping(oe),T,o.CullFaceMode.disabled,ee,f.id,X.layoutVertexBuffer,ie,ae,f.paint,m.transform.zoom,ne)}}function lh(m,l,f,y,b,T,M){const C=m.context,k=C.gl,B=m.transform,R=f.paint.get("fill-extrusion-pattern"),H=R.constantOr(1),ee=f.paint.get("fill-extrusion-opacity"),ie=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),f.paint.get("fill-extrusion-ambient-occlusion-radius")],ae=f.layout.get("fill-extrusion-edge-radius"),oe=ae>0&&!f.paint.get("fill-extrusion-rounded-roof"),se=oe?0:ae,X=B.projection.name==="globe"?o.fillExtrusionHeightLift():0,ne=B.projection.name==="globe",fe=ne?o.globeToMercatorTransition(B.zoom):0,de=[o.mercatorXfromLng(B.center.lng),o.mercatorYfromLat(B.center.lat)],Ee=[];ne&&Ee.push("PROJECTION_GLOBE_VIEW"),ie[0]>0&&Ee.push("FAUX_AO"),oe&&Ee.push("ZERO_ROOF_RADIUS");for(const Pe of y){const Ae=l.getTile(Pe),je=Ae.getBucket(f);if(!je||je.projection.name!==B.projection.name)continue;const ze=je.programConfigurations.get(f.id),We=m.useProgram(H?"fillExtrusionPattern":"fillExtrusion",ze,Ee);if(m.terrain){const rt=m.terrain;if(m.style.terrainSetForDrapingOnly())rt.setupElevationDraw(Ae,We,{useMeterToDem:!0});else{if(!je.enableTerrain)continue;if(rt.setupElevationDraw(Ae,We,{useMeterToDem:!0}),Fy(C,l,Pe,je,f,rt),!je.centroidVertexBuffer){const gt=We.attributes.a_centroid_pos;gt!==void 0&&k.vertexAttrib2f(gt,0,0)}}}H&&(m.context.activeTexture.set(k.TEXTURE0),Ae.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ze.updatePaintBuffers());const pt=R.constantOr(null);if(pt&&Ae.imageAtlas){const rt=Ae.imageAtlas.patternPositions[pt.toString()];rt&&ze.setConstantPatternPositions(rt)}const Ne=m.translatePosMatrix(Pe.projMatrix,Ae,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),nt=B.projection.createInversionMatrix(B,Pe.canonical),He=f.paint.get("fill-extrusion-vertical-gradient"),dt=H?ky(Ne,m,He,ee,ie,se,Pe,Ae,X,fe,de,nt):np(Ne,m,He,ee,ie,se,Pe,X,fe,de,nt);m.prepareDrawProgram(C,We,Pe.toUnwrapped());const Ge=[];m.terrain&&Ge.push(je.centroidVertexBuffer),ne&&Ge.push(je.layoutVertexExtBuffer),We.draw(C,C.gl.TRIANGLES,b,T,M,o.CullFaceMode.backCCW,dt,f.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,f.paint,m.transform.zoom,ze,Ge)}}function Fy(m,l,f,y,b,T){const M=[X=>{let ne=X.canonical.x-1,fe=X.wrap;return ne<0&&(ne=(1<<X.canonical.z)-1,fe--),new o.OverscaledTileID(X.overscaledZ,fe,X.canonical.z,ne,X.canonical.y)},X=>{let ne=X.canonical.x+1,fe=X.wrap;return ne===1<<X.canonical.z&&(ne=0,fe++),new o.OverscaledTileID(X.overscaledZ,fe,X.canonical.z,ne,X.canonical.y)},X=>new o.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,(X.canonical.y===0?1<<X.canonical.z:X.canonical.y)-1),X=>new o.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y===(1<<X.canonical.z)-1?0:X.canonical.y+1)],C=X=>{const ne=l.getSource().minzoom,fe=Ee=>{const Pe=l.getTileByID(Ee);if(Pe&&Pe.hasData())return Pe.getBucket(b)},de=[0,-1,1];for(const Ee of de){if(X.overscaledZ+Ee<ne)continue;const Pe=fe(X.calculateScaledKey(X.overscaledZ+Ee));if(Pe)return Pe}},k=[0,0,0],B=(X,ne)=>(k[0]=Math.min(X.min.y,ne.min.y),k[1]=Math.max(X.max.y,ne.max.y),k[2]=o.EXTENT-ne.min.x>X.max.x?ne.min.x-o.EXTENT:X.max.x,k),R=(X,ne)=>(k[0]=Math.min(X.min.x,ne.min.x),k[1]=Math.max(X.max.x,ne.max.x),k[2]=o.EXTENT-ne.min.y>X.max.y?ne.min.y-o.EXTENT:X.max.y,k),H=[(X,ne)=>B(X,ne),(X,ne)=>B(ne,X),(X,ne)=>R(X,ne),(X,ne)=>R(ne,X)],ee=new o.Point(0,0);let ie,ae,oe;const se=(X,ne,fe,de,Ee)=>{const Pe=[[de?fe:X,de?X:fe,0],[de?fe:ne,de?ne:fe,0]],Ae=Ee<0?o.EXTENT+Ee:Ee,je=[de?Ae:(X+ne)/2,de?(X+ne)/2:Ae,0];return fe===0&&Ee<0||fe!==0&&Ee>0?T.getForTilePoints(oe,[je],!0,ae):Pe.push(je),T.getForTilePoints(f,Pe,!0,ie),Math.max(Pe[0][2],Pe[1][2],je[2])/T.exaggeration()};for(let X=0;X<4;X++){const ne=(X<2?1:5)-X,fe=y.borders[X];if(fe.length===0)continue;const de=oe=M[X](f),Ee=C(de);if(!(Ee&&Ee instanceof o.FillExtrusionBucket&&Ee.enableTerrain)||y.borderDoneWithNeighborZ[X]===Ee.canonical.z&&Ee.borderDoneWithNeighborZ[ne]===y.canonical.z||(ae=T.findDEMTileFor(de),!ae||!ae.dem))continue;if(!ie){const ze=T.findDEMTileFor(f);if(!ze||!ze.dem)return;ie=ze}const Pe=Ee.borders[ne];let Ae=0;const je=Ee.borderDoneWithNeighborZ[ne]!==y.canonical.z;if(y.canonical.z===Ee.canonical.z){for(let ze=0;ze<fe.length;ze++){const We=y.featuresOnBorder[fe[ze]],pt=We.borders[X];let Ne;for(;Ae<Pe.length&&(Ne=Ee.featuresOnBorder[Pe[Ae]],!(Ne.borders[ne][1]>pt[0]+3));)je&&Ee.encodeCentroid(void 0,Ne,!1),Ae++;if(Ne&&Ae<Pe.length){const nt=Ae;let He=0;for(;!(Ne.borders[ne][0]>pt[1]-3)&&(He++,++Ae!==Pe.length);)Ne=Ee.featuresOnBorder[Pe[Ae]];if(Ne=Ee.featuresOnBorder[Pe[nt]],We.intersectsCount()>1||Ne.intersectsCount()>1||He!==1){He!==1&&(Ae=nt),y.encodeCentroid(void 0,We,!1),je&&Ee.encodeCentroid(void 0,Ne,!1);continue}const dt=H[X](We,Ne),Ge=X%2?o.EXTENT-1:0;ee.x=se(dt[0],Math.min(o.EXTENT-1,dt[1]),Ge,X<2,dt[2]),ee.y=0,y.encodeCentroid(ee,We,!1),je&&Ee.encodeCentroid(ee,Ne,!1)}else y.encodeCentroid(void 0,We,!1)}y.borderDoneWithNeighborZ[X]=Ee.canonical.z,y.needsCentroidUpdate=!0,je&&(Ee.borderDoneWithNeighborZ[ne]=y.canonical.z,Ee.needsCentroidUpdate=!0)}else{for(const ze of fe)y.encodeCentroid(void 0,y.featuresOnBorder[ze],!1);if(je){for(const ze of Pe)Ee.encodeCentroid(void 0,Ee.featuresOnBorder[ze],!1);Ee.borderDoneWithNeighborZ[ne]=y.canonical.z,Ee.needsCentroidUpdate=!0}y.borderDoneWithNeighborZ[X]=Ee.canonical.z,y.needsCentroidUpdate=!0}}(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(m)}const wl=new o.Color(1,0,0,1),R1=new o.Color(0,1,0,1),B1=new o.Color(0,0,1,1),j1=new o.Color(1,0,1,1),F1=new o.Color(0,1,1,1);function $1(m,l,f){const y=m.context,b=m.transform,T=y.gl,M=b.projection.name==="globe",C=M?["PROJECTION_GLOBE_VIEW"]:null;let k=f.projMatrix;if(M&&o.globeToMercatorTransition(b.zoom)>0){const We=o.transitionTileAABBinECEF(f.canonical,b),pt=o.globeDenormalizeECEF(We);k=o.multiply(new Float32Array(16),b.globeMatrix,pt),o.multiply(k,b.projMatrix,k)}const B=m.useProgram("debug",null,C),R=l.getTileByID(f.key);m.terrain&&m.terrain.setupElevationDraw(R,B);const H=o.DepthMode.disabled,ee=o.StencilMode.disabled,ie=m.colorModeForRenderPass(),ae="$debug";y.activeTexture.set(T.TEXTURE0),m.emptyTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),M?R._makeGlobeTileDebugBuffers(m.context,b):R._makeDebugTileBoundsBuffers(m.context,b.projection);const oe=R._tileDebugBuffer||m.debugBuffer,se=R._tileDebugIndexBuffer||m.debugIndexBuffer,X=R._tileDebugSegments||m.debugSegments;B.draw(y,T.LINE_STRIP,H,ee,ie,o.CullFaceMode.disabled,ih(k,o.Color.red),ae,oe,se,X,null,null,null,[R._globeTileDebugBorderBuffer]);const ne=R.latestRawTileData,fe=Math.floor((ne&&ne.byteLength||0)/1024),de=l.getTile(f).tileSize,Ee=512/Math.min(de,512)*(f.overscaledZ/b.zoom)*.5;let Pe=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Pe+=` => ${f.overscaledZ}`),Pe+=` ${fe}kb`,function(We,pt){We.initDebugOverlayCanvas();const Ne=We.debugOverlayCanvas,nt=We.context.gl,He=We.debugOverlayCanvas.getContext("2d");He.clearRect(0,0,Ne.width,Ne.height),He.shadowColor="white",He.shadowBlur=2,He.lineWidth=1.5,He.strokeStyle="white",He.textBaseline="top",He.font="bold 36px Open Sans, sans-serif",He.fillText(pt,5,5),He.strokeText(pt,5,5),We.debugOverlayTexture.update(Ne),We.debugOverlayTexture.bind(nt.LINEAR,nt.CLAMP_TO_EDGE)}(m,Pe);const Ae=R._tileDebugTextBuffer||m.debugBuffer,je=R._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,ze=R._tileDebugTextSegments||m.debugSegments;B.draw(y,T.TRIANGLES,H,ee,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,ih(k,o.Color.transparent,Ee),ae,Ae,je,ze,null,null,null,[R._globeTileDebugTextBuffer])}function $y(m,l,f,y){Tl(m,0,l+f/2,m.transform.width,f,y)}function uh(m,l,f,y){Tl(m,l-f/2,0,f,m.transform.height,y)}function Tl(m,l,f,y,b,T){const M=m.context,C=M.gl;C.enable(C.SCISSOR_TEST),C.scissor(l*o.exported.devicePixelRatio,f*o.exported.devicePixelRatio,y*o.exported.devicePixelRatio,b*o.exported.devicePixelRatio),M.clear({color:T}),C.disable(C.SCISSOR_TEST)}const Ny=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Uy}=Ny;function Ta(m,l,f,y){m.emplaceBack(l,f,y)}class ch{constructor(l){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Ta(this.vertexArray,-1,-1,1),Ta(this.vertexArray,1,-1,1),Ta(this.vertexArray,-1,1,1),Ta(this.vertexArray,1,1,1),Ta(this.vertexArray,-1,-1,-1),Ta(this.vertexArray,1,-1,-1),Ta(this.vertexArray,-1,1,-1),Ta(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,Uy),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function ao(m,l,f,y,b,T){const M=m.gl,C=l.paint.get("sky-atmosphere-color"),k=l.paint.get("sky-atmosphere-halo-color"),B=l.paint.get("sky-atmosphere-sun-intensity"),R=((H,ee,ie,ae,oe)=>({u_matrix_3f:H,u_sun_direction:ee,u_sun_intensity:ie,u_color_tint_r:[ae.r,ae.g,ae.b,ae.a],u_color_tint_m:[oe.r,oe.g,oe.b,oe.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),y),b,B,C,k);M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+T,l.skyboxTexture,0),f.draw(m,M.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,R,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const Nu=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Vy{constructor(l){const f=new o.StructArrayLayout5f20;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const y=new o.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(f,Nu.members),this.indexBuffer=l.createIndexBuffer(y),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Os={symbol:function(m,l,f,y,b){if(m.renderPass!=="translucent")return;const T=o.StencilMode.disabled,M=m.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(C,k,B,R,H,ee,ie){const ae=k.transform,oe=H==="map",se=ee==="map";for(const X of C){const ne=R.getTile(X),fe=ne.getBucket(B);if(!fe||!fe.text||!fe.text.segments.get().length)continue;const de=o.evaluateSizeForZoom(fe.textSizeData,ae.zoom),Ee=an(X,fe.getProjection(),ae),Pe=ae.calculatePixelsToTileUnitsMatrix(ne),Ae=Je(Ee,ne.tileID.canonical,se,oe,ae,fe.getProjection(),Pe),je=B.layout.get("icon-text-fit")!=="none"&&fe.hasIconData();if(de){const ze=Math.pow(2,ae.zoom-ne.tileID.overscaledZ);z1(fe,oe,se,ie,o.symbolSize,ae,Ae,X,ze,de,je)}}}(y,m,f,l,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),b),f.paint.get("icon-opacity").constantOr(1)!==0&&By(m,l,f,y,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),T,M),f.paint.get("text-opacity").constantOr(1)!==0&&By(m,l,f,y,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),T,M),l.map.showCollisionBoxes&&(Fu(m,l,f,y,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),Fu(m,l,f,y,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(m,l,f,y){if(m.renderPass!=="translucent")return;const b=f.paint.get("circle-opacity"),T=f.paint.get("circle-stroke-width"),M=f.paint.get("circle-stroke-opacity"),C=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(b.constantOr(1)===0&&(T.constantOr(1)===0||M.constantOr(1)===0))return;const k=m.context,B=k.gl,R=m.transform,H=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),ee=o.StencilMode.disabled,ie=m.colorModeForRenderPass(),ae=R.projection.name==="globe",oe=[o.mercatorXfromLng(R.center.lng),o.mercatorYfromLat(R.center.lat)],se=[];for(let ne=0;ne<y.length;ne++){const fe=y[ne],de=l.getTile(fe),Ee=de.getBucket(f);if(!Ee||Ee.projection.name!==R.projection.name)continue;const Pe=Ee.programConfigurations.get(f.id),Ae=ap(f);ae&&Ae.push("PROJECTION_GLOBE_VIEW");const je=m.useProgram("circle",Pe,Ae),ze=Ee.layoutVertexBuffer,We=Ee.globeExtVertexBuffer,pt=Ee.indexBuffer,Ne=R.projection.createInversionMatrix(R,fe.canonical),nt={programConfiguration:Pe,program:je,layoutVertexBuffer:ze,globeExtVertexBuffer:We,indexBuffer:pt,uniformValues:op(m,fe,de,Ne,oe,f),tile:de};if(C){const He=Ee.segments.get();for(const dt of He)se.push({segments:new o.SegmentVector([dt]),sortKey:dt.sortKey,state:nt})}else se.push({segments:Ee.segments,sortKey:0,state:nt})}C&&se.sort((ne,fe)=>ne.sortKey-fe.sortKey);const X={useDepthForOcclusion:!ae};for(const ne of se){const{programConfiguration:fe,program:de,layoutVertexBuffer:Ee,globeExtVertexBuffer:Pe,indexBuffer:Ae,uniformValues:je,tile:ze}=ne.state,We=ne.segments;m.terrain&&m.terrain.setupElevationDraw(ze,de,X),m.prepareDrawProgram(k,de,ze.tileID.toUnwrapped()),de.draw(k,B.TRIANGLES,H,ee,ie,o.CullFaceMode.disabled,je,f.id,Ee,Ae,We,f.paint,R.zoom,fe,[Pe])}},heatmap:function(m,l,f,y){if(f.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const b=m.context,T=b.gl,M=o.StencilMode.disabled,C=new o.ColorMode([T.ONE,T.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(ie,ae,oe,se){const X=ie.gl,ne=ae.width*se,fe=ae.height*se;ie.activeTexture.set(X.TEXTURE1),ie.viewport.set([0,0,ne,fe]);let de=oe.heatmapFbo;if(!de||de&&(de.width!==ne||de.height!==fe)){de&&de.destroy();const Ee=X.createTexture();X.bindTexture(X.TEXTURE_2D,Ee),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),de=oe.heatmapFbo=ie.createFramebuffer(ne,fe,!1),function(Pe,Ae,je,ze,We,pt){const Ne=Pe.gl;Ne.texImage2D(Ne.TEXTURE_2D,0,Pe.isWebGL2&&Pe.extRenderToTextureHalfFloat?Ne.RGBA16F:Ne.RGBA,We,pt,0,Ne.RGBA,Pe.extRenderToTextureHalfFloat?Pe.isWebGL2?Ne.HALF_FLOAT:Pe.extTextureHalfFloat.HALF_FLOAT_OES:Ne.UNSIGNED_BYTE,null),ze.colorAttachment.set(je)}(ie,0,Ee,de,ne,fe)}else X.bindTexture(X.TEXTURE_2D,de.colorAttachment.get()),ie.bindFramebuffer.set(de.framebuffer)})(b,m,f,m.transform.projection.name==="globe"?.5:.25),b.clear({color:o.Color.transparent});const k=m.transform,B=k.projection.name==="globe",R=B?["PROJECTION_GLOBE_VIEW"]:null,H=B?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,ee=[o.mercatorXfromLng(k.center.lng),o.mercatorYfromLat(k.center.lat)];for(let ie=0;ie<y.length;ie++){const ae=y[ie];if(l.hasRenderableParent(ae))continue;const oe=l.getTile(ae),se=oe.getBucket(f);if(!se||se.projection.name!==k.projection.name)continue;const X=se.programConfigurations.get(f.id),ne=m.useProgram("heatmap",X,R),{zoom:fe}=m.transform;m.terrain&&m.terrain.setupElevationDraw(oe,ne),m.prepareDrawProgram(b,ne,ae.toUnwrapped());const de=k.projection.createInversionMatrix(k,ae.canonical);ne.draw(b,T.TRIANGLES,o.DepthMode.disabled,M,C,H,Ly(m,ae,oe,de,ee,fe,f.paint.get("heatmap-intensity")),f.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,f.paint,m.transform.zoom,X,B?[se.globeExtVertexBuffer]:null)}b.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(b,T){const M=b.context,C=M.gl,k=T.heatmapFbo;if(!k)return;M.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,k.colorAttachment.get()),M.activeTexture.set(C.TEXTURE1);let B=T.colorRampTexture;B||(B=T.colorRampTexture=new o.Texture(M,T.colorRamp,C.RGBA)),B.bind(C.LINEAR,C.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(M,C.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,b.colorModeForRenderPass(),o.CullFaceMode.disabled,((R,H,ee,ie)=>({u_image:0,u_color_ramp:1,u_opacity:H.paint.get("heatmap-opacity")}))(0,T),T.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,T.paint,b.transform.zoom)}(m,f))},line:function(m,l,f,y){if(m.renderPass!=="translucent")return;const b=f.paint.get("line-opacity"),T=f.paint.get("line-width");if(b.constantOr(1)===0||T.constantOr(1)===0)return;const M=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),C=m.colorModeForRenderPass(),k=m.terrain&&m.terrain.renderingToTexture?1:o.exported.devicePixelRatio,B=f.paint.get("line-dasharray"),R=B.constantOr(1),H=f.layout.get("line-cap"),ee=f.paint.get("line-pattern"),ie=ee.constantOr(1),ae=f.paint.get("line-gradient"),oe=ie?"linePattern":"line",se=m.context,X=se.gl,ne=(de=>{const Ee=[];ju(de)&&Ee.push("RENDER_LINE_DASH"),de.paint.get("line-gradient")&&Ee.push("RENDER_LINE_GRADIENT");const Pe=de.paint.get("line-trim-offset");Pe[0]===0&&Pe[1]===0||Ee.push("RENDER_LINE_TRIM_OFFSET");const Ae=de.paint.get("line-pattern").constantOr(1),je=de.paint.get("line-opacity").constantOr(1)!==1;return!Ae&&je&&Ee.push("RENDER_LINE_ALPHA_DISCARD"),Ee})(f);let fe=ne.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(fe=!1);for(const de of y){const Ee=l.getTile(de);if(ie&&!Ee.patternsLoaded())continue;const Pe=Ee.getBucket(f);if(!Pe)continue;m.prepareDrawTile();const Ae=Pe.programConfigurations.get(f.id),je=m.useProgram(oe,Ae,ne),ze=ee.constantOr(null);if(ze&&Ee.imageAtlas){const rt=Ee.imageAtlas.patternPositions[ze.toString()];rt&&Ae.setConstantPatternPositions(rt)}const We=B.constantOr(null),pt=H.constantOr(null);if(!ie&&We&&pt&&Ee.lineAtlas){const rt=Ee.lineAtlas.getDash(We,pt);rt&&Ae.setConstantPatternPositions(rt)}let[Ne,nt]=f.paint.get("line-trim-offset");(pt==="round"||pt==="square")&&Ne!==nt&&(Ne===0&&(Ne-=1),nt===1&&(nt+=1));const He=m.terrain?de.projMatrix:null,dt=ie?Bu(m,Ee,f,He,k):D1(m,Ee,f,He,Pe.lineClipsArray.length,k,[Ne,nt]);if(ae){const rt=Pe.gradients[f.id];let gt=rt.texture;if(f.gradientVersion!==rt.version){let lt=256;if(f.stepInterpolant){const _t=l.getSource().maxzoom,jt=de.canonical.z===_t?Math.ceil(1<<m.transform.maxZoom-de.canonical.z):1;lt=o.clamp(o.nextPowerOfTwo(Pe.maxLineLength/o.EXTENT*1024*jt),256,se.maxTextureSize)}rt.gradient=o.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:lt,image:rt.gradient||void 0,clips:Pe.lineClipsArray}),rt.texture?rt.texture.update(rt.gradient):rt.texture=new o.Texture(se,rt.gradient,X.RGBA),rt.version=f.gradientVersion,gt=rt.texture}se.activeTexture.set(X.TEXTURE1),gt.bind(f.stepInterpolant?X.NEAREST:X.LINEAR,X.CLAMP_TO_EDGE)}R&&(se.activeTexture.set(X.TEXTURE0),Ee.lineAtlasTexture.bind(X.LINEAR,X.REPEAT),Ae.updatePaintBuffers()),ie&&(se.activeTexture.set(X.TEXTURE0),Ee.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Ae.updatePaintBuffers()),m.prepareDrawProgram(se,je,de.toUnwrapped());const Ge=rt=>{je.draw(se,X.TRIANGLES,M,rt,C,o.CullFaceMode.disabled,dt,f.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,f.paint,m.transform.zoom,Ae,[Pe.layoutVertexBuffer2])};if(fe){const rt=m.stencilModeForClipping(de).ref;rt===0&&m.terrain&&se.clear({stencil:0});const gt={func:X.EQUAL,mask:255};dt.u_alpha_discard_threshold=.8,Ge(new o.StencilMode(gt,rt,255,X.KEEP,X.KEEP,X.INVERT)),dt.u_alpha_discard_threshold=0,Ge(new o.StencilMode(gt,rt,255,X.KEEP,X.KEEP,X.KEEP))}else Ge(m.stencilModeForClipping(de))}fe&&(m.resetStencilClippingMasks(),m.terrain&&se.clear({stencil:0}))},fill:function(m,l,f,y){const b=f.paint.get("fill-color"),T=f.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const M=m.colorModeForRenderPass(),C=f.paint.get("fill-pattern"),k=m.opaquePassEnabledForLayer()&&!C.constantOr(1)&&b.constantOr(o.Color.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===k){const B=m.depthModeForSublayer(1,m.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);jy(m,l,f,y,B,M,!1)}if(m.renderPass==="translucent"&&f.paint.get("fill-antialias")){const B=m.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);jy(m,l,f,y,B,M,!0)}},"fill-extrusion":function(m,l,f,y){const b=f.paint.get("fill-extrusion-opacity");if(b!==0&&m.renderPass==="translucent"){const T=new o.DepthMode(m.context.gl.LEQUAL,o.DepthMode.ReadWrite,m.depthRangeFor3D);if(b!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))lh(m,l,f,y,T,o.StencilMode.disabled,o.ColorMode.disabled),lh(m,l,f,y,T,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const M=m.colorModeForRenderPass();lh(m,l,f,y,T,o.StencilMode.disabled,M)}}},hillshade:function(m,l,f,y){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const b=m.context,T=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),M=m.colorModeForRenderPass(),C=m.terrain&&m.terrain.renderingToTexture,[k,B]=m.renderPass!=="translucent"||C?[{},y]:m.stencilConfigForOverlap(y);for(const R of B){const H=l.getTile(R);if(H.needsHillshadePrepare&&m.renderPass==="offscreen")Cy(m,H,f,T,o.StencilMode.disabled,M);else if(m.renderPass==="translucent"){const ee=C&&m.terrain?m.terrain.stencilModeForRTTOverlap(R):k[R.overscaledZ];My(m,R,H,f,T,ee,M)}}b.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,l,f,y,b,T){if(m.renderPass!=="translucent"||f.paint.get("raster-opacity")===0||!y.length)return;const M=m.context,C=M.gl,k=l.getSource(),B=m.useProgram("raster"),R=m.colorModeForRenderPass(),H=m.terrain&&m.terrain.renderingToTexture,[ee,ie]=k instanceof er||H?[{},y]:m.stencilConfigForOverlap(y),ae=ie[ie.length-1].overscaledZ,oe=!m.options.moving;for(const se of ie){const X=H?o.DepthMode.disabled:m.depthModeForSublayer(se.overscaledZ-ae,f.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,C.LESS),ne=se.toUnwrapped(),fe=l.getTile(se);if(H&&(!fe||!fe.hasData()))continue;const de=H?se.projMatrix:m.transform.calculateProjMatrix(ne,oe),Ee=m.terrain&&H?m.terrain.stencilModeForRTTOverlap(se):ee[se.overscaledZ],Pe=T?0:f.paint.get("raster-fade-duration");fe.registerFadeDuration(Pe);const Ae=l.findLoadedParent(se,0),je=ep(fe,Ae,l,m.transform,Pe);let ze,We;m.terrain&&m.terrain.prepareDrawTile();const pt=f.paint.get("raster-resampling")==="nearest"?C.NEAREST:C.LINEAR;M.activeTexture.set(C.TEXTURE0),fe.texture.bind(pt,C.CLAMP_TO_EDGE),M.activeTexture.set(C.TEXTURE1),Ae?(Ae.texture.bind(pt,C.CLAMP_TO_EDGE),ze=Math.pow(2,Ae.tileID.overscaledZ-fe.tileID.overscaledZ),We=[fe.tileID.canonical.x*ze%1,fe.tileID.canonical.y*ze%1]):fe.texture.bind(pt,C.CLAMP_TO_EDGE),fe.texture.useMipmap&&M.extTextureFilterAnisotropic&&m.transform.pitch>20&&C.texParameterf(C.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax);const Ne=up(de,We||[0,0],ze||1,je,f,k instanceof er?k.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(M,B,ne),k instanceof er)k.boundsBuffer&&k.boundsSegments&&B.draw(M,C.TRIANGLES,X,o.StencilMode.disabled,R,o.CullFaceMode.disabled,Ne,f.id,k.boundsBuffer,m.quadTriangleIndexBuffer,k.boundsSegments);else{const{tileBoundsBuffer:nt,tileBoundsIndexBuffer:He,tileBoundsSegments:dt}=m.getTileBoundsBuffers(fe);B.draw(M,C.TRIANGLES,X,Ee,R,o.CullFaceMode.disabled,Ne,f.id,nt,He,dt)}}m.resetStencilClippingMasks()},background:function(m,l,f,y){const b=f.paint.get("background-color"),T=f.paint.get("background-opacity");if(T===0)return;const M=m.context,C=M.gl,k=m.transform,B=k.tileSize,R=f.paint.get("background-pattern");if(m.isPatternMissing(R))return;const H=!R&&b.a===1&&T===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==H)return;const ee=o.StencilMode.disabled,ie=m.depthModeForSublayer(0,H==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),ae=m.colorModeForRenderPass(),oe=m.useProgram(R?"backgroundPattern":"background");let se,X=y;X||(se=m.getBackgroundTiles(),X=Object.values(se).map(ne=>ne.tileID)),R&&(M.activeTexture.set(C.TEXTURE0),m.imageManager.bind(m.context));for(const ne of X){const fe=ne.toUnwrapped(),de=y?ne.projMatrix:m.transform.calculateProjMatrix(fe);m.prepareDrawTile();const Ee=l?l.getTile(ne):se?se[ne.key]:new o.Tile(ne,B,k.zoom,m),Pe=R?L1(de,T,m,R,{tileID:ne,tileSize:B}):hp(de,T,b);m.prepareDrawProgram(M,oe,fe);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:je,tileBoundsSegments:ze}=m.getTileBoundsBuffers(Ee);oe.draw(M,C.TRIANGLES,ie,ee,ae,o.CullFaceMode.disabled,Pe,f.id,Ae,je,ze)}},sky:function(m,l,f){const y=m.transform,b=y.projection.name==="mercator"||y.projection.name==="globe"?1:o.smoothstep(7,8,y.zoom),T=f.paint.get("sky-opacity")*b;if(T===0)return;const M=m.context,C=f.paint.get("sky-type"),k=new o.DepthMode(M.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),B=m.frameCounter/1e3%1;C==="atmosphere"?m.renderPass==="offscreen"?f.needsSkyboxCapture(m)&&(function(R,H,ee,ie){const ae=R.context,oe=ae.gl;let se=H.skyboxFbo;if(!se){se=H.skyboxFbo=ae.createFramebuffer(32,32,!1),H.skyboxGeometry=new ch(ae),H.skyboxTexture=ae.gl.createTexture(),oe.bindTexture(oe.TEXTURE_CUBE_MAP,H.skyboxTexture),oe.texParameteri(oe.TEXTURE_CUBE_MAP,oe.TEXTURE_WRAP_S,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_CUBE_MAP,oe.TEXTURE_WRAP_T,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_CUBE_MAP,oe.TEXTURE_MIN_FILTER,oe.LINEAR),oe.texParameteri(oe.TEXTURE_CUBE_MAP,oe.TEXTURE_MAG_FILTER,oe.LINEAR);for(let de=0;de<6;++de)oe.texImage2D(oe.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,oe.RGBA,32,32,0,oe.RGBA,oe.UNSIGNED_BYTE,null)}ae.bindFramebuffer.set(se.framebuffer),ae.viewport.set([0,0,32,32]);const X=H.getCenter(R,!0),ne=R.useProgram("skyboxCapture"),fe=new Float64Array(16);o.identity(fe),o.rotateY(fe,fe,.5*-Math.PI),ao(ae,H,ne,fe,X,0),o.identity(fe),o.rotateY(fe,fe,.5*Math.PI),ao(ae,H,ne,fe,X,1),o.identity(fe),o.rotateX(fe,fe,.5*-Math.PI),ao(ae,H,ne,fe,X,2),o.identity(fe),o.rotateX(fe,fe,.5*Math.PI),ao(ae,H,ne,fe,X,3),o.identity(fe),ao(ae,H,ne,fe,X,4),o.identity(fe),o.rotateY(fe,fe,Math.PI),ao(ae,H,ne,fe,X,5),ae.viewport.set([0,0,R.width,R.height])}(m,f),f.markSkyboxValid(m)):m.renderPass==="sky"&&function(R,H,ee,ie,ae){const oe=R.context,se=oe.gl,X=R.transform,ne=R.useProgram("skybox");oe.activeTexture.set(se.TEXTURE0),se.bindTexture(se.TEXTURE_CUBE_MAP,H.skyboxTexture);const fe=((de,Ee,Pe,Ae,je)=>({u_matrix:de,u_sun_direction:Ee,u_cubemap:0,u_opacity:Ae,u_temporal_offset:je}))(X.skyboxMatrix,H.getCenter(R,!1),0,ie,ae);R.prepareDrawProgram(oe,ne),ne.draw(oe,se.TRIANGLES,ee,o.StencilMode.disabled,R.colorModeForRenderPass(),o.CullFaceMode.backCW,fe,"skybox",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(m,f,k,T,B):C==="gradient"&&m.renderPass==="sky"&&function(R,H,ee,ie,ae){const oe=R.context,se=oe.gl,X=R.transform,ne=R.useProgram("skyboxGradient");H.skyboxGeometry||(H.skyboxGeometry=new ch(oe)),oe.activeTexture.set(se.TEXTURE0);let fe=H.colorRampTexture;fe||(fe=H.colorRampTexture=new o.Texture(oe,H.colorRamp,se.RGBA)),fe.bind(se.LINEAR,se.CLAMP_TO_EDGE);const de=((Ee,Pe,Ae,je,ze)=>({u_matrix:Ee,u_color_ramp:0,u_center_direction:Pe,u_radius:o.degToRad(Ae),u_opacity:je,u_temporal_offset:ze}))(X.skyboxMatrix,H.getCenter(R,!1),H.paint.get("sky-gradient-radius"),ie,ae);R.prepareDrawProgram(oe,ne),ne.draw(oe,se.TRIANGLES,ee,o.StencilMode.disabled,R.colorModeForRenderPass(),o.CullFaceMode.backCW,de,"skyboxGradient",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(m,f,k,T,B)},debug:function(m,l,f){for(let y=0;y<f.length;y++)$1(m,l,f[y])},custom:function(m,l,f,y){const b=m.context,T=f.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&f.isLayerDraped()){if(m.renderPass==="offscreen"){const M=T.prerender;if(M){if(m.setCustomLayerDefaults(),b.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const C=m.transform.pointMerc;M.call(T,b.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(m.transform.zoom),[C.x,C.y],m.transform.pixelsPerMeterRatio)}else M.call(T,b.gl,m.transform.customLayerMatrix());b.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const C=T.renderToTile;if(C){const k=y[0].canonical,B=new o.MercatorCoordinate(k.x+y[0].wrap*(1<<k.z),k.y,k.z);b.setDepthMode(o.DepthMode.disabled),b.setStencilMode(o.StencilMode.disabled),b.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),C.call(T,b.gl,B),b.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),b.setColorMode(m.colorModeForRenderPass()),b.setStencilMode(o.StencilMode.disabled);const M=T.renderingMode==="3d"?new o.DepthMode(m.context.gl.LEQUAL,o.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,o.DepthMode.ReadOnly);if(b.setDepthMode(M),m.transform.projection.name==="globe"){const C=m.transform.pointMerc;T.render(b.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(m.transform.zoom),[C.x,C.y],m.transform.pixelsPerMeterRatio)}else T.render(b.gl,m.transform.customLayerMatrix());b.setDirty(),m.setBaseState(),b.bindFramebuffer.set(null)}}else o.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Sl{constructor(l,f,y=!1){this.context=new yt(l,y),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(l,f){const y=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new rp(this,l));const b=this._terrain;this.transform.elevation=y?b:null,b.update(l,this.transform,f)}_updateFog(l){const f=l.fog;if(!f||this.transform.projection.name==="globe"||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,b]=f.getFovAdjustedRange(this.transform._fov);if(y>b)return void(this.transform.fogCullDistSq=null);const T=y+.78*(b-y);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(l,f){if(this.width=l*o.exported.devicePixelRatio,this.height=f*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._layers[y].resize()}setup(){const l=this.context,f=new o.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(o.EXTENT,0),f.emplaceBack(0,o.EXTENT),f.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(f,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const y=new o.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(o.EXTENT,0),y.emplaceBack(0,o.EXTENT),y.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=l.createVertexBuffer(y,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const b=new o.StructArrayLayout2i4;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(b,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const T=new o.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(o.EXTENT,0,o.EXTENT,0),T.emplaceBack(0,o.EXTENT,0,o.EXTENT),T.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=l.createVertexBuffer(T,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const M=new o.StructArrayLayout3ui6;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(M);const C=new o.StructArrayLayout1ui2;for(const B of[0,1,3,2,0])C.emplaceBack(B);this.debugIndexBuffer=l.createIndexBuffer(C),this.emptyTexture=new o.Texture(l,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA),this.identityMat=o.create();const k=this.context.gl;this.stencilClearMode=new o.StencilMode({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new Vy(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context,f=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(l,f.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,zu(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,f,y){if(!f||this.currentStencilSource===f.id||!l.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let C=!1;for(const k of y)if(this._tileClippingMaskIDs[k.key]===void 0){C=!0;break}if(!C)return}this.currentStencilSource=f.id;const b=this.context,T=b.gl;this.nextStencilID+y.length>256&&this.clearStencil(),b.setColorMode(o.ColorMode.disabled),b.setDepthMode(o.DepthMode.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const C of y){const k=f.getTile(C),B=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,{tileBoundsBuffer:R,tileBoundsIndexBuffer:H,tileBoundsSegments:ee}=this.getTileBoundsBuffers(k);M.draw(b,T.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:T.ALWAYS,mask:0},B,255,T.KEEP,T.KEEP,T.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,zu(C.projMatrix),"$clipping",R,H,ee)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,f=this.context.gl;return new o.StencilMode({func:f.NOTEQUAL,mask:255},l,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const f=this.context.gl;return new o.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(l){const f=this.context.gl,y=l.sort((M,C)=>C.overscaledZ-M.overscaledZ),b=y[y.length-1].overscaledZ,T=y[0].overscaledZ-b+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const M={};for(let C=0;C<T;C++)M[C+b]=new o.StencilMode({func:f.GEQUAL,mask:255},C+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=T,[M,y]}return[{[b]:o.StencilMode.disabled},y]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([l.CONSTANT_COLOR,l.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(l,f,y){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new o.DepthMode(y||this.context.gl.LEQUAL,f,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,f){this.style=l,this.options=f,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const y=this.style.order,b=this.style._sourceCaches;for(const B in b){const R=b[B];R.used&&R.prepare(this.context)}const T={},M={},C={};for(const B in b){const R=b[B];T[B]=R.getVisibleCoordinates(),M[B]=T[B].slice().reverse(),C[B]=R.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<y.length;B++)if(this.style._layers[y[B]].is3D()){this.opaquePassCutoff=B;break}if(this.terrain&&(this.terrain.updateTileBinding(C),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),!o.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const B of y){const R=this.style._layers[B],H=l._getLayerSourceCache(R);if(!R.hasOffscreenPass()||R.isHidden(this.transform.zoom))continue;const ee=H?M[H.id]:void 0;(R.type==="custom"||R.isSky()||ee&&ee.length)&&this.renderLayer(this,H,R,ee)}this.depthRangeFor3D=[0,1-(l.order.length+2)*this.numSublayers*this.depthEpsilon];const k=this.terrain;if(k&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&k.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:f.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[y[this.currentLayer]],R=l._getLayerSourceCache(B);if(B.isSky())continue;const H=R?M[R.id]:void 0;this._renderTileClippingMasks(B,R,H),this.renderLayer(this,R,B,H)}if(this.style.fog&&this.transform.projection.supportsFog&&function(B,R){const H=B.context,ee=H.gl,ie=B.transform,ae=new o.DepthMode(ee.LEQUAL,o.DepthMode.ReadOnly,[0,1]),oe=B.useProgram("globeAtmosphere",null,ie.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),se=o.globeToMercatorTransition(ie.zoom),X=R.properties.get("color").toArray01(),ne=R.properties.get("high-color").toArray01(),fe=R.properties.get("space-color").toArray01PremultipliedAlpha(),de=o.identity$1([]);o.rotateY$1(de,de,-o.degToRad(ie._center.lng)),o.rotateX$1(de,de,o.degToRad(ie._center.lat)),o.rotateZ$1(de,de,ie.angle),o.rotateX$1(de,de,-ie._pitch);const Ee=o.fromQuat(new Float32Array(16),de),Pe=o.mapValue(R.properties.get("star-intensity"),0,1,0,.25),Ae=5e-4,je=o.mapValue(R.properties.get("horizon-blend"),0,1,Ae,.25),ze=o.globeUseCustomAntiAliasing(B,H,ie)&&je===Ae?ie.worldSize/(2*Math.PI*1.025)-1:ie.globeRadius,We=B.frameCounter/1e3%1,pt=o.length(ie.globeCenterInViewSpace),Ne=Math.sqrt(Math.pow(pt,2)-Math.pow(ze,2)),nt=Math.acos(Ne/pt),He=((Ge,rt,gt,lt,_t,jt,Ht,Dt,Vt,dr,cr,Bt,Cr,zr)=>({u_frustum_tl:Ge,u_frustum_tr:rt,u_frustum_br:gt,u_frustum_bl:lt,u_horizon:_t,u_transition:jt,u_fadeout_range:Ht,u_color:Dt,u_high_color:Vt,u_space_color:dr,u_star_intensity:cr,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Bt,u_horizon_angle:Cr,u_rotation_matrix:zr}))(ie.frustumCorners.TL,ie.frustumCorners.TR,ie.frustumCorners.BR,ie.frustumCorners.BL,ie.frustumCorners.horizon,se,je,X,ne,fe,Pe,We,nt,Ee);B.prepareDrawProgram(H,oe);const dt=B.atmosphereBuffer;dt&&oe.draw(H,ee.TRIANGLES,ae,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,He,"skybox",dt.vertexBuffer,dt.indexBuffer,dt.segments)}(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const B=this.style._layers[y[this.currentLayer]],R=l._getLayerSourceCache(B);B.isSky()&&this.renderLayer(this,R,B,R?M[R.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;){const B=this.style._layers[y[this.currentLayer]],R=l._getLayerSourceCache(B);if(B.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(B)){if(B.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const H=R?(B.type==="symbol"?C:M)[R.id]:void 0;this._renderTileClippingMasks(B,R,R?T[R.id]:void 0),this.renderLayer(this,R,B,H),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let B=null;o.values(this.style._layers).forEach(R=>{const H=l._getLayerSourceCache(R);H&&!R.isHidden(this.transform.zoom)&&(!B||B.getSource().maxzoom<H.getSource().maxzoom)&&(B=H)}),B&&this.options.showTileBoundaries&&Os.debug(this,B,B.getVisibleCoordinates())}this.options.showPadding&&function(B){const R=B.transform.padding;$y(B,B.transform.height-(R.top||0),3,wl),$y(B,R.bottom||0,3,R1),uh(B,R.left||0,3,B1),uh(B,B.transform.width-(R.right||0),3,j1);const H=B.transform.centerPoint;(function(ee,ie,ae,oe){Tl(ee,ie-1,ae-10,2,20,oe),Tl(ee,ie-10,ae-1,20,2,oe)})(B,H.x,B.transform.height-H.y,F1)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}renderLayer(l,f,y,b){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||b&&b.length)&&(this.id=y.id,this.gpuTimingStart(y),(!l.transform.projection.unsupportedLayers||!l.transform.projection.unsupportedLayers.includes(y.type)||l.terrain&&y.type==="custom")&&Os[y.type](l,f,y,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let y=this.gpuTimers[l.id];y||(y=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),y.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const l=this.context.extTimerQuery,f=l.createQueryEXT();this.deferredRenderGpuTimeQueries.push(f),l.beginQueryEXT(l.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){const l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){const f={};for(const y in l){const b=l[y],T=this.context.extTimerQuery,M=T.getQueryObjectEXT(b.query,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(b.query),f[y]=M}return f}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery;let y=0;for(const b of l)y+=f.getQueryObjectEXT(b,f.QUERY_RESULT_EXT)/1e6,f.deleteQueryEXT(b);return y}translatePosMatrix(l,f,y,b,T){if(!y[0]&&!y[1])return l;const M=T?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(M){const B=Math.sin(M),R=Math.cos(M);y=[y[0]*R-y[1]*B,y[0]*B+y[1]*R]}const C=[T?y[0]:st(f,y[0],this.transform.zoom),T?y[1]:st(f,y[1],this.transform.zoom),0],k=new Float32Array(16);return o.translate(k,l,C),k}saveTileTexture(l){const f=this._tileTextures[l.size[0]];f?f.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const f=this._tileTextures[l];return f&&f.length>0?f.pop():null}isPatternMissing(l){return l===null||l!==void 0&&!this.imageManager.getPattern(l.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const l=this.terrain&&this.terrain.renderingToTexture,f=this.terrain&&this.terrain.exaggeration()===0,y=this.style&&this.style.fog,b=[];return this.terrainRenderModeElevated()&&b.push("TERRAIN"),this.transform.projection.name==="globe"&&b.push("GLOBE"),f&&b.push("ZERO_EXAGGERATION"),y&&!l&&y.getOpacity(this.transform.pitch)!==0&&b.push("FOG"),l&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}useProgram(l,f,y){this.cache=this.cache||{};const b=y||[],T=this.currentGlobalDefines().concat(b),M=gr.cacheKey(Kd[l],l,T,f);return this.cache[M]||(this.cache[M]=new gr(this.context,l,Kd[l],f,fp[l],T)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(l,f,y){if(this.terrain&&this.terrain.renderingToTexture)return;const b=this.style.fog;if(b){const T=b.getOpacity(this.transform.pitch),M=((C,k,B,R,H,ee,ie,ae,oe,se,X)=>{const ne=C.transform,fe=k.properties.get("color").toArray01();fe[3]=R;const de=C.frameCounter/1e3%1;return{u_fog_matrix:B?ne.calculateFogTileMatrix(B):C.identityMat,u_fog_range:k.getFovAdjustedRange(ne._fov),u_fog_color:fe,u_fog_horizon_blend:k.properties.get("horizon-blend"),u_fog_temporal_offset:de,u_frustum_tl:H,u_frustum_tr:ee,u_frustum_br:ie,u_frustum_bl:ae,u_globe_pos:oe,u_globe_radius:se,u_viewport:X,u_globe_transition:o.globeToMercatorTransition(ne.zoom),u_is_globe:+(ne.projection.name==="globe")}})(this,b,y,T,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);f.setFogUniformValues(l,M)}}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){const l=this.canvasCopy();l&&(this.frameCopies.push(l),this.tileLoaded=!1)}canvasCopy(){const l=this.context.gl,f=l.createTexture();return l.bindTexture(l.TEXTURE_2D,f),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&l.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const l=this._backgroundTiles,f=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const b of y)f[b.key]=l[b.key]||new o.Tile(b,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class hh{constructor(l=0,f=0,y=0,b=0){if(isNaN(l)||l<0||isNaN(f)||f<0||isNaN(y)||y<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=f,this.left=y,this.right=b}interpolate(l,f,y){return f.top!=null&&l.top!=null&&(this.top=o.number(l.top,f.top,y)),f.bottom!=null&&l.bottom!=null&&(this.bottom=o.number(l.bottom,f.bottom,y)),f.left!=null&&l.left!=null&&(this.left=o.number(l.left,f.left,y)),f.right!=null&&l.right!=null&&(this.right=o.number(l.right,f.right,y)),this}getCenter(l,f){const y=o.clamp((this.left+l-this.right)/2,0,l),b=o.clamp((this.top+f-this.bottom)/2,0,f);return new o.Point(y,b)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new hh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function fh(m,l){const f=o.getColumn(m,3);o.fromQuat(m,l),o.setColumn(m,3,f)}function _r(m,l){const f=o.identity$1([]);return o.rotateZ$1(f,f,-l),o.rotateX$1(f,f,-m),f}function Uu(m,l){const f=[m[0],m[1],0],y=[l[0],l[1],0];if(o.length(f)>=1e-15){const M=o.normalize([],f);o.scale$2(y,M,o.dot(y,M)),l[0]=y[0],l[1]=y[1]}const b=o.cross([],l,m);if(o.len(b)<1e-15)return null;const T=Math.atan2(-b[1],b[0]);return _r(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),T)}class Gy{constructor(l,f){this.position=l,this.orientation=f}get position(){return this._position}set position(l){if(l){const f=l instanceof o.MercatorCoordinate?l:new o.MercatorCoordinate(l[0],l[1],l[2]);this._renderWorldCopies&&(f.x=o.wrap(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(l,f){if(this.orientation=null,!this.position)return;const y=this.position,b=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(l)):0,T=o.MercatorCoordinate.fromLngLat(l,b),M=[T.x-y.x,T.y-y.y,T.z-y.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=Uu(M,f)}setPitchBearing(l,f){this.orientation=_r(o.degToRad(l),o.degToRad(-f))}}class dh{constructor(l,f){this._transform=o.identity([]),this.orientation=f,this.position=l}get mercatorPosition(){const l=this.position;return new o.MercatorCoordinate(l[0],l[1],l[2])}get position(){const l=o.getColumn(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var f;l&&o.setColumn(this._transform,3,[(f=l)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||o.identity$1([]),l&&fh(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,f){this._orientation=_r(l,f),fh(this._transform,this._orientation)}forward(){const l=o.getColumn(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=o.getColumn(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=o.getColumn(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,f){const y=new Float64Array(16);return o.invert(y,this.getWorldToCamera(l,f)),y}getWorldToCameraPosition(l,f,y){const b=this.position;o.scale$2(b,b,-l);const T=new Float64Array(16);return o.fromScaling(T,[y,y,y]),o.translate(T,T,b),T[10]*=f,T}getWorldToCamera(l,f){const y=new Float64Array(16),b=new Float64Array(4),T=this.position;return o.conjugate(b,this._orientation),o.scale$2(T,T,-l),o.fromQuat(y,b),o.translate(y,y,T),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=f,y[9]*=f,y[10]*=f,y[11]*=f,y}getCameraToClipPerspective(l,f,y,b){const T=new Float64Array(16);return o.perspective(T,l,f,y,b),T}getDistanceToElevation(l,f=!1){const y=l===0?0:o.mercatorZfromAltitude(l,f?o.latFromMercatorY(this.position[1]):this.position[1]),b=this.forward();return(y-this.position[2])/b[2]}clone(){return new dh([...this.position],[...this.orientation])}}function El(m,l){const f=ph(m.projection,m.zoom,m.width,m.height),y=function(T,M,C,k,B){const R=new o.LngLat(C.lng-180*Sa,C.lat),H=new o.LngLat(C.lng+180*Sa,C.lat),ee=T.project(R.lng,R.lat),ie=T.project(H.lng,H.lat),ae=-Math.atan2(ie.y-ee.y,ie.x-ee.x),oe=o.MercatorCoordinate.fromLngLat(C);oe.y=o.clamp(oe.y,-1+Sa,1-Sa);const se=oe.toLngLat(),X=T.project(se.lng,se.lat),ne=o.MercatorCoordinate.fromLngLat(se);ne.x+=Sa;const fe=ne.toLngLat(),de=T.project(fe.lng,fe.lat),Ee=mh(de.x-X.x,de.y-X.y,ae),Pe=o.MercatorCoordinate.fromLngLat(se);Pe.y+=Sa;const Ae=Pe.toLngLat(),je=T.project(Ae.lng,Ae.lat),ze=mh(je.x-X.x,je.y-X.y,ae),We=Math.abs(Ee.x)/Math.abs(ze.y),pt=o.identity([]);o.rotateZ(pt,pt,-ae*(1-(B?0:k)));const Ne=o.identity([]);return o.scale(Ne,Ne,[1,1-(1-We)*k,1]),Ne[4]=-ze.x/ze.y*k,o.rotateZ(Ne,Ne,ae),o.multiply(Ne,pt,Ne),Ne}(m.projection,0,m.center,f,l),b=Wy(m);return o.scale(y,y,[b,b,1]),y}function Wy(m){const l=m.projection,f=ph(m.projection,m.zoom,m.width,m.height),y=qy(l,m.center),b=qy(l,o.LngLat.convert(l.center));return Math.pow(2,y*f+(1-f)*b)}function ph(m,l,f,y,b=1/0){const T=m.range;if(!T)return 0;const M=Math.min(b,Math.max(f,y)),C=Math.log(M/1024)/Math.LN2;return o.smoothstep(T[0]+C,T[1]+C,l)}const Sa=1/4e4;function qy(m,l){const f=o.clamp(l.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),y=new o.LngLat(l.lng-180*Sa,f),b=new o.LngLat(l.lng+180*Sa,f),T=m.project(y.lng,f),M=m.project(b.lng,f),C=o.MercatorCoordinate.fromLngLat(y),k=o.MercatorCoordinate.fromLngLat(b),B=M.x-T.x,R=M.y-T.y,H=k.x-C.x,ee=k.y-C.y,ie=Math.sqrt((H*H+ee*ee)/(B*B+R*R));return Math.log(ie)/Math.LN2}function mh(m,l,f){const y=Math.cos(f),b=Math.sin(f);return{x:m*y-l*b,y:m*b+l*y}}class Al{constructor(l,f,y,b,T,M,C){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=l||0,this._maxZoom=f||22,this._minPitch=y??0,this._maxPitch=b??60,this.setProjection(M),this.setMaxBounds(C),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new hh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new dh,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const l=new Al(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(l,f=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(l||y)&&this._constrainCamera(f),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const y=!x(f,this.getProjection());return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setMercatorFromTransition(){const l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.getProjection({name:"mercator"});const f=l!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.Point(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const f=-l*Math.PI/180;var y;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(y=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),function(b,T,M){var C=T[0],k=T[1],B=T[2],R=T[3],H=Math.sin(M),ee=Math.cos(M);b[0]=C*ee+B*H,b[1]=k*ee+R*H,b[2]=C*-H+B*ee,b[3]=k*-H+R*ee}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const f=o.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=o.degToRad(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){const f=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const l=this._elevation;this._centerAltitude=l.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=l.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let b=0,T=0;for(let M=0;M<f.length;M++){const C=new o.Point(f[M][0]*this.width,y+f[M][1]*(this.height-y)),k=l.pointCoordinate(C);if(!k)continue;const B=1/Math.hypot(k[0]-this._camera.position[0],k[1]-this._camera.position[1]);b+=k[3]*B,T+=B}return T===0?NaN:b/T}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const l=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*f,b=this._mercatorZfromZoom(l),T=this._mercatorZfromZoom(this._maxZoom),M=Math.max(b-y,T);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let y;y=l.z<this._camera.position[2]?[f.x,f.y,f.z]:[l.x,l.y,l.z];const b=o.length(o.sub([],this._camera.position,y));return o.clamp(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let f=!1;if(l.orientation&&!o.exactEquals(l.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(l.orientation)),l.position){const y=[l.position.x,l.position.y,l.position.z];o.exactEquals$1(y,this._camera.position)||(this._setCameraPosition(y),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,f=new Gy;return f.position=new o.MercatorCoordinate(l[0],l[1],l[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(l){if(!o.length$1(l))return!1;o.normalize$1(l,l);const f=o.transformQuat([],[0,0,-1],l),y=o.transformQuat([],[0,-1,0],l);if(y[2]<0)return!1;const b=Uu(f,y);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(l){const f=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;l[2]=o.clamp(l[2],b/y,b/f),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,f,y){this._unmodified=!1,this._edgeInsets.interpolate(l,f,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const f=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(l){const f=[new o.UnwrappedTileID(0,l)];if(this.renderWorldCopies){const y=this.pointCoordinate(new o.Point(0,0)),b=this.pointCoordinate(new o.Point(this.width,0)),T=this.pointCoordinate(new o.Point(this.width,this.height)),M=this.pointCoordinate(new o.Point(0,this.height)),C=Math.floor(Math.min(y.x,b.x,T.x,M.x)),k=Math.floor(Math.max(y.x,b.x,T.x,M.x)),B=1;for(let R=C-B;R<=k+B;R++)R!==0&&f.push(new o.UnwrappedTileID(R,l))}return f}coveringTiles(l){let f=this.coveringZoomLevel(l);const y=f,b=this.elevation&&!l.isTerrainDEM,T=this.projection.name==="mercator";if(l.minzoom!==void 0&&f<l.minzoom)return[];l.maxzoom!==void 0&&f>l.maxzoom&&(f=l.maxzoom);const M=this.locationCoordinate(this.center),C=this.center.lat,k=1<<f,B=[k*M.x,k*M.y,0],R=this.projection.name==="globe",H=!R,ee=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,H),ie=R?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ae=k*o.mercatorZfromAltitude(1,this.center.lat),oe=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),se=[k*ie.x,k*ie.y,oe*(H?1:ae)],X=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),ne=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?f:0,fe=l.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,de=l.isTerrainDEM?-fe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ee=this.projection.isReprojectedInTileSpace?Wy(this):1,Pe=Ge=>{const gt=new o.MercatorCoordinate(Ge.x+25e-6,Ge.y,Ge.z),lt=new o.MercatorCoordinate(Ge.x,Ge.y+25e-6,Ge.z),_t=Ge.toLngLat(),jt=gt.toLngLat(),Ht=lt.toLngLat(),Dt=this.locationCoordinate(_t),Vt=this.locationCoordinate(jt),dr=this.locationCoordinate(Ht),cr=Math.hypot(Vt.x-Dt.x,Vt.y-Dt.y),Bt=Math.hypot(dr.x-Dt.x,dr.y-Dt.y);return Math.sqrt(cr*Bt)*Ee/25e-6},Ae=Ge=>{const rt=fe,gt=de;return{aabb:o.tileAABB(this,k,0,0,0,Ge,gt,rt,this.projection),zoom:0,x:0,y:0,minZ:gt,maxZ:rt,wrap:Ge,fullyVisible:!1}},je=[];let ze=[];const We=f,pt=l.reparseOverscaled?y:f,Ne=Ge=>Ge*Ge,nt=Ne((oe-this._centerAltitude)*ae),He=Ge=>{if(!this._elevation||!Ge.tileID||!T)return;const rt=this._elevation.getMinMaxForTile(Ge.tileID),gt=Ge.aabb;rt?(gt.min[2]=rt.min,gt.max[2]=rt.max,gt.center[2]=(gt.min[2]+gt.max[2])/2):(Ge.shouldSplit=dt(Ge),Ge.shouldSplit||(gt.min[2]=gt.max[2]=gt.center[2]=this._centerAltitude))},dt=Ge=>{if(Ge.zoom<ne)return!0;if(Ge.zoom===We)return!1;if(Ge.shouldSplit!=null)return Ge.shouldSplit;const rt=Ge.aabb.distanceX(se),gt=Ge.aabb.distanceY(se);let lt=nt,_t=1;if(R){lt=Ne(Ge.aabb.distanceZ(se));const Dt=Math.pow(2,Ge.zoom),Vt=o.latFromMercatorY((Ge.y+1)/Dt),dr=o.latFromMercatorY(Ge.y/Dt),cr=Math.min(Math.max(C,Vt),dr),Bt=o.circumferenceAtLatitude(cr)/o.circumferenceAtLatitude(C);if(_t=cr===C?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Bt/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&Ge.zoom===We-1&&Bt>=.9)return!0}else if(b&&(lt=Ne(Ge.aabb.distanceZ(se)*ae)),this.projection.isReprojectedInTileSpace&&y<=5){const Dt=Math.pow(2,Ge.zoom),Vt=Pe(new o.MercatorCoordinate((Ge.x+.5)/Dt,(Ge.y+.5)/Dt));_t=Vt>.85?1:Vt}const jt=rt*rt+gt*gt+lt,Ht=Ne((1<<We-Ge.zoom)*X*_t*((Dt,Vt)=>{if(Vt*Ne(.707)<Dt)return 1;const dr=Math.sqrt(Vt/Dt);return dr/(1.4144271570014144+(Math.pow(1.1,dr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(lt,nt),jt));return jt<Ht};if(this.renderWorldCopies)for(let Ge=1;Ge<=3;Ge++)je.push(Ae(-Ge)),je.push(Ae(Ge));for(je.push(Ae(0));je.length>0;){const Ge=je.pop(),rt=Ge.x,gt=Ge.y;let lt=Ge.fullyVisible;if(!lt){const _t=Ge.aabb.intersects(ee);if(_t===0)continue;lt=_t===2}if(Ge.zoom!==We&&dt(Ge))for(let _t=0;_t<4;_t++){const jt=(rt<<1)+_t%2,Ht=(gt<<1)+(_t>>1),Dt={aabb:T?Ge.aabb.quadrant(_t):o.tileAABB(this,k,Ge.zoom+1,jt,Ht,Ge.wrap,Ge.minZ,Ge.maxZ,this.projection),zoom:Ge.zoom+1,x:jt,y:Ht,wrap:Ge.wrap,fullyVisible:lt,tileID:void 0,shouldSplit:void 0,minZ:Ge.minZ,maxZ:Ge.maxZ};b&&!R&&(Dt.tileID=new o.OverscaledTileID(Ge.zoom+1===We?pt:Ge.zoom+1,Ge.wrap,Ge.zoom+1,jt,Ht),He(Dt)),je.push(Dt)}else{const _t=Ge.zoom===We?pt:Ge.zoom;if(l.minzoom&&l.minzoom>_t)continue;const jt=B[0]-(.5+rt+(Ge.wrap<<Ge.zoom))*(1<<f-Ge.zoom),Ht=B[1]-.5-gt,Dt=Ge.tileID?Ge.tileID:new o.OverscaledTileID(_t,Ge.wrap,Ge.zoom,rt,gt);ze.push({tileID:Dt,distanceSq:jt*jt+Ht*Ht})}}if(this.fogCullDistSq){const Ge=this.fogCullDistSq,rt=this.horizonLineFromTop();ze=ze.filter(gt=>{const lt=[0,0,0,1],_t=[o.EXTENT,o.EXTENT,0,1],jt=this.calculateFogTileMatrix(gt.tileID.toUnwrapped());o.transformMat4$1(lt,lt,jt),o.transformMat4$1(_t,_t,jt);const Ht=o.getAABBPointSquareDist(lt,_t);if(Ht===0)return!0;let Dt=!1;const Vt=this._elevation;if(Vt&&Ht>Ge&&rt!==0){const dr=this.calculateProjMatrix(gt.tileID.toUnwrapped());let cr;l.isTerrainDEM||(cr=Vt.getMinMaxForTile(gt.tileID)),cr||(cr={min:de,max:fe});const Bt=o.furthestTileCorner(this.rotation),Cr=[Bt[0]*o.EXTENT,Bt[1]*o.EXTENT,cr.max];o.transformMat4(Cr,Cr,dr),Dt=(1-Cr[1])*this.height*.5<rt}return Ht<Ge||Dt})}return ze.sort((Ge,rt)=>Ge.distanceSq-rt.distanceSq).map(Ge=>Ge.tileID)}resize(l,f){this.width=l,this.height=f,this.pixelsToGLUnits=[2/l,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const f=o.clamp(l.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),y=this.projection.project(l.lng,f);return new o.Point(y.x*this.worldSize,y.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(l,f){let y,b;const T=this.centerPoint;if(this.projection.name==="globe"){const C=this.worldSize;y=(f.x-T.x)/C,b=(f.y-T.y)/C}else{const C=this.pointCoordinate(f),k=this.pointCoordinate(T);y=C.x-k.x,b=C.y-k.y}const M=this.locationCoordinate(l);this.setLocation(new o.MercatorCoordinate(M.x-y,M.y-b))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,f){const y=f?o.mercatorZfromAltitude(f,l.lat):void 0,b=this.projection.project(l.lng,l.lat);return new o.MercatorCoordinate(b.x,b.y,y)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,f){const y=f??this._centerAltitude,b=[l.x,l.y,0,1],T=[l.x,l.y,1,1];o.transformMat4$1(b,b,this.pixelMatrixInverse),o.transformMat4$1(T,T,this.pixelMatrixInverse);const M=T[3];o.scale$1(b,b,1/b[3]),o.scale$1(T,T,1/M);const C=b[2],k=T[2];return{p0:b,p1:T,t:C===k?0:(y-C)/(k-C)}}screenPointToMercatorRay(l){const f=[l.x,l.y,0,1],y=[l.x,l.y,1,1];return o.transformMat4$1(f,f,this.pixelMatrixInverse),o.transformMat4$1(y,y,this.pixelMatrixInverse),o.scale$1(f,f,1/f[3]),o.scale$1(y,y,1/y[3]),f[2]=o.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,y[2]=o.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,o.scale$1(f,f,1/this.worldSize),o.scale$1(y,y,1/this.worldSize),new o.Ray([f[0],f[1],f[2]],o.normalize([],o.sub([],y,f)))}rayIntersectionCoordinate(l){const{p0:f,p1:y,t:b}=l,T=o.mercatorZfromAltitude(f[2],this._center.lat),M=o.mercatorZfromAltitude(y[2],this._center.lat);return new o.MercatorCoordinate(o.number(f[0],y[0],b)/this.worldSize,o.number(f[1],y[1],b)/this.worldSize,o.number(T,M,b))}pointCoordinate(l,f=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,f)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let f=this.projection.pointCoordinate3D(this,l.x,l.y);if(f)return new o.MercatorCoordinate(f[0],f[1],f[2]);let y=0,b=this.horizonLineFromTop();if(l.y>b)return this.pointCoordinate(l);const T=.02*b,M=l.clone();for(let C=0;C<10&&b-y>T;C++){M.y=o.number(y,b,.66);const k=this.projection.pointCoordinate3D(this,M.x,M.y);k?(b=M.y,f=k):y=M.y}return f?new o.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}isPointOnSurface(l){if(l.y<0||l.y>this.height||l.x<0||l.x>this.width)return!1;if(this.elevation||this.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(l);const f=this.pointCoordinate(l);return f.y>=0&&f.y<=1}_coordinatePoint(l,f){const y=f&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,b=[l.x*this.worldSize,l.y*this.worldSize,y+l.toAltitude(),1];return o.transformMat4$1(b,b,this.pixelMatrix),b[3]>0?new o.Point(b[0]/b[3],b[1]/b[3]):new o.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:l,left:f}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,T=this.pointLocation3D(new o.Point(f,l)),M=this.pointLocation3D(new o.Point(b,l)),C=this.pointLocation3D(new o.Point(b,y)),k=this.pointLocation3D(new o.Point(f,y));let B=Math.min(T.lng,M.lng,C.lng,k.lng),R=Math.max(T.lng,M.lng,C.lng,k.lng),H=Math.min(T.lat,M.lat,C.lat,k.lat),ee=Math.max(T.lat,M.lat,C.lat,k.lat);const ie=Math.pow(2,-this.zoom)/16*270,ae=this.projection.name==="globe"?1:4,oe=(se,X,ne,fe,de)=>{const Ee=(se+ne)/2,Pe=(X+fe)/2,Ae=new o.Point(Ee,Pe),{lng:je,lat:ze}=this.pointLocation3D(Ae),We=Math.max(0,B-je,H-ze,je-R,ze-ee);B=Math.min(B,je),R=Math.max(R,je),H=Math.min(H,ze),ee=Math.max(ee,ze),(de<ae||We>ie)&&(oe(se,X,Ee,Pe,de+1),oe(Ee,Pe,ne,fe,de+1))};if(oe(f,l,b,l,1),oe(b,l,b,y,1),oe(b,y,f,y,1),oe(f,y,f,l,1),this.projection.name==="globe"){const[se,X]=o.polesInViewport(this);se?(ee=90,R=180,B=-180):X&&(H=-90,R=180,B=-180)}return new o.LngLatBounds(new o.LngLat(B,H),new o.LngLat(R,ee))}_getBoundsRectangular(l,f){const{top:y,left:b}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,M=this.width-this._edgeInsets.right,C=new o.Point(b,y),k=new o.Point(M,y),B=new o.Point(M,T),R=new o.Point(b,T);let H=this.pointCoordinate(C,l),ee=this.pointCoordinate(k,l);const ie=this.pointCoordinate(B,f),ae=this.pointCoordinate(R,f),oe=(se,X)=>(X.y-se.y)/(X.x-se.x);return H.y>1&&ee.y>=0?H=new o.MercatorCoordinate((1-ae.y)/oe(ae,H)+ae.x,1):H.y<0&&ee.y<=1&&(H=new o.MercatorCoordinate(-ae.y/oe(ae,H)+ae.x,0)),ee.y>1&&H.y>=0?ee=new o.MercatorCoordinate((1-ie.y)/oe(ie,ee)+ie.x,1):ee.y<0&&H.y<=1&&(ee=new o.MercatorCoordinate(-ie.y/oe(ie,ee)+ie.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(H)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(ae)).extend(this.coordinateLocation(ie))}_getBoundsRectangularTerrain(){const l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBoundsRectangular(0,0);const f=l.visibleDemTiles.reduce((y,b)=>{if(b.dem){const T=b.dem.tree;y.min=Math.min(y.min,T.minimums[0]),y.max=Math.max(y.max,T.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(f.min*l.exaggeration(),f.max*l.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(l=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,y=this.height/2-f*(1-this._horizonShift);return l?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,f){return this.projection.createTileMatrix(this,f,l)}calculateDistanceTileData(l){const f=l.key,y=this._distanceTileDataCache;if(y[f])return y[f];const b=l.canonical,T=1/this.height,M=this.cameraWorldSize,C=M/this.zoomScale(b.z),k=(b.x+Math.pow(2,b.z)*l.wrap)*C,B=b.y*C,R=this.point;R.x*=M/this.worldSize,R.y*=M/this.worldSize;const H=this.angle,ee=Math.sin(-H),ie=-Math.cos(-H);return y[f]={bearing:[ee,ie],center:[(R.x-k)*T,(R.y-B)*T],scale:C/o.EXTENT*T},y[f]}calculateFogTileMatrix(l){const f=l.key,y=this._fogTileMatrixCache;if(y[f])return y[f];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return o.multiply(b,this.worldToFogMatrix,b),y[f]=new Float32Array(b),y[f]}calculateProjMatrix(l,f=!1){const y=l.key,b=f?this._alignedProjMatrixCache:this._projMatrixCache;if(b[y])return b[y];const T=this.calculatePosMatrix(l,this.worldSize);return o.multiply(T,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.alignedProjMatrix:this.projMatrix,T),b[y]=new Float32Array(T),b[y]}calculatePixelsToTileUnitsMatrix(l){const f=l.tileID.key,y=this._pixelsToTileUnitsCache;if(y[f])return y[f];const b=function(T,M){const{scale:C}=T.tileTransform,k=C*o.EXTENT/(T.tileSize*Math.pow(2,M.zoom-T.tileID.overscaledZ+T.tileID.canonical.z));return B=new Float32Array(4),ee=(R=M.inverseAdjustmentMatrix)[1],ie=R[2],ae=R[3],se=(H=[k,k])[1],B[0]=R[0]*(oe=H[0]),B[1]=ee*oe,B[2]=ie*se,B[3]=ae*se,B;var B,R,H,ee,ie,ae,oe,se}(l,this);return y[f]=b,y[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const l=1/this.worldSize,f=o.fromScaling([],[l,l,l]);return o.multiply(f,f,this.globeMatrix),f}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const l=this._elevation;this._updateCameraState();const f=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(f),b=this._camera.forward(),T=o.mercatorZfromAltitude(1,this._center.lat);y[2]/=T,b[2]/=T,o.normalize(b,b);const M=l.raycast(y,b,l.exaggeration());if(M){const C=o.scaleAndAdd([],y,b,M),k=new o.MercatorCoordinate(C[0],C[1],o.mercatorZfromAltitude(C[2],o.latFromMercatorY(C[1]))),B=(k.z+o.length([k.x-y[0],k.y-y[1],k.z-y[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(B),this._centerAltitude=k.toAltitude(),this._center=this.coordinateLocation(k),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;const f=this._elevation,y=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(y),T=f.getAtPointOrZero(new o.MercatorCoordinate(...b)),M=this.pixelsPerMeter/this.worldSize*T,C=this._minimumHeightOverTerrain(),k=b[2]-M;if(k<=C)if(k<0||l){const B=this.locationCoordinate(this._center,this._centerAltitude),R=[b[0],b[1],B.z-b[2]],H=o.length(R);R[2]-=(C-k)/this._pixelsPerMercatorPixel;const ee=o.length(R);if(ee===0)return;o.scale$2(R,R,H/ee*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],B.z*this._pixelsPerMercatorPixel-R[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){const ee=this.center;return ee.lat=o.clamp(ee.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(ee.lng=o.clamp(ee.lng,this.minLng,this.maxLng)),this.center=ee,void(this._constraining=!1)}const f=this._unmodified,{x:y,y:b}=this.point;let T=0,M=y,C=b;const k=this.width/2,B=this.height/2,R=this.worldMinY*this.scale,H=this.worldMaxY*this.scale;if(b-B<R&&(C=R+B),b+B>H&&(C=H-B),H-R<this.height&&(T=Math.max(T,this.height/(H-R)),C=(H+R)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ee=this.worldMinX*this.scale,ie=this.worldMaxX*this.scale,ae=this.worldSize/2-(ee+ie)/2;M=(y+ae+this.worldSize)%this.worldSize-ae,M-k<ee&&(M=ee+k),M+k>ie&&(M=ie-k),ie-ee<this.width&&(T=Math.max(T,this.width/(ie-ee)),M=(ie+ee)/2)}M===y&&C===b||(this.center=this.unproject(new o.Point(M,C))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.mercatorZfromAltitude(1,this.center.lat)/o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE));const y=ph(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b=this.projection.zAxisUnit==="meters"?f:1,T=this._camera.getWorldToCamera(this.worldSize,b),M=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);M[8]=2*-l.x/this.width,M[9]=2*l.y/this.height;let C=o.mul([],M,T);if(this.projection.isReprojectedInTileSpace){const Pe=this.locationCoordinate(this.center),Ae=o.identity([]);o.translate(Ae,Ae,[Pe.x*this.worldSize,Pe.y*this.worldSize,0]),o.multiply(Ae,Ae,El(this)),o.translate(Ae,Ae,[-Pe.x*this.worldSize,-Pe.y*this.worldSize,0]),o.multiply(C,C,Ae),this.inverseAdjustmentMatrix=function(je){const ze=El(je,!0);return ge([],[ze[0],ze[1],ze[4],ze[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],C,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=C,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const k=o.invert([],M);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(k,this.horizonLineFromTop(),this.height);const B=new Float32Array(16);o.identity(B),o.scale(B,B,[1,-1,1]),o.rotateX(B,B,this._pitch),o.rotateZ(B,B,this.angle);const R=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),H=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;R[8]=2*-l.x/this.width,R[9]=2*(l.y+H)/this.height,this.skyboxMatrix=o.multiply(B,R,B);const ee=this.point,ie=ee.x,ae=ee.y,oe=this.width%2/2,se=this.height%2/2,X=Math.cos(this.angle),ne=Math.sin(this.angle),fe=ie-Math.round(ie)+X*oe+ne*se,de=ae-Math.round(ae)+X*se+ne*oe,Ee=new Float64Array(C);if(o.translate(Ee,Ee,[fe>.5?fe-1:fe,de>.5?de-1:de,0]),this.alignedProjMatrix=Ee,C=o.create(),o.scale(C,C,[this.width/2,-this.height/2,1]),o.translate(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=o.create(),o.scale(C,C,[1,-1,1]),o.translate(C,C,[-1,-1,0]),o.scale(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},C=o.invert(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=C,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const Pe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(Pe,Pe,T),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=C;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSizeForFog,f=this.cameraPixelsPerMeter,y=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,T=[l,l,f];o.scale$2(T,T,b),o.scale$2(y,y,-1),o.multiply$2(y,y,T);const M=o.create();o.translate(M,M,y),o.scale(M,M,T),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,f,b)}_computeCameraPosition(l){const f=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),b=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-l/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-y[0]*T,b.y/this.worldSize-y[1]*T,l/this.worldSize*this._centerAltitude-y[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],b=l[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(T=Math.min((f-y)/b,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,l,T),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,f=this._camera.forward(),{pitch:y,bearing:b}=this._camera.getPitchBearing(),T=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),C=Math.max((l[2]-T)/Math.cos(y),M),k=this._zoomFromMercatorZ(C);o.scaleAndAdd(l,l,f,C),this._pitch=o.clamp(y,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(b,-Math.PI,Math.PI),this._setZoom(o.clamp(k,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){let f=0,y=o.GLOBE_ZOOM_THRESHOLD_MAX,b=0,T=1/0;for(;y-f>1e-6&&y>f;){const M=f+.5*(y-f),C=this.tileSize*Math.pow(2,M),k=this.getCameraToCenterDistance(this.projection,M,C),B=this.scaleZoom(k/(l*this.tileSize)),R=Math.abs(M-B);R<T&&(T=R,b=M),M<B?f=M:y=M}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,f){const y=Math.min(l.x,f.x),b=Math.max(l.x,f.x),T=Math.min(l.y,f.y),M=Math.max(l.y,f.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const C=[new o.Point(y,T),new o.Point(b,M),new o.Point(y,M),new o.Point(b,T)],k=this.renderWorldCopies?-3:0,B=this.renderWorldCopies?4:1;for(const R of C){const H=this.pointRayIntersection(R);if(H.t<0)return!0;const ee=this.rayIntersectionCoordinate(H);if(ee.x<k||ee.y<0||ee.x>B||ee.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.Point(0,0),new o.Point(this.width,this.height))}zoomDeltaToMovement(l,f){const y=o.length(o.sub([],this._camera.position,l)),b=this._zoomFromMercatorZ(y)+f;return y-this._mercatorZfromZoom(b)}getCameraPoint(){if(this.projection.name==="globe"){const l=function([f,y,b],T){const M=[f,y,b,1];o.transformMat4$1(M,M,T);const C=M[3]=Math.max(M[3],1e-6);return M[0]/=C,M[1]/=C,M[2]/=C,M}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.Point(l[0],l[1])}{const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,l))}}getCameraToCenterDistance(l,f=this.zoom,y=this.worldSize){const b=ph(l,f,this.width,this.height,1024),T=l.pixelSpaceConversion(this.center.lat,y,b);return .5/Math.tan(.5*this._fov)*this.height*T}getWorldToCameraMatrix(){const l=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.multiply(l,l,this.globeMatrix),l}}function Pl(m,l){let f=!1,y=null;const b=()=>{y=null,f&&(m(),y=setTimeout(b,l),f=!1)};return()=>(f=!0,y||b(),y)}class mp{constructor(l){this._hashName=l&&encodeURIComponent(l),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Pl(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,o.window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const l=this._map;if(!l)return"";const f=Vu(l);if(this._hashName){const y=this._hashName;let b=!1;const T=o.window.location.hash.slice(1).split("&").map(M=>{const C=M.split("=")[0];return C===y?(b=!0,`${C}=${f}`):M}).filter(M=>M);return b||T.push(`${y}=${f}`),`#${T.join("&")}`}return`#${f}`}_getCurrentHash(){const l=o.window.location.hash.replace("#","");if(this._hashName){let f;return l.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(f=y)}),(f&&f[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._map;if(!l)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(y=>isNaN(y))){const y=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(f[3]||0):l.getBearing();return l.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:y,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,l)}}function Vu(m,l){const f=m.getCenter(),y=Math.round(100*m.getZoom())/100,b=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,b),M=Math.round(f.lng*T)/T,C=Math.round(f.lat*T)/T,k=m.getBearing(),B=m.getPitch();let R=l?`/${M}/${C}/${y}`:`${y}/${C}/${M}`;return(k||B)&&(R+="/"+Math.round(10*k)/10),B&&(R+=`/${Math.round(B)}`),R}const Gu={linearity:.3,easing:o.bezier(0,0,.3,1)},gh=o.extend({deceleration:2500,maxSpeed:1400},Gu),yh=o.extend({deceleration:20,maxSpeed:1400},Gu),Ct=o.extend({deceleration:1e3,maxSpeed:360},Gu),wo=o.extend({deceleration:1e3,maxSpeed:90},Gu);class Zy{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,f=o.exported.now();for(;l.length>0&&f-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const f={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)f.zoom+=T.zoomDelta||0,f.bearing+=T.bearingDelta||0,f.pitch+=T.pitchDelta||0,T.panDelta&&f.pan._add(T.panDelta),T.around&&(f.around=T.around),T.pinchAround&&(f.pinchAround=T.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(f.pan.mag()){const T=qu(f.pan.mag(),y,o.extend({},gh,l||{}));b.offset=f.pan.mult(T.amount/f.pan.mag()),b.center=this._map.transform.center,Wu(b,T)}if(f.zoom){const T=qu(f.zoom,y,yh);b.zoom=this._map.transform.zoom+T.amount,Wu(b,T)}if(f.bearing){const T=qu(f.bearing,y,Ct);b.bearing=this._map.transform.bearing+o.clamp(T.amount,-179,179),Wu(b,T)}if(f.pitch){const T=qu(f.pitch,y,wo);b.pitch=this._map.transform.pitch+T.amount,Wu(b,T)}if(b.zoom||b.bearing){const T=f.pinchAround===void 0?f.around:f.pinchAround;b.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function Wu(m,l){(!m.duration||m.duration<l.duration)&&(m.duration=l.duration,m.easing=l.easing)}function qu(m,l,f){const{maxSpeed:y,linearity:b,deceleration:T}=f,M=o.clamp(m*b/(l/1e3),-y,y),C=Math.abs(M)/(T*b);return{easing:f.easing,duration:1e3*C,amount:M*(C/2)}}class Xn extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,y,b={}){const T=K(f.getCanvasContainer(),y),M=f.unproject(T);super(l,o.extend({point:T,lngLat:M,originalEvent:y},b)),this._defaultPrevented=!1,this.target=f}}class Zu extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,y){const b=l==="touchend"?y.changedTouches:y.touches,T=re(f.getCanvasContainer(),b),M=T.map(k=>f.unproject(k)),C=T.reduce((k,B,R,H)=>k.add(B.div(H.length)),new o.Point(0,0));super(l,{points:T,point:C,lngLats:M,lngLat:f.unproject(C),originalEvent:y}),this._defaultPrevented=!1}}class _h extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,y){super(l,{originalEvent:y}),this._defaultPrevented=!1}}class gp{constructor(l,f){this._map=l,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new _h(l.type,this._map,l))}mousedown(l,f){return this._mousedownPos=f,this._firePreventable(new Xn(l.type,this._map,l))}mouseup(l){this._map.fire(new Xn(l.type,this._map,l))}preclick(l){const f=o.extend({},l);f.type="preclick",this._map.fire(new Xn(f.type,this._map,f))}click(l,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(l),this._map.fire(new Xn(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new Xn(l.type,this._map,l))}mouseover(l){this._map.fire(new Xn(l.type,this._map,l))}mouseout(l){this._map.fire(new Xn(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Zu(l.type,this._map,l))}touchmove(l){this._map.fire(new Zu(l.type,this._map,l))}touchend(l){this._map.fire(new Zu(l.type,this._map,l))}touchcancel(l){this._map.fire(new Zu(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vh{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new Xn(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Xn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new Xn(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hy{constructor(l,f){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,f){this.isEnabled()&&l.shiftKey&&l.button===0&&(V(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(l,f){if(!this._active)return;const y=f,b=this._startPos,T=this._lastPos;if(!b||!T||T.equals(y)||!this._box&&y.dist(b)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=L("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const M=Math.min(b.x,y.x),C=Math.max(b.x,y.x),k=Math.min(b.y,y.y),B=Math.max(b.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${k}px)`,this._box.style.width=C-M+"px",this._box.style.height=B-k+"px")})}mouseupWindow(l,f){if(!this._active)return;const y=this._startPos,b=f;if(y&&l.button===0){if(this.reset(),q(),y.x!==b.x||y.y!==b.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:T=>T.fitScreenCoordinates(y,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),U(),delete this._startPos,delete this._lastPos}_fireEvent(l,f){return this._map.fire(new o.Event(l,{originalEvent:f}))}}function xh(m,l){const f={};for(let y=0;y<m.length;y++)f[m[y].identifier]=l[y];return f}class Ml{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,f,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=l.timeStamp),y.length===this.numTouches&&(this.centroid=function(b){const T=new o.Point(0,0);for(const M of b)T._add(M);return T.div(b.length)}(f),this.touches=xh(y,f)))}touchmove(l,f,y){if(this.aborted||!this.centroid)return;const b=xh(y,f);for(const T in this.touches){const M=b[T];(!M||M.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(l,f,y){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class yp{constructor(l){this.singleTap=new Ml(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,f,y){this.singleTap.touchstart(l,f,y)}touchmove(l,f,y){this.singleTap.touchmove(l,f,y)}touchend(l,f,y){const b=this.singleTap.touchend(l,f,y);if(b){const T=l.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(b)<30;if(T&&M||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class N1{constructor(){this._zoomIn=new yp({numTouches:1,numTaps:2}),this._zoomOut=new yp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,f,y){this._zoomIn.touchstart(l,f,y),this._zoomOut.touchstart(l,f,y)}touchmove(l,f,y){this._zoomIn.touchmove(l,f,y),this._zoomOut.touchmove(l,f,y)}touchend(l,f,y){const b=this._zoomIn.touchend(l,f,y),T=this._zoomOut.touchend(l,f,y);return b?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(b)},{originalEvent:l})}):T?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(T)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Xy={0:1,2:2};class Cl{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,f){return!1}_move(l,f){return{}}mousedown(l,f){if(this._lastPoint)return;const y=pe(l);this._correctButton(l,y)&&(this._lastPoint=f,this._eventButton=y)}mousemoveWindow(l,f){const y=this._lastPoint;if(y){if(l.preventDefault(),this._eventButton!=null&&function(b,T){const M=Xy[T];return b.buttons===void 0||(b.buttons&M)!==M}(l,this._eventButton))this.reset();else if(this._moved||!(f.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(y,f)}}mouseupWindow(l){this._lastPoint&&pe(l)===this._eventButton&&(this._moved&&q(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _p extends Cl{mousedown(l,f){super.mousedown(l,f),this._lastPoint&&(this._active=!0)}_correctButton(l,f){return f===0&&!l.ctrlKey}_move(l,f){return{around:f,panDelta:f.sub(l)}}}class vp extends Cl{_correctButton(l,f){return f===0&&l.ctrlKey||f===2}_move(l,f){const y=.8*(f.x-l.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(l){l.preventDefault()}}class xp extends Cl{_correctButton(l,f){return f===0&&l.ctrlKey||f===2}_move(l,f){const y=-.5*(f.y-l.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(l){l.preventDefault()}}class bh{constructor(l,f){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)}touchstart(l,f,y){return this._calculateTransform(l,f,y)}touchmove(l,f,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!o.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,f,y)}}touchend(l,f,y){this._calculateTransform(l,f,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,f,y){y.length>0&&(this._active=!0);const b=xh(y,f),T=new o.Point(0,0),M=new o.Point(0,0);let C=0;for(const B in b){const R=b[B],H=this._touches[B];H&&(T._add(R),M._add(R.sub(H)),C++,b[B]=R)}if(this._touches=b,C<this._minTouches||!M.mag())return;const k=M.div(C);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(C),panDelta:k}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Hu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,f,y){return{}}touchstart(l,f,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([f[0],f[1]]))}touchmove(l,f,y){const b=this._firstTwoTouches;if(!b)return;l.preventDefault();const[T,M]=b,C=Xu(y,f,T),k=Xu(y,f,M);if(!C||!k)return;const B=this._aroundCenter?null:C.add(k).div(2);return this._move([C,k],B,l)}touchend(l,f,y){if(!this._firstTwoTouches)return;const[b,T]=this._firstTwoTouches,M=Xu(y,f,b),C=Xu(y,f,T);M&&C||(this._active&&q(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Xu(m,l,f){for(let y=0;y<m.length;y++)if(m[y].identifier===f)return l[y]}function bp(m,l){return Math.log(m/l)/Math.LN2}class Ky extends Hu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,f){const y=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(bp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bp(this._distance,y),pinchAround:f}}}function wp(m,l){return 180*m.angleWith(l)/Math.PI}class Yy extends Hu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,f){const y=this._vector;if(this._vector=l[0].sub(l[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:wp(this._vector,y),pinchAround:f}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const f=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const b=wp(l,y);return Math.abs(b)<f}}function es(m){return Math.abs(m.y)>Math.abs(m.x)}class Jy extends Hu{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,es(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,f,y){const b=this._lastPoints;if(!b)return;const T=l[0].sub(b[0]),M=l[1].sub(b[1]);return this._map._cooperativeGestures&&!o.isFullscreen()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(T,M,y.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(T.y+M.y)/2*-.5})}gestureBeginsVertically(l,f,y){if(this._valid!==void 0)return this._valid;const b=l.mag()>=2,T=f.mag()>=2;if(!b&&!T)return;if(!b||!T)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const M=l.y>0==f.y>0;return es(l)&&es(f)&&M}}const Qy={panStep:100,bearingStep:15,pitchStep:10};class U1{constructor(){const l=Qy;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let f=0,y=0,b=0,T=0,M=0;switch(l.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:l.shiftKey?y=-1:(l.preventDefault(),T=-1);break;case 39:l.shiftKey?y=1:(l.preventDefault(),T=1);break;case 38:l.shiftKey?b=1:(l.preventDefault(),M=-1);break;case 40:l.shiftKey?b=-1:(l.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(y=0,b=0),{cameraAnimation:C=>{const k=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:e_,zoom:f?Math.round(k)+f*(l.shiftKey?2:1):k,bearing:C.getBearing()+y*this._bearingStep,pitch:C.getPitch()+b*this._pitchStep,offset:[-T*this._panStep,-M*this._panStep],center:C.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function e_(m){return m*(2-m)}const Tp=4.000244140625;class t_{constructor(l,f){this._map=l,this._el=l.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||o.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=l.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const y=o.exported.now(),b=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,f!==0&&f%Tp==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(b*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),l.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=l,this._delta-=f,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=K(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;this._type==="wheel"&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>Tp?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&B!==0&&(B=1/B);const R=f(),H=Math.pow(2,R),ee=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):H;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(ee*B))),this._type==="wheel"&&(this._startZoom=R,this._easing=this._smoothOutEasing(200)),this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:f(),b=this._startZoom,T=this._easing;let M,C=!1;if(this._type==="wheel"&&b&&T){const k=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),B=T(k);M=o.number(b,y,B),k<1?this._frameId||(this._frameId=!0):C=!0}else M=y,C=!0;return this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!C,zoomDelta:M-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let f=o.ease;if(this._prevEase){const y=this._prevEase,b=(o.exported.now()-y.start)/y.duration,T=y.easing(b+.01)-y.easing(b),M=.27/Math.sqrt(T*T+1e-4)*.01,C=Math.sqrt(.0729-M*M);f=o.bezier(M,C,.25,1)}return this._prevEase={start:o.exported.now(),duration:l,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class r_{constructor(l,f){this._clickZoom=l,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class pi{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,f){return l.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(l.shiftKey?-1:1),around:y.unproject(f)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class V1{constructor(){this._tap=new yp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,f,y){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=f[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(l,f,y))}touchmove(l,f,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const b=f[0],T=b.y-this._swipePoint.y;return this._swipePoint=b,l.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(l,f,y)}touchend(l,f,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(l,f,y)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class n_{constructor(l,f,y){this._el=l,this._mousePan=f,this._touchPan=y}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class G1{constructor(l,f,y){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=f,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class W1{constructor(l,f,y,b){this._el=l,this._touchZoom=f,this._touchRotate=y,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const so=m=>m.zoom||m.drag||m.pitch||m.rotate;class i_ extends o.Event{}class q1{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,f){const y=o.sub([],f,l);this.radius=o.length(y[2]<0?o.div([],y,this.constants):[y[0],y[1],0])}projectRay(l){o.div(l,l,this.constants),o.normalize(l,l),o.mul$1(l,l,this.constants);const f=o.scale$2([],l,this.radius);if(f[2]>0){const y=o.scale$2([],[0,0,1],o.dot(f,[0,0,1])),b=o.scale$2([],o.normalize([],[f[0],f[1],0]),this.radius),T=o.add([],f,o.scale$2([],o.sub([],o.add([],b,y),f),2));f[0]=T[0],f[1]=T[1]}return f}}function To(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Vo{constructor(l,f){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zy(l),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new q1,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),o.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[b,T,M]of this._listeners)b.addEventListener(T,b===o.window.document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[l,f,y]of this._listeners)l.removeEventListener(f,l===o.window.document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(l){const f=this._map,y=f.getCanvasContainer();this._add("mapEvent",new gp(f,l));const b=f.boxZoom=new Hy(f,l);this._add("boxZoom",b);const T=new N1,M=new pi;f.doubleClickZoom=new r_(M,T),this._add("tapZoom",T),this._add("clickZoom",M);const C=new V1;this._add("tapDragZoom",C);const k=f.touchPitch=new Jy(f);this._add("touchPitch",k);const B=new vp(l),R=new xp(l);f.dragRotate=new G1(l,B,R),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",R,["mouseRotate"]);const H=new _p(l),ee=new bh(f,l);f.dragPan=new n_(y,H,ee),this._add("mousePan",H),this._add("touchPan",ee,["touchZoom","touchRotate"]);const ie=new Yy,ae=new Ky;f.touchZoomRotate=new W1(y,ae,ie,C),this._add("touchRotate",ie,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]),this._add("blockableMapEvent",new vh(f));const oe=f.scrollZoom=new t_(f,this);this._add("scrollZoom",oe,["mousePan"]);const se=f.keyboard=new U1;this._add("keyboard",se);for(const X of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[X]&&f[X].enable(l[X])}_add(l,f,y){this._handlers.push({handlerName:l,handler:f,allowed:y}),this._handlersById[l]=f}stop(l){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!so(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,f,y){for(const b in l)if(b!==y&&(!f||f.indexOf(b)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const f=[];for(const y of l)this._el.contains(y.target)&&f.push(y);return f}handleEvent(l,f){this._updatingCamera=!0;const y=l.type==="renderFrame",b=y?void 0:l,T={needsRenderFrame:!1},M={},C={},k=l.touches?this._getMapTouches(l.touches):void 0,B=k?re(this._el,k):y?void 0:K(this._el,l);for(const{handlerName:ee,handler:ie,allowed:ae}of this._handlers){if(!ie.isEnabled())continue;let oe;this._blockedByActive(C,ae,ee)?ie.reset():ie[f||l.type]&&(oe=ie[f||l.type](l,B,k),this.mergeHandlerResult(T,M,oe,ee,b),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()),(oe||ie.isActive())&&(C[ee]=ie)}const R={};for(const ee in this._previousActiveHandlers)C[ee]||(R[ee]=b);this._previousActiveHandlers=C,(Object.keys(R).length||To(T))&&(this._changes.push([T,M,R]),this._triggerRenderFrame()),(Object.keys(C).length||To(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:H}=T;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))}mergeHandlerResult(l,f,y,b,T){if(!y)return;o.extend(l,y);const M={handlerName:b,originalEvent:y.originalEvent||T};y.zoomDelta!==void 0&&(f.zoom=M),y.panDelta!==void 0&&(f.drag=M),y.pitchDelta!==void 0&&(f.pitch=M),y.bearingDelta!==void 0&&(f.rotate=M)}_applyChanges(){const l={},f={},y={};for(const[b,T,M]of this._changes)b.panDelta&&(l.panDelta=(l.panDelta||new o.Point(0,0))._add(b.panDelta)),b.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(l.around=b.around),b.aroundCoord!==void 0&&(l.aroundCoord=b.aroundCoord),b.pinchAround!==void 0&&(l.pinchAround=b.pinchAround),b.noInertia&&(l.noInertia=b.noInertia),o.extend(f,T),o.extend(y,M);this._updateMapTransform(l,f,y),this._changes=[]}_updateMapTransform(l,f,y){const b=this._map,T=b.transform,M=ne=>[ne.x,ne.y,ne.z];if((ne=>{const fe=this._eventsInProgress.drag;return fe&&!this._handlersById[fe.handlerName].isActive()})()&&!To(l)){const ne=T.zoom;T.cameraElevationReference="sea",T.recenterOnTerrain(),T.cameraElevationReference="ground",ne!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&b._stop(!0),!To(l))return void this._fireEvents(f,y,!0);let{panDelta:C,zoomDelta:k,bearingDelta:B,pitchDelta:R,around:H,aroundCoord:ee,pinchAround:ie}=l;T._isCameraConstrained&&(k>0&&(k=0),T._isCameraConstrained=!1),ie!==void 0&&(H=ie),(k||(ne=>f[ne]&&!this._eventsInProgress[ne])("drag"))&&H&&(this._dragOrigin=M(T.pointCoordinate3D(H)),this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",b._stop(!0),H=H||b.transform.centerPoint,B&&(T.bearing+=B),R&&(T.pitch+=R),T._updateCameraState();const ae=[0,0,0];if(C)if(T.projection.name==="mercator"){const ne=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(H).dir),fe=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(H.sub(C)).dir);ae[0]=fe[0]-ne[0],ae[1]=fe[1]-ne[1]}else{const ne=T.pointCoordinate(H);if(T.projection.name==="globe"){C=C.rotate(-T.angle);const fe=T._pixelsPerMercatorPixel/T.worldSize;ae[0]=-C.x*o.mercatorScale(o.latFromMercatorY(ne.y))*fe,ae[1]=-C.y*o.mercatorScale(T.center.lat)*fe}else{const fe=T.pointCoordinate(H.sub(C));ne&&fe&&(ae[0]=fe.x-ne.x,ae[1]=fe.y-ne.y)}}const oe=T.zoom,se=[0,0,0];if(k){const ne=M(ee||T.pointCoordinate3D(H)),fe={dir:o.normalize([],o.sub([],ne,T._camera.position))};if(fe.dir[2]<0){const de=T.zoomDeltaToMovement(ne,k);o.scale$2(se,fe.dir,de)}}const X=o.add(ae,ae,se);T._translateCameraConstrained(X),k&&Math.abs(T.zoom-oe)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(f,y,!0)}_fireEvents(l,f,y){const b=so(this._eventsInProgress),T=so(l),M={};for(const R in l){const{originalEvent:H}=l[R];this._eventsInProgress[R]||(M[`${R}start`]=H),this._eventsInProgress[R]=l[R]}!b&&T&&this._fireEvent("movestart",T.originalEvent);for(const R in M)this._fireEvent(R,M[R]);T&&this._fireEvent("move",T.originalEvent);for(const R in l){const{originalEvent:H}=l[R];this._fireEvent(R,H)}const C={};let k;for(const R in this._eventsInProgress){const{handlerName:H,originalEvent:ee}=this._eventsInProgress[R];this._handlersById[H].isActive()||(delete this._eventsInProgress[R],k=f[H]||ee,C[`${R}end`]=k)}for(const R in C)this._fireEvent(R,C[R]);const B=so(this._eventsInProgress);if(y&&(b||T)&&!B){this._updatingCamera=!0;const R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=ee=>ee!==0&&-this._bearingSnap<ee&&ee<this._bearingSnap;R?(H(R.bearing||this._map.getBearing())&&(R.bearing=0),this._map.easeTo(R,{originalEvent:k})):(this._map.fire(new o.Event("moveend",{originalEvent:k})),H(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,f){this._map.fire(new o.Event(l,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{this._frameId=void 0,this.handleEvent(new i_("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Is="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class wh extends o.Evented{constructor(l,f){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=f.bearingSnap,this._respectPrefersReducedMotion=f.respectPrefersReducedMotion!==!1,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,f){return this.jumpTo({center:l},f)}panBy(l,f,y){return l=o.Point.convert(l).mult(-1),this.panTo(this.transform.center,o.extend({offset:l},f),y)}panTo(l,f,y){return this.easeTo(o.extend({center:l},f),y)}getZoom(){return this.transform.zoom}setZoom(l,f){return this.jumpTo({zoom:l},f),this}zoomTo(l,f,y){return this.easeTo(o.extend({zoom:l},f),y)}zoomIn(l,f){return this.zoomTo(this.getZoom()+1,l,f),this}zoomOut(l,f){return this.zoomTo(this.getZoom()-1,l,f),this}getBearing(){return this.transform.bearing}setBearing(l,f){return this.jumpTo({bearing:l},f),this}getPadding(){return this.transform.padding}setPadding(l,f){return this.jumpTo({padding:l},f),this}rotateTo(l,f,y){return this.easeTo(o.extend({bearing:l},f),y)}resetNorth(l,f){return this.rotateTo(0,o.extend({duration:1e3},l),f),this}resetNorthPitch(l,f){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},l),f),this}snapToNorth(l,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,f):this}getPitch(){return this.transform.pitch}setPitch(l,f){return this.jumpTo({pitch:l},f),this}cameraForBounds(l,f){l=o.LngLatBounds.convert(l);const y=f&&f.bearing||0,b=f&&f.pitch||0,T=l.getNorthWest(),M=l.getSouthEast();return this._cameraForBounds(this.transform,T,M,y,b,f)}_extendCameraOptions(l){const f={top:0,bottom:0,right:0,left:0};if(typeof(l=o.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=="number"){const y=l.padding;l.padding={top:y,bottom:y,right:y,left:y}}return l.padding=o.extend(f,l.padding),l}_minimumAABBFrustumDistance(l,f){const y=f.max[0]-f.min[0],b=f.max[1]-f.min[1];return y/b>l.aspect?y/(2*Math.tan(.5*l.fovX)*l.aspect):b/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,f,y,b,T,M){const C=l.clone(),k=this._extendCameraOptions(M);C.bearing=b,C.pitch=T;const B=o.LngLat.convert(f),R=o.LngLat.convert(y),H=.5*(B.lat+R.lat),ee=.5*(B.lng+R.lng),ie=o.latLngToECEF(H,ee),ae=o.normalize([],ie),oe=o.normalize([],o.cross([],ae,[0,1,0])),se=o.cross([],oe,ae),X=[oe[0],oe[1],oe[2],0,se[0],se[1],se[2],0,ae[0],ae[1],ae[2],0,0,0,0,1],ne=[ie,o.latLngToECEF(B.lat,B.lng),o.latLngToECEF(R.lat,B.lng),o.latLngToECEF(R.lat,R.lng),o.latLngToECEF(B.lat,R.lng),o.latLngToECEF(H,B.lng),o.latLngToECEF(H,R.lng),o.latLngToECEF(B.lat,ee),o.latLngToECEF(R.lat,ee)];let fe=o.Aabb.fromPoints(ne.map(lt=>[o.dot(oe,lt),o.dot(se,lt),o.dot(ae,lt)]));const de=o.transformMat4([],fe.center,X);o.squaredLength(de)===0&&o.set(de,0,0,1),o.normalize(de,de),o.scale$2(de,de,o.GLOBE_RADIUS),C.center=o.ecefToLatLng(de);const Ee=C.getWorldToCameraMatrix(),Pe=o.invert(new Float64Array(16),Ee);fe=o.Aabb.applyTransform(fe,o.multiply([],Ee,X)),o.transformMat4(de,de,Ee);const Ae=.5*(fe.max[2]-fe.min[2]),je=this._minimumAABBFrustumDistance(C,fe),ze=o.scale$2([],[0,0,1],Ae),We=o.add(ze,de,ze),pt=je+(C.pitch===0?0:o.distance(de,We)),Ne=C.globeCenterInViewSpace,nt=o.sub([],de,[Ne[0],Ne[1],Ne[2]]);o.normalize(nt,nt),o.scale$2(nt,nt,pt);const He=o.add([],de,nt);o.transformMat4(He,He,Pe);const dt=o.earthRadius/o.GLOBE_RADIUS,Ge=o.length(He),rt=o.mercatorZfromAltitude(Math.max(Ge*dt-o.earthRadius,Number.EPSILON),0),gt=Math.min(C.zoomFromMercatorZAdjusted(rt),k.maxZoom);return gt>.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(C.setProjection({name:"mercator"}),C.zoom=gt,this._cameraForBounds(C,f,y,b,T,M)):{center:C.center,zoom:gt,bearing:b,pitch:T}}queryTerrainElevation(l,f){const y=this.transform.elevation;return y?(f=o.extend({},{exaggerated:!0},f),y.getAtPoint(o.MercatorCoordinate.fromLngLat(l),null,f.exaggerated)):null}_cameraForBounds(l,f,y,b,T,M){if(l.projection.name==="globe")return this._cameraForBoundsOnGlobe(l,f,y,b,T,M);const C=l.clone(),k=this._extendCameraOptions(M),B=C.padding;C.bearing=b,C.pitch=T;const R=o.LngLat.convert(f),H=o.LngLat.convert(y),ee=new o.LngLat(R.lng,H.lat),ie=new o.LngLat(H.lng,R.lat),ae=C.project(R),oe=C.project(H),se=this.queryTerrainElevation(R),X=this.queryTerrainElevation(H),ne=this.queryTerrainElevation(ee),fe=this.queryTerrainElevation(ie),de=[[ae.x,ae.y,Math.min(se||0,X||0,ne||0,fe||0)],[oe.x,oe.y,Math.max(se||0,X||0,ne||0,fe||0)]];let Ee=o.Aabb.fromPoints(de);const Pe=C.getWorldToCameraMatrix(),Ae=o.invert(new Float64Array(16),Pe);Ee=o.Aabb.applyTransform(Ee,Pe);const je=o.sub([],Ee.max,Ee.min),ze=B.left||0,We=B.right||0,pt=B.bottom||0,Ne=B.top||0,{left:nt,right:He,top:dt,bottom:Ge}=k.padding,rt=.5*(ze+We),gt=.5*(Ne+pt),lt=Math.min(C.scaleZoom(C.scale*Math.min((C.width-(ze+We+nt+He))/je[0],(C.height-(pt+Ne+Ge+dt))/je[1])),k.maxZoom),_t=C.scale/C.zoomScale(lt);Ee=new o.Aabb([Ee.min[0]-(nt+rt)*_t,Ee.min[1]-(Ge+gt)*_t,Ee.min[2]],[Ee.max[0]+(He+rt)*_t,Ee.max[1]+(dt+gt)*_t,Ee.max[2]]);const jt=.5*je[2],Ht=this._minimumAABBFrustumDistance(C,Ee),Dt=[0,0,1,0];o.transformMat4$1(Dt,Dt,Pe),o.normalize$2(Dt,Dt);const Vt=o.scale$2([],Dt,Ht+jt),dr=o.add([],Ee.center,Vt),cr=(typeof k.offset.x=="number"&&typeof k.offset.y=="number"?new o.Point(k.offset.x,k.offset.y):o.Point.convert(k.offset)).rotate(-o.degToRad(b));Ee.center[0]-=cr.x*_t,Ee.center[1]+=cr.y*_t,o.transformMat4(Ee.center,Ee.center,Ae),o.transformMat4(dr,dr,Ae);const Bt=[Ee.center[0],Ee.center[1],dr[2]*C.pixelsPerMeter];o.scale$2(Bt,Bt,1/C.worldSize);const Cr=o.lngFromMercatorX(Bt[0]),zr=o.latFromMercatorY(Bt[1]),Rr=Math.min(C._zoomFromMercatorZ(Bt[2]),k.maxZoom),Br=new o.LngLat(Cr,zr);return C.mercatorFromTransition&&Rr<.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(C.setProjection({name:"globe"}),C.zoom=Rr,this._cameraForBounds(C,f,y,b,T,M)):{center:Br,zoom:Rr,bearing:b,pitch:T}}fitBounds(l,f,y){const b=this.cameraForBounds(l,f);return this._fitInternal(b,f,y)}fitScreenCoordinates(l,f,y,b,T){const M=o.Point.convert(l),C=o.Point.convert(f),k=new o.Point(Math.min(M.x,C.x),Math.min(M.y,C.y)),B=new o.Point(Math.max(M.x,C.x),Math.max(M.y,C.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(M,C))return this;const R=this.transform.pointLocation3D(k),H=this.transform.pointLocation3D(B),ee=this.transform.pointLocation3D(new o.Point(k.x,B.y)),ie=this.transform.pointLocation3D(new o.Point(B.x,k.y)),ae=[Math.min(R.lng,H.lng,ee.lng,ie.lng),Math.min(R.lat,H.lat,ee.lat,ie.lat)],oe=[Math.max(R.lng,H.lng,ee.lng,ie.lng),Math.max(R.lat,H.lat,ee.lat,ie.lat)],se=b&&b.pitch?b.pitch:this.getPitch(),X=this._cameraForBounds(this.transform,ae,oe,y,se,b);return this._fitInternal(X,b,T)}_fitInternal(l,f,y){return l?(delete(f=o.extend(l,f)).padding,f.linear?this.easeTo(f,y):this.flyTo(f,y)):this}jumpTo(l,f){this.stop();const y=l.preloadOnly?this.transform.clone():this.transform;let b=!1,T=!1,M=!1;return"zoom"in l&&y.zoom!==+l.zoom&&(b=!0,y.zoom=+l.zoom),l.center!==void 0&&(y.center=o.LngLat.convert(l.center)),"bearing"in l&&y.bearing!==+l.bearing&&(T=!0,y.bearing=+l.bearing),"pitch"in l&&y.pitch!==+l.pitch&&(M=!0,y.pitch=+l.pitch),l.padding==null||y.isPaddingEqual(l.padding)||(y.padding=l.padding),l.preloadOnly?(this._preloadTiles(y),this):(this.fire(new o.Event("movestart",f)).fire(new o.Event("move",f)),b&&this.fire(new o.Event("zoomstart",f)).fire(new o.Event("zoom",f)).fire(new o.Event("zoomend",f)),T&&this.fire(new o.Event("rotatestart",f)).fire(new o.Event("rotate",f)).fire(new o.Event("rotateend",f)),M&&this.fire(new o.Event("pitchstart",f)).fire(new o.Event("pitch",f)).fire(new o.Event("pitchend",f)),this.fire(new o.Event("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(Is),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,f){const y=this.transform;if(!y.projection.supportsFreeCamera)return o.warnOnce(Is),this;this.stop();const b=y.zoom,T=y.pitch,M=y.bearing;y.setFreeCameraOptions(l);const C=b!==y.zoom,k=T!==y.pitch,B=M!==y.bearing;return this.fire(new o.Event("movestart",f)).fire(new o.Event("move",f)),C&&this.fire(new o.Event("zoomstart",f)).fire(new o.Event("zoom",f)).fire(new o.Event("zoomend",f)),B&&this.fire(new o.Event("rotatestart",f)).fire(new o.Event("rotate",f)).fire(new o.Event("rotateend",f)),k&&this.fire(new o.Event("pitchstart",f)).fire(new o.Event("pitch",f)).fire(new o.Event("pitchend",f)),this.fire(new o.Event("moveend",f)),this}easeTo(l,f){this._stop(!1,l.easeId),((l=o.extend({offset:[0,0],duration:500,easing:o.ease},l)).animate===!1||this._prefersReducedMotion(l))&&(l.duration=0);const y=this.transform,b=this.getZoom(),T=this.getBearing(),M=this.getPitch(),C=this.getPadding(),k="zoom"in l?+l.zoom:b,B="bearing"in l?this._normalizeBearing(l.bearing,T):T,R="pitch"in l?+l.pitch:M,H="padding"in l?l.padding:y.padding,ee=o.Point.convert(l.offset);let ie,ae,oe;if(y.projection.name==="globe"){const ze=o.MercatorCoordinate.fromLngLat(y.center),We=ee.rotate(-y.angle);ze.x+=We.x/y.worldSize,ze.y+=We.y/y.worldSize;const pt=ze.toLngLat(),Ne=o.LngLat.convert(l.center||pt);this._normalizeCenter(Ne),ie=y.centerPoint.add(We),ae=new o.Point(ze.x,ze.y).mult(y.worldSize),oe=new o.Point(o.mercatorXfromLng(Ne.lng),o.mercatorYfromLat(Ne.lat)).mult(y.worldSize).sub(ae)}else{ie=y.centerPoint.add(ee);const ze=y.pointLocation(ie),We=o.LngLat.convert(l.center||ze);this._normalizeCenter(We),ae=y.project(ze),oe=y.project(We).sub(ae)}const se=y.zoomScale(k-b);let X,ne;l.around&&(X=o.LngLat.convert(l.around),ne=y.locationPoint(X));const fe=this._zooming||k!==b,de=this._rotating||T!==B,Ee=this._pitching||R!==M,Pe=!y.isPaddingEqual(H),Ae=ze=>We=>{if(fe&&(ze.zoom=o.number(b,k,We)),de&&(ze.bearing=o.number(T,B,We)),Ee&&(ze.pitch=o.number(M,R,We)),Pe&&(ze.interpolatePadding(C,H,We),ie=ze.centerPoint.add(ee)),X)ze.setLocationAtPoint(X,ne);else{const pt=ze.zoomScale(ze.zoom-b),Ne=k>b?Math.min(2,se):Math.max(.5,se),nt=Math.pow(Ne,1-We),He=ze.unproject(ae.add(oe.mult(We*nt)).mult(pt));ze.setLocationAtPoint(ze.renderWorldCopies?He.wrap():He,ie)}return l.preloadOnly||this._fireMoveEvents(f),ze};if(l.preloadOnly){const ze=this._emulate(Ae,l.duration,y);return this._preloadTiles(ze),this}const je={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=fe,this._rotating=de,this._pitching=Ee,this._padding=Pe,this._easeId=l.easeId,this._prepareEase(f,l.noMoveStart,je),this._ease(Ae(y),ze=>{y.recenterOnTerrain(),this._afterEase(f,ze)},l),this}_prepareEase(l,f,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||y.moving||this.fire(new o.Event("movestart",l)),this._zooming&&!y.zooming&&this.fire(new o.Event("zoomstart",l)),this._rotating&&!y.rotating&&this.fire(new o.Event("rotatestart",l)),this._pitching&&!y.pitching&&this.fire(new o.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new o.Event("move",l)),this._zooming&&this.fire(new o.Event("zoom",l)),this._rotating&&this.fire(new o.Event("rotate",l)),this._pitching&&this.fire(new o.Event("pitch",l))}_afterEase(l,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,b=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new o.Event("zoomend",l)),b&&this.fire(new o.Event("rotateend",l)),T&&this.fire(new o.Event("pitchend",l)),this.fire(new o.Event("moveend",l))}flyTo(l,f){if(this._prefersReducedMotion(l)){const lt=o.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(lt,f)}this.stop(),l=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},l);const y=this.transform,b=this.getZoom(),T=this.getBearing(),M=this.getPitch(),C=this.getPadding(),k="zoom"in l?o.clamp(+l.zoom,y.minZoom,y.maxZoom):b,B="bearing"in l?this._normalizeBearing(l.bearing,T):T,R="pitch"in l?+l.pitch:M,H="padding"in l?l.padding:y.padding,ee=y.zoomScale(k-b),ie=o.Point.convert(l.offset);let ae=y.centerPoint.add(ie);const oe=y.pointLocation(ae),se=o.LngLat.convert(l.center||oe);this._normalizeCenter(se);const X=y.project(oe),ne=y.project(se).sub(X);let fe=l.curve;const de=Math.max(y.width,y.height),Ee=de/ee,Pe=ne.mag();if("minZoom"in l){const lt=o.clamp(Math.min(l.minZoom,b,k),y.minZoom,y.maxZoom),_t=de/y.zoomScale(lt-b);fe=Math.sqrt(_t/Pe*2)}const Ae=fe*fe;function je(lt){const _t=(Ee*Ee-de*de+(lt?-1:1)*Ae*Ae*Pe*Pe)/(2*(lt?Ee:de)*Ae*Pe);return Math.log(Math.sqrt(_t*_t+1)-_t)}function ze(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function We(lt){return(Math.exp(lt)+Math.exp(-lt))/2}const pt=je(0);let Ne=function(lt){return We(pt)/We(pt+fe*lt)},nt=function(lt){return de*((We(pt)*(ze(_t=pt+fe*lt)/We(_t))-ze(pt))/Ae)/Pe;var _t},He=(je(1)-pt)/fe;if(Math.abs(Pe)<1e-6||!isFinite(He)){if(Math.abs(de-Ee)<1e-6)return this.easeTo(l,f);const lt=Ee<de?-1:1;He=Math.abs(Math.log(Ee/de))/fe,nt=function(){return 0},Ne=function(_t){return Math.exp(lt*fe*_t)}}l.duration="duration"in l?+l.duration:1e3*He/("screenSpeed"in l?+l.screenSpeed/fe:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);const dt=T!==B,Ge=R!==M,rt=!y.isPaddingEqual(H),gt=lt=>_t=>{const jt=_t*He,Ht=1/Ne(jt);lt.zoom=_t===1?k:b+lt.scaleZoom(Ht),dt&&(lt.bearing=o.number(T,B,_t)),Ge&&(lt.pitch=o.number(M,R,_t)),rt&&(lt.interpolatePadding(C,H,_t),ae=lt.centerPoint.add(ie));const Dt=_t===1?se:lt.unproject(X.add(ne.mult(nt(jt))).mult(Ht));return lt.setLocationAtPoint(lt.renderWorldCopies?Dt.wrap():Dt,ae),lt._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(f),lt};if(l.preloadOnly){const lt=this._emulate(gt,l.duration,y);return this._preloadTiles(lt),this}return this._zooming=!0,this._rotating=dt,this._pitching=Ge,this._padding=rt,this._prepareEase(f,!1),this._ease(gt(y),()=>this._afterEase(f),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,f)}if(!l){const y=this.handlers;y&&y.stop(!1)}return this}_ease(l,f,y){y.animate===!1||y.duration===0?(l(1),f()):(this._easeStart=o.exported.now(),this._easeOptions=y,this._onEaseFrame=l,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,f){l=o.wrap(l,-180,180);const y=Math.abs(l-f);return Math.abs(l-360-f)<y&&(l-=360),Math.abs(l+360-f)<y&&(l+=360),l}_normalizeCenter(l){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const y=l.lng-f.center.lng;l.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(l){return this._respectPrefersReducedMotion&&o.exported.prefersReducedMotion&&!(l&&l.essential)}_emulate(l,f,y){const b=Math.ceil(15*f/1e3),T=[],M=l(y.clone());for(let C=0;C<=b;C++){const k=M(C/b);T.push(k.clone())}return T}}class It{constructor(l={}){this.options=l,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const f=this.options&&this.options.compact;return this._map=l,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L("button","mapboxgl-ctrl-attrib-button",this._container),L("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,f){const y=this._map._getUIString(`AttributionControl.${f}`);l.setAttribute("aria-label",y),l.removeAttribute("title"),l.firstElementChild&&l.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(l){const y=f.reduce((b,T,M)=>(T.value&&(b+=`${T.key}=${T.value}${M<f.length-1?"&":""}`),b),"?");l.href=`${o.config.FEEDBACK_URL}/${y}#${Vu(this._map,!0)}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const f=this._map.style._sourceCaches;for(const b in f){const T=f[b];if(T.used){const M=T.getSource();M.attribution&&l.indexOf(M.attribution)<0&&l.push(M.attribution)}}l.sort((b,T)=>b.length-T.length),l=l.filter((b,T)=>{for(let M=T+1;M<l.length;M++)if(l[M].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));const y=l.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,l.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Sp{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=L("div","mapboxgl-ctrl");const f=L("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(Object.entries(l).length===0)return!0;for(const f in l){const y=l[f].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const f=l[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class Ep{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const f=++this._id;return this._queue.push({callback:l,id:f,cancelled:!1}),f}remove(l){const f=this._currentlyRunning,y=f?this._queue.concat(f):this._queue;for(const b of y)if(b.id===l)return void(b.cancelled=!0)}run(l=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const y of f)if(!y.cancelled&&(y.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Ol(m,l,f){if(m=new o.LngLat(m.lng,m.lat),l){const y=new o.LngLat(m.lng-360,m.lat),b=new o.LngLat(m.lng+360,m.lat),T=360*Math.ceil(Math.abs(m.lng-f.center.lng)/360),M=f.locationPoint(m).distSqr(l),C=l.x<0||l.y<0||l.x>f.width||l.y>f.height;f.locationPoint(y).distSqr(l)<M&&(C||Math.abs(y.lng-f.center.lng)<T)?m=y:f.locationPoint(b).distSqr(l)<M&&(C||Math.abs(b.lng-f.center.lng)<T)&&(m=b)}for(;Math.abs(m.lng-f.center.lng)>180;){const y=f.locationPoint(m);if(y.x>=0&&y.y>=0&&y.x<=f.width&&y.y<=f.height)break;m.lng>f.center.lng?m.lng-=360:m.lng+=360}return m}const ks={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Pt extends o.Evented{constructor(l,f){if(super(),(l instanceof o.window.HTMLElement||f)&&(l=o.extend({element:l},f)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=o.Point.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=L("div");const b=41,T=27,M=j("svg",{display:"block",height:b*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${b}`},this._element),C=j("radialGradient",{id:"shadowGradient"},j("defs",{},M));j("stop",{offset:"10%","stop-opacity":.4},C),j("stop",{offset:"100%","stop-opacity":.05},C),j("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),j("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),j("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),j("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=o.Point.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});const y=this._element.classList;for(const b in ks)y.remove(`mapboxgl-marker-anchor-${b}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){const l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const f=l.code,y=l.charCode||l.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(l){const f=l.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const l=this._map,f=this._pos;if(!l||!f)return!1;const y=l.unproject(f),b=l.getFreeCameraOptions();if(!b.position)return!1;const T=b.position.toLngLat();return T.distanceTo(y)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const l=this._map;if(!l)return;const f=this._pos;if(!f||f.x<0||f.x>l.transform.width||f.y<0||f.y>l.transform.height)return void this._clearFadeTimer();const y=l.unproject(f);let b;l._showingGlobe()&&o.isLngLatBehindGlobe(l.transform,this._lngLat)?b=0:(b=1-l._queryFogOpacity(y),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const l=this._pos;if(!l||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${l.x}px,${l.y}px)
            ${ks[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${f.x}px,${f.y}px)
        `}_calculateXYTransform(){const l=this._pos,f=this._map,y=this.getPitchAlignment();if(!f||!l||y!=="map")return"";if(!f._showingGlobe()){const k=f.getPitch();return k?`rotateX(${k}deg)`:""}const b=o.radToDeg(o.globeTiltAtLngLat(f.transform,this._lngLat)),T=l.sub(o.globeCenterToScreenPoint(f.transform)),M=Math.abs(T.x)+Math.abs(T.y);if(M===0)return"";const C=b/M;return`rotateX(${-T.y*C}deg) rotateY(${T.x*C}deg)`}_calculateZTransform(){const l=this._pos,f=this._map;if(!f||!l)return"";let y=0;const b=this.getRotationAlignment();if(b==="map")if(f._showingGlobe()){const T=f.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),M=f.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);y=o.radToDeg(Math.atan2(M.y,M.x))-90}else y=-f.getBearing();else if(b==="horizon"){const T=o.smoothstep(4,6,f.getZoom()),M=o.globeCenterToScreenPoint(f.transform);M.y+=T*f.transform.height;const C=l.sub(M),k=o.radToDeg(Math.atan2(C.y,C.x));y=(k>90?k-270:k+90)*(1-T)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(l){o.window.cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=Ol(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),l===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(l){return this._offset=o.Point.convert(l),this._update(),this}_onMove(l){const f=this._map;if(!f)return;const y=this._pointerdownPos,b=this._positionDelta;if(y&&b){if(!this._isDragging){const T=this._clickTolerance||f._clickTolerance;if(l.point.dist(y)<T)return;this._isDragging=!0}this._pos=l.point.sub(b),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(l){const f=this._map,y=this._pos;f&&y&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(y),this._pointerdownPos=l.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;const f=this._map;return f&&(l?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ap={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Z1=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function o_(m=new o.Point(0,0),l="bottom"){if(typeof m=="number"){const f=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(l){case"top":return new o.Point(0,m);case"top-left":return new o.Point(f,f);case"top-right":return new o.Point(-f,f);case"bottom":return new o.Point(0,-m);case"bottom-left":return new o.Point(f,-f);case"bottom-right":return new o.Point(-f,-f);case"left":return new o.Point(m,0);case"right":return new o.Point(-m,0)}return new o.Point(0,0)}return m instanceof o.Point||Array.isArray(m)?o.Point.convert(m):o.Point.convert(m[l]||[0,0])}class Pp{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const f=o.easeCubicInOut((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,f,y){this._start=this.getValue(f),this._end=l,this._startTime=f,this._endTime=f+y}}const a_={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},s_={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},H1={showCompass:!0,showZoom:!0,visualizePitch:!1};class X1{constructor(l,f,y=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new vp({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,y&&(this.mousePitch=new xp({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(l,f){this.mouseRotate.mousedown(l,f),this.mousePitch&&this.mousePitch.mousedown(l,f),V()}move(l,f){const y=this.map,b=this.mouseRotate.mousemoveWindow(l,f),T=b&&b.bearingDelta;if(T&&y.setBearing(y.getBearing()+T),this.mousePitch){const M=this.mousePitch.mousemoveWindow(l,f),C=M&&M.pitchDelta;C&&y.setPitch(y.getPitch()+C)}}off(){const l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){U(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(o.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),K(this.element,l)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,K(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=re(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=re(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Mp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Cp={maxWidth:100,unit:"metric"},Op={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Il={version:o.version,supported:E,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends wh{constructor(m){if(o.LivePerformanceUtils.mark(o.PerformanceMarkers.create),(m=o.extend({},s_,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(m.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Al(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._useWebGL2=m.useWebGL2,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Ep,this._domRenderTaskQueue=new Ep,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.uniqueId(),this._locale=o.extend({},a_,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Pp(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new o.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,typeof m.container=="string"){if(this._container=o.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Vo(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new mp(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,o.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new It({customAttribution:m.customAttribution})),this._logoControl=new Sp,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new o.Event(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new o.Event(`${l.dataType}dataloading`,l))})}_getMapId(){return this._mapId}addControl(m,l){if(l===void 0&&(l=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=m.onAdd(this);this._controls.push(m);const y=this._controlPositions[l];return l.indexOf("bottom")!==-1?y.insertBefore(f,y.firstChild):y.appendChild(f),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(m);return l>-1&&this._controls.splice(l,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const l=!this._moving;return l&&this.fire(new o.Event("movestart",m)).fire(new o.Event("move",m)),this.fire(new o.Event("resize",m)),l&&this.fire(new o.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(o.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?o.window.navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(l=>l==="auto"?o.window.navigator.language:l):m}setLanguage(m){const l=this._parseLanguage(m);if(!this.style||l===this._language)return this;this._language=l,this.style._reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,l=m.projection.name;let f;l==="globe"&&m.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),f=!0):l==="mercator"&&m.zoom<o.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,l){return this._updateProjection(m||l||{name:"mercator"})}_updateProjection(m){let l;if(l=m.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),l){this.painter.clearBackgroundTiles();for(const f in this.style._sourceCaches)this.style._sourceCaches[f].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(o.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(o.Point.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,l,f){if(m==="mouseenter"||m==="mouseover"){let y=!1;const b=M=>{const C=l.filter(B=>this.getLayer(B)),k=C.length?this.queryRenderedFeatures(M.point,{layers:C}):[];k.length?y||(y=!0,f.call(this,new Xn(m,this,M.originalEvent,{features:k}))):y=!1},T=()=>{y=!1};return{layers:new Set(l),listener:f,delegates:{mousemove:b,mouseout:T}}}if(m==="mouseleave"||m==="mouseout"){let y=!1;const b=M=>{const C=l.filter(k=>this.getLayer(k));(C.length?this.queryRenderedFeatures(M.point,{layers:C}):[]).length?y=!0:y&&(y=!1,f.call(this,new Xn(m,this,M.originalEvent)))},T=M=>{y&&(y=!1,f.call(this,new Xn(m,this,M.originalEvent)))};return{layers:new Set(l),listener:f,delegates:{mousemove:b,mouseout:T}}}{const y=b=>{const T=l.filter(C=>this.getLayer(C)),M=T.length?this.queryRenderedFeatures(b.point,{layers:T}):[];M.length&&(b.features=M,f.call(this,b),delete b.features)};return{layers:new Set(l),listener:f,delegates:{[m]:y}}}}on(m,l,f){if(f===void 0)return super.on(m,l);Array.isArray(l)||(l=[l]);const y=this._createDelegatedListener(m,l,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(y);for(const b in y.delegates)this.on(b,y.delegates[b]);return this}once(m,l,f){if(f===void 0)return super.once(m,l);Array.isArray(l)||(l=[l]);const y=this._createDelegatedListener(m,l,f);for(const b in y.delegates)this.once(b,y.delegates[b]);return this}off(m,l,f){if(f===void 0)return super.off(m,l);l=new Set(Array.isArray(l)?l:[l]);const y=(T,M)=>{if(T.size!==M.size)return!1;for(const C of T)if(!M.has(C))return!1;return!0},b=this._delegatedListeners?this._delegatedListeners[m]:void 0;return b&&(T=>{for(let M=0;M<T.length;M++){const C=T[M];if(C.listener===f&&y(C.layers,l)){for(const k in C.delegates)this.off(k,C.delegates[k]);return T.splice(M,1),this}}})(b),this}queryRenderedFeatures(m,l){return this.style?(l!==void 0||m===void 0||m instanceof o.Point||Array.isArray(m)||(l=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],l=l||{},this.transform)):[]}querySourceFeatures(m,l){return this.style.querySourceFeatures(m,l)}isPointOnSurface(m){const{name:l}=this.transform.projection;return l!=="globe"&&l!=="mercator"&&o.warnOnce(`${l} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.Point.convert(m))}setStyle(m,l){return(l=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&l.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(m,l))}_getUIString(m){const l=this._locale[m];if(l==null)throw new Error(`Missing UI string '${m}'`);return l}_updateStyle(m,l){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new No(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new No(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,l){if(typeof m=="string"){const f=this._requestManager.normalizeStyleURL(m),y=this._requestManager.transformRequest(f,o.ResourceType.Style);o.getJSON(y,(b,T)=>{b?this.fire(new o.ErrorEvent(b)):T&&this._updateDiff(T,l)})}else typeof m=="object"&&this._updateDiff(m,l)}_updateDiff(m,l){try{this.style.setState(m)&&this._update(!0)}catch(f){o.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(m,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(m,l){return this._lazyInitEmptyStyle(),this.style.addSource(m,l),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const l in m){const f=m[l]._tiles;for(const y in f){const b=f[y];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}addSourceType(m,l,f){this._lazyInitEmptyStyle(),this.style.addSourceType(m,l,f)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,l,{pixelRatio:f=1,sdf:y=!1,stretchX:b,stretchY:T,content:M}={}){if(this._lazyInitEmptyStyle(),l instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&l instanceof o.window.ImageBitmap){const{width:C,height:k,data:B}=o.exported.getImageData(l);this.style.addImage(m,{data:new o.RGBAImage({width:C,height:k},B),pixelRatio:f,stretchX:b,stretchY:T,content:M,sdf:y,version:0})}else if(l.width===void 0||l.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:C,height:k}=l,B=l;this.style.addImage(m,{data:new o.RGBAImage({width:C,height:k},new Uint8Array(B.data)),pixelRatio:f,stretchX:b,stretchY:T,content:M,sdf:y,version:0,userImage:B}),B.onAdd&&B.onAdd(this,m)}}updateImage(m,l){const f=this.style.getImage(m);if(!f)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=l instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&l instanceof o.window.ImageBitmap?o.exported.getImageData(l):l,{width:b,height:T}=y;b!==void 0&&T!==void 0?b===f.data.width&&T===f.data.height?(f.data.replace(y.data,!(l instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&l instanceof o.window.ImageBitmap)),this.style.updateImage(m,f)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${b}, ${T})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,l){o.getImage(this._requestManager.transformRequest(m,o.ResourceType.Image),(f,y)=>{l(f,y instanceof o.window.HTMLImageElement?o.exported.getImageData(y):y)})}listImages(){return this.style.listImages()}addLayer(m,l){return this._lazyInitEmptyStyle(),this.style.addLayer(m,l),this._update(!0)}moveLayer(m,l){return this.style.moveLayer(m,l),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,l,f){return this.style.setLayerZoomRange(m,l,f),this._update(!0)}setFilter(m,l,f={}){return this.style.setFilter(m,l,f),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,l,f,y={}){return this.style.setPaintProperty(m,l,f,y),this._update(!0)}getPaintProperty(m,l){return this.style.getPaintProperty(m,l)}setLayoutProperty(m,l,f,y={}){return this.style.setLayoutProperty(m,l,f,y),this._update(!0)}getLayoutProperty(m,l){return this.style.getLayoutProperty(m,l)}setLight(m,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,l),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(m),this.transform):0}setFeatureState(m,l){return this.style.setFeatureState(m,l),this._update()}removeFeatureState(m,l){return this.style.removeFeatureState(m,l),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300;let f,y,b,T=this._container;for(;T&&(!y||!b);){const M=o.window.getComputedStyle(T).transform;M&&M!=="none"&&(f=M.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&f[0]!=="0"&&f[0]!=="1"&&(y=f[0]),f[3]&&f[3]!=="0"&&f[3]!=="1"&&(b=f[3])),T=T.parentElement}this._containerWidth=y?Math.abs(m/y):m,this._containerHeight=b?Math.abs(l/b):l}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=L("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=L("div","mapboxgl-canvas-container",m);this._interactive&&l.classList.add("mapboxgl-interactive"),this._canvas=L("canvas","mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=L("div","mapboxgl-control-container",m),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{y[b]=L("div",`mapboxgl-ctrl-${b}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,l){const f=o.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(m),this._canvas.height=f*Math.ceil(l),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${l}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const l=this._markers.indexOf(m);l!==-1&&this._markers.splice(l,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const l=this._popups.indexOf(m);l!==-1&&this._popups.splice(l,1)}_setupPainter(){const m=o.extend({},E.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._useWebGL2&&this._canvas.getContext("webgl2",m),f=l||this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);f?(this._useWebGL2&&!l&&o.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),o.storeAuthState(f,!0),this.painter=new Sl(f,this.transform,!!l),this.on("data",y=>{y.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(f)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let l;const f=this.painter.context.extTimerQuery,y=o.exported.now();if(this.listens("gpu-timing-frame")&&(l=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],o.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],o.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const C=this.transform.zoom,k=this.transform.pitch,B=o.exported.now(),R=new o.EvaluationParameters(C,{now:B,fadeDuration:b,pitch:k,transition:this.style.getTransition()});this.style.update(R)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let T=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),T=this._updateAverageElevation(y),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):T=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){const C=o.exported.now()-y;f.endQueryEXT(f.TIME_ELAPSED_EXT,l),setTimeout(()=>{const k=f.getQueryObjectEXT(l,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(l),this.fire(new o.Event("gpu-timing-frame",{cpuTime:C,gpuTime:k})),o.window.performance.mark("frame-gpu",{startTime:y,detail:{gpuTime:k}})},50)}if(this.listens("gpu-timing-layer")){const C=this.painter.collectGpuTimers();setTimeout(()=>{const k=this.painter.queryGpuTimers(C);this.fire(new o.Event("gpu-timing-layer",{layerTimes:k}))},50)}if(this.listens("gpu-timing-deferred-render")){const C=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const k=this.painter.queryGpuTimeDeferredRender(C);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:k}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty||T;if(M||this._repaint)this.triggerRepaint();else{const C=!this.isMoving()&&this.loaded();if(C&&(T=this._updateAverageElevation(y,!0)),T)this.triggerRepaint();else if(this._triggerFrame(!1),C&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const k=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:k})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,o.LivePerformanceUtils.mark(o.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&o.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const l of this._markers)m&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(const l of this._popups)!m||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(m,l=!1){const f=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);if((l||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const y=this.transform.averageElevation;let b=this.transform.sampleAverageElevation(),T=!1;this.transform.elevation&&(T=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=m;const M=Math.abs(y-b);if(M>1){if(this._isInitialLoad||T)return this._averageElevation.jumpTo(b),f(b);this._averageElevation.easeTo(b,m,300)}else if(M>1e-4)return this._averageElevation.jumpTo(b),f(b)}return!!this._averageElevation.isEasing(m)&&f(this._averageElevation.getValue(m))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===o.AUTH_ERR_MSG||m.status===401)){const l=this.painter.context.gl;o.storeAuthState(l,!1),this._logoControl instanceof Sp&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const f=this.painter.context.gl,y=f.createFramebuffer();function b(T){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,T,0);const M=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,M),M}return f.bindFramebuffer(f.FRAMEBUFFER,y),this._canvasPixelComparison(b(m),l.canvasCopies.map(b),l.timeStamps)}_canvasPixelComparison(m,l,f){let y=f[1]-f[0];const b=m.length/4;for(let T=0;T<l.length;T++){const M=l[T];let C=0;for(let k=0;k<M.length;k+=4)M[k]===m[k]&&M[k+1]===m[k+1]&&M[k+2]===m[k+2]&&M[k+3]===m[k+3]&&(C+=1);y+=(f[T+2]-f[T+1])*(1-C/b)}return y}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1),o.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=o.exported.frame(l=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(l)}))}_preloadTiles(m){const l=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(l,(f,y)=>f._preloadTiles(m,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){o.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,l){o.setCacheLimits(m,l)}get version(){return o.version}},NavigationControl:class{constructor(m){this.options=o.extend({},H1,m),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>{this._map&&this._map.zoomIn({},{originalEvent:l})}),L("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>{this._map&&this._map.zoomOut({},{originalEvent:l})}),L("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:l}):f.resetNorth({},{originalEvent:l}))}),this._compassIcon=L("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const l=m.getZoom(),f=l===m.getMaxZoom(),y=l===m.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=l)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new X1(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,l){const f=L("button",m,this._container);return f.type="button",f.addEventListener("click",l),f}_setButtonTitle(m,l){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${l}`);m.setAttribute("aria-label",f),m.firstElementChild&&m.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends o.Evented{constructor(m){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},Mp,m),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Pl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const l=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,m(f)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(f=>l(f.state!=="denied")).catch(()=>l()):l()}_isOutOfMapMaxBounds(m){const l=this._map.getMaxBounds(),f=m.coords;return!!l&&(f.longitude<l.getWest()||f.longitude>l.getEast()||f.latitude<l.getSouth()||f.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",m)),this._finish()}}_updateCamera(m){const l=new o.LngLat(m.coords.longitude,m.coords.latitude),f=m.coords.accuracy,y=this._map.getBearing(),b=o.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(f),b,{geolocateSource:!0})}_updateMarker(m){if(m){const l=new o.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,l=o.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,f=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=L("button","mapboxgl-ctrl-geolocate",this._container),L("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L("div","mapboxgl-user-location"),this._dotElement.appendChild(L("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(L("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Pt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=L("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Pt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(l=>{l==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:It,ScaleControl:class{constructor(m){this.options=o.extend({},Cp,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,l=this._map,f=l._containerHeight/2,y=l._containerWidth/2-m/2,b=l.unproject([y,f]),T=l.unproject([y+m,f]),M=b.distanceTo(T);if(this.options.unit==="imperial"){const C=3.2808*M;C>5280?this._setScale(m,C/5280,"mile"):this._setScale(m,C,"foot")}else this.options.unit==="nautical"?this._setScale(m,M/1852,"nautical-mile"):M>=1e3?this._setScale(m,M/1e3,"kilometer"):this._setScale(m,M,"meter")}_setScale(m,l,f){this._map._requestDomTask(()=>{const y=function(T){const M=Math.pow(10,`${Math.floor(T)}`.length-1);let C=T/M;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(k){const B=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*B)/B}(C),M*C}(l),b=y/l;this._container.innerHTML=this._isNumberFormatSupported&&f!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:f}).format(y):`${y}&nbsp;${Op[f]}`,this._container.style.width=m*b+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof o.window.HTMLElement?this._container=m.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=L("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(m){super(),this.options=o.extend(Object.create(Ap),m),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=o.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(o.window.document.createTextNode(m))}setHTML(m){const l=o.window.document.createDocumentFragment(),f=o.window.document.createElement("body");let y;for(f.innerHTML=m;y=f.firstChild,y;)l.appendChild(y);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=L("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(m),this.options.closeButton){const f=this._closeButton=L("button","mapboxgl-popup-close-button",l);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let l;return this._classList.delete(m)?l=!1:(this._classList.add(m),l=!0),this._updateClassList(),l}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const l=this._map,f=this._container,y=this._pos;if(!l||!f||!y)return"bottom";const b=f.offsetWidth,T=f.offsetHeight,M=y.x<b/2,C=y.x>l.transform.width-b/2;if(y.y+m<T)return M?"top-left":C?"top-right":"top";if(y.y>l.transform.height-T){if(M)return"bottom-left";if(C)return"bottom-right"}return M?"left":C?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),m.className=l.join(" ")}_update(m){const l=this._map,f=this._content;if(!l||!this._lngLat&&!this._trackPointer||!f)return;let y=this._container;if(y||(y=this._container=L("div","mapboxgl-popup",l.getContainer()),this._tip=L("div","mapboxgl-popup-tip",y),y.appendChild(f)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ol(this._lngLat,this._pos,l.transform)),!this._trackPointer||m){const b=this._pos=this._trackPointer&&m?m:l.project(this._lngLat),T=o_(this.options.offset),M=this._anchor=this._getAnchor(T.y),C=o_(this.options.offset,M),k=b.add(C).round();l._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${ks[M]} translate(${k.x}px,${k.y}px)`)})}if(!this._marker&&l._showingGlobe()){const b=o.isLngLatBehindGlobe(l.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Z1);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Pt,Style:No,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:Gy,Evented:o.Evented,config:o.config,prewarm:function(){Ja().acquire(Lr)},clearPrewarmedResources:function(){const m=Zn;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(Lr),Zn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(m){o.config.ACCESS_TOKEN=m},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(m){o.config.API_URL=m},get workerCount(){return dn.workerCount},set workerCount(m){dn.workerCount=m},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){o.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){o.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return Il});var _=h;return _})})(FF);var NF=FF.exports;const Cge=Xr(NF),Oge=yz({__proto__:null,default:Cge},[NF]);export{qge as B,yme as C,Nge as F,Rge as H,zge as L,$ge as M,Uge as N,Jr as P,Wge as R,Gge as S,Ws as T,vS as W,KP as X,YP as Y,NG as _,Fge as a,Vge as b,Ld as c,Lge as d,jge as e,IO as f,Fe as g,OG as h,Dge as i,kge as j,Bge as p,De as r,DV as u};
